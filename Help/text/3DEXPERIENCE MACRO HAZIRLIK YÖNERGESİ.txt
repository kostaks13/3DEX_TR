--- PAGE 1 ---

3DEXPERIENCE MACRO HAZIRLIK YÃ–NERGESÄ° 
1âƒ£ Ä°htiyacÄ± Analiz Et (Context & Scope) â€“ DerinleÅŸtirilmiÅŸ Ã‡erÃ§eve Bir talebi kod aÅŸamasÄ±na geÃ§irmeden Ã¶nce â€œne istiyoruz, neden istiyoruz, hangi kÄ±sÄ±tlarla istiyoruz?â€ sorularÄ±nÄ± tÃ¼m netliÄŸiyle yanÄ±tlamamÄ±z gerekir. AÅŸaÄŸÄ±daki beÅŸ katmanlÄ± analiz, 3DEXPERIENCE otomasyon projelerinde gereksinimi eksiksiz Ã§Ä±karmak iÃ§in adÄ±m adÄ±m izlenecek rehberdir.  Katman A â€“ AmaÃ§ & Ä°ÅŸ Sonucu 1. Ä°ÅŸ Hedefi Â· ParÃ§ayÄ± mÄ± otomatik oluÅŸturacaÄŸÄ±z, montaj verisini mi raporlayacaÄŸÄ±z? 2. BaÅŸarÄ± Ã–lÃ§Ã¼tÃ¼ Â· â€œMakro Ã§alÄ±ÅŸÄ±nca 5 dakikadan kÄ±sa sÃ¼rede X iÅŸlemi bitmeli.â€ 3. KullanÄ±cÄ± Profili Â· TasarÄ±m mÃ¼hendisi mi, simÃ¼lasyon mÃ¼hendisi mi? 4. Zaman / SÄ±klÄ±k Â· Bir kerelik mi, her gÃ¼n Ã§alÄ±ÅŸacak kronik bir iÅŸ mi? 5. PaydaÅŸlar Â· Kim onaylayacak; kimlerin modeline dokunuyoruz?  Katman B â€“ Teknik Kapsam 1. Ã‡alÄ±ÅŸma Nesnesi Â· Part / Product / Drawing / VPMReference? 2. Workbench Gereksinimi Â· GSD, Part Design, Composites, Simulationâ€¦ 3. Ana API ModÃ¼lÃ¼ Â· HybridShapeFactory, PLMProductService, VOCServices vb. 4. Girdi Tipi Â· KullanÄ±cÄ± seÃ§imi, parametre listesi, dosya, PLM aramasÄ±? 5. Ã‡Ä±ktÄ± Tipi Â· Geometri, attribute gÃ¼ncellemesi, rapor dosyasÄ±?  Katman C â€“ Operasyon & BaÄŸÄ±mlÄ±lÄ±klar 1. Veri KaynaÄŸÄ± Â· Yerel .CATPart mi, PLM sunucusundan Ã§aÄŸrÄ±lan referans mÄ±? 2. EriÅŸim Yetkisi Â· KullanÄ±cÄ±nÄ±n gerekli lisansÄ±/workbenchâ€™i var mÄ±? 3. AltyapÄ± BaÄŸÄ±mlÄ±lÄ±ÄŸÄ± Â· Malzeme kÃ¼tÃ¼phanesi, rulebase, harici DLL, network paylaÅŸÄ±mlarÄ±? 4. Kritik Yol Â· Makro hangi adÄ±mda durursa iÅŸ aksar? 

--- PAGE 2 ---

5. Performans SÄ±nÄ±rÄ± Â· 10.000 occurrenceâ€™lÄ± montajÄ± tarayacak mÄ±yÄ±z?  Katman D â€“ KÄ±sÄ±tlar & Riskler â€¢ Politika Â· â€œV5 API Ã§aÄŸrÄ±sÄ± yasakâ€, â€œyalnÄ±zca VBScript desteklenirâ€. â€¢ GÃ¼venlik Â· PLM sunucuda yalnÄ±z okuma / yazma izni? â€¢ Rollback Gerekir mi? Â· Attributeâ€™lar hatalÄ± yazÄ±lÄ±rsa otomatik geri alma. â€¢ Versioning Â· Yeni nesne oluÅŸturulacaksa revisyon stratejisi ne? â€¢ Hata YansÄ±malarÄ± Â· BaÅŸarÄ±sÄ±z gÃ¼ncelleme montaj iliÅŸkilerini bozar mÄ±?  Katman E â€“ DÃ¶kÃ¼mantasyon & DoÄŸrulama 1. Kabul Testi TanÄ±mÄ± o â€œSeÃ§ilen iki yÃ¼z arasÄ±nda Ã¶lÃ§Ã¼ raporu (mm) = 25 Â± 0.1 yazdÄ±rÄ±lmalÄ±dÄ±r.â€ 2. GÃ¼nlÃ¼k/Geri Bildirim o BaÅŸarÄ±lÄ± tamamlanÄ±nca mesaj; hata varsa log dosyasÄ±. 3. Versiyon Notasyonu o Makro sÃ¼rÃ¼mÃ¼, API deÄŸiÅŸiklik zamanÄ±, Help referansÄ±. 4. EÄŸitim / El KitabÄ± o KullanÄ±cÄ±ya Ã¼Ã§ adÄ±mlÄ± kullanÄ±m yÃ¶nergesi. 5. BakÄ±m PlanÄ± o Hangi Help dokÃ¼man sÃ¼rÃ¼mÃ¼ deÄŸiÅŸirse makro revize edilecek?  Uygulanabilir Kontrol Formu (Minimum Soru Seti) 1. Ne yapÄ±lacak? 2. Hangi model(ler) / workbench? 3. Girdi nereden geliyor? 4. Ã‡Ä±ktÄ± ne olacak, kime gidecek? 5. Ã–lÃ§ek? (parÃ§a / montaj bÃ¼yÃ¼klÃ¼ÄŸÃ¼) 6. SÃ¼re/lisans kÄ±sÄ±tÄ± var mÄ±? 7. BaÅŸarÄ±nÄ±n teknik Ã¶lÃ§Ã¼tÃ¼? 8. Hata durumda ne olmalÄ±? 9. Ek risk veya politika kÄ±sÄ±tÄ±? Bu formu doldurmadan Katman Bâ€™ye geÃ§ilmez; eksik alan kalÄ±rsa kullanÄ±cÄ±dan netleÅŸtirme sorusu sorulur.  

--- PAGE 3 ---

Ã–rnek Uygulama â€“ Analiz Ã‡Ä±kÄ±ÅŸÄ± (Ã–zet) â€¢ Ä°ÅŸ Hedefi: Montaj iÃ§indeki tÃ¼m CATPartâ€™larÄ±n kÃ¼tlesini toparlayÄ±p CSV export. â€¢ API ModÃ¼lÃ¼: PLMProductService (occurrence tarama) + InertiaService. â€¢ Girdi: Aktif montaj, kullanÄ±cÄ± seÃ§imine gerek yok. â€¢ Ã‡Ä±ktÄ±: C:\Reports\masslist.csv, kolonlar = PartName, Mass(kg). â€¢ SÄ±klÄ±k: HaftalÄ±k. â€¢ KÄ±sÄ±t: Export klasÃ¶rÃ¼ne yazma izni olmalÄ±; V5 API kullanÄ±mÄ± yasak. â€¢ Test: Toplam kÃ¼tle, CATIA Properties toplam kÃ¼tleyle Â±1 g tutarlÄ± olmalÄ±. Bu derinleÅŸtirilmiÅŸ analiz tamamlandÄ±ÄŸÄ±nda artÄ±k DoÄŸru ModÃ¼l EÅŸleÅŸtirme fazÄ±na geÃ§ilmeye hazÄ±rÄ±z.   
2âƒ£ DoÄŸru ModÃ¼lÃ¼ & APIâ€™yi EÅŸleÅŸtir â€“ AyrÄ±ntÄ±lÄ± Karar Sistemi Bir gereksinimin hangi 3DEXPERIENCE â€œdÃ¼nyasÄ±ndaâ€ (Part Design, GSD, Assembly, Simulation vb.) Ã§Ã¶zÃ¼leceÄŸini hatasÄ±z belirlemek, makronun %80â€™ini baÅŸarÄ±yla yazmak anlamÄ±na gelir. AÅŸaÄŸÄ±daki Ã§ok katmanlÄ± eÅŸleÅŸtirme yÃ¶ntemi, â€œhangi iÅŸi hangi API ile yapacaÄŸÄ±m?â€ sorusunu sistematik biÃ§imde yanÄ±tlar.  A. Ã–n Filtre â€“ ÃœÃ§ Kritik Soru Soru SeÃ§enek SonuÃ§ta BakÄ±lacak Katman 
1âƒ£ Ã‡Ä±ktÄ± geometri mi, Ã¶znitelik mi, belge mi? Geometri â†’ Factory API Ã–znitelik â†’ PLMEntity/Parameter Belge/Rapor â†’ FileSystem/Python B-1 / B-2 
2âƒ£ Ä°ÅŸ tekil parÃ§a mÄ±, montaj mÄ±, dokÃ¼man mÄ±? Tekil â†’ Part tabanlÄ± API Montaj â†’ Occurrence & Service API DokÃ¼man â†’ Drafting/Document API B-3 
3âƒ£ Ä°ÅŸlem yerel mi, sunucu tabanlÄ± mÄ±? Yerel â†’ Editor-level API Sunucu â†’ Session-level Service C-1  B. Ana ModÃ¼l Matrisi 

--- PAGE 4 ---

Gereksinim Tipi KullanÄ±lacak Workbench Temel Nesne Ana Factory veya Service Basit KatÄ± (Pad, Pocket) Part Design Part / Bodies ShapeFactory Ä°leri YÃ¼zey (Sweep, Loft) GSD Part / HybridBodies HybridShapeFactory Montaj AÄŸacÄ± Ä°ÅŸlemi Assembly Design Product / VPMOccurrence PLMProductService KÃ¼tle, Atalet â€” Part/Product InertiaService Ã–lÃ§Ã¼m (mesafe, aÃ§Ä±) â€” SeÃ§im veya Ref MeasureService / MeasurableService Parametrik Kural Knowledge ParameterSet KnowledgeFactory Kompozit Composites Part CompositesServices Hacim Analizi (BoÅŸluk, KalÄ±nlÄ±k) â€” VPMRepReference VOCServices Malzeme Atama â€” PLMEntity MaterialService PLM Arama â€” â€” SearchService SimÃ¼lasyon KoÅŸusu Simulation ScenarioRepresentation SimExecutionService Taktik: Ã‡izgiyi kesen hiÃ§bir kutu yoksaâ€”Ã¶rneÄŸin â€œElektrik 2D kablo dÃ¼zeniâ€ gibi Ã¶zel bir ihtiyaÃ§â€”yardÄ±m setinde â€œNative Apps Automation.pdfâ€ iÃ§indeki modÃ¼l baÄŸÄ±msÄ±z API grubuna (ElectricalHarnessItf vb.) bak.  C. Servis KatmanÄ± SeÃ§imi Ã–lÃ§Ã¼t Editor-Level Service Session-Level Service Nesneye Ã¶zgÃ¼ anlÄ±k iÅŸlem Geometri oluÅŸtur, kÃ¼tle hesapla, Ã¶lÃ§Ã¼m yap Yeni nesne yarat, PLM arama, malzeme kÃ¼tÃ¼phanesi, toplu kaydet Sunucu etkileÅŸimi Sadece â€œSaveâ€ Ã§aÄŸrÄ±sÄ±nda Her Ã§aÄŸrÄ±da (Ã¶r. PLMNewService.PLMCreate) Performans RAM odaklÄ±, hÄ±zlÄ± AÄŸ gecikmesi + PLM doÄŸrulamasÄ± Ã–rnek InertiaService, SectionService SearchService, MaterialService Kural: Editor-level servis Ã§aÄŸrÄ±sÄ± iÃ§inde Session-level servis Ã§aÄŸrÄ±sÄ± yapma; kilitleÅŸme riski doÄŸar.  D. Karar AkÄ±ÅŸ ÅemasÄ± (Ã–zet) 

--- PAGE 5 ---

BaÅŸla  â””â”€> Ã‡Ä±ktÄ± geometri mi? â€” HayÄ±r â€”â”       â”‚                          â”‚       â””â”€> PLM Ã¶zniteliÄŸi mi?      â”‚             â”‚                    â”‚      Geometri ise Part/Product?  â”‚            â”‚                     â”‚       Part â†’ Factory seÃ§ (A)     â”‚       Product â†’ Service seÃ§ (B)  â”‚       â”‚                          â”‚       Ã–znitelik ise              â”‚       Parameter mÄ±? â†’ Knowledge  â”‚       PLM attribute? â†’ PLMEntity â”‚       â”‚                          â”‚       Son â†’ Kod TaslaÄŸÄ±          â”‚  E. Ã‡apraz Uyumluluk & Yasaklar Durum Kullan / Kullanma ParÃ§a iÃ§inde yeni 3DShape aÃ§mak PLMNewService.PLMCreate â€” Documents.Add yasak HybridBodies olmayan Partâ€™a yÃ¼zey eklemek Ã–nce Part.GetItem("HybridBodies"), yoksa Create Geometrical Set OrderedGeometricalSets (Body) iÃ§ine hibrit yÃ¼zey atmak YASAK â€“ Derleme hatasÄ± V5 API â€œSelection.Filterâ€ kullanÄ±mÄ± YASAK â€“ 3DEXPERIENCE Selection objesi farklÄ±dÄ±r Ã‡ift taraflÄ± Update (loopâ€™ta Update) Performans-hatasÄ± â€“ tek oPart.Update  F. SeÃ§im SonrasÄ± DoÄŸrulama SorularÄ± 1. Factory/Service mevcut mu? Set obj = â€¦ sonrasÄ± If obj Is Nothing Then. 2. Workbench yÃ¼klÃ¼ mÃ¼? CATIA.StartWorkbench("Generative Shape Design") gerekti mi? 3. Koleksiyon boÅŸ mu? Count kontrolÃ¼ yapÄ±lmadan Item(i) Ã§aÄŸrÄ±lmayacak. 4. Read-only nesneye mi yazÄ±yoruz? PLMEntity.AccessState ? 5. Sunucu kilidi gerekir mi? PLMSessionService.ChangeOwner gerekli mi?  G. Pratik EÅŸleÅŸtirme Ã–rnekleri 

--- PAGE 6 ---

Talep ModÃ¼l + API Neden DoÄŸru? 3 SatÄ±rlÄ±k Kod Ä°skeleti â€œParÃ§anÄ±n XY dÃ¼zlemine 10 mm offset bir dÃ¼zlem ekleâ€ 
GSD, HybridShapeFactory Hibrit yÃ¼zey; Part iÃ§i. Set oHSF = oPart.HybridShapeFactorySet oPlane = oHSF.AddNewPlaneOffset(refXY,10#)oHB.AppendHybridShape oPlane 
â€œMontajta tÃ¼m alt parÃ§alarÄ±n kÃ¼tlesini alâ€ 
Assembly + PLMProductService & InertiaService 
Montaj taramasÄ± + kÃ¼tle. Set prodSvc = ed.GetService("PLMProductService")Set inrSvc = ed.GetService("InertiaService")For Each occ In prodSvc.RootOccurrence.RepInstances â€¦ 
â€œParÃ§aya â€˜Material: 7075-T6â€™ ataâ€ Session-level MaterialService VeritabanÄ± malzeme tablosu. 
Set matSvc = CATIA.GetSessionService("MaterialService")matSvc.AssignMaterial oPart,"7075-T6" â€œTÃ¼m CATPartâ€™larÄ± ada gÃ¶re PLMâ€™de araâ€ 
Session-level SearchService PLM veritabanÄ± aramasÄ±. 
Set ss = CATIA.GetSessionService("SearchService")Set rs = ss.Search("CATPart","Name LIKE 'Gear*'") 
 Bu geniÅŸletilmiÅŸ eÅŸleÅŸtirme fazÄ± tamamlandÄ±ÄŸÄ±nda: â€¢ Hangi workbench / servis / factory kullanacaÄŸÄ±mÄ±z, â€¢ Neden o modÃ¼lÃ¼ tercih ettiÄŸimiz, â€¢ NasÄ±l null-kontrolleri ve lisans doÄŸrulamasÄ±nÄ± yapacaÄŸÄ±mÄ±z netleÅŸmiÅŸ olur. ArdÄ±ndan Faz 3â€™te (Kod TaslaÄŸÄ±) doÄŸrudan bu seÃ§ime gÃ¶re ÅŸablon Ã¼retilir.   
3âƒ£ Kodu Standart Åablona GÃ¶re Ãœret (Design â†’ Draft â†’ Finalize) â€“ AyrÄ±ntÄ±lÄ± Uygulama KÄ±lavuzu 

--- PAGE 7 ---

Bu faz, â€œanaliz-ve-eÅŸleÅŸtirmeâ€ adÄ±mlarÄ±nda netleÅŸtirdiÄŸimiz gereksinimi Ã¼retilebilir CATScript koduna dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r. AÅŸaÄŸÄ±daki dÃ¶rt alt-faz, fikirden derlenebilir makroya kadar giden tÃ¼m basamaklarÄ± ayrÄ±ntÄ±landÄ±rÄ±r.  3A â€” Design (AkÄ±ÅŸ TasarÄ±mÄ±) AdÄ±m Ã‡Ä±ktÄ± Not D-1 High-level pseudo-code Her satÄ±r tek iÅŸ: â€œGeometrical Setâ€™i bulâ€, â€œNokta oluÅŸturâ€, â€œUpdateâ€. D-2 Veri sÃ¶zleÅŸmesi Girdiâ€†/â€†Ã§Ä±ktÄ± listesi, parametre adlarÄ±, birim (mm/deg), seÃ§im bekleniyor mu? D-3 Risk matrisi Null koleksiyon, lisans yok, read-only attributeâ€¦ D-4 Kod baÅŸlÄ±ÄŸÄ± AmaÃ§, sÃ¼rÃ¼m, yazar, tarih, kullanÄ±lan APIâ€™ler. Åablon â€“ Pseudo-code â€¢ Aktif Editor & Part al â€¢ HybridBodies koleksiyonu doÄŸrula â€¢ HybridShapeFactory al â€¢ Yeni nokta ekle â€¢ InWorkObject ayarla â€¢ Part update  3B â€” Draft (Ä°skelet Kod) BÃ¶lÃ¼m Ä°Ã§erik Kural B-1 Option Explicit + baÅŸlÄ±k yorum bloÄŸu JIRA ID, Help referansÄ±, sÃ¼rÃ¼m B-2 Sub â€¦ End Sub Tek giriÅŸ, gerekirse alt prosedÃ¼rler B-3 DeÄŸiÅŸken bildirimi Ã–nekli adlandÄ±rma (oPart, dOffset, vSel) B-4 Hata bloÄŸu aÃ§ On Error Resume Next B-5 Ana API nesnelerini late-binding ile al Dim oHSF As Object : Set oHSF = â€¦ B-6 BoÅŸ/null kontrolleri Her Set sonrasÄ± If obj Is Nothing Then Exit Sub B-7 Ä°skelet â€œiÅŸ mantÄ±ÄŸÄ±â€ satÄ±rlarÄ± YalnÄ±z AddNew* veya Service Ã§aÄŸrÄ±larÄ±, parametre yer tutucu Option Explicit                      ' B-1 '--- AddPoint v1.0 â€“ 2025-07-12 Sub AddPoint()                       ' B-2     On Error Resume Next             ' B-4     '--- B-3 DeÄŸiÅŸkenler 

--- PAGE 8 ---

    Dim oEd  As Object, oPart As Object, oHBs As Object     Dim oHB  As Object, oHSF As Object, oPt As Object          Set oEd  = CATIA.ActiveEditor     Set oPart = oEd.ActiveObject     If oPart Is Nothing Then Exit Sub        ' B-6          Set oHBs = oPart.GetItem("HybridBodies") ' B-5     If oHBs Is Nothing Or oHBs.Count = 0 Then Exit Sub     Set oHB  = oHBs.Item(1)          Set oHSF = oPart.HybridShapeFactory     Set oPt  = oHSF.AddNewPointCoord(0#, 0#, 0#)   ' B-7          oHB.AppendHybridShape oPt     oPart.InWorkObject = oPt     oPart.Update     On Error GoTo 0 End Sub  3C â€” Harden (GÃ¼venli & PerformanslÄ± Kod) Kontrol Uygulama Null & Count TÃ¼m koleksiyonlar iÃ§in If Is Nothing Or .Count=0 Workbench doÄŸrulama CATIA.StartWorkbench("Generative Shape Design") gerekliyse Read-only engeli If oPart.ReadOnly Then Exit Sub Tek Update DÃ¶ngÃ¼de deÄŸil, sonda bir kez oPart.Update Err log FileSystem + OpenAsTextStream(ForAppend) SÃ¼re Ã¶lÃ§Ã¼mÃ¼ t0 = Timer â€¦ Debug.Print "SÃ¼re: ", Timer-t0 Bellek boÅŸaltma BÃ¼yÃ¼k dÃ¶ngÃ¼ sonunda Set oHB = Nothing  3D â€” Finalize (Temizlik + Belgeleme) 1. Kod Ä°nceleme Check-list o Eski V5 API yok (Documents.Add, Selection.Searchâ€¦). o TÃ¼m Set satÄ±rÄ±ndan sonra Null kontrolÃ¼. o GÃ¼ncel Option Explicit, sÃ¼rÃ¼m, Help sayfa nosu. o Hata bloÄŸu kapatÄ±lmÄ±ÅŸ (On Error GoTo 0). 2. Yorum & Docstring o Her 10â€“15 satÄ±rda bir satÄ±r iÃ§i aÃ§Ä±klama. 3. Versiyon Etiketi o '-- REV 1.1 â€“ 2025-07-13: Offset parametre eklendi 4. DaÄŸÄ±tÄ±m Notu o â€œMakro %CATStartupPath%\Macros\â€ konumuna kopyalanacak. 5. KullanÄ±m Klavuzu (3 satÄ±r) o â€œGSD aktifken Ã§alÄ±ÅŸtÄ±rÄ±n â†’ Part gÃ¼ncel â†’ Pencerede â€˜Doneâ€™ mesajÄ±.â€ 

--- PAGE 9 ---

 
ğŸ›  Åablon GeniÅŸletme KitaplÄ±ÄŸÄ± (Kopyala-YapÄ±ÅŸtÄ±r BloklarÄ±) Ä°htiyaÃ§ HazÄ±r Blok Parametre Oku Function GetRealParam(oPart, idName) Selection Filtrele Call sel.SelectElement3D(array, "YÃ¼z seÃ§", False) KÃ¼tle Liste Raporu DÃ¶ngÃ¼ + InertiaService.GetInertiaElement(occ) PLM Arama SearchService.Search("CATPart","Name LIKE 'PX%')" Log Yaz Sub LogWrite(msg) iÃ§inde FileSystem Taktik: Bu bloklarÄ± tek bir â€œMacroUtility.basâ€ dosyasÄ±nda tutup ExecuteGlobal ile iÃ§eri Ã§ekebilirsin; her yeni makro sadece iÅŸi anlatan 20â€“30 satÄ±rla kalÄ±r.  Faz 3 TamamlandÄ±ÄŸÄ±nda Elde Edilenler â€¢ Derlenebilir CATScript (standartlara %100 uygun) â€¢ Yorumlu, sÃ¼rÃ¼mlÃ¼, log desteÄŸi olan kod tabanÄ± â€¢ Performans test raporu (Debug sÃ¼re Ã§Ä±ktÄ±sÄ±) â€¢ KullanÄ±m notu Bu Ã§Ä±ktÄ±, Faz 4 (Hata Yakala) adÄ±mÄ±nda gerÃ§ek Ã§alÄ±ÅŸma koÅŸullarÄ±nda denenir; hata tabanlÄ± iyileÅŸtirmeler geri beslenir. Tekrar hatÄ±rlatalÄ±m: her makro Ã¶nce Design, sonra Draft, ardÄ±ndan Harden ve Finalize adÄ±mlarÄ±nÄ± tamamlamadan paylaÅŸÄ±lmaz.   
4âƒ£ HatalarÄ± Yakala & GÃ¼nlÃ¼ÄŸe Kaydet â€“ Kurumsal Seviyede Hata YÃ¶netimi 3DEXPERIENCE makrolarÄ±nda hatalar yalnÄ±zca diyalog kutusu gÃ¶stermekle kalmamalÄ±; kayÄ±t altÄ±na alÄ±nmalÄ±, kÃ¶k neden analizine zemin hazÄ±rlamalÄ± ve gerekirse otomatik â€œgeri alma (rollback)â€ yapmalÄ±dÄ±r. AÅŸaÄŸÄ±daki Ã§erÃ§eve, gÃ¼venliâ€izlenebilir kod iÃ§in izlenecek adÄ±m adÄ±m hat-yÃ¶netim stratejisini, kod bloklarÄ±yla birlikte sunar.  A. Hata SÄ±nÄ±flandÄ±rmasÄ± (Taxonomy) 

--- PAGE 10 ---

Seviye Kaynak Ã–rnek Etki Eylem 0 â€“ Derleme SÃ¶z dizimi Option Explicit eksik Makro aÃ§Ä±lmaz GeliÅŸtirici dÃ¼zeltir 1 â€“ Ortam Workbench/Lisans GSD yÃ¼klÃ¼ deÄŸil Makro atlanÄ±r KullanÄ±cÄ± uyar + log 2 â€“ Nesne Null/Count HybridBodies boÅŸ Makro gÃ¼venli Ã§Ä±kar Log + uyarÄ± 3 â€“ Ä°ÅŸ MantÄ±ÄŸÄ± Geometri, veri Offset mm < 0 Makro devam/geri al Log + hata mesajÄ± 4 â€“ AltyapÄ± Dosya, aÄŸ, PLM Reports dizini yok Makro geri al Log + Retry/Sapma 5 â€“ Kritik Ã‡Ä±ktÄ± tutarsÄ±z KÃ¼tle sapmasÄ± > %5 Rollback & engelle Log + Stakeholder mail  B. Hata Yakalama Deseni Option Explicit Sub Main()     Const LOGPATH = "C:\Logs\myMacro.log"     Dim logTS As TextStream     Set logTS = InitLog(LOGPATH)                'B-1          On Error GoTo ERR_HANDLER                   'B-2          '--- Ä°ÅŸ MantÄ±ÄŸÄ± -------------------------------------------------     Dim oEd As Object: Set oEd = CATIA.ActiveEditor     If oEd Is Nothing Then Err.Raise 9001,,"No active editor"      'B-3          Dim oPart As Object: Set oPart = oEd.ActiveObject     If oPart Is Nothing Then Err.Raise 9002,,"Active object nil"          Dim hb As Object: Set hb = oPart.GetItem("HybridBodies")     If hb Is Nothing Or hb.Count=0 Then         Err.Raise 9100,,"HybridBodies missing"     End If          'â€¦ (iÅŸlemler)          logTS.WriteLine TS & "SUCCESS"     CleanQuit logTS                                           'B-4     Exit Sub      ERR_HANDLER:     LogError logTS, Err.Number, Err.Description               'B-5     RollbackIfNeeded                                          'B-6     MsgBox "Makro durduruldu: " & Err.Description, vbCritical     CleanQuit logTS End Sub AÃ§Ä±klamalar â€¢ B-1 InitLog â†’ FileSystem.CreateFile + timestamp baÅŸlÄ±ÄŸÄ±. 

--- PAGE 11 ---

â€¢ B-2 yapÄ±sal On Error GoTo ERR_HANDLER; satÄ±r iÃ§i Resume Next kÄ±saâ€Ã¶mÃ¼rlÃ¼ lokal bloklarda (Ã–rn. Kill komutu). â€¢ B-3 Err.Raise ile Ã§ekirdek hata seti (9000â€“9999) tanÄ±mla; Help-ID ile karÄ±ÅŸmaz. â€¢ B-4 CleanQuit â†’ On Error Resume Next + logTS.Close + objeleri Nothing yap. â€¢ B-5 LogError â†’ logTS.WriteLine TS & vbTab & Err.Number & vbTab & Err.Description â€¢ B-6 RollbackIfNeeded â†’ Ã–nceki parametre deÄŸeri / PLM transaction ID saklandÄ±ysa geri al.  C. GÃ¼nlÃ¼k (Log) TasarÄ±mÄ± Alan Ã–neri Konum %TEMP% veya paylaÅŸÄ±lan \\Server\MacroLogs\ Format TSV â†’ Timestamp <TAB> ErrNo <TAB> Message <TAB> Context Boyut YÃ¶netimi 5 MBâ€™a ulaÅŸÄ±nca _old olarak yeniden adlandÄ±r + yeni dosya DÃ¼zey INFO, WARN, ERROR, CRIT tagâ€™leri YardÄ±mcÄ± Her makro baÅŸÄ±nda "--- START v1.3 ---" satÄ±rÄ± Function TS() TS = Format(Now,"yyyy-mm-dd hh:nn:ss"); End Function Sub LogError(ts, n, msg)     ts.WriteLine TS & vbTab & "ERROR" & vbTab & n & vbTab & msg End Sub  D. Rollback Desenleri Senaryo Strateji Parametre DeÄŸiÅŸti Eski deÄŸeri deÄŸiÅŸkene al â†’ hata durumunda geri yaz Yeni Geometri Eklendi oPart.Update Ã¶ncesi eklendi; hata olursa oPart.DeleteObjectOnError PLMObj Create PLMNewService.PLMCreate sonrasÄ± obj.State="Preview"; onaylanmazsa obj.Delete Dosya Ãœretimi Temp dosya uzantÄ±sÄ± .tmp; baÅŸarÄ±da .csv olarak yeniden adlandÄ±r  E. Performans & Ä°zlenebilirlik â€¢ Timer Ã¶lÃ§Ã¼mÃ¼: t0=Timer â€¦ logTS.WriteLine TS & vbTab & "INFO" & vbTab & "Elapsed=" & Timer-t0 â€¢ Debug.Print yalnÄ±z geliÅŸtirme; Ã¼retimde logâ€™a yÃ¶nlendir. â€¢ Event Viewer (Windows) entegrasyonu iÃ§in WScript.Shell + eventcreate.  

--- PAGE 12 ---

F. GeliÅŸmiÅŸ Senaryolar Hata YaklaÅŸÄ±m PLM Sunucu Timeout On Error Resume Next + Retry dÃ¶ngÃ¼sÃ¼ (Max 3, sleep 2 s) Lisansa EriÅŸilemedi DynLicenseSettingAtt.IsAuthorized("GSD") â†’ false ise uyar/log, makro pasif mod Ä°zin Reddedildi Read-only check â†’ â€œKaydedilemezâ€ kategorisine logla, makroyu bitir ama rollback gerekmez Ã–lÃ§Ã¼m SapmasÄ± Ã–lÃ§Ã¼m doÄŸrulama formÃ¼lÃ¼ Â± tolerans; hata logâ€™u â€œCRITâ€ dÃ¼zeyine Ã§Ä±kar  G. Standart Kontrol Listesi (â€œLog & Error Ready?â€) â€¢ On Error GoTo ERR_HANDLER aktif mi? â€¢ En az bir â€œInitLog/LogError/CleanQuitâ€ bloÄŸu var mÄ±? â€¢ Kendi Err.Raise numara aralÄ±ÄŸÄ± 9000â€“9999 arasÄ±nda mÄ±? â€¢ Tek Update; Update Ã¶ncesi eklenti listesi gÃ¼ncel mi? â€¢ Log dosyasÄ± var â†’ ilk satÄ±rÄ± START etiketi iÃ§eriyor mu? â€¢ Rollback fonksiyonu; en az bir â€œgeri dÃ¶ndÃ¼rmeâ€ yolu test edildi mi? Bu kontrol listesi tiklenmeden makro daÄŸÄ±tÄ±ma Ã§Ä±kmaz.  Ã–rnek Log SatÄ±rÄ± 2025-07-12 10:42:15 ERROR 9100 HybridBodies missing Part=Wing_Rib_A.CATPart Bu ayrÄ±ntÄ±lÄ± hata-yÃ¶netim & log sistemi sayesinde, makrolarÄ±nÄ±z sessizce baÅŸarÄ±sÄ±z olmak yerine izlenebilir, geri dÃ¶nÃ¼lebilir ve kurumsal kalite sÃ¼reÃ§lerine uygun hÃ¢le gelir.   
5âƒ£ Sonucu AÃ§Ä±kla & Sonraki AdÄ±mÄ± Belirle â€“ â€œTeslim & Devamâ€ ProtokolÃ¼ Bir makronun Ã§alÄ±ÅŸmasÄ± bitmiÅŸ sayÄ±lmaz; Ã§Ä±ktÄ±sÄ± anlaÅŸÄ±lÄ±r biÃ§imde sunulmalÄ±, eksik/hata payÄ± aÃ§Ä±kÃ§a raporlanmalÄ± ve izlenecek bir geliÅŸtirme yolu gÃ¶sterilmelidir. AÅŸaÄŸÄ±daki Ã§erÃ§eve, her otomasyon teslimatÄ±nda uygulanacak ayrÄ±ntÄ±lÄ± iletiÅŸim-ve-devam kÄ±lavuzudur. 

--- PAGE 13 ---

 A. 360Â° Teslim Paketi BÃ¶lÃ¼m Ä°Ã§erik AmaÃ§ 1. Ã–zet (â€œNe YaptÄ±k?â€) 2â€“3 cÃ¼mlede iÅŸin Ã¶zeti Ã–rn. â€œHybridBodies iÃ§indeki â€˜Geometrical Set.1â€™e (0,0,0) koordinatlÄ± nokta eklendi.â€ HÄ±zlÄ± kavrayÄ±ÅŸ 2. Ã‡Ä±ktÄ±lar â€¢ CATScript kod bloÄŸu â€¢ Ãœretilen dosya adÄ± / yol (varsa) â€¢ GÃ¼nlÃ¼k (log) konumu Tek bakÄ±ÅŸta teslim 3. BaÅŸarÄ± MetriÄŸi SÃ¼re, bellek, toplam kÃ¼tle gibi doÄŸrulama rakamlarÄ± Ã–rn. â€œMakro sÃ¼resi = 2.4 s; kÃ¼tle toplamÄ± = 12.032 kg (Â±0.2 g)â€ Kalite kanÄ±tÄ± 4. VarsayÄ±mlar Workbench, lisans, klasÃ¶r yetkisi, Geometrical Set adÄ± vb. SÃ¼rprizleri Ã¶nle 5. Hata Ã–zeti Toplam log satÄ±rÄ±, seviye-3â†‘ hata sayÄ±sÄ± Log yolu, ilk 1â€“2 kritik satÄ±r Ã¶rneÄŸi ÅeffaflÄ±k 6. KullanÄ±cÄ± AdÄ±mlarÄ± â€œMakroyu makro toolbarâ€™Ä±ndan Ã§alÄ±ÅŸtÄ±r â†’ â€˜Done!â€™ mesajÄ±nÄ± gÃ¶rÃ¼nce geometri gÃ¼ncellendi.â€ HÄ±zlÄ± kullanÄ±m 7. SÃ¼rÃ¼m & Kaynak Kod revizyon, Help sayfa no, tarih Ä°zlenebilirlik  B. Sunum FormatlarÄ± Senaryo Ã–nerilen Kanal Ä°Ã§erik Åablonu HÄ±zlÄ± destek (chat) Sade metin 1 Kurumsal inceleme Word/PDF raporu TÃ¼m 7 bÃ¶lÃ¼m + ekran gÃ¶rÃ¼ntÃ¼sÃ¼ + Appendix (tam log) AnlÄ±k demo Ekran paylaÅŸÄ±mÄ± / video 1â€“3 dakikalÄ±k kayÄ±t + konuÅŸmalÄ± aÃ§Ä±klama SÃ¼rekli entegrasyon Jenkins veya Git Hook Log & metrikleri build Ã§Ä±ktÄ±sÄ±na gÃ¶m Kural: KullanÄ±cÄ± â€œdosya istemiyorumâ€ dediÄŸinde yalnÄ±z metin sun; aksi hÃ¢lde python_user_visible ile dosya linki Ã¼ret.  C. Validasyon & Onay AdÄ±mlarÄ± 1. Otomatik Test Ã‡alÄ±ÅŸtÄ±r â€” Parametrik makrolarda, beklenen sonuÃ§ (Ã¶r. nokta sayÄ±sÄ±) assert edilir. 2. Log GÃ¶zden GeÃ§ir â€” Seviye-3â†‘ hata yoksa â€œPASSâ€ etiketi eklenir. 

--- PAGE 14 ---

3. KullanÄ±cÄ± OnayÄ± â€” â€œSonuÃ§ beklediÄŸiniz gibi mi?â€ sorusu; gerekirse hÄ±zlÄ± dÃ¼zeltme dÃ¶ngÃ¼sÃ¼.  D. â€œSonraki AdÄ±mâ€ Ã–neri Motoru Mevcut Ä°ÅŸ MantÄ±klÄ± Devam Ã–neri CÃ¼mlesi ParÃ§aya nokta eklendi Bunu parametreye baÄŸla â€œNoktayÄ± â€˜Ref_Xâ€™ parametresiyle sÃ¼rÃ¼kleyebilir hÃ¢le getirelim mi?â€ KÃ¼tle raporu CSV @Excel grafik â€œAynÄ± makroyla otomatik kÃ¼tle trend grafiÄŸi oluÅŸturalÄ±m.â€ Offset plane Dizisel offset â€œ5 mmâ€™lik ofseti 10 adÄ±mlÄ± dizi hÃ¢line getirmek ister misiniz?â€ PLM arama listesi Toplu gÃ¼ncelle â€œBulunan parÃ§alarÄ±n malzeme attributeâ€™unu toplu gÃ¼ncelleyelim mi?â€ Ã–neri FormatÄ± Sonraki olasÄ± adÄ±m â†’ <Tek satÄ±r baÅŸlÄ±k> â€¢ FaydasÄ±: â€¦ ï¸± Tahmini efor: <kÄ±sa>  E. Ä°letiÅŸim Tonu & Detay Seviyesi Hedef Kitle Terim YoÄŸunluÄŸu Ã–rnek TasarÄ±m MÃ¼hendisi Orta (HybridBody, Update) â€œHybridShapeFactory kullanÄ±larakâ€¦â€ YazÄ±lÄ±m UzmanÄ± YÃ¼ksek (late-binding, PLMEntity) â€œEditor-level service iÃ§indeâ€¦â€ YÃ¶netici DÃ¼ÅŸÃ¼k (iÅŸ faydasÄ±) â€œÄ°ÅŸ sÃ¼resi %80 kÄ±saldÄ±.â€ ChatGPT yanÄ±tÄ±, kullanÄ±cÄ±nÄ±n profiline gÃ¶re otomatik seviye ayarlar.  F. HÄ±zlÄ± Kontrol Listesi (â€œDelivery Ready?â€) â€¢ Ã–zet + kod + metrik + log yolu yazÄ±ldÄ±. â€¢ VarsayÄ±mlar ve kÄ±sÄ±tlar listelendi. â€¢ KullanÄ±cÄ± adÄ±m adÄ±m yÃ¶nerge aldÄ±. â€¢ En az bir â€œsonraki adÄ±mâ€ Ã¶nerisi sunuldu. â€¢ Ä°letiÅŸim tonu hedef kitleye uygun. Bu checklist tiklenmeden teslim yapÄ±lmaz. 

--- PAGE 15 ---

 
ğŸ“Œ Ã–rnek Teslim (Chat Metni) Ne YaptÄ±k? â€¢ â€˜Geometrical Set.1â€™e (0,0,0) nokta eklendi ve Part gÃ¼ncellendi. Kod Bloku â€˜â€” AddPoint v1.0 â€¦ (kod) Metrik SÃ¼re = 2.4 s Â· GÃ¼nlÃ¼k â†’ C:\Logs\AddPoint_2025-07-12.log VarsayÄ±m GSD yÃ¼klÃ¼, Geometrical Set.1 mevcut. Hata Ã–zeti 0 kritik, 1 uyarÄ± (lisans kontrolÃ¼). KullanÄ±m Makroyu GSDâ€™de Ã§alÄ±ÅŸtÄ±r â†’ â€œDone!â€ mesajÄ±. Sonraki AdÄ±m NoktayÄ± â€œRef_Xâ€ parametresiyle sÃ¼rÃ¼klenebilir yapalÄ±m mÄ±? â€¢ FaydasÄ±: geometrik esneklik   â€¢ Efor: ~10 satÄ±r  Bu ayrÄ±ntÄ±lÄ± â€œTeslim & Devamâ€ protokolÃ¼, makrolarÄ±nÄ±zÄ±n Ã§Ä±ktÄ±sÄ±nÄ± anlaÅŸÄ±lÄ±r, izlenebilir ve geliÅŸtirilebilir hÃ¢le getirir. ArtÄ±k faz 1-5 dÃ¶ngÃ¼sÃ¼nÃ¼ kapattÄ±k; ek geliÅŸtirme isteklerinizi aynÄ± Ã§erÃ§eveyle sÃ¼rdÃ¼rmeye hazÄ±rÄ±z.   
ğŸš¦ TAMAM / HAZIR KONTROL LÄ°STESÄ° Bu â€œson kontrol paneliâ€, 1 â†’ 5 fazlarÄ±nÄ±n tamamÄ±nÄ± kapsayan, makro daÄŸÄ±tÄ±mÄ±na ya da kurumsal incelemeye gitmeden Ã¶nce hiÃ§bir maddeyi atlamadan hÄ±zlÄ±ca tikleyebileceÄŸiniz ayrÄ±ntÄ±lÄ± listedir. Ä°ki dÃ¼zey iÃ§erir: â€¢ Ã‡ekirdekâ€Minimum â‡’ Kodun kÄ±rÄ±lmadan Ã§alÄ±ÅŸtÄ±ÄŸÄ±ndan emin olmak. â€¢ Kurumsalâ€GeniÅŸ â‡’ Log, sÃ¼rÃ¼m, geri alma, performans, dokÃ¼mantasyon dÃ¢hil.  1. Ã‡ekirdekâ€Minimum Kontrol (Mutlaka âœ“) 

--- PAGE 16 ---

# Madde âœ“ 1 Ä°htiyaÃ§ formu Katman Aâ€“E tÃ¼m sorulara yanÄ±tlÄ±  2 DoÄŸru workbench & API seÃ§imi kanÄ±tlandÄ± (matriste iÅŸaretli)  3 Option Explicit bulunuyor  4 On Error Resume Next + On Error GoTo 0 veya GoTo bloklu handler var  5 TÃ¼m Set â€¦ = â€¦GetItem sonrasÄ± Is Nothing / .Count kontrolÃ¼  6 Tek bir oPart.Update (dÃ¶ngÃ¼ iÃ§inde yok)  7 Eski V5 API yok (Documents.Add, HybridShapeFactoryOld, vb.)  8 Kod sorunsuz derleniyor & Ã§alÄ±ÅŸÄ±yor (manuel test)  9 KullanÄ±cÄ±ya en az bir aÃ§Ä±klama satÄ±rÄ± (MsgBox/echo)   2. Kurumsalâ€GeniÅŸ Kontrol (Ã–nerilen âœ“) Kategori Detay âœ“ Hata YÃ¶netimi Ã–zel Err.Raise numara aralÄ±ÄŸÄ± 9000â€“9999 kullanÄ±ldÄ±   Log dosyasÄ± konumu & rotasyonu belirlendi   Rollback mekanizmasÄ± (parametre/geometri/sunucu nesnesi) tanÄ±mlÄ±  Performans Makro sÃ¼re Ã¶lÃ§Ã¼mÃ¼ (Timer) â‰¥ rapora yazÄ±ldÄ±   10K+ occurrence montaj testinde time-out yok  GÃ¼venlik / Lisans Gerekli workbench varlÄ±ÄŸÄ± test edilip loglandÄ±   Read-only Part/Product tespiti ve Ã§Ä±kÄ±ÅŸ  Versiyonlama Kod baÅŸlÄ±ÄŸÄ±: SÃ¼rÃ¼m, tarih, Help sayfa no   DeÄŸiÅŸiklik gÃ¼nlÃ¼ÄŸÃ¼ ('-- REV 1.1 ...) gÃ¼ncel  DokÃ¼mantasyon 7-BÃ¶lÃ¼mlÃ¼ Teslim Paketi hazÄ±r (Ã–zet + Kod + Metrikâ€¦)   KullanÄ±m adÄ±mlarÄ± 3 satÄ±rda anlatÄ±ldÄ±  Sonraki AdÄ±m En az 1 Ã¶neri: fayda + tahmini efor belirtildi  PaydaÅŸ OnayÄ± Talep sahibi â€œÃ‡alÄ±ÅŸtÄ±â€ yanÄ±tÄ± verdi (UAT PASS)   
ğŸ“‹ Kontrol Listesini Kullanma Ã–nerisi 1. Bas â€“ KÃ¢ÄŸÄ±t/makro Ã¶n yÃ¼zÃ¼ne bu tablonun boÅŸ tik sÃ¼tunlu halini koy. 2. Test Bitince â€“ Her maddeye check koy; boÅŸ kalan satÄ±r = geri dÃ¶n. 3. ArÅŸivle â€“ PDF veya Wordâ€™e imzalÄ±/tarihli olarak ekle (denetim izi).
