--- PAGE 1 ---

The Scenario Representation Overview
The scenario representation contains a scenario manager. It is unique inside the represenation and it contains all the pre-processing features necessary to describe the simulation scenario.
The data model and navigation APIs from the scenario representation are shown below:
The Result Representation Overview
The results representation contains a result manager. It is unique inside the represenation and it contains all the simulation results and the post-processing featuresnecessary to describe the simulation results.
The data model and navigation APIs from the results representation is shown below:
References
Assembly Evaluation objects can be managed using the FittingService object. This object allows you to:
Scenario and Result RepresentationsTechnical Article
Abstract
This article's main goal is to help partners understand the data model of the Scenario and Result Represention PLM objects and identify the APIs necessary to navigatethem.
In order to better depict the relationships, the data model and navigation behavior is described through the following two sub-sections:
lThe Scenario Manager
lThe Results Manager
For further details on how to retrieve the scenario and result representation from a Simulation please refer to the use case "Navigation on a Simulation".[1]
Fig1: Scenario Representation to the Scenario Features
Fig2: Results Represenation to the Results Features
[1]Navigation on a Simulation
Assembly Evaluation Object Model MapSee AlsoLegend
Page 1 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 2 ---

lCreate or retrieve a FitTrack object.
lManage FitTrackTPoint objects. 
Use theGetService method of the Service object to return the FittingService object:
Dim oFittingService As FittingServiceSet oFittingService = CATIA.ActiveEditor.GetService("FittingService")
Use the Item method of theFittingService object to return an existingFitTrack object:
Dim objFitTrack As FitTrackSet objFitTrack = oFittingService.Item(objContext, 1)
Creating a Fitting Track in MSR
This use case primarily focuses on the methodology to create a Fitting Track in MSR Context.
Before you begin: Note that:
lYou should first launch DELMIA and import theCAAScdFitMSR.3dxml files supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFit\samples\whereInstallRootFolder is the folder where the CAA CD-ROM is installed. 
Where to find the macro: CAAScdFitUcTrackMsrSource.htm
Related Topics
This use case can be divided in seven steps:
1.Retrieves the current Editor2.Retrieves the Fitting Service from the Editor3.Creates a new Fit Track4.Applies properties to Track5.Retrieve the FitTrackTPoints object6.Creates new TPoints7.Refreshes the Track
1.Retrieves the current Editor
... Dim oEditor As EditorSet oEditor = DELMIA.ActiveEditor...
2.Retrieves the Fitting Service from the Editor
Then, retrieve the FittingService from Editor.
 ...Dim oFittingService As FittingServiceSet oFittingService = oEditor.GetService("FittingService") ...
3.Creates a new Fit Track
Then, Add a new Track.
Provide 'Nothing' as context in MSR context.
Provide 'DNBFitTrack' as type of Track.
... Dim oContext As AnyObjectSet oContext = NothingDim sTrackType As CATBSTRsTrackType = "DNBFitTrack"Dim oFitTrack As FitTrackSet oFitTrack = oFittingService.Add(oContext, sTrackType)...
4.Applies properties to Track
Apply the below properties to the newly creted Track:
Set Track Mode.
... Dim eTrackMode As DNBTrackMode eTrackMode = FitTIME oFitTrack.Mode = eTrackMode...
Set Track Interpolation Type.
... Dim eTrackInter As DNBInterpolater eTrackInter = FitSPLINE oFitTrack.Interpolater = eTrackInter...
Set Track Total default Duration. 
... Dim dTotalTime As double dTotalTime = 5.0
Page 2 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 3 ---

 oFitTrack.TotalTime = dTotalTime...
Set the Anchor Position to the Track. This is a set of twelve doubles.
Here we are setting the Anchor Position at the origin of the world.
... Dim aAnchorPos(11) As double aAnchorPos(0) = 1 aAnchorPos(1) = 0 aAnchorPos(2) = 0 aAnchorPos(3) = 0 aAnchorPos(4) = 1 aAnchorPos(5) = 0 aAnchorPos(6) = 0 aAnchorPos(7) = 0 aAnchorPos(8) = 1 aAnchorPos(9) = 0 aAnchorPos(10) = 0 aAnchorPos(11) = 0 oFitTrack.SetAnchorPosition aAnchorPos...
5.Retrieve the FitTrackTPoints object
Retrieve FitTrackTPoints object which is a collection of TPoints.
... Dim cFitTPoints As FitTrackTPointsSet cFitTPoints = oFitTrack.TPoints...
6.Creates new TPoints
Then, create TPoints with its positions. Here we will create three TPoints.
Note that the TPoints are relative to the Anchor Position.
First define the position of the First TPoint. Here, it is at the origin of the world.
... ReDim aTPointPos(11) As double aTPointPos(0) = 1 aTPointPos(1) = 0 aTPointPos(2) = 0 aTPointPos(3) = 0 aTPointPos(4) = 1 aTPointPos(5) = 0 aTPointPos(6) = 0 aTPointPos(7) = 0 aTPointPos(8) = 1 aTPointPos(9) = 0 aTPointPos(10) = 0 aTPointPos(11) = 0...
Define the position of the Compass Offset from the TPoint. Here, there is no offset.
... Dim TPointCompPos(11) As double TPointCompPos(0) = 1 TPointCompPos(1) = 0 TPointCompPos(2) = 0 TPointCompPos(3) = 0 TPointCompPos(4) = 1 TPointCompPos(5) = 0 TPointCompPos(6) = 0 TPointCompPos(7) = 0 TPointCompPos(8) = 1 TPointCompPos(9) = 0 TPointCompPos(10) = 0 TPointCompPos(11) = 0...
Innsert the first TPoint with 'zero' duration.
...  cFitTPoints.InsertTPoint 1, aTPointPos, TPointCompPos, 0...
Define the position of the second TPoint.
...  aTPointPos(9) = 100 aTPointPos(10) = 0 aTPointPos(11) = 0...
Innsert the second TPoint with duration 2.5.
...  cFitTPoints.InsertTPoint 2, aTPointPos, TPointCompPos, 2.5...
Define the position of the third TPoint.
...  aTPointPos(9) = 100 aTPointPos(10) =100
Page 3 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 4 ---

This article provides the basis for understanding how to customize the RoboticsOffline Programming (OLP) translation.
OLP translation is the process of converting a DELMIA robot task into a native robot program for a specific robot programming language or visa-versa. This translation software is written using VB.NET VSTA macro libraries. You have access to the VB.NET source code for the language translation process which means that you can customize any aspect of the translation or even write a translator for which a DELMIA translator is not available.
For example, you may wish to modify how a robot program is created from a DELMIA task (download) in order to:
lAdd comments to the top of a program. 
lAdd a special instruction before every spot operation. 
lModify how a specific instruction is translated. For example, you could generate the text for your own custom robot instruction for every robot motion instead of the standard motion syntax. 
lValidate that the robot program conforms to your template and programming guidelines.
When importing a robot program into DELMIA (upload) you may wish to:
lCreate DELMIA instructions for non-standard robot instructions.
lModify attributes of DELMIA instructions when they are created.
Before you Start
This documentation assumes that you are already familiar with the OLP Upload and Download commands. You can find information about those commands in the user documentation under "Content and Simulation Apps | Robotics | Robot Programming | Creating and Importing Robot Programs".
We also assume that you are familiar with VB, and specifically VB.NET and object oriented programming.
Getting Started
To get started with customizing an OLP translator, we recommend following these steps.
1.Read this document, the OLP Overview. It includes background information on the translation process and the technologies and objects used during translation. 2.Follow the use case forCustomizing a Translator. This use case provides an overview of the steps involved in customizing a translator.3.Follow the use case for Translating an Instruction. This provides the detail from step 4 in Customizing a Translator. It walks you through the code which translates an instruction. 4.Follow the use case for Integrating Your Customizations. This provides the detail from step 5 in Customizing a Translator. It walks you through the steps for calling the code written in Translating an Instruction. 
Translation Architecture
The OLP Translators are VSTA macro libraries written in VB.NET. The macros are executed during the Download and Upload translation processes. In V6 all macro libraries, including the OLP translators, are stored in the ENOVIA database. This means you have access to the translation source code to view and modify as needed. Also because it is in the database, your modifications will be available to your entire enterprise. 
The translation is a multi-step process. 
 aTPointPos(11) = 0...
Innsert the third TPoint with duration 2.5.
...  cFitTPoints.InsertTPoint 3, aTPointPos, TPointCompPos, 2.5...
7.Refreshes the Track
Refresh/update the Track with all the above set properties and TPoints.
THIS IS A MANDATORY STEP. THE REFRESH MUST BE CALLED AT THE END OTHERWISE THE MODIFICATIONS WILL NOT BE REFLECTED ON THE TRACK.
...  oFitTrack.Refresh...
Robotics Programming Overview
Download: The process of generating a robot program text file from one or more DELMIA robot tasks.Upload:The process of creating a DELMIA robot task from a robot program text file.
Download Upload1.Pre-process the DELMIA task(s) and robot controller to initialize the OLP automation objects. 2.Run the Download macro to generate the Abstract Syntax Tree (AST) 3.Dump the AST into the text file. 
1.Pre-process the DEMIA robot controller to initialize the OLP automation objects. 2.Run the Upload macro. This macro has 2jobs1.Call the OlpParser object to parse the file. It returns the Abstract Syntax Tree (AST). 2.Convert the AST into DELMIA task(s)3.Post-process the created tasks.Fig.1: Translation Process
Page 4 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 5 ---

The translator macro library converts between 2 data structures, the Abstract Syntax Tree (AST) and the DELMIA objects. The AST is a parsed version of the robot program text file. Access to the DELMIA objects is provided through the OLP Automation objects. 
The parsers are written in C++. You do not need to modify them unless you are creating a translator to upload a language for which no DELMIA translator exists. If youneed to create a new parser, you could write the parser in VB.NET to create the AST. The parsers have been written to accept any valid syntax for the robot language. In a procedure-oriented language like ABB RAPID, the AST structure for a call will be created for any unknown instructions. In other languages that do not have a well defined generic instruction grammar, like FANUC TP, the text of any instruction which cannot be parsed, like a macro call, will be stored in the AST as a generic statement.
Abstract Syntax Tree (AST) Data Structure
The AST is organized into a tree format. You can programmatically access each portion of an instruction based on its meaning. By traversing the tree, starting at the 1st leaf node and proceeding to the last node, the text of the robot program can be constructed. Below is an example of how a FANUC TP run instruction is represented in AST.
The AST is composed of 2 types of nodes. Branches, represented by OlpAstBranch, are nodes with children. Leaves, represented by OlpAstLeaf, contain the individual tokens from the robot program. Each node has 3 pieces of data associated with it.
lType - This identifies the category of data stored in the node. For example Header, Instruction, Keyword, Comment, Operator, etc. 
lID - This identifies the purpose of the node. For example Speed, LineNumber, etc. 
lValue OR Children
¡Value - Leaf nodes have a value stored on them which is the text from the robot program. 
¡Children - Branch nodes have a list of sub-nodes. 
The ID and Type can be used to easily locate a particular piece of data in an AST instruction.
Translator Macros
There are several macros in an OLP translator VB.NET macro library. These macros are called during different times of the translation process. Some macros are optional and are ignored if missing.
Fig.2: AST Example
Macro Name DescriptionMacroDownloadCalled after the download pre-process step to translate the DELMIA objects into the AST. MacroUploadCalled after the upload pre-process step. It parses the programs using OlpParser and then translates the AST into DELMIA objects.MacroGetTranslatorInfo(Optional) Called before a download or upload to get basic translator information. This includes the file extensions used for this robot programming language. This may also be used to identify features supported by a particular translator.MacroSetConfigs(Optional) Called during the upload post-process step. Some languages require inverse-kinematics calculations in order to compute the robot posture and turn numbers or turn signs. The post process step includes positioning tags in the DELMIA simulation which is required before 
Page 5 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 6 ---

OLP Automation Objects
During translation, access to the DELMIA task, instructions, and robot controller is provided through the OLP Automation objects. OlpTranslatorHelper is the main object which gives you access to all the objects required for translation. See the Robotics Programming Object Model Map and theOLP Automation Object Referencefor more details.
Additional Information
For details on translating the expressions used in DELMIA instructions, please seeOLP Expression Translation.
inverse-kinematics can be performed. After the tags have been correctly located, MacroSetConfigs is called, if it exists, to allow the translator to compute the robot posture and turn information.
Warning: The OLP automation objects can only be used by a macro which is called from the OLP Download or Upload commands. These objects do not exist outside the scope of an OLP translation.Warning: Use of automation objects other than the OLP automation objects could cause problems during upload or download. In general, you should not use any automation object for which there is an equivalent OLP object. For example, you should not use any other objects which manipulate tasks, instructions, variables, robotprofiles, or robot controllers. There are a few exceptions to these rules. The following APIs are approved for use in an OLP translator:
lRscApplicativeProfilesMgr 
lRscApplicativeProfilesGroup
lRscApplicativeProfile 
lRscMotionProfile 
lRscAccuracyProfile
lArcWeldProfile 
lArcWeldProfileSection 
lArcWeldCSPProfiles
Robotics Programming Object Model MapSee AlsoLegend
Page 6 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 7 ---

Page 7 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 8 ---

The OlpTranslationHelper object is the root object for Robotics Programming (Olp) applications. It is a service object retrieved from the Application object thanks to theGetSessionService method, as follows:
Dim oOlpTranslationHelper As OlpTranslationHelper Set oOlpTranslationHelper = CATIA.GetSessionService("OlpTranslationHelper")
Using the OlpTranslationHelper Object
Use theBehavior property to return the OlpBehavior object that itself aggregates the global variables and procedures as  an OlpVariables and an OlpProcedures collection objects respectively.
Dim oOlpBehavior As OlpBehavior Set oOlpBehavior = oOlpTranslationHelper.Behavior
Use the MotionGroups property to return theOlpMotionGroups collection object that contains the motion groups selected for download or upload.
Dim oOlpBehavior As OlpBehavior Set oOlpBehavior = oOlpTranslationHelper.Behavior
Use the AstRoot property to return theOlpAstBranch collection object that represents the root node of the abstract syntax tree.
Dim oOlpRoot As OlpAstBranchSet oOlpRoot = oOlpTranslationHelper.AstRoot
Use the ErrorReporter property to return theOlpErrorReporter object that report errors, warnings; and so on.
Dim oOlpErrorReporter As OlpErrorReporterSet oOlpErrorReporter = oOlpTranslationHelper.ErrorReporter
Use the CreateExprFixerDownload method to create a new expression for download as a OlpExpressionFixerDownload object.
Dim oOlpExpressionFixerDownload As OlpExpressionFixerDownloadSet oOlpExpressionFixerDownload = oOlpTranslationHelper.CreateExprFixerDownload
Use the CreateExprFixerUpload method to create a new expression for upload as a OlpExpressionFixerUpload object.
Dim oOlpExpressionFixerUpload As OlpExpressionFixerUploadSet oOlpExpressionFixerUpload = oOlpTranslationHelper.CreateExprFixerUpload
Use the CreateIDFixer method to create a new id fixer as anOlpIDFixer object.
Dim oOlpIDFixer As OlpIDFixer Set oOlpIDFixer = oOlpTranslationHelper.CreateIDFixer
Use the CreateParser method to create a new robot program parser as an OlpParser object.
Dim oOlpParser As OlpParserSet oOlpParser = oOlpTranslationHelper.CreateParser
This article provides details on translating expressions and the expression AST format used by the OLP Automation objects.
Many of the OLP Instructions have an expression as a property. An Abstract Syntax Tree (AST) is used to describe the expression. An AST is simply a parsed copy of the code so the AST format for one language is different from other languages. The OLP Expression AST format is used for DELMIA expressions. Please see the "DELMIA | Automation | Module & Block for Library | Reference Information | Predefined Types and Functions" in the user documentation for a description of the operators and function which are valid in a DELMIA expression.
The following instructions are examples of the ones that use expressions:
lOlpAssign
lOlpFor
Note: there is no actual inheritance between OlpAstBranch,OlpAstLeaf, and OlpAstNode. This is because OlpAstBranch is a collection andOlpAstLeaf is an object. However, all objects which are an OlpAstLeaf are also a OlpAstNode and all objects which are an OlpAstBranch are also anOlpAstNode. 
OlpTranslationHelper ObjectSee AlsoLegendUse CasesPropertiesMethods
OLP Expression Translation
Page 8 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 9 ---

lOlpIf
lOlpLoop
lOlpRun
lOlpWait
The translator needs to convert between the robot language expression and the DELMIA expression. In the translator both are represented in an AST format, so the translator needs to just make modifications to the AST structure to do the translation. There are 2 classes which help with this translation: OlpExpressionFixerDownloadand OlpExpressionFixerUpload. Please see the reference documentation for how to use those classes.
In general, the translator is responsible for the entire conversion from the Robot Language expression syntax to the DELMIA expression syntax. Using the expression fixer makes some of these transformations easier and validates that the expression conforms to the target language's limitations. There are a few cases where the OLP IDL interfaces directly manipulate and transform the expression such as for data type conversion and unit conversions.
Data Type Conversion: All the OLP instruction properties and methods where an expression can be set or retrieved, automatically add any data type conversion functions (e.g. NumberToBoolean, DoubleToInteger) that are necessary to prevent logic errors. Those data type conversion functions are removed automatically in the expression retrieved by the translator. For string concatenation, DELMIA uses the "++" operator. The "++" operator for string concatenation is always converted to "+" when the translator retrieves an expression.
Unit Conversions: Likewise, all the OLP instruction properties and methods automatically add or remove unit conversion functions if the robot language units differ from the DELMIA units. DELMIA always uses meters and radians for the units. The translator can specify the units used by the robot language by setting the propertiesPositionVariableRobotLanguageLengthUnits, PositionVariableRobotLanguageRotationUnits, and TrigFunctionRobotLanguageRotationUnits on OlpTranslatorHelper.
Expression AST Format
The OlpExpressionFixer objects assume require that the AST conforms to a standard expression structure. The OLP Automation objects which use expressions alsoexpect the expressions to be in this format when it is assigned. Expressions retrieved from the OLP Automation objects are also in this AST format.
The top level node of an expression of type Expression. An expression can contain any of the following nodes. Any of the following nodes can be used interchangeably in an expression. For example, anywhere that aConstInteger is allowed you could have an Identifier or even aBinaryExp. Formatting nodes can be contained anywhere in the expression and are completely ignored when translating an expression but the formatting is preserved.
Here is a sample AST for the simple expression A+B
    <Expression>        <BinaryExp>            <Identifierid="Operand1">A</Identifier>            <Operator>+</Operator>            <Identifierid="Operand2">B</Identifier>        </BinaryExp>            </Expression>
Leaf Expression Parts
These can be used in the place of any expression. For example A+B and A+1 are both valid. Technically A+true is a valid AST format but the resulting expression would be in error.
Integer
Any integer in a format allowed by DELMIA: 1, 0x1A, 0b1001, etc.
<ConstInteger>100</ConstInteger>
Double
Any double in a format allowed by DELMIA: 1.0, 3.14, 1e10, etc.
<ConstDouble>-2.3E5</ConstDouble>
Boolean
A Boolean value: "true" or "false".
<ConstBoolean>true</ConstBoolean>
String
A string, including the double quotes.
<String>"hello"</String>
Identifier
Leaf NodesConstIntegeran integer numberConstDoublea floating point numberConstBooleana BooleanString a stringIdentifiera variable nameBranch Nodes
BinaryExpAn expression involving 1 operator with 2 operands
UnaryExpAn expression involving 1 operator with just 1 operandGroupExpA grouping expression (parentheses).VariableA compound variableFunctionA function callConditionalExpA conditional (if) expression.
Page 9 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 10 ---

A variable name.
<Identifier>A</Identifier>
Branch Expression Parts
Each of these is an expression. An expression is composed of other expressions. Between any 2 nodes there can be a "Format" node.
Binary Expression
An expression involving 1 operator with 2 operands in the format "expression operator expression". Expressions are grouped in execution priority order. For example A+B+C would be grouped as ((A+B)+C). The expressions must have the "operand1" and "operand2" IDs set in order to easily identify the operands. 
A+B+C is expressed as:
<BinaryExp>    <BinaryExp id="Operand1">        <Identifierid="Operand1">A</Identifier>        <Operator>+</Operator>        <Identifierid="Operand2">B</Identifier>    </BinaryExp>    <Operator>+</Operator>    <Identifierid="Operand2">C</Identifier>  </BinaryExp>
Unary Expression
An expression involving 1 operator with just 1 operand in the format "operator expression". For example "-X". The expression must have the ID set to "Operand".
-X is expressed as: 
    <UnaryExp>        <Operator>-</Operator>        <Identifierid="Operand">X</Identifier>    </UnaryExp>
Group Expression
A grouping expression in the format " ( Expression ) ". The expression must have the ID "Expression" set.
(X+1) is expressed as:
    <GroupExp>        <Operator>(</Operator>        <BinaryExpid="Expression">            <Identifier>X</Identifier>            <Operator>+</Operator>            <ConstInteger>1</ConstInteger>        </BinaryExp>        <Operator>)</Operator>    </GroupExp>
Variable Expression
A variable expression can be more complicated than a single identifier in the case of subscripted variables (e.g. x[1]) or data member access (e.g. P.x).
x[1] is expressed as follow.  If FixSubscriptedVariables=True (the default) then this variable node (e.g. "x[1]") is treated as a unique variable including the subscripts in the Variables list of the expression fixer.  If FixSubscriptedVariables=False then the array variable identifier (e.g. "x") is added to the Variables list.
    <Variable>      <Identifier>x</Identifier>      <Operator>[</Operator>      <Arguments>         <ConstInteger id="Argument">1</ConstInteger>      </Arguments>      <Operator>]</Operator>   </Variable>
P.x is expressed as follows where each side of the "." operator must be tagged with the ID "Operand1" or "Operand2".  Operand1 could be a subscripted variable in the structure as described above.  Operand2 could be a identifier in the case of simple data member access, a function (e.g. inv()), or another variable node (e.g. j[2]) 
    <Variable>      <Identifier id="Operand1">varL1</Identifier>      <Operator>.</Operator>      <Identifier id="Operand2">x</Identifier>   </Variable>
Function
A function call in the format " function ( expression , expression ) ". There can be 0 or more expressions in the argument list. Each argument has the id set to"Argument" because it can be of any expression type. The function branch must contain an "Identifier" for the function name and an Arguments branch. The arguments branch can be empty. The parentheses around the arguments are specified as operator leaf nodes.
max(theta,x) is expressed as:
    <Function>        <Identifier>max</Identifier>        <Operator>(</Operator>        <Arguments>            <Identifierid="Argument">theta</Identifier>            <Operator>,</Operator>            <Identifierid="Argument">x</Identifier>        </Arguments>        <Operator>)</Operator>    </Function>
Page 10 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 11 ---

Conditional Expression
A conditional expression in the format "if expression then expression else expression". The else is required. The Condition, ThenExp, and ElseExp IDs must be set.
if x=2 then 100 else 200 is expressed as:
    <ConditionalExp>        <Keyword>if</Keyword>        <BinaryExpid="Condition">            <Format> </Format>            <Identifier>x</Identifier>            <Operator>=</Operator>            <ConstInteger>2</ConstInteger>        </BinaryExp>        <Format> </Format>        <Keyword>then</Keyword>        <Format> </Format>        <ConstIntegerid="ThenExp">100</ConstInteger>        <Format> </Format>        <Keyword>else</Keyword>        <Format> </Format>        <ConstIntegerid="ElseExp">200</ConstInteger>    </ConditionalExp>
Complicated Example
Below is a more complex example of nested expressions. The expression below is (X+mod(X,Y))/Y.
<Expression>    <BinaryExp>        <GroupExpid="Operand1">            <Operator>(</Operator>            <BinaryExpid="Expression">                <Identifier>X</Identifier>                <Operator>+</Operator>                <Function>                    <Identifier>mod</Identifier>                    <Operator>(</Operator>                    <Arguments>                        <Identifier>X</Identifier>                        <Operator>,</Operator>                        <Identifier>Y</Identifier>                    </Arguments>                    <Operator>)</Operator>                </Function>            </BinaryExp>            <Operator>)</Operator>        </GroupExp>        <Operator>/</Operator>        <Identifier>Y</Identifier>    </BinaryExp></Expression>
Error Cases
An expression can be empty, which will result in an error during simulation or it can contain only formatting, which is also an error. If there is a problem parsing a DELMIA instruction on download the invalid expression text is stored as formatting when the expression is retrieved from the instruction. The following are examples of error cases which could be produced.
    <Expression></Expression>
    <Expression>          <Format>Invalid Expression+</Format>      </Expression>
Customizing a Translator
This example illustrates how to modify a translator to convert a non-standard robot language instruction into a DELMIA instruction and back again. 
Before you begin:
lYou should have read Robotics Programming Overview. 
lYou can import a working version of the customized translator from the fileMyFanucTranslatorR2016x.3dxml supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdOlpOfflineProg\samples\whereInstallRootFolder is the folder where the CAA CD-ROM is installed. That folder also has the sample FANUC robot program MAIN.txt. This example steps through how to customize the FANUC translator. To illustrate the example, we have invented a custom FANUC instruction "IO_SYNC".
CALL IO_SYNC('0000000100000000') ;
IO_SYNC is a procedure to do IO handshaking. It sets a group output signal and waits for a group input signal. The group output is set to the string argument. The string is interpreted as a binary number. After setting the output, it waits for the input value to be equal to the output value.
We are assuming that IO_SYNC is not a normal FANUC task. For example, it could be a KAREL program. This is a language that is sometimes used to write custom procedures for the FANUC controller. Each robot manufacturer offers a different way to customize their language. The basic philosophy for how to customize a DELMIA translator is the same for all languages.
The FANUC translator without modification creates IO_SYNC as an empty procedure. It creates one input argument to that procedure. Then it creates a run instruction to call that procedure and pass in the input value. The result is that nothing happens for this instruction during simulation because the IO_SYNC task has no instructions. The goal of this customization is to have IO handshaking executed during simulation.
Related TopicsRobotics ProgrammingOverviewTranslating anInstructionIntegrating YourCustomizations
Page 11 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 12 ---

To customize a translator follow these steps:
1.Determine the DELMIA instruction structure2.Determine the AST structure3.Make a copy of the translator4.Write the class to translate the instruction5.Modify the translator to use your class6.Update options to use your translator
1.Determine the desired DELMIA instruction structure for CALL IO_SYNC
Lets assume you want IO_SYNC to do the same IO handshaking during simulation as it does on the FANUC controller. We will create a task in DELMIA and then when a CALL IO_SYNC instruction is encountered, we will create an instruction to run the task and pass the input argument.
¡IO_SYNC is a Task
¡IO_SYNC has 1 integer input (io_value) 
¡The 1st instruction sets the group output (GO1) value 
¡The 2nd instruction waits for the group input (GI1) value to be the same. 
The instruction to run the task will look like this:
¡The input is changed from a string to an integer in binary notation. 
There are many possible equivalent solutions in DELMIA. This is just one possible example.
2.Determine the AST structure for CALL IO_SYNC
The AST structure is determined by the parser. Since the parser cannot be customized, you just need to identify the AST structure that the parser creates for theCALL IO_SYNC instruction. During the upload and download commands, there is an option to export the AST as an XML document. With this option you can observe the AST structure simply by uploading a FANUC TP program that calls IO_SYNC. 
NOTE: During translation, AST is not an XML document but it can be exported to an XML document.
1.Set the environment variable DNB_OLP_AST_FILE to a file path. The AST will be exported to that XML file.
set DNB_OLP_AST_FILE=C:\tmp\ast.xml
2.Rename MAIN.txt to MAIN.LS, and run the upload command using the DELMIA Fanuc Translator to upload the file MAIN.LS. MAIN.txt can be found in the samples folder listed above.
3.Open the document C:\tmp\ast.xml. Within it, you will find the following XML notation for the CALL IO_SYNC instruction.
<Run> <Statement id="LineNumber"><ConstInteger>1</ConstInteger><Operator>:</Operator><Statement><Format> </Format><Statement id="Call"><Keyword>CALL</Keyword><Format> </Format><Identifier>IO_SYNC</Identifier><Statement id="Arguments"><Operator>(</Operator><Statement id="Argument"><String>'0000000100000000'</String></Statement><Operator>)</Operator></Statement></Statement><Format> </Format>
Fig.1: IO_SYNC Task
Fig.2: Running IO_SYNC
Page 12 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 13 ---

<Operator>;</Operator><NewLine/></Run>
3.Create a copy of the translator
We recommend creating your own copy of the macro library for your customizations. This way it is clear whether you are using the DELMIA standard translator or your custom version. Also, as soon as you save a change to a macro library, it is updated in the database so other users in your enterprise will get yourchanges.
1.Search for the translator in the database. You can use the search string "VSTA: *" to find all VSTA macro libraries.
2.Use the PLM Access->Duplicate command to create a copy of "DELMIA Fanuc Translator R2016x" and rename it "My Fanuc Translator R2016x".
3.Open your copy of the macro library for editing using the Tools->Macros dialog.
4.Write the class to convert between DELMIA Instruction(s) and AST
We recommend putting all your modifications into new classes. This way it is clear what code has been customized and what is part of the DELMIA standardtranslator. This will also make it simple to move your customization to a new version of the DELMIA translator.
The translators have been written with Object Oriented design. With this approach, your class can inherit from an existing class in the DELMIA translator. You will only need to write code for your specific customization. This will make your development faster because you can make use of existing class methods to do much of the work. This will also mean that if the standard translator is improved, your customized class can also benefit.
In this case we will create a new class MyIO_SYNC which inherits from FanucCallInstruction.
For details on the code used to translate the IO_SYNC instruction, please see Translating an Instruction.
5.Modify the translator to use your class
All translators have a class which identifies the instruction and determines which class to use to translate it. In FANUC translator this class is FanucInstructionList. By creating your own class, MyInstructionList, which inherits from FanucInstructionList, you can identify when an IO_SYNC instruction is being translated and create an object to translate it. 
You also need to modify the TranslatorFactory class to return MyInstructionList instead of FanucInstructionList. This is the onlyoriginal translator file that you will ever need to modify.
For details on modifying the translator to use your class, please see Integrating Your Customizations.
6.Update Options to use your translator.
Each robot controller type is associated with a translator macro library. You can update this association to use your customized macro library "My Fanuc Translator R2016x". 
Depending on the robot manufacturer, there may be more than one controller type listed. In most cases, you will want to update the translator for all the controller types associated with your robot manufacturer. In the case of FANUC there are four entries to update.
Fig.3: OLP Tools->Options dialog.
Page 13 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 14 ---

Translating an Instruction
This example illustrates how to convert a non-standard robot language instruction into DELMIA instructions and back again. 
Before you begin:
lYou should have read Robotics Programming Overview and Customizing a Translator. 
lYou can import a working version of the customized translator from the fileMyFanucTranslatorR2016x.3dxml supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdOlpOfflineProg\samples\whereInstallRootFolder is the folder where the CAA CD-ROM is installed. 
Where to find the macro: MyIO_SYNCSource.htmThis example steps through how to translate a non-standard FANUC instruction. To illustrate the example, we have invented a custom FANUC instruction "IO_SYNC". The details of the IO_SYNC instruction are explained in Customizing a Translator.
CALL IO_SYNC('0000000100000000') ;
We recommend putting all your modifications into new classes. This way it is clear what code has been customized and what is part of the DELMIA standard translator. This will also make it simple to move your customization to a new version of the DELMIA translator.
The translators have been written with Object Oriented design. With this approach, your class can inherit from an existing class in the DELMIA translator. You will only need to write code for your specific customization. This will make your development faster because you can make use of existing class methods to do much of the work. This will also mean that if the standard translator is improved, your customized class can alsobenefit.
Related TopicsRobotics ProgrammingOverviewCustomizing aTranslatorIntegrating YourCustomizations
The modifications required to translate the IO_SYNC instruction are:
1.Determine the Base Class2.Create the constructor3.Identify properties and methods to override4.Create the IO_SYNC task5.Overriding UploadProcedure6.Overriding UploadArguments7.Overriding AppendArguments
1.Determine the Base Class
The first step in object oriented design is to plan the relationships between your classes. In this case we want to create one class to translate FANUC CALL instruction into a DELMIA runthe called task is IO_SYNC. Our class has the following behavior:
¡on upload creates an IO_SYNC procedure if it does not already exist 
¡on upload create a run IO_SYNC instruction from a CALL IO_SYNC instruction 
¡on upload convert the argument from a string to an integer in binary format
¡on download create a CALL IO_SYNC instruction from a run IO_SYNC instruction 
Page 14 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 15 ---

¡on download convert the argument from an integer in binary format into a string 
Our class takes as input an existing FANUC CALL IO_SYNC instruction (on upload) or DELMIA run IO_SYNC instruction (on download). It does not need to identify the typeinstruction type and calling this class when needed is addressed in the use case Integrating Your Customizations.
The behavior of our class is a specialized version of the FanucCallInstruction class which is used to translate a normal CALL instruction into a run instruction. So we will use
<CLSCompliant(False)> PublicClass MyIO_SYNCInherits FanucCallInstruction
2.Create the constructor
Since our class inherits from FanucCallInstruction, we must have a constructor with a similar signature. In this case we simply take the same inputs and pass them to the base class, FanucCallInstruction, constructor.
PublicSub New(ByRef iTask As FanucTask, _ByVal iV6Instruction As OlpInstruction, _ByRef iAstInstruction As OlpAstBranch)        MyBase.New(iTask, iV6Instruction, iAstInstruction)    End Sub
3.Identify the properties and methods to override
By identifying the differences between the normal CALL translation and the CALL IO_SYNC translation we can identify what behavior we need to override.
All other behavior is already included in the FanucCallInstruction translator, such as creating the run instruction on upload and creating the CALL instruction AST on download.
4.Creating the IO_SYNC task
First we will write the function to create the task. This function will be called if the task does not already exist. You may recall from Customizing a Translator that the
We will write a function to create this task. First we create the task and give it a name.
ProtectedOverridableFunction CreateIOSYNC() As OlpProcedure        Dim IO_SYNC As OlpProcedure = Main.TransHelper.Behavior.Procedures.CreateRobotTask()        IO_SYNC.Name = "IO_SYNC"        ...
Then we add the task input argument.
        ...        Dim io_value As OlpVariable = IO_SYNC.LocalVariables.GetOrCreateIO("io_value", _                                                                            DELOlpDataType.delOlpInteger, _                                                                            DELOlpIODirection.delOlpInput)        ...
Now we need to create the instructions in the task to set the group output and wait for the group input. But before we do this, we need to get the external IOs. We assume that IO_SYNC always uses GO[1]output and GI[1] as the input.
        ...        Dim ExternalIO As OlpVariables = Main.TransHelper.Behavior.GlobalVariables        Dim go1 As OlpVariable = ExternalIO.GetOrCreateIO("GO1", DELOlpDataType.delOlpInteger, DELOlpIODirection.delOlpOutput)        Dim gi1 As OlpVariable = ExternalIO.GetOrCreateIO("GI1", DELOlpDataType.delOlpInteger, DELOlpIODirection.delOlpInput)        ...
Then we create the set and wait instructions. The last two arguments to CreateInstruction determine where the instructions are created. We want to append the instructions to the task so we specifyposition and "True" to create at the end (instead of the beginning).
        ...        Dim Instructions As OlpInstructions = IO_SYNC.Instructions        Dim SetOutput As OlpAssign = Instructions.CreateInstruction(DELOlpInstructionType.delOlpAssign, Nothing, True)        Dim WaitInput As OlpWait = Instructions.CreateInstruction(DELOlpInstructionType.delOlpWait, Nothing, True)        ...
Next we configure the Set instruction. First, by setting the group output as the destination of the assignment.
        ...        SetOutput.Destination = go1        ...
Then we configure the value that is assigned to the output. The value can be any expression which is assigned in AST format. DELMIA expressions have a dedicated AST format which is detailed in 
Method to OverrideReason to OverrideUploadProcedureThe default behavior is to create a blank task if the called task does not exist. Instead, we want to create the IO_SYNC procedure with the correctUploadArgumentsWe need to convert the string argument into an integer and validate that the argument is in the expected format.AppendArgumentsThis is used on download to create the AST for the arguments. We need to convert the integer to a string and validate that the argument is in the
Fig.1: IO_SYNC Task
Page 15 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 16 ---

Translation. In our case we want a very simple expression which contains just the input argument identifier. This is the AST format (expressed as XML) we want to create:
<Expression><Identifier>io_value</Identifier></Expression>
That AST format is created by the following code and then assigned to the set instruction source.
        ...        Dim SetExpression As OlpAstBranch = Main.TransHelper.AstRoot.CreateBranch(DELOlpAstNodeType.delAstEXPRESSION, "")        SetExpression.AppendLeaf(DELOlpAstNodeType.delAstIDENTIFIER, "", io_value.Name)        SetOutput.Source = SetExpression        ...
Finally we configure the Wait instruction. The wait expression is also in AST format. In this case we want to wait for the task input argument to be equal to the external group input.
<BinaryExpression><Identifier id="Operand1">GO1</Identifier><Operator>=</Operator><Identifier id="Operand2">io_value</Identifier></BinaryExpression>
That AST format is created with the following code. We also set the WAIT instruction to not timeout.
        ...        WaitInput.UseTimeout = False
        Dim WaitExpression As OlpAstBranch = Main.TransHelper.AstRoot.CreateBranch(DELOlpAstNodeType.delAstBINARYEXP, "")        WaitExpression.AppendLeaf(DELOlpAstNodeType.delAstIDENTIFIER, "Operand1", gi1.Name)        WaitExpression.AppendLeaf(DELOlpAstNodeType.delAstOPERATOR, "", "=")        WaitExpression.AppendLeaf(DELOlpAstNodeType.delAstIDENTIFIER, "Operand2", io_value.Name)        WaitInput.Condition = WaitExpression
        Return IO_SYNC    End Function
5.Overriding UploadProcedure
We need to call the CreateIOSYNC function if the IO_SYNC task does not exist. We assume that if it exists that the logic inside the task is correct. You could improve this macro byis correct the first time you upload a CALL IO_SYNC instruction.
PublicOverridesSub UploadProcedure()        Dim IO_SYNC As OlpProcedure = Nothing
' see if the task already exists        IO_SYNC = Main.TransHelper.Behavior.Procedures.Item("IO_SYNC")
        If IO_SYNC Is Nothing Then' if it does not exist, create it            IO_SYNC = CreateIOSYNC()        End If
' set the run instruction to call IO_SYNC        RunInstr.Procedure = IO_SYNC
    End Sub
6.Overriding UploadArguments
UploadArguments converts the Arguments AST branch into arguments for the DELMIA run instruction. The DELMIA run instruction arguments are also specified as an AST branch. So we need toFANUC AST format into the expression AST format as described in OLP Expression Translation. Note that an Abstract Syntax Tree (AST) is different for each languageprogram. 
First we find the FANUC arguments AST branch which is a child of the CALL instruction AST branch. You can find the full AST format for the FANUC CALL instruction ExistsChildByType so that we can detect missing arguments. After finding the argument, we make a copy so we don't modify the parsed FANUC AST.
ProtectedOverridesSub UploadArguments()
       Dim ArgsNode As OlpAstNode = Nothing        Dim ExpressionOK As Boolean = False        If AstInstruction.ExistsChildByType(DELOlpAstNodeType.delAstARGUMENTS, ArgsNode) Then            Dim ArgsBranch As OlpAstBranch = ArgsNode.Clone        ...
Then we locate the argument. Again we validate that there is only one argument and get the argument with ExistsChildByType in case the CALL IO_SYNC instruction has a syntax error.
        ...            Dim StringNode As OlpAstNode = Nothing            If ArgsBranch.Count = 1 And ArgsBranch.ExistsChildByType(DELOlpAstNodeType.delAstSTRING, StringNode) Then
                ExpressionOK = True        ...
We know from the AST format that the argument is an AST leaf node, so now we need to convert it from a string to an integer. We can change the AST node type. We also convert '0001000' into 0b0001000 byremoving the quotes and adding "0b". Then we update the AST value.
        ...                Dim StringLeaf As OlpAstLeaf = StringNode                StringLeaf.Type = DELOlpAstNodeType.delAstCONST_INTEGER
                Dim StringValue As String = StringLeaf.Value                StringLeaf.Value = "0b" & StringValue.Substring(1, StringValue.Length - 2)        ...
Finally we set the run instruction arguments if they were in the correct format or post a warning if they were not.
        ...            End If        End If
Page 16 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 17 ---

        If ExpressionOK Then            RunInstr.Arguments = ArgsBranchElse            Main.ErrorReporter.AddMessage(DELOlpMessageType.delOlpWarning, "Invalid arguments in call to IO_SYNC.  There should be 1 string input."        End If
    End Sub
7.Overriding AppendArguments
This is the method used on download to add the arguments to the AST. This is the reverse logic of UploadArguments. 
First we get the run instruction arguments. We do not need to make a copy because OlpRun.Arguments returns an AST branch that can be modified.
ProtectedOverridesSub AppendArguments()        Dim V6Args As OlpAstBranch = RunInstr.Arguments        ...
Then we verify that there is only one argument, that the argument is an integer, and get that argument.
        ...        Dim ExpressionOK As Boolean = False        If V6Args.Count = 1 Then            Dim Arg1 As OlpAstBranch = V6Args.Item(1)            Dim IntegerNode As OlpAstNode = Nothing            If Arg1.Count = 1 And Arg1.ExistsChildByType(DELOlpAstNodeType.delAstCONST_INTEGER,IntegerNode) Then                ExpressionOK = True        ...
The integer argument is converted to a string. For details on on the CovertIntToString method please see the full source code.
        ...                ConvertIntToString(IntegerNode)            End If        End If        ...
Finally, if the arguments were valid, we add the arguments to the instruction AST, if not we post a warning.
        ...        If ExpressionOK Then            AstInstruction.AppendLeaf(DELOlpAstNodeType.delAstOPERATOR, "", "(")            AstInstruction.Append(V6Args)            AstInstruction.AppendLeaf(DELOlpAstNodeType.delAstOPERATOR, "", ")")Else            Main.ErrorReporter.AddMessage(DELOlpMessageType.delOlpWarning, "Invalid arguments in call to IO_SYNC.  There should be 1 string input."        End If
    End Sub
Integrating Your Customizations
This example illustrates how to integrate into a DELMIA translator a class which translates a custom instruction. 
Before you begin:
lYou should have read Robotics Programming Overview, Customizing a Translator and Translating an Instruction. 
lYou can import a working version of the customized translator from the fileMyFanucTranslatorR2016x.3dxml supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdOlpOfflineProg\samples\whereInstallRootFolder is the folder where the CAA CD-ROM is installed. 
Where to find the macro: MyInstructionListSource.htm,TranslatorFactorySource.htmThis example steps through how to identify they type of an instruction and call the appropriate class to translate that instruction. To illustrate theexample, we have invented a custom FANUC instruction "IO_SYNC". The details of the IO_SYNC instruction are explained in Customizing aTranslator. The class to translate that instruction, MyIO_SYNC.vb, is explained inTranslating an Instruction.
Related TopicsRobotics ProgrammingOverviewCustomizing aTranslatorTranslating anInstruction
The modifications required to integrate a custom translator class are:
1.Create MyInstructionList Class2.Override CreateTranslatorForUpload3.Override CreateTranslatorForDownload4.Modify TranslatorFactory1.Create MyInstructionList Class
The class FanucInstructionList is used to identify the instructions in a FANUC TP program on upload or in a DELMIA task on download. It then creates the appropriate object to perform the translation of the instruction. Therefore, since we need to identify CALL IO_SYNC instructions and create the MyIO_SYNC object to translatethem, we need to create our own version of this class.
For the same reasons given in Customizing a Translator, we should create our own class, MyInstructionList, which inherits from FanucInstructionList.
<CLSCompliant(False)> PublicClass MyInstructionListInherits FanucInstructionList
PublicSub New(ByRef iTask As FanucTask, ByRef iV6Instructions As OlpInstructions, ByRef iAstInstructions As OlpAstBranch)        MyBase.New(iTask, iV6Instructions, iAstInstructions)    End Sub
We will need to override 2 methods in this class to create the MyIO_SYNC class for upload and download.
2.Override CreateTranslatorForUpload
In the FANUC translator, the method CreateTranslatorForUpload is called for each instruction in the FANUC AST. We will override this function to identify CALL IO_SYNC instructions and return a new MyIO_SYNC object for them. For all other instructions, we will rely on the base class implementation. After all the objects to 
Page 17 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 18 ---

translate the instructions have been created, the FanucInstructionList class will call Upload on each of them.
If the AST instruction branch is of type delAstRUN then we know that the instruction is a CALL instruction. 
ProtectedOverridesFunction CreateTranslatorForUpload(ByRef AstInstruction As OlpAstNode) As FanucInstruction        If AstInstruction.Type = DELOlpAstNodeType.delAstRUN Then        ...
If it is a CALL, then we need to get the task that is called. Based on the FANUC AST instruction format which was identified in Customizing a Translator, we know that the task name is in a node of type delAstIDENTIFIER. 
        ...            Dim AstInstructionBranch As OlpAstBranch = AstInstruction            Dim TaskName As String = _                    AstInstructionBranch.FindChildByType(DELOlpAstNodeType.delAstIDENTIFIER).Value        ...
If the name of the task is IO_SYNC, then we create a run instruction and a new MyIO_SYNC translator and return the MyIO_SYNC object. The FANUC translator always creates the DELMIA instruction at the same time as the class which will translate it. Other translators may do this differently. You will need to examine the equivalent methods in those translators to see how it is done.
        ...            If TaskName = "IO_SYNC" Then                Dim EVTAPIInstruction As OlpInstruction = _                        V6Instructions.CreateInstruction(DELOlpInstructionType.delOlpRun, Nothing, True)                Return New MyIO_SYNC(TaskTranslator, EVTAPIInstruction, AstInstruction)            End If        ...
If the instruction is not a CALL MY_IOSYNC, then call the base class implementation of CreateTranslatorForUpload to create the appropriate objects.
        ...        End If
        Return MyBase.CreateTranslatorForUpload(AstInstruction)    End Function
3.Override CreateTranslatorForDownload
This method identifies the DELMIA instruction and creates the appropriate object to perform the translation. We will override it to identify a run IO_SYNC instructionand return MyIO_SYNC.
Check the instruction type to see if it is a run instruction.
ProtectedOverridesFunction CreateTranslatorsForDownload(ByVal V6Instruction As DELOlp.OlpInstruction) As List(Of FanucInstruction)        If V6Instruction.Type = DELOlpInstructionType.delOlpRun Then        ...
Check the called task's name to see if it is IO_SYNC.
        ...            Dim RunInstruction As OlpRun = V6InstructionIf RunInstruction.Procedure.Name = "IO_SYNC" Then        ...
If a run IO_SYNC instruction was found, create the main AST branch for the FANUC instruction and the MyIO_SYNC object. The FANUC translator may use more than 1 object to translate a DELMIA instruction. We only need 1 object, so we need to return a list which has just the MyIO_SYNC object in it. Other translators may not create the AST branch at the same time or may not use a list. You will need to examine the equivalent method in other translators to identify what needs to be done.
        ...                Dim AstEVTAPIInstruction As OlpAstBranch = AstInstructions.CreateBranch(DELOlpAstNodeType.delAstRUN, "")                Dim Translator As FanucInstruction = New MyIO_SYNC(TaskTranslator, V6Instruction, AstEVTAPIInstruction)                Dim InstructionTranslators As List(Of FanucInstruction) = New List(Of FanucInstruction)                InstructionTranslators.Add(Translator)                Return InstructionTranslators        ...
If the instruction is not a run IO_SYNC, then call the base class implementation of CreateTranslatorForDownload to create the appropriate objects.
        ...            End If        End If        Return MyBase.CreateTranslatorsForDownload(V6Instruction)    End Function
4.Modify TranslatorFactory to create MyInstructionList
The final step in customizing a translator is to replace an existing translator class with one (or more) of your classes. To do this, your class must inherit from the class it is replacing. 
TranslatorFactory.vb is the file which enables you do do this substitution. This is theonly file you will ever need to modify in the DELMIA translator. The same file is used in all translators. When you move your customizations from one version of a DELMIA translator to another, you will only need to copy the files you created, and update the TranslatorFactory.
In our example, we only need to replace one class, FanucInstructionList, with our version, MyInstructionList. The only change we made below was to replace "New FanucInstructionList"with "New MyInstructionList".
PublicShared Function NewInstructionListTranslator( _ByRef iTask As FanucTask, _ByRef iV6Instructions As OlpInstructions, _ByRef iAstInstructions As OlpAstBranch) As FanucInstructionList        Return New MyInstructionList(iTask, iV6Instructions, iAstInstructions)    End Function
OLP Profile MatchingTechnical Article
Page 18 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 19 ---

An Introduction to DELMIA Profiles
Robot language instructions have many parameters. In DELMIA Robotics, we have grouped together these parameters into profiles. For example, the Motion Profilecontains all the parameters related to specifying the speed and acceleration of the robot. There are also profiles for specific manufacturing applications such as Spot Welding and Painting. 
The grouping of the parameters in DELMIA frequently does not match the groupings in the robot language or the individual parameter may be set on an instructiondirectly. During upload, these parameters will need to be grouped according to the DELMIA profiles and each unique set of parameter values should have just 1 profile instance created and should be re-used on all the instructions where those parameter values are needed. 
When customizing a translator, you have 2 choices for how to create and re-use a profile. The first option is manage the creation and re-used of the profiles directly in the translator. The second option is to assign the parameter values directly to the instruction and specify the rules for when an existing profile should be re-used. Each option will be discussed below. 
Managing Profile Creation Directly
This method is similar to how a user creates and assigns profiles through our user interface. Therefor it is a simpler method. However, you may need to write a lot of logic in the translator to get it to work correctly.
Given the nature of the problem, some (or a lot) of logic is required to properly manage the creation and retrieval of a profile type given a set of parameters. This logic should only create new profiles if the parameters given do not match any other existent profile, or if the application specifically dictates to do so. It is important to re-useprofile as much as possible for performance and usability.
There are 3 steps to working with profiles like this:
1.Get or Create the profile from the list of profiles2.Set the parameter values3.Assign the profile to an instruction
Get or Create the profile from the list of profiles
With this method, the profiles are managed by name. You can create a new profile, or retrieve an existing profile with a specific name by calling GetOrCreateProfile(“MyProfileName”) on an object implementing OlpProfiles by passing the profile name as the argument. Some of those objects can be retrieved like:
Dim MyProfiles As OlpProfiles = MainMotionGroup.PrimaryDevice.GetApplicativeProfileList("MyProfileType")Dim ToolProfiles As OlpProfiles = MainMotionGroup.PrimaryDevice.ToolProfileListDim AccuracyProfiles As OlpProfiles = MainMotionGroup.PrimaryDevice.AccuracyProfileListDim ObjectProfiles As OlpProfiles = MainMotionGroup.PrimaryDevice.ObjectFrameProfileListDim SpotProfiles As OlpProfiles = MainMotionGroup.PrimaryDevice.SpotProfileList         ...
And then the profile is created:
Dim MyProfile As OlpProfile = MyProfiles.GetOrCreateProfile("MyProfileName")
Set the parameter values
You can then set the parameters of that profile directly by calling OlpProfile.SetParameter.
SetParameter(CATBSTR iProfileType,     CATBSTR iParameterName,     CATVariant iValue,     Boolean iMatch)
For example to set the attribute “MyParameterName”of the profile we created above to the value 1.0 you would do this:
MyProfile.SetParameter("", "MyParameterName", 1.0, False)
The first argument is the profile type. When setting a parameter directly on a profile, it is not needed and can be blank. Some profiles can have sub groupings of parameters and this argument is used to set which sub group the parameter is in. The 2nd argument is the parameter name. The 3rd argument is the parameter value and can be any simple data type. The 4th argument is not used when a profile has been retrieved directly from the OlpProfiles list. Its purpose will be discussed in the next section.
The main profile types like Motion Profile, Tool Profile, Spot Profile, etc have dedicated Object types and methods to access their properties. User profiles and Applicative Profiles use the generic object type OlpProfile.
Assign the profile to an instruction
Finally you assign the profile to an instruction. For dedicated profile types you can assign it directly:
Dim MotionProfiles As OlpProfiles = MainMotionGroup.PrimaryDevice.MotionProfileListDim MyMotionProfile As OlpProfile = MotionProfiles.GetOrCreateProfile("MyMotionProfileName")MyRobotTarget.MotionProfileOlp = MyMotionProfile
For applicative and user profiles you need to assign it by name. 
MyRobotTarget.SetProfileName("MyProfileType", MyProfile.Name, True)
The 1st argument is the type of your profile, the 2nd argument is the name of your profiles and the 3rd argument must be TRUE so that the instruction will go search for a profile that matches the given name.
Using Match Profiles
Abstract
This article provides details on translating profiles and the methods used to reuse existing profiles while uploading a robot program.
Warning: Robot language parameters might not be grouped the same way as the DELMIA profiles. Warning: Robot program translation is performed sequentially –that is, instruction by instruction.
Page 19 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 20 ---

The main idea with matching profiles is that when translating, parameters are associated to a motion instruction. Rather than writing code to create the profiles and search through created profiles for one that has all the same parameter values, translators can just set the parameters on the instruction and the system will automatically create a new profile or re-use an existing one. This type of profile creation solves the creation/retrieval problem we depicted above.
However, in order for this to work, the system needs to know which parameters to search for and which ones to ignore. This is because many of the parameters of a profile may not specified in the robot program for a particular language.
Setting a parameter
You can set user and applicative profile parameters on a robot motion target or instruction using the SetParameter method. It is the same as the OlpProfile.SetParameter method. Except you need to specify the profile type
SetParameter(CATBSTR iProfileType,     CATBSTR iParameterName,     CATVariant iValue,     Boolean iMatch)
For example to set the attribute “MyParameter”of a profile to the value 1.0 you would do this:
MyRobotTarget.SetParameter("MyProfileType", "MyParameterName", 1.0, True)
The first argument is the profile type and must be specified. If a profile with this type does not exist a new user profile with that type will be created. The 2nd argument is the parameter name. If a parameter does not exist on the applicative or user profile, a new user parameter will be added with the datatype of the 3rd argument. The 3rd argument is the parameter value and can be any simple data type. The 4th argument indicates if you want to use this parameter to search for an existing profile to re-use. 
For all profiles types that have a method within an OlpController object to retrieve a profile list (Accuracy, Conveyor Tracking, Motion, Object Frame, Paint, Spot and Tool) you can set their parameters in two ways:
Directly on the object profile:
MyRobotTarget.MotionProfileOlp.SetTCPSpeedLinear(DELOlpMotionProfileUnits.delOlpMotionProfileAbsolute, 0.5, True)
Or by retrieving a generic profile and then assigning it to the object:
Dim MyMotionProfile As OlpMotionProfile = MotionProfiles.GetOrCreateByMatch(True)' The True argument in GetOrCreateByMatch is used to avoid duplicate creation of default (empty) profiles MyMotionProfile.SetTCPSpeedLinear(DELOlpMotionProfileUnits.delOlpMotionProfileAbsolute, 0.5, True)MyRobotTarget.MotionProfileOlp = MyMotionProfile
Matching Details
In most cases, you will want to match every property that is set. However, there are some scenarios where this is not desired. There are a few guidelines you must following in order for matching to work correctly:
1.At least 1 parameter or the profile name for a given profile type must have iMatch set to TRUE. If no parameters are set to match, then the system doesn’t know how to find a profile to reuse and a new profile will be created for every instruction and warning will be issued. 2.You can match either the profile name or some parameters, but never both. The profile name is always unique so if you are matching the profile name, it doesn’t makes sense to also match a parameter. 3.You should match the same parameters on every instruction for a specific profile type. When searching for a matching profile, the 1st profile that use all the sameparameters will be used. If you don’t always match the same set of parameters, you may re-use an incorrect profile. 
To help debug the mapping behavior you can set the environment variable “DNB_OLP_MATCH_DEBUG”to any value. It will display trace message in the console window describing when a matching profile is found and when a new profile is created.
A Simple Example:
Here is a simple example to illustrate matching. Let’s say there is a profile with 3 attributes in addition to the name:
MyProfileTypeAttribute1 (String)Attribute2 (Integer)Attribute3 (Double)
Before uploading let say there are 2 profile instances already:
Let’s say you are uploading some motions that have 2 of these attributes but attribute 3 is not included in the program.
When uploading the 1st move you would make 4 calls:
Target1.SetParameter("MyProfileType", "Attribute.1", "Abc", True)Target1.SetParameter("MyProfileType", "Attribute.2", 1, True)Target1.SetParameter("MyProfileType", "Attribute.3", 1.1111, False)Target1.SetProfileName("MyProfileType", "Abc.1", False)
The result is a new profile will be created because no existing profile has Attribute1= “Abc”and Attribute2=1. The last 2 calls for setting Attribute.3 and setting theprofile name without matching are optional and depend on your desired results. If those arguments were not specified the default name and attribute value would be used for the new profile.
When uploading the 2nd move you would make 4 calls: 
Target2.SetParameter("MyProfileType", "Attribute.1", "Xyz", True)Target2.SetParameter("MyProfileType", "Attribute.2", 2, True)
NameAttribute1Attribute2Attribute3Profile.1Abc 3 3.14Profile.2Xyz 2 2.72
InstructionAttribute1Attribute2Move.1Abc 1Move.2Xyz 2Move.3Abc 1
Page 20 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 21 ---

Target2.SetParameter("MyProfileType", "Attribute.3", 2.2222, False)Target2.SetProfileName("MyProfileType", "Xyz.2", False)
This time the result is that Profile.2 from above will be matched because Attribute.1= “Xyz”and Attribute.2 = 2. The value of attribute 3 does not matter for matching aprofile because iMatch is false. Also the name does matter for matching the profile for the same reason. Those value will be set on the profile.
When uploading the 3rd move you would make 4 calls: 
Target3.SetParameter("MyProfileType", "Attribute.1", "Abc", True)Target3.SetParameter("MyProfileType", "Attribute.2", 1, True)Target3.SetParameter("MyProfileType", "Attribute.3", 1.1111, False)Target3.SetParameter("MyProfileType", "Attribute.4", "Abc.1", False)
This time the same profile created for the 1st move will be matched and used again.
So after upload you want to have this:
NameAttribute1Attribute2Attribute3Profile.1Abc 3 3.14Xyz.2*Xyz 2 2.22222**Abc.1Abc 1 1.11111
* The profile name was changed from Profile.2 to Xyz.2 because the name was set without matching.
** The attribute value was changed from 2.72 to 2.2222 because it was set without matching.
An the task would look like this:
If you do not set the name or an attribute during upload and a new profile is created a default value will be used for the attribute. If an existing profile is matched, the value from the original profile will be kept. 
References
Before you Begin
You should have read Robotics Programming Overview, Customizing a Translator and Translating an Instruction.
You can import a working version of the customized translator from the file “DELMIA XMLCAADrillRivet Translator.3dxml”and a sample dataset supplied in the folder InstallRootFolder\CAADoc\Doc\English\CAAScdOlpOfflineProg\samples\ whereInstallRootFolder [1] is the folder where the API CD-ROM is installed. Additionally, this folder contains a sample XML program to upload.
On the Customized Translator and the Program Structure
lThe XML program structure supplied in the sample file is just for teaching purposes. The Delmia V5/V6 XML format does not specify a structure for this instruction set. 
lDuring the entire upload process, the XML translator does not make use of a parser/scanner. Instead, it iterates through the XML nodes found in an XML document. Thus, the structure of program uploaded is clearly visible and requires no parsing. 
Conceputal Overview of Waypoints
Waypoint Targets:
A series of joint or cartesian target locations that define collision free paths the robot can move between. A robot can always move from the parent to a child waypoint and visa-versa. Each parent waypoint target can have multiple possible children to move to. Each process point defines, at least, a waypoint target that it can move to on a collision free path. The hierarchical structure forms an inverted Tree structure with the Root of the Tree having no parent. Each waypoint target must have a WaypointID and a ParentWaypointID assigned. Optionally, the waypoint can have an escape motiontype defined.
Waypoint Motion:
A robot motion that contains a waypoint target.
Waypoint Operation:
A sequence instruction containing a series Waypoint motions generated using an assigned Waypoint Task as a reference. 
InstructionMyProfileTypeMove.1Abc.1Move.2Xyz.2Move.3Abc.1
[1]Robotics Programming Overview[2]Customizing a Translator[3]Translating an InstructionHistoryVersion:1 [Jun 2020]Document created
Integrating Drilling and Riveting into your TranslatorUse Case
Abstract
This document describes the necessary steps to customize an existing translator so it can translate drill and rivet instructions and their associated profiles during both program upload and download.
Page 21 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 22 ---

In a Drill/Rivet robot task only one Waypoint Task can be assigned as a reference for its contained Waypoint Operations. The assignment just needs to happen once, in any of the Waypoint Operations instantiated within the Drill/Rivet task.
Waypoint Task:
A task containing only waypoint motions. A waypoint task cannot contain any other type of instruction. Conceptually, a waypoint task can be seen as the reference task that solely defines the hierarchical structure and positional data of waypoint motions. A waypoint task is used as a reference when creating a drill/rivet task, serving as the source of positional data for any waypoint operations instantiated within the drill/rivet task.
In waypoint task image, Waypoint 1 (Root) is the parent of Waypoint 11 and 12. Waypoint 11 is the parent of Waypoint 111 and Waypoint 112 and Waypoint 12 is the parent of Waypoint 121.
Manufacturing Fastener:
An object containing manufacturing positions for the design fasteners/entities (3D points). This object is persisted in the logical behavior Representation and aggregated to Manufacturing cell in the Resource tree. Manufacturing Fastener isused downstream to generate robot tasks.
Manufacturing Pattern –An object used to group Manufacturing Fasteners. This object is persisted in the logical behavior Representation along with Manufacturing Fasteners and aggregated to Manufacturing cell in the Resource tree. Manufacturing Pattern is used downstream to generate robot tasks.
Drill/Rivet Operation:
A Robot instruction for drilling/riveting a point. Depending on the content of associated Drill/Rivet Profile, Drill/Rivet Operation would perform different intermediate motions (like Approach, Drill/Rivet Start, Drill/Rivet, Drill/Rivet Complete, Retract) to emulate Drilling/Riveting. Each Drill/Rivet Operation in a Drill/Rivet Task is assigned a parent waypoint, which is used to approach and depart from the operation.
An Example Program
Let us consider a Drill/Rivet task with 4 Drill Operations (DOp.1-ROp.3) and 2 Rivet Operations (ROp.1 and ROp.2). Let us assign Waypoint 111 as parent waypoint of Drill Operation DOp.1 and Rivet Operation ROP.1, Waypoint 112 as parent waypoint of Drill Operation DOp.2 and Rivet Operation ROp.2 and Waypoint 121 as parent waypoint of Drill Operations DOp.3 and ROp.3.
Let’s define the order of execution as follows: DOp.1, ROp.1, DOp.2, ROp.2, DOp.3 and finally ROp.3. These are the steps the robot will take to accomplish this:
1.DOp.1 and ROp.1 identify waypoint #112 as its parent. This means we must move to Waypoint #112 in order to execute these operations. Thus, the robot would move to:1.Waypoint 1 2.Waypoint 113.Waypoint 112 2.The robot would perform drill operation DOp.1 and rivet operation ROp.1. Because both share the same parent waypoint, the robot would not perform any waypoint motion between them by default. However, it is possible for the Robot programmer to specify that they wish to force waypoint motion between DOp.1 and ROp.1, even though their parent waypoint is the same. If this option is chosen, the robot would move to waypoint 112 between DOp.1 and ROp.1. 3.DOp.2 and ROp.2 identify waypoint 111 as its parent. In order to reach waypoint 111, the robot would move to:1.Waypoint 112, as this is the parent waypoint of the previously executed DOp.1 and ROp.1. 2.Waypoint 11, as this is the lowest common parent of waypoints 111 and 112 3.Waypoint 111 4.The robot would perform drill operation DOp.2 and rivet operation ROp.2 5.Drill Operation DOp.3 and Rivet Operation ROp.3 identify waypoint 121 as its parent. In order to reach waypoint 121, the robot would move to:1.Waypoint 1112.Waypoint 11 3.Waypoint 1 4.Waypoint 12 5.Waypoint 1216.The robot would perform drill operations DOp.3, and ROp.3
Customizing the XML Translator
To customize the translator, we will follow the steps described in Customizing a Translator:
1.Determine the DELMIA instruction structure2.Determine the XML structure3.Make a copy of the translator4.Write the required classes to translate the instruction5.Modify the translator to use your classes6.Update options to use your translator
1. Determine the DELMIA instruction structure
Waypoint Task
To create a waypoint task, we will create a regular robot task and define the waypoint tree structure within by creating Waypoint Motion instructions. A Waypoint Task is just that, a task that contains only waypoint motions. Thus, no special customization is needed on the way the XML translator translates tasks –at least for WaypointTasks.
Waypoint Motion
Creating a waypoint motion is not any different from creating any other instruction type, except that they can only be instantiated within a Waypoint Task. Use the CreateInstruction interface on anOlpInstructions object, and pass in the instruction type –delOlpWaypointMotion. Waypoint motion instructions can only be created in a Waypoint Task or under a waypoint Operation. The returned instruction is actually of type OlpRobotMotion, and the main key difference from a regular OlpRobotMotion is that the waypoint motion target implements OlpWaypointMotionTarget. Thus, we will have to customize the class used to translate Robot Motions (XMLMotionInstruction) in order to translate Waypoint Motions.
Waypoint Operation
Page 22 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 23 ---

To create them, use the CreateInstruction interface on an OlpInstructions object, and pass in the instruction type –delOlpWaypointOperation. The returned object of type OlpWaypointOperation contains an Instructions member where we will create the desired waypoint motions. When uploading a waypoint operation, we must set its reference waypoint task. Keep in mind that, when instantiating Waypoint Motion instructions within a Waypoint Operation that has a Waypoint Task set, the only requirement for a fully defined waypoint motion is its waypoint ID. Any additional information set will be overwriting the information stored in the Waypoint Task, so please plan accordingly. As far as our custom translator goes and, since this is a new instruction that did not exist before, we will add a new class that derives from the base Instruction class to translate it.
Drill/Rivet Operation
Creating drill, rivet and drill-rivet operations follows a slightly different approach from what we are accustomed to. This type of operations need to be instantiated from a OlpTemplate. To do so, we will use the CreateInstructionFromTemplate method on the task’s OlpInstructions object with the following parameters:
libraryName = “DrillRivet”templateName = “DrillAction”or “DrillRivetAction”or “RivetAction”TemplateType = “Spot”subtype = “Action”RelInstruction is the relative OlpInstruction where to create this actionAfter is a Boolean value indicating whether to create the instruction before or after the relative instruction
We must keep in mind that the return object from this function call is an OlpTemplate, but we can also use the OlpDrillRivetAction interface to access further properties of this object. The returned object’s instructions will contain the drill and/or rivet operations for us to set data on.
The instructions within the returned OlpTemplate will vary depending on whether we created a Drill, Rivet or a DrillRivet operation. When creating a drill or a rivet action we get a list with a single instruction, as opposed to a DrillRivet action where two instructions are contained. Use the OlpRobotMotion to modify or access the action’s data.
DrillRivet Profile
Drill, Rivet and Drill-Rivet actions must have an associated DrillRivet profile for their definition to be complete. To translate DrillRivet profiles within our custom XML translator, we will derive the XMLController class to add a DrillRivet profile translation method. When instantiating a new DrillRivet profile, we will get a profile that contains slightly different objects depending on the process type we assign it during creation.
Translation Logic
Since we are adding instructions to the translation set, we will have to customize the logic governing the translation process: XMLInstructionList. Additionally, to aid in our translation of waypoint operations, we will need a customized XMLTask.
Others
For the sake of clarity, we will store our Keywords in a separate class from XMLKeywords.
2. Determine the XML structure
Note: Have a look at the sample XML program to get a deeper insight into any of the structures outlined below.
Drill-Rivet profiles
Their structure is contained within the Controller element, and is quite simple.
<DrillProfileList></DrillProfile>Properties</DrillProfile></DrillProfileList><DrillRivetProfileList><DrillRivetProfile>Properties</DrillRivetProfile></DrillProfileList>
Waypoint Motion
The Waypoint Motion XML structure is identical to that of a Robot Motion.
<Instruction></PersistentParameters><ApplicativeParameters></MotionAttributes></Target></ApplicativeParameters></Instruction>
Waypoint Operation
The Waypoint Operation structure is quite simple, as it mainly just serves as a Waypoint Motion container. We can identify a waypoint operation by its LateType, which takes a value of DNBWaypointOperationActivity. The link to the Waypoint Task is stored within the PersistentParameters element.
<Instruction></PersistentParameters>
Class Base Class Purpose of customizationXMLControllerCustomXMLControllerTranslate Drill-Rivet profilesXMLDrillRivetOperationBaseInstructionXMLMotionInstructionCustomTranslate Drill and Rivet operationsXMLDrillRivetOperationInstructionXMLInstructionCoordinate Drill-Rivet operation upload/downloadXMLInstructionListCustomXMLInstructionListControl translation logicXMLKeywordsCustomXMLKeywordsStorage of keywordsXMLMotionInstructionCustomXMLMotionInstructionTranslate waypoint instructionsXMLTaskCustom XMLTask Aid in WaypointOperation translationXMLTranslatorCustomXMLTranslatorSet translator options, fix waypoint operations without waypoint task.XMLWaypointMotionInstructionXMLMotionInstructionCustomTranslate WaypointMotionsXMLWaypointOperationInstructionXMLInstructionTranslate WaypointOperations
Page 23 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 24 ---

</WaypointOperationInstructions></Instruction>
Drill, Drill-Rivet and Rivet Operations
The DrillRivet Motion XML structure is identical to that of a Robot Motion. We can identify them by the use of DNBDrillOperationActivity, DNBDrillRivetOperationActivity and DNBRivetOperationActivity.
<Instruction></PersistentParameters><ApplicativeParameters></MotionAttributes></Target></ApplicativeParameters></Instruction>
3. Make a copy of the translator
We recommend creating your own copy of the macro library for your customizations. This way it is clear whether you are using the DELMIA standard translator oryour custom version. Also, as soon as you save a change to a macro library, it is updated in the database so other users in your enterprise will get your changes.
1.Search for the translator in the database. You can use the search string "VSTA: *" to find all VSTA macro libraries. 2.Use the Collaborative Tasks->Duplicate command to create a copy of "DELMIA XML R2020x" and rename it to your liking. 3.Open your copy of the macro library for editing using the Tools->Macros dialog. 
4. Write the required classes to translate the instruction
Please import the provided XMLCAADrillRivet translator to get details on writing the classes.
5. Modify the translator to use your classes
We will update the TranslatorFactory class to return the appropriate instruction class when instantiating XMLController, XMLMotionInstruction, XMLInstructionList and XMLTask objects. For the newly added classes, we will create new factory methods. Please refer to the provided XMLCAADrillRivet translator for more details.
6. Update options to use your translator
The XML translator supports both V5 and V6 upload and downloads. There is no upload option so there is nothing for us to update there. However, the translator doesprovide a V5 and a V6 download option. In our case, since we have defined this custom XML structure in a V6-typed XML, we will set the valid download options to “V6”, thus dropping “V5”from the supported formats for download.
References
These articles contain further information for creating Translators for Robotics Offline Programming (OLP), as well as an explanation of the provided ExampleTranslator:
1.Structure of a Translator2.Parsing a Robot Program using VB.NET3.Translating Instructions. 4.Details of the Example Language. 
[1]Robotics Programming Overview[2]Customizing a Translator[3]Translating an InstructionHistoryVersion:1 [Jun 2020]Document created
Creating a New Translator
Structure of a Translator
Page 24 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 25 ---

Most 3DExperience translators are VB.NET  programs with associated C++ code. The C++ code is built into 3DExperience, so this documentation will use the DELMIA Example Translator for reference as it is entirely built in VB.NET. When a translator is opened for editing, there are a few parts available at the base level. ThisApplication.vb includes methods for initiating the translator as an object and launching the appropriate step of translation. Main.vb includes the methods used to initialize and launch the Upload, Download, Parse, and Debug  processes. Each of these methods also launches error handling and collects any messages from error handling. These two files sit at the main level of the translator and will call the classes in the Translator directory as the process runs. Some translators additionally have a TranslatorUtils.vb class at this level; this class contains common conversions and utilities used in that translator.
The classes in the Translator directory handle specific functions during the translation process. TranslatorFactory handles generation of new instances of these classes, and should have an entry for any new class added. The [language]Translator.vb file contains the class that Main will call to start Upload or Download for each specific translator. [Language]Keyword.vb contains a series of strings the other functions will use to find relevant items in the incoming program. The Translating Instructions page (link) contains information on how the other files in this directory are used.
To add more instruction types to the Example Translator, create new classes that inherit from ExampleInstruction.vb and add a method to TranslatorFactory.vb to construct them, then add the appropriate conditions for these instructions to ExampleInstructionList.vb. Most instructions will also need keywords for these instructions added to ExampleKeywords.vb to allow identification of the instruction in the text file and consistency in download to a text file.
Parsing is the process of programmatically reading text and identifying the components of it that make up individual instructions and arguments. In most 3DExperience translators, this is accomplished by a C++ parser associated with that translator. This parser constructs an Abstract Syntax Tree (AST) out of the items it identifies, which will then be read by the VB.NET upload process for that translator. See Robotics Programming Overview for an explanation of the AST.
The Example Translator is designed to use VB.NET for parse in order to provide a demonstration of how the parse process works. In this translator, ExampleTranslator.Parse() will call ExampleTask.Parse(), similar to the Upload/Download process (link) in most translators. The ExampleTask.Parse() method checks each line for the keywords that would identify a motion instruction and calls a function to parse the line based on what it finds. If it finds the appropriate keywords, it calls ExampleMotionInstruction.Parse(). If it does not find those keywords, it defaults to calling ExampleCommentInstruction.Parse().  This is the method where additional logic would need to be added to parse non-motion, non-comment lines with the Example Translator, by adding another possibility to the If statement. Note that the terms being checked for are defined in ExampleKeywords.vb; this assures consistency in the keywords used in the code, as well as improving convenience by allowing all instances of each keyword to be changed in one location.
To assist with debugging translators, the TranslatorUtils class contains the method TranslatorUtils.OutputASTForDebug(). This method will output the AST structure as an .xml file. This method expects two arguments - the first is the AST structure to output, an OlpAstBranch variable, and the second is a string, which the method will use to name the output file. You can use the AST XML-file while debugging to identify problems with the parsing logic. For more information on how to debug a translator with breakpoints, see the Simulation | Robotics | Robot Programming | Translator Prerequisites | Debugging Translators section of the User Assistance. 
Parsing a Robot Program Using VB.NET
Translating Instructions
Page 25 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 26 ---

Instructions are the individual lines in a 3DExperience simulated robot program. The included translators are intended to use appropriate robot backups and/or programs to create 3DExperience simulation programs, and to use 3DExperience simulation programs to create appropriate robot programs to the translator used.
When Uploading or Downloading, the ExampleTranslator class will find each Task to be translated and pass that task into the ExampleTask class, which uses the passed information to configure an ExampleInstructionList class. ExampleInstructionList contains methods for breaking the task down into a list of instructions and determining the type of each instruction. The Example Translator by default has two classes that could be called from here: ExampleMotionInstruction andExampleCommentInstruction. Both of these classes inherit from ExampleInstruction to ensure that the same methods can be called from ExampleInstructionListmethods. These classes then convert between an AST structure (more information in Parsing a Robot Program) and 3DExperience Tasks and Instructions.
Using the Example Translator
The Example Translator converts between 3DExperience tasks and text files using a custom syntax (the Example Language). The provided Example Translator will translate motion instructions and will render all other instructions as comments. The following is the syntax used in the text files:
lMoveJoint 50% Joint[{0deg,0deg,0deg,0deg,0deg,0deg}] Tool[1m,2m,3m,4deg,5deg,6deg] Stop[Fine] 
lMoveLine .5m/s Cart[{0.6m,0.2m,0.3m,10deg,20deg,30deg} Config{1}] Tool[.01m,.02m,0.03m,5deg,10deg,15deg] Stop[Fine] 
Movement Type:
The Example Language handles Linear and Joint movement. The keywords for these are MoveLine (for linear) and MoveJoint (for joint).
Movement Speed:
The Example Language handles Linear and Relative speeds. Linear (absolute, in 3DExperience movement terms) speeds are measured in meters per second (m/s) by default, while Relative speeds are measured as a percentage of maximum (%).
Target Location:
The Example Language support Joint and Cartesian (Joint and Cart keywords, respectively) position data. By default, it is configured to accept joint positions as such:
lJoint[{10deg, 20deg, 20deg, 0deg, 45deg, 0deg}]
Where "Joint" identifies the type of position data, and each joint's position is then specified in degrees. These values are stored as doubles. The brackets identify the scope of the joint position and the curly braces identify the scope of the joint values.
By default, the Example Language is configured to accept Cartesian positions as such:
lCart[{.5m, 0m, .1m, 0deg, -90deg, 0deg} Config{1}]
Where "Cart" identifies the type of position data, and the brackets identify the scope of this data. The first set of curly braces identifies the scope of the Cartesian coordinates, measured in meters ("m") and degrees ("deg") and stored as doubles, while "Config" and the second set of curly braces identify the configuration of the robot at this position. Configuration numbers reference the index of the pose saved to the 3DExperience controller, and must be an integer.
Tool Offset:
The key word "Tool" identifies the tool offset specification, contained in its own set of brackets. As with Cartesian positions, this is a Cartesian vector measured in meters (m) and degrees (deg) by default. These values are stored as doubles.
Stop Type:
The "Stop" key word identifies the stop type information. The Example Translator provided supports three stop types: 
lStop[Fine] will cause the simulated robot to perform a fine move, coming to a stop at the target location. 
lStop[.05m] will cause the simulated robot to use corner rounding, slowing down as much as is required to come within the specified distance (in meters) of the target location. 
lStop[70%] will cause the robot to brake to 70% of its speed as it approaches the target location before moving on to the next position. 
As with the position and tool data, values are stored as doubles.
Details of the Example Language
Material Definition Object Model MapSee AlsoLegend
Page 26 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 27 ---

Use theGetSessionService method of the Application object to retrieve the MATPLMService object.
Dim oMatService As MATPLMServiceSet oMatService = CATIA.GetSessionService("MATPLMService")
oMatService = CATIA.GetSessionService("MATPLMService")
Using the MATPLMService object, you can:
lRetrieve or set the core material and the covering materials of/to a given object. See Applying a Material with Domains on a 3D Part. 
lRemove an applied material. 
lRetrieve the materials in the session as a ListObject object in which a material is returned as a PLMEntity object. 
lCreate a material. See Creating a New Material with Domains.
From a Material object, you can retrieve two collections:
1.Use the GetSimulationBehaviors method to retrieve the MaterialBehaviors collection. 2.Use theGetDomains method to retrieve theMaterialDomains collection. 
From aMaterialDomain object, use theMaterialDomainContent property to retrieve a specific material domain, either a DrawingDomain object to create drawingpatterns, or a SimMaterialDomain object to access behaviors and options of material for simulations.
VBAPython
Creating a New Material with Domains
Before you begin: Note that:
lYou should first launch CATIA before executing the macro. 
lAs macro is demontrating the "dsc_matref_rep_Sample" domain, some C++ sample of code need to be build before executing the macro. Associated software is located inCAAMatExtendInterfaces.edu. An alternative is to adapt the macro to use another domain implementing scripting (as simulation docmain). 
Where to find the macro: CAAScdMatCreateMatSource.htm
Related TopicsMaterial Definition Object Model Map
This use case can be divided in ten steps:
1.Retrieve the Material Service2.Core Material Creation3.Add Domain to Core Material4.Covering Material Creation5.Add Domain to Covering Material6.Retrieve the first domain of a material7.Retrieve a domain by discipline8.Retrieve a PLM Attribute of a domain9.Set a PLM Attribute of a domain10.Retrieve Material Domain Content
1.Retrieve the Material Service
... Dim MatService   As  MATPLMServiceSet MatService   = CATIA.GetSessionService("MATPLMService")...
2.Core Material Creation
...Dim MyMaterialEditor   As EditorDim MyCoreMatRef       As Material
' Creation of Core MaterialMatService.PLMCreate   "dsc_matref_ref_Core", MyCoreMatRef, MyMaterialEditor...
3.Add Domain to Core Material
For adding a domain to material, you need to get all domains of material, and add in this list your domain.
...Dim MyListCoreMatDomains As MaterialDomainsDim MyDomain   As MaterialDomain
MyCoreMatRef.GetDomains  MyListCoreMatDomains
' Add a Rendering DomainMyListCoreMatDomains.Add "dsc_matref_rep_Rendering",  MyDomain
' Add a Composite DomainMyListCoreMatDomains.Add "dsc_matref_rep_Composite",  MyDomain
' Add a Drafting DomainMyListCoreMatDomains.Add "dsc_matref_rep_Drafting",   MyDomain
' Add a Simulation DomainMyListCoreMatDomains.Add "dsc_matref_rep_SmaOptions", MyDomain           ...
4.Covering Material Creation
...
Page 27 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 28 ---

Dim MyMaterialEditor   As EditorDim MyCoveringMatRef   As Material
' Creation of Covering MaterialMatService.PLMCreate   "dsc_matref_ref_Covering", MyCoveringMatRef, MyMaterialEditor...
5.Add Domain to Covering Material
You can only add a Rendering Domain for a Covering Material.
...Dim MyListCovMatDomains  As MaterialDomainsDim MyDomain   As MaterialDomain
' Retrieve all domains of materialMyCoveringMatRef.GetDomains   MyListCovMatDomains
' Add a Rendering DomainMyListCovMatDomains.Add   "dsc_matref_rep_Rendering",  MyDomain...
6.Retrieve the first domain of a material
...' Retrieve all domains of materialDim MyListCovMatDomains   As MaterialDomains  MyCoveringMatRef.GetDomains MyListCovMatDomains
' From the list, get the first domain of materialDim MyMatDomain As MaterialDomainSet MyMatDomain = MyListCovMatDomains.Item(1)...
7.Retrieve a domain by discipline
...Dim   MyFilteredDomainList   'As ListObjectReDim MyDomainListDisc(0)    'As CollectionMyDomainListDisc(0) = "dsc_matref_rep_Rendering"
' Get list of domainsDim MyDomainsList         As ObjectMyCoreMatRef.GetDomains   MyDomainsList
MyDomainsList.GetItemByDiscipline MyDomainListDisc, MyFilteredDomainList...
8.Retrieve a PLM Attribute of a domain
...' Get the V_description of DomainDim MyAttrValue   As String          MyAttrValue = MyMatDomain.GetAttributeValue("V_description")...
9.Set a PLM Attribute of a domain
...' Set the V_description of DomainDim MyAttrValue   As StringMyAttrValue = "Modified by User"MyMatDomain.SetAttributeValue "V_description", MyAttrValue...
10.Retrieve Material Domain Content
...' Retrieve the Material Domain ContentDim MyMaterialDomainContent As  MaterialDomainContentSet MyMaterialDomainContent = MyMatDomain.MaterialDomainContent...
Creating a New Material with Domains
Before you begin: Note that:
lYou should first launch CATIA. 
limport theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolderis the folder where the API CD-ROM is installed.
lOpen any part of the PumpModel 
lLaunch the structural scenario App and create a structural simulation.
Where to find the macro: CAAScdMatCreateMatWithPythonSource.htm
Related TopicsMaterial Definition Object Model Map
This use case can be divided in ten steps:
1.Retrieve the Material Service2.Core Material Creation3.Add Domain to Core Material4.Covering Material Creation5.Add Domain to Covering Material6.Retrieve the first domain of a material7.Retrieve a domain by discipline8.Retrieve a PLM Attribute of a domain9.Set a PLM Attribute of a domain
Page 28 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 29 ---

10.Retrieve Material Domain Content1.Retrieve the Material Service
... MatService = CATIA.GetSessionService("MATPLMService")...
2.Core Material Creation
...MyCoreMatRef, MyMaterialEditor = MatService.PLMCreate ("dsc_matref_ref_Core", None, None)...
3.Add Domain to Core Material
For adding a domain to material, you need to get all domains of material, and add in this list your domain.
...    MyListCoreMatDomains = MyCoreMatRef.GetDomains ()MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Rendering", None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Composite", None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Drafting", None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_SmaOptions", None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Sample", None)...
4.Covering Material Creation
...MyCoveringMatRef, MyMaterialEditor = MatService.PLMCreate ("dsc_matref_ref_Covering", None, None)...
5.Add Domain to Covering Material
You can only add a Rendering Domain for a Covering Material.
...      MyListCovMatDomains = MyCoveringMatRef.GetDomains()MyDomain = MyListCovMatDomains.Add ("dsc_matref_rep_Rendering", None)...
6.Retrieve the first domain of a material
...MyMatDomainsList = iMyCoreMatRef.GetDomains()MyDomainMat = MyMatDomainsList.Item(1)...
7.Retrieve a domain by discipline
...MyDomainListDisc=[]MyDomainListDisc.append("dsc_matref_rep_Sample")MyDomainsList = MyCoreMatRef.GetDomains()MyFilteredDomainList = MyDomainsList.GetItemByDiscipline (MyDomainListDisc, None)...
8.Retrieve a PLM Attribute of a domain
...MyMatDomName = MyDomainMat.GetAttributeValue("V_description")...
9.Set a PLM Attribute of a domain
...MyMatDomName = "Modified by User"MyDomainMat.SetAttributeValue ("V_description", MyMatDomName)...
10.Retrieve Material Domain Content
...MyMaterialDomainContent = MyDomainMat.MaterialDomainContent...
Applying a Material with Domains on a 3D Part
Before you begin: Note that:
lYou should first launch CATIA and then import and open the CAAScdMat3DPart.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdMat\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
Where to find the macro: CAAScdMatApplyMatSource.htm
Related TopicsMaterial Definition Object Model Map
This use case can be divided in twelve steps:
1.Open the 3DPart2.Create the compose link used for the apply material3.Retrieves the Material Service4.Material and Domain Creation5.Apply a Covering and Core Material on Root Occurrence6.Apply a Covering and Core Material on RepInstance7.Apply a Covering and Core Material on Feature
Page 29 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 30 ---

8.Get Applied-Material on Root Occurrence9.Get Applied-Material on RepInstance10.Get Applied-Material on Feature11.Remove Applied Covering Material12.Remove Applied Core Material
1.Retrieves the 3DPart Service
... Dim My3DPartService   As  PLMNewServiceSet My3DPartService = CATIA.GetSessionService("PLMNewService")...
2.Search and Open 3DPart (by its Title, using V_Name attribute)
... oDBSearch.AddEasyCriteria "V_Name", "CAAScdMat3DPart" oSearchService.SearchDim MyEditor3DShape   As  EditorDim cPLMEntities   As  PLMEntitiesSet cPLMEntities = oDBSearch.Results
If cPLMEntities.Count <> 0 Then Set oPLMEntity = cPLMEntities.Item(1)Set oPLMOpenService = CATIA.GetSessionService("PLMOpenService")oPLMOpenService.PLMOpen oPLMEntity,  MyEditor3DShape End If ...
3.Retrieves the active Object
... Dim MyEditor As  PartSet MyEditor= MyEditor3DShape.ActiveObject...
4.Retrieves the VPMRepReference
... Dim MyVPMRepRef   As  VPMRepReferenceSet MyVPMRepRef   = MyEditor.Parent...
5.Retrieves the PartBody
... Dim MyPartBody   As  BodySet MyPartBody   = MyEditor.MainBody...
6.Retrieves the Reference of 3DPart
... Dim MyRootRef   As  VPMReferenceSet MyRootRef   = MyVPMRepRef.Father...
7.Retrieves the RepInstance
... Dim MyRepInstance   As  VPMRepInstanceDim ListInstance    As  VPMRepInstancesSet ListInstance    = MyRootRef.RepInstancesSet MyRepInstance   = ListInstance.Item(1)...
8.Retrieves the Product Service
... Dim MyProductService   As  PLMNewServiceSet MyProductService   = CATIA.GetSessionService("PLMProductService")...
9.Retrieves the Root Occurrence
... Dim MyVPMRootOcc   As  VPMRootOccurrenceSet MyVPMRootOcc   = MyProductService.RootOccurrence...
10.Create the compose link used for the apply material
The apply material can be done on Root Occurrence, RepInstance or PartBody. For each case, you need to compose a link that points a target : 
... Dim NoRef      As  VPMReferenceDim NoRepInst  As  PLMEntityDim NoOcc      As  VPMOccurrence...
- Root Occurrence :  the RepInstance and Reference have to be NULL
... Dim myLinkOnRootOcc  As AnyObjectSet myLinkOnRootOcc  = MyProductService.ComposeLink(MyVPMRootOcc, Nothing, Nothing)...
- RepInstance :  the VPMReference and Reference have to be NULL
Page 30 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 31 ---

... Dim myLinkOnRepInst   As AnyObjectSet myLinkOnRepInst   = MyProductService.ComposeLink(Nothing, MyRepInstance, Nothing)...
- Feature (PartBody, ...) : the VPMReference has to be NULL, but not the RepInstance. In automation, the feature is a CATIAReference, you have to not confuse it with VPMReference.
... Dim myLinkOnFeature  As AnyObject' Create a CATIAReference from Object ( as Body, etc ...)Set MyReference      = MyEditor.CreateReferenceFromObject(MyPartBody)Set myLinkOnFeature  = MyProductService.ComposeLink(Nothing, MyRepInstance, MyReference)...
11.Retrieves the Material Service
... Dim MatService   As  MATPLMServiceSet MatService   = CATIA.GetSessionService("MATPLMService")...
12.Material and Domain Creation
The material and domain creation is not described in this page. You can found it in CAAScdMatCreateMat.htm.
13.Apply a Covering and Core Material on Root Occurrence
Before that you need to compose your link thanks to Product Service. here
...Dim MyCoveringAppliedMat   As AppliedMaterialDim MyCoreAppliedMat       As AppliedMaterial
' Apply covering material on Root OccurrenceMatService.SetMaterialCovering myLinkOnRootOcc, MyCoveringMatRef, MyCoveringAppliedMat
' Apply core material on Root OccurrenceMatService.SetMaterialCore myLinkOnRootOcc, MyCoreMatRef, MyCoreAppliedMat...
14.Apply a Covering and Core Material on RepInstance
Before that you need to compose your link thanks to Product Service. here
...Dim MyCoveringAppliedMat   As AppliedMaterialDim MyCoreAppliedMat       As AppliedMaterial
' Apply covering material on RepInstanceMatService.SetMaterialCovering myLinkOnRepInst, MyCoveringMatRef, MyCoveringAppliedMat
' Apply core material on RepInstanceMatService.SetMaterialCore myLinkOnRepInst, MyCoreMatRef, MyCoreAppliedMat...
15.Apply a Covering and Core Material on Feature
Before that you need to compose your link thanks to Product Service. here
...Dim MyCoveringAppliedMat   As AppliedMaterialDim MyCoreAppliedMat       As AppliedMaterial
' Apply covering material on PartBodyMatService.SetMaterialCovering myLinkOnFeature, MyCoveringMatRef, MyCoveringAppliedMat
' Apply core material on PartBodyMatService.SetMaterialCore myLinkOnFeature, MyCoreMatRef, MyCoreAppliedMat...
16.Get Applied-Material on Root Occurrence
Before that you need to compose your link thanks to Product Service. here
...' Materials and Applied-Material for Covering MaterialDim MyCoveringMatRefList      As ListObjectDim MyCoveringAppliedMatList  As AppliedMaterials' Applied-Material for Core MaterialDim MyCoreAppliedMat          As AppliedMaterial
' Get Covering Material and Applied-Material on Root OccurrenceMatService.GetMaterialCovering myLinkOnRootOcc, MyCoveringMatRefList, MyCoveringAppliedMatList
' Get Core Material and Applied-Material on Root OccurrenceMatService.GetMaterialCore myLinkOnRootOcc, MyCoreMatRef, MyCoreAppliedMat...
17.Get Applied-Material on RepInstance
Before that you need to compose your link thanks to Product Service. here
...' Materials and Applied-Material for Covering MaterialDim MyCoveringMatRefList      As ListObjectDim MyCoveringAppliedMatList  As AppliedMaterials' Applied-Material for Core MaterialDim MyCoreAppliedMat          As AppliedMaterial
Page 31 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 32 ---

' Get Covering Material and Applied-Material on RepInstanceMatService.GetMaterialCovering myLinkOnRepInst, MyCoveringMatRefList, MyCoveringAppliedMatList
' Get Core Material and Applied-Material on RepInstanceMatService.GetMaterialCore myLinkOnRepInst, MyCoreMatRef, MyCoreAppliedMat...
18.Get Applied-Material on Feature
Before that you need to compose your link thanks to Product Service. here
...' Materials and Applied-Material for Covering MaterialDim MyCoveringMatRefList      As ListObjectDim MyCoveringAppliedMatList  As AppliedMaterials' Applied-Material for Core MaterialDim MyCoreAppliedMat          As AppliedMaterial
' Get Covering Material and Applied-Material on FeatureMatService.GetMaterialCovering myLinkOnFeature, MyCoveringMatRefList, MyCoveringAppliedMatList
' Get Core Material and Applied-Material on FeatureMatService.GetMaterialCore myLinkOnFeature, MyCoreMatRef, MyCoreAppliedMat...
19.Remove Applied Covering Material
...' Materials and Applied-Material for Covering MaterialDim MyCoveringAppliedMat      As AppliedMaterialDim MyCoveringMatRefList      As ListObjectDim MyCoveringAppliedMatList  As AppliedMaterials
' Get Covering Material and Applied-Material on FeatureMatService.GetMaterialCovering myLinkOnFeature, MyCoveringMatRefList, MyCoveringAppliedMatList
' Get the first Applied-Material of listSet MyCoveringAppliedMat = MyCoveringAppliedMatList.Item(1)
' Remove the applied covering materialMatService.RemoveAppliedMaterial MyCoveringAppliedMat...
20.Remove Applied Core Material
...' Applied Coe Material and Core MaterialDim MyCoreAppliedMat  As AppliedMaterialDim MyCoreMatRef      As Material
' Get Core Material and Applied Core MaterialMatService.GetMaterialCore myLinkOnFeature, MyCoreMatRef, MyCoreAppliedMat
' Remove the applied core materialMatService.RemoveAppliedMaterial MyCoreAppliedMat...
Applying a Material with Domains on a 3D Part
Before you begin: Note that:
lYou should first launch CATIA. 
limport theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolderis the folder where the API CD-ROM is installed.
lOpen any part of the PumpModel 
lLaunch the structural scenario App and create a structural simulation.
Where to find the macro: CAAScdMatApplyMatWithPythonSource.htm
Related TopicsMaterial Definition Object Model Map
This use case can be divided in twelve steps:
1.Retrieves the simulation, its model and creates the different links2.Retrieves the Material Service3.Create Covering and Core Material4.Apply Covering and Core Material5.Retrieve Covering and Core Material 6.Remove Applied Material
1.Retrieves the simulation, its model and creates the different links
As a first step, the UC retrieves the active editor and retrieves the simulation model.
...myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the root occurence.
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditor
Page 32 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 33 ---

MyProductService = myProductEditor.GetService("PLMProductService")
myEntities = MyProductService.EditedContentmyRootProduct = myEntities.Item(1)
myRootOccurrence = MyProductService.RootOccurrence...
The apply material can be done on Root Occurrence, RepInstance or PartBody. For each case, you need to compose a link that points a target.
As next step, the UC compose the needed links
...MyActiveObject = myProductEditor.ActiveObjectMyVPMRepRef = MyActiveObject.ParentMyPartBody = MyActiveObject.MainBodyMyRootRef = MyVPMRepRef.FatherListInstance = MyRootRef.RepInstancesMyRepInstance = ListInstance.Item(1)...
Root Occurrence : the RepInstance and Reference have to be NULL
...myLinkOnRootOcc = MyProductService.ComposeLink(myRootOccurrence, None, None)...
RepInstance : the VPMReference and Reference have to be NULL
...myLinkOnRepInst = MyProductService.ComposeLink(None, MyRepInstance, None)...
Feature (PartBody, ...) : the VPMReference has to be NULL, but not the RepInstance. 
In automation, the feature is a CATIAReference, you have to not confuse it with VPMReference.
...MyReference     = MyActiveObject.CreateReferenceFromObject(MyPartBody)myLinkOnFeature = MyProductService.ComposeLink(None, MyRepInstance, MyReference)...
2.Retrieves the Material Service
... MyMaterialService = CATIA.GetSessionService("MATPLMService")...
3.Create Covering and Core Material
In this step UC creates a core and covering material
First it Creates a Covering Material
... MyCoveringMatRef, MyMaterialEditor = MyMaterialService.PLMCreate ("dsc_matref_ref_Covering", None, None)...
Then it Adds Domain to coverin Material
...MyListCovMatDomains = MyCoveringMatRef.GetDomains(None)MyDomain = MyListCovMatDomains.Add ("dsc_matref_rep_Rendering", None)...
it Creates a core Material
...MyCoreMatRef, MyMaterialEditor = MyMaterialService.PLMCreate ("dsc_matref_ref_Core", None, None)
Then Adds Domain to Core Material
It is described in CAAScdMatCreateMatWithPython.htm.
MyListCoreMatDomains = MyCoreMatRef.GetDomains (None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Rendering",  None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Composite",  None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_Drafting",   None)MyDomain = MyListCoreMatDomains.Add ("dsc_matref_rep_SmaOptions", None)return MyCoveringMatRef, MyCoreMatRef...
4.Apply Covering and Core Material 
It first Applies a Core and Covering Material on Root Occurrence
... MyCoveringAppliedMat = MyMaterialService.SetMaterialCovering (myLinkOnRootOcc, iMyCoveringMatRef, None)MyCoreAppliedMat = MyMaterialService.SetMaterialCore (myLinkOnRootOcc, iMyCoreMatRef, None)...
then Applies a Core and Covering Material on RepInstance
...MyCoveringAppliedMat = MyMaterialService.SetMaterialCovering (myLinkOnRepInst, iMyCoveringMatRef, None)MyCoreAppliedMat = MyMaterialService.SetMaterialCore (myLinkOnRepInst, iMyCoreMatRef, None)...
Page 33 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 34 ---

The Material Simulation Domain
The data model and navigation APIs for the Material Simulation Domain are shown below:
Finally Applies a Core and Covering Material on Feature
...MyCoveringAppliedMat = MyMaterialService.SetMaterialCovering (myLinkOnFeature, iMyCoveringMatRef, None)MyCoreAppliedMat = MyMaterialService.SetMaterialCore (myLinkOnFeature, iMyCoreMatRef, None) ...
5.Retrieve Covering and Core Material 
First UC retrieves Applied Material on Root Occurrence 
... MyCoreMatRef, MyCoreAppliedMat = MyMaterialService.GetMaterialCore (myLinkOnRootOcc, None, None)MyCoveringMatRefList, MyCoveringAppliedMatList = MyMaterialService.GetMaterialCovering (myLinkOnRootOcc, None, None)...
Then Retrieves Applied Material on RepInstance
...MyCoreMatRef, MyCoreAppliedMat = MyMaterialService.GetMaterialCore (myLinkOnRepInst, None, None)MyCoveringMatRefList, MyCoveringAppliedMatList = MyMaterialService.GetMaterialCovering (myLinkOnRepInst, None, None)
Finally Retrieves Applied Material on Feature
...MyCoreMatRef, MyCoreAppliedMat = MyMaterialService.GetMaterialCore (myLinkOnFeature, None, None)MyCoveringMatRefList, MyCoveringAppliedMatList = MyMaterialService.GetMaterialCovering (myLinkOnFeature, None, None)...
6.Remove Applied Material
First, UC retrieves Applied Material on Root Occurrence
...MyCoreMatRef, MyCoreAppliedMat = MyMaterialService.GetMaterialCore (myLinkOnRootOcc, None, None) MyCoveringMatRefList, MyCoveringAppliedMatList = MyMaterialService.GetMaterialCovering (myLinkOnRootOcc, None, None)...
Then, remove Applied Core Material on Root Occurrence
...MyMaterialService.RemoveAppliedMaterial (MyCoreAppliedMat)...
Finally Removes Applied Covering Material on Root Occurrence
...iMaxCnx = MyCoveringAppliedMatList.Count
for index inrange(1, iMaxCnx+1):    MyCoveringAppliedMat = MyCoveringAppliedMatList.Item(index)    MyMaterialService.RemoveAppliedMaterial (MyCoveringAppliedMat)...
Material Simulation Domain representationTechnical Article
Abstract
This article's main goal is to help partners understand the data model of the simulation material domain object and identify the APIs necessary to navigate it.
lMaterial Simulation Domain
Fig1: Material Simulation Domain navigation graph
Page 34 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 35 ---

Use theMaterialDomainContent property theMaterialDomain object to return aSimMaterialDomain object.
Dim oMaterialDomain As MaterialDomain...Dim oSimMaterialDomain As SimMaterialDomainSet oSimMaterialDomain = oMaterialDomain.MaterialDomainContent
...oSimMaterialDomain = oMaterialDomain.MaterialDomainContent...
From the SimMaterialDomain object, use the:
lBehaviors property to return theSimMaterialBehaviors collection 
lOptions property to return the SimMaterialOptions collection. See theSimMaterialOptions Collection to know which option objects can be created in or retrieved from this collection. 
SimMaterialDomain ObjectSee AlsoLegend
VBAPython
SimMaterialOptions CollectionSee AlsoLegend
Page 35 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 36 ---

Use theOptions property the SimMaterialDomain object to return a SimMaterialOptions collection.
Dim oSimMaterialDomain As SimMaterialDomain...Dim cSimMaterialOptions As SimMaterialOptionsSet cSimMaterialOptions = oSimMaterialDomain.Options
...cSimMaterialOptions = oSimMaterialDomain.Options...
Use the Add method of theSimMaterialOptions collection to create a new simulation material option, such as a SimAcousticAbsorption object.
Dim oSimAcousticAbsorption As SimAcousticAbsorptionSet oSimAcousticAbsorption = cSimMaterialOptions.Add("SimAcousticAbsorption")
...oSimAcousticAbsorption = cSimMaterialOptions.Add("SimAcousticAbsorption")...
See Creation Late Types for Material Features to know how you can create the simulation material options.
Use theMaterialTable property of one of its aggregating object, such as a SimAcousticAbsorption object, to return aSimMaterialTable object.
Dim oSimAcousticAbsorption As SimAcousticAbsorption...Dim oSimMaterialTable As SimMaterialTableSet oSimMaterialTable = oSimAcousticAbsorption.MaterialTable
...oSimMaterialTable = oSimAcousticAbsorption.MaterialTable...
VBAPython
VBAPython
SimMaterialTable ObjectSee AlsoLegend
VBAPython
Creating and Modifying Simulation Material DomainThis use case primarily focuses on the methodology to create or modify a simulation material domain.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
Where to find the macro: CAAScdFeaSimulationMaterialDomainSource.htm
This use case can be divided in six steps:
1.Retrieving the active product2.Creating Material3.Creating Simulation domain4.Creating material option and assign data
Page 36 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 37 ---

5.Creating Behavior and add options in behavior6.Assigning material to part
1.Retrieving the active product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Creating Material
In this step UC creates a material reference.
...Dim myMaterialService As MATPLMServiceSet myMaterialService = CATIA.GetSessionService("MATPLMService")
Dim myCoreMatRef  As MaterialDim myMaterialEditor As EditormyMaterialService.PLMCreate "dsc_matref_ref_Core", myCoreMatRef, myMaterialEditor...
3.Creating Simulation domain
In this step UC creates simulation domain in the material.
...Dim myDomainList As MaterialDomainsmyCoreMatRef.GetDomains myDomainList
Dim myDomain As MaterialDomainmyDomainList.Add "dsc_matref_rep_SmaOptions", myDomain
Dim mySimDomain As SimMaterialDomainSet mySimDomain = myDomain.MaterialDomainContent...
4.Creating material options and assign data
In this step UC creates new density and elasticity material options.
...Dim myMaterialOptions As SimMaterialOptionsSet myMaterialOptions = MySimDomain.Options
' Creation of a density material option
Dim myDensity As SimDensitySet myDensity = myMaterialOptions.Add("SimDensity")
Dim myDensityColumn As SimTableColumnSet myDensityColumn = myDensity.GetMaterialTableColumn(SimDensityDensity)myDensityColumn.SetCellData 1, 7870
' Creation of an elasticity material option
Dim myElastic As SimElasticSet myElastic = myMaterialOptions.Add("SimElasticity")
myElastic.ElasticType = SimElasticIsotropicmyElastic.ModuliTimeScaletype = SimElasticLongTerm
Dim myYoungsModulusColumn As SimTableColumnSet myYoungsModulusColumn = myElastic.GetMaterialTableColumn(SimElasticYoungsModulus)myYoungsModulusColumn.SetCellData 1, 211000000000.0
Dim myPoissonsRatioColumn As SimTableColumnSet myPoissonsRatioColumn = myElastic.GetMaterialTableColumn(SimElasticPoissonsRatio)myPoissonsRatioColumn.SetCellData 1, 0.291...
You can find the available late types for material options creation in the Creation Late Types for Material Features article. 
5.Creating Behavior and add options in behavior
In this step UC creates a material behavior and add options in it. 
...Dim myBehaviors As SimMaterialBehaviorsSet myBehaviors = mySimDomain.Behaviors
Dim myBehavior As MaterialBehaviorSet myBehavior = myBehaviors.Add
Dim myBehaviorOptions As MaterialBehaviorOptionsSet myBehaviorOptions = myBehavior.BehaviorOptions
myBehaviorOptions.Add myDensity, 1myBehaviorOptions.Add myElastic, 2
Page 37 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 38 ---

...
6.Assigning material to part
In this step UC assigns the created material to a part.
...' Retrieve the Root Occurrence and the Part Instance
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myInstances As VPMInstancesSet myInstances = myRootProduct.Instances
Dim myInstance As VPMInstanceSet myInstance = myInstances.Item(1)
Dim myInstanceRef As VPMReferenceSet myInstanceRef = myInstance.ReferenceInstanceOf
Dim myRepInstances As VPMRepInstancesSet myRepInstances = myInstanceRef.RepInstances
Dim myPartRepInstance As VPMRepInstanceSet myPartRepInstance = myRepInstances.Item(1)
' Creating link to the part instance
Dim myLinkToPartInstance As AnyObjectSet myLinkToPartInstance = myProdService.ComposeLink(myRootOccurrence, myPartRepInstance, Nothing)
' Assigning material
Dim myCoreAppliedMaterial As AppliedMaterialmyMaterialService.SetMaterialCore myLinkToPartInstance, myCoreMatRef, myCoreAppliedMaterial...
Creating and Modifying Simulation Material DomainThis use case primarily focuses on the methodology to create or modify a simulation material domain.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaSimulationMaterialDomainWithPythonSource.htmThis use case can be divided in six steps:
1.Retrieves the simulation and its product2.Creates Material3.Creates Simulation domain4.Creates material option and assign data5.Creates Behavior and add options in behavior6.Assign material to part
1.Retrieves the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model. 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the root occurence.
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myEntities = MyProductService.EditedContentmyRootProduct = myEntities.Item(1)
myRootOccurrence = MyProductService.RootOccurrence...
2.Creates Material
In this step UC creates a material reference.
...myMaterialService = CATIA.GetSessionService("MATPLMService")myCoreMatRef, myMaterialEditor = myMaterialService.PLMCreate ("dsc_matref_ref_Core", None, None)...
3.Creates Simulation domain
In this step UC creates simulation domain in the material.
Page 38 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 39 ---

Material Options Late Types
Material options creation is managed by the SimMaterialOptions object by calling theAdd method from it.
A "late type" must be given to indicate which type of material option is to be created:
...myDomainList = myCoreMatRef.GetDomains (None)myDomain = myDomainList.Add ("dsc_matref_rep_SmaOptions", None)mySimDomain = myDomain.MaterialDomainContent...
4.Creates material options and assign data
In this step UC creates new density and elasticity material options.
...myMaterialOptions = mySimDomain.Options
# Creation of a density material option
myDensity = myMaterialOptions.Add("SimDensity")
myDensityColumn = myDensity.GetMaterialTableColumn(win32com.client.constants.SimDensityDensity)
myDensityColumn.SetCellData (1, 7870)
# Creation of an elasticity material option
myElastic = myMaterialOptions.Add("SimElasticity")
myElastic.ElasticType = win32com.client.constants.SimElasticIsotropicmyElastic.ModuliTimeScaletype = win32com.client.constants.SimElasticLongTerm
myYoungsModulusColumn = myElastic.GetMaterialTableColumn(win32com.client.constants.SimElasticYoungsModulus)
myYoungsModulusColumn.SetCellData (1, 211000000000.0)
myPoissonsRatioColumn = myElastic.GetMaterialTableColumn(win32com.client.constants.SimElasticPoissonsRatio)myPoissonsRatioColumn.SetCellData (1, 0.291)...
You can find the available late types for material options creation in the Creation Late Types for Material Features article. 
5.Creates Behavior and add options in behavior
In this step UC creates a material behavior and add options in it. 
...myBehaviors = mySimDomain.Behaviors
myBehavior = myBehaviors.Add()
myBehaviorOptions = myBehavior.BehaviorOptions
myBehaviorOptions.Add (myDensity, 1)myBehaviorOptions.Add (myElastic, 2)...
6.Assign material to part
In this step UC assigns the created material to a part.
...# Retrieve the Part InstancemyInstances = myRootProduct.Instances
myInstance = myInstances.Item(1)
myInstanceRef = myInstance.ReferenceInstanceOf
myRepInstances = myInstanceRef.RepInstances
myPartRepInstance = myRepInstances.Item(1)
# Creating link to the part instancemyLinkToPartInstance = MyProductService.ComposeLink(myRootOccurrence, myPartRepInstance, None)
# Assigning materialmyCoreAppliedMaterial = myMaterialService.SetMaterialCore (myLinkToPartInstance, myCoreMatRef, None)...
Creation Late Types for Material FeaturesQuick ReferenceAbstract
The following reference article documents the different late types that can be used to create material features.
lMaterial Options Late Types
Related TopicsSimMaterialOptions Collection
Material optionLate typeIsotropic ConductivitySimConductivity 
Density SimDensityElastic SimElasticityExpansion SimExpansion
Page 39 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 40 ---

 Available with the RBM - Simulation Scripting product only.
History
Use the SearchService object to retrieve a simulation from the database, the PLMOpenService object to open it, and the PLMProductService object to retrieve the root SimulationReference object.
' Search the database and retrieve a simulation objectDim oSearchService As SearchServiceSet oSearchService = CATIA.GetSessionService("Search")
Dim oDatabaseSearch As DatabaseSearchSet oDatabaseSearch = oSearchService.DatabaseSearch
oDatabaseSearch.BaseType = "SIMObjSimulationObjectGenericDS"oDatabaseSearch.AddEasyCriteria "PLM_ExternalID", "TSTSimulation"oSearchService.Search
Dim cPLMEntities As PLMEntitiesSet cPLMEntities = oDatabaseSearch.Results
Dim oPLMEntity As PLMEntitySet oPLMEntity = cPLMEntities.Item(1) 
' Open the simulation object from the databaseDim oOpenService As PLMOpenServiceSet oOpenService = CATIA.GetSessionService("PLMOpenService")
Dim oEditor As EditoroOpenService.PLMOpen oPLMEntity, oEditor
' Retrieve the root SimulationReference objectDim oProdService As PLMProductServiceSet oProdService = oEditor.GetService("PLMProductService")
Dim cPLMSimEntities As PLMEntitiesSet cPLMSimEntities = oProdService.EditedContent
Dim oSimulationRoot As SimulationReferenceSet oSimulationRoot = cPLMSimEntities.Item(1)
For the Python case, the simulation product is already opened 
The code below describe how to get the simulation root reference and how to get the simulation Model
...# Retrieve the active editoroSimulationEditor = CATIA.ActiveEditor
# Retrieve the root SimulationReference objectoProdService = oSimulationEditor.GetService("PLMProductService")cPLMSimEntities = oProdService.EditedContent
Gasket Membrane ElasticSimGasketMembraneElasticGasket Thickness BehaviorSimGasketThicknessBehaviorGasket Transverse Shear ElasticSimGasketTransverseShearElasticHashin Damage SimHashinDamagePlastic SimPlasticityCast Iron Plasticity SimCastIronPlasticityDamping SimDampingBulk Modulus SimBulkModulusSpecific Heat SimSpecificHeatInelastic Heat FractionSimInelasticHeatFractionLatent Heat SimLatentHeatVolumetric Drag SimVolumetricDragAcoustic AbsorptionSimAcousticAbsorption
Version: 1 [Jan 2015]Document created
Multiphysics Common Services Object Model MapSee AlsoLegend
VBAPython
Page 40 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 41 ---

oSimulationRoot = cPLMSimEntities.Item(1)
# retrieve the simulation modelmyModel = oSimulationRoot.Model...
Simulation PLM Object to Managers
The simulation PLM object is the root feature for any simulation. The following figure describes the data model and navigation APIs from the simulation PLM object to individual managers.
The FEM Representation Manager
The FEM representation manager contains all the meshes and associated properties necessary to describe the simulation model. The data model and navigation APIs for the FEMRep manager are shown below:
Scenario RepresentationTechnical Article
Abstract
This article's main goal is to help partners understand the data model of the simulation PLM object and identify the APIs necessary to navigate it.
In order to better depict the relationships, the data model and navigation behavior is described through the following five sub-sections:
lSimulation PLM Object to Managers
lThe FEM Representation Manager
lThe Engineering Connection Manager
lThe Scenario Manager
lThe Results Manager
Fig1: Simulation PLM Object to Managers
Fig2: FEM Representation Manager to the Model Features
Page 41 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 42 ---

The Engineering Connection Manager
The Engineering connection manager contains all the engineering connections and associated properties necessary to describe the simulation model. The data model and navigation APIs for the Engineering connection manager are shown below:
The Scenario Manager
The scenario manager contains all the pre-processing features necessary to describe the simulation scenario. The data model and navigation APIs for the scenario manager are shown below:
The Results Manager
The results manager contains all the simulation results and the post-processing features necessary to describe the simulation results. The data model and navigation APIs for the results manager is shown below:
Fig3: Engineering Connection Manager to the Model Features
Fig4: Scenario Manager to the Scenario Features
Fig5: Results Manager to the Results Features
Page 42 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 43 ---

ABAQUS Input File exporter/importer
The ABAQUS Input File exporter/importer Keys
The ABAQUS Input File exporter parameters Keys
The ABAQUS Input File importer parameters Keys
NASTRAN Bulk Data exporter/importer
The NASTRAN Bulk Data exporter/importer Keys
DS Exporter and Importer optionsTechnical ArticleAbstract
The following reference article describes the different options for the DS importer/exporter and their usage.
This paper explains the options for:
lThe ABAQUS Input File exporter/importer.
¡The ABAQUS Input File exporter/importer Keys.
¡The ABAQUS Input File exporter parameters Keys.
¡The ABAQUS Input File importer parameters Keys.
lThe NASTRAN Bulk Data exporter/importer.
¡The NASTRAN Bulk Data exporter/importer Keys.
¡The NASTRAN Bulk Data exporter parameters Keys.
¡The NASTRAN Bulk Data importer parameters Keys.
CategoryExporterImporterModelModel2AbaqusAbaqus2ModelScenarioScenario2AbaqusAbaqus2ScenarioResultsResults2Odb
Parameter Keys Description TypePossible optionsAllowOverwriteAllows to overwrite an existing file. Integer0 | 1CreateLogFileCreate a Log File. Integer0 | 1LogFolderPathLog File Path. String
FluidFormulationChanges the mesh element types exported to support appropriate use in an Abaqus input file.
Only for Model2Abaqus exporter. Integer0 | 1
PrintPartNameExport the mesh data for each mesh part separately for the "Mesh of Assembly" finite element representation.
Only for Model2Abaqus exporter. Integer0 | 1
Parameter Keys Description TypePossible optionsCreateLogFileCreate a Log File. Integer0 | 1LogFolderPathLog File Path. String
StructuringOptionNone : Generates a mesh part per mesh dimension.
Section : Generates a mesh part per property.StringNone | Section
ConnectorImportImport all connector-related objects.Integer0 | 1
Page 43 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 44 ---

The NASTRAN Bulk Data exporter parameters Keys
The NASTRAN Bulk Data importer parameters Keys
CategoryExporterImporterModelModel2NastranNastran2ModelScenarioScenario2NastranNastran2Scenario
Parameter Keys Description TypePossible optionsGranularityGroups Export groups (Only elements and nodes groups are supported). Integer1 | 0
GroupsLabel SET to write the groups before the bulk data in the output file.
SET1 to write the groups after the bulk data. StringSET | SET1
GranularityMaterials Export materials. Integer1 | 0MaterialsStartingID Starting index for the numbering of the exported materials. Integer>=1GranularityProperties Export properties. Integer1 | 0PropertiesStartingID Starting index for the numbering of the exported properties. Integer>=1
GranularitySpecialElementsElement connectivity and specifications are exported according to hard-codedtranslation. Integer1 | 0
AnalysisCase Export analysis case. Integer1 | 0
AnalysisCaseSteps Specify list of steps to be exported. Array ofIntegerAnalysisCaseGranularityRestraintsExport restraints. Integer1 | 0AnalysisCaseGranularityLoadsExport loads. Integer1 | 0AnalysisCaseGranularityOutputsExport outputs. Integer1 | 0AnalysisCaseGranularityInitialsExport initial conditions. Integer1 | 0
OptionsParamPost Instruct Nastran about generation of output files. String
PARAM,POST,-1 $ original OP2
PARAM,POST,-2 $ general OP2
PARAM,POST,0 $ XDB
PARAM,POST,1 $ implicit OP2
Not Enabled
OptionsExportFormat Sets the format for bulk data in exported file StringFree field|Fixed small fieldFixed large field
OptionsBeamProperties
YES: Exports beam properties into CBEAM and PBEAM/PBEAML data cardsonly.
NO : Exports beam properties into a mix of BAR and BEAM data cards based on whether it is a Euler-Bernoulli or Timoshenko in Abaqus.
StringYES |NO
OptionsAxialSpring
CELAS1/PELAS : Exports axial connectors and springs into CELAS1 elements and PELAS properties.
CELAS2: Exports axial connectors and springs into elements without reference to a property entry.
StringCELAS2 |CELAS1/PELAS
OptionsComposite Exports the composite properties to PCOMP or PCOMPG. StringPCOMP | PCOMPG
OptionsCompositeFailureTheorySets the failure theory for the FT field in PCOMP or PCOMPG. String
Blank | Hill | Hoffman|
Tsai-wu | MaximumStrain
OptionsCompositeStressStrainOutputForPliesSets the stress/strain output request field for all the plies in all thePCOMP/PCOMPG cards. StringNO | YES
OptionsCompositeMaximumStrainTheoryThis determines Xt, Xc, Yt, Yc, and S fields at MAT8 are stress or strainallowables. StringSTRESS | STRAIN
OptionsTruss Exports the truss elemens and associated properties into a CROD/PROD or aCONROD. StringCROD/PROB |CONROD
OptionsBeamConnectorExports a beam connector to CBUSH/PBUSH or RBE2. If exporting to CBUSH/PBUSH data card, one can specify either translational stiffness or rotational stiffness or both, otherwise export would calculate high stiffness values.StringCBUSH/PBUSH |RBE2
OptionsPBUSHTranslationalStiffnessSpecify translational stiffness to be used at CBUSH/PBUSH exporting from beamconnectors. Double
OptionsPBUSHRotationalStiffnessSpecify rotational stiffness to be used at CBUSH/PBUSH exporting from beamconnectors. Double
OptionsUserDefinePBUSHTranslationalStiffnessEnable export to use user specified translational stiffness to be used atCBUSH/PBUSH exporting from beam connectors. Int 0 | 1
OptionsUserDefinePBUSHRotationalStiffnessEnable export to use user specified rotational stiffness to be used atCBUSH/PBUSH exporting from beam connectors. Int 0 | 1
OptionsMaximumIOTimeSpecifies the maximum run time in CPU minutes. Double>=0 | (No value)
Parameter Keys Description TypePossible optionsCreateLogFileCreate a Log File. Integer0 | 1LogFolderPathLog File Path. String
StructuringOptionNone : Generates a mesh part per mesh dimension.StringNone | Section
Page 44 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 45 ---

Section : Generates a mesh part per property.ConnectorImportImport all connector-related objects.Integer0 | 1
Exporting FE DataThis use case primarily focuses on the methodology to export a FEM representation into a formatted inp file.Before you begin: Note that:
lYou should first launch CATIA and import the CAAScdFeaExportFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaSimulation\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lThen, you should open the "CAAScdFeaExportFEM" physical product. You should also check if all representations are loaded and if the FEM Representation isupdated. The export will succeed only if the FEM is updated without errors. 
Where to find the macro: CAAScdFeaExportFEMSource.htmThis use case can be divided in six steps:
1.Retrieve the active editor2.Retrieve the FEM Root3.Retrieve the simulation exporter4.Retrieve the exporter arguments5.Set the export parameters6.Execute the export
1.Retrieve the active editor
As a first step, the UC retrieves the active editor. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor...
2.Retrieve the FEM Root
In the next step, the UC retrieves theSimFemRoot object. We need to iterate on the Rep Instances to find the FEM Root object.
 ...Dim myContext As PLMProductServiceSet myContext = myEditor.GetService("PLMProductService")Dim myFEMRoot As SimFemRootFor Each myEntity In myContext.EditedContentDim myRef As VPMReferenceSet myRef = myEntityDim myReps As VPMRepInstancesSet myReps = myRef.RepInstancesFor Each myRep In myRepsDim myRepRef As VPMRepReferenceSet myRepRef = myRep.ReferenceInstanceOfDim attr As Stringattr = myRepRef.GetAttributeValue("V_discipline")If ( attr = "FEM" ) ThenSet myFEMRoot = myRep.GetItem("SimFemRoot")End IfNextNextIf (IsObject(myFEMRoot) = false) ThenExit SubEnd If ...
3.Retrieve the simulation exporter
In the next step the UC retrieves the FEM representation exporter.
...Dim mySimManagerSIMExport As SimManagerSIMExportSet mySimManagerSIMExport = myFEMRoot.GetItem("SimManagerSIMExport")...
4.Retrieve the exporter arguments
In this step the UC retrieves the arguments object that allow to define the units, the export path, and some other options.
...Dim mySimExportArgs As SimImportExportArgsSet mySimExportArgs = mySimManagerSIMExport.Args...
5.Set the export parameters
In this step the UC defines the export path and the export file name. 
Then the UC defines some specific parameters to the exporter. Refer to DS Exporter and Importer options [1] for further details.
...Dim myExportPath As StringmyExportPath=CATIA.SystemService.Environ("TMP") & "\CAAScdFeaExportFEM.inp"mySimExportArgs.SetPath(myExportPath)
Dim myParameters As SimParameterSetSet myParameters = mySimExportArgs.ParametersmyParameters.SetIntegerParameter "AllowOverwrite", 1myParameters.SetIntegerParameter "PrintPartName", 1...
6.Execute the export
Page 45 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 46 ---

References
In this step the UC executes the export. Refer toDS Exporter and Importer options [1] to find the keys corresponding to the DS exporter/importer.
...mySimManagerSIMExport.Export("Model2Abaqus")...
[1]DS Exporter and Importer options
Exporting FE DataThis use case primarily focuses on the methodology to export a FEM representation into a formatted inp file.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaExportFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaSimulation\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lThen, you should open the "CAAScdFeaExportFEM" physical product. You should also check if all representations are loaded and if the FEM Representation isupdated. The export will succeed only if the FEM is updated without errors. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaExportFEMWithPythonSource.htmThis use case can be divided in six steps:
1.Retrieves the simulation and its product2.Retrieves the FEM Root3.Retrieves the simulation exporter4.Retrieves the exporter arguments5.Sets the export parameters6.Executes the export
1.Retrieves the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model.
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the product service associated to the product editor
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myEntities = MyProductService.EditedContent...
2.Retrieve the FEM Root
In the next step, the UC retrieves theSimFemRoot object. We need to iterate on the Rep Instances to find the FEM Root object.
 ...for myEntity in myEntities:    myRef = myEntity    myReps = myRef.RepInstancesfor myRep in myReps:        myRepRef = myRep.ReferenceInstanceOf        attr = myRepRef.GetAttributeValue("V_discipline")if (attr == "FEM"):            myFEMRoot = myRepRef.GetItem("SimFemRoot")...
3.Retrieves the simulation exporter
In the next step the UC retrieves the FEM representation exporter.
...mySimManagerSIMExport = myFEMRoot.GetItem("SimManagerSIMExport")...
4.Retrieves the exporter arguments
In this step the UC retrieves the arguments object that allow to define the units, the export path, and some other options.
...mySimExportArgs = mySimManagerSIMExport.Args...
5.Sets the export parameters
In this step the UC defines the export pathand the export file name. Then the UC sets a parameter to allow the exporter to overwrite the export file if this one already exists.
...
Page 46 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 47 ---

myExportPath=CATIA.SystemService.Environ("TMP") + "\CAAScdFeaExportFEM.inp"mySimExportArgs.SetPath(myExportPath)
myParameters = mySimExportArgs.Parameters
myParameters.SetIntegerParameter ("AllowOverwrite", 1)...
6.Executes the export
In this step the UC executes the export.
...mySimManagerSIMExport.Export("Model2Abaqus")...
Importing Data into a FEM Rep from an inp FileThis use case primarily focuses on the methodology to import data into a FEM representation from a formatted inp file.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaImportFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaSimulation\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should also copy into the folder pointed by the "TEMP" environment variable the "CAAScdFeaImportFEM.inp.txt" file supplied in the same folder as the 3dxml file. The file extension must be changed to "inp" instead of "txt".
lFinally, you should open the "CAAScdFeaImportFEM" physical product. You should also check if all representations are loaded. 
Where to find the macro: CAAScdFeaImportFEMSource.htmThis use case can be divided in seven steps:
1.Retrieve the active editor2.Retrieve the FEM Root3.Retrieve the simulation importer4.Retrieve the importer arguments5.Set the import parameters6.Manage the import units7.Execute the import
1.Retrieve the active editor
As a first step, the UC retrieves the active editor. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor...
2.Retrieve the FEM Root
In the next step, the UC retrieves theSimFemRoot object. We need to iterate on the Rep Instances to find the FEM Root object.
 ...Dim myContext As PLMProductServiceSet myContext = myEditor.GetService("PLMProductService")Dim myFEMRoot As SimFemRootFor Each myEntity In myContext.EditedContentDim myRef As VPMReferenceSet myRef = myEntityDim myReps As VPMRepInstancesSet myReps = myRef.RepInstancesFor Each myRep In myRepsDim myRepRef As VPMRepReferenceSet myRepRef = myRep.ReferenceInstanceOfDim attr As Stringattr = myRepRef.GetAttributeValue("V_discipline")If ( attr = "FEM" ) ThenSet myFEMRoot = myRep.GetItem("SimFemRoot")End IfNextNextIf (IsObject(myFEMRoot) = false) ThenExit SubEnd If ...
3.Retrieve the simulation importer
In the next step the UC retrieves the FEM representation importer.
...Dim mySimManagerSIMImport As SimManagerSIMImportSet mySimManagerSIMImport = myFEMRoot.GetItem("SimManagerSIMImport")...
4.Retrieve the importer arguments
In this step the UC retrieves the arguments object that allow to define the units, the export path, and some other options.
...Dim mySimImportArgs As SimImportExportArgsSet mySimImportArgs = mySimManagerSIMImport.Args...
5.Set the import parameters
Page 47 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 48 ---

References
In this step the UC defines the import file path. 
Then the UC can defines some specific parameters to the importer. Refer to DS Exporter and Importer options [1] for further details.
...Dim myImportFilePath As StringmyImportFilePath=CATIA.SystemService.Environ("TMP") & "\CAAScdFeaImportFEM.inp"mySimImportArgs.SetPath(myImportFilePath)...
6.Manage the import units
In this step the UC describes the units used into the input file.
...Dim MyMagnitude(0)Dim MyUnits(0)MyMagnitude(0) = "LENGTH"MyUnits(0) = "mm"mySimImportArgs.SetUnits MyMagnitude, MyUnits...
7.Execute the import
In this step the UC executes the import. Refer toDS Exporter and Importer options [1] to find the keys corresponding to the DS exporter/importer.
...mySimManagerSIMImport.Import("Abaqus2Model")...
[1]DS Exporter and Importer options
Importing Data into a FEM Rep from an inp FileThis use case primarily focuses on the methodology to import data into a FEM representation from a formatted inp file.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaImportFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaSimulation\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should also copy into the folder pointed by the "TEMP" environment variable the "CAAScdFeaImportFEM.inp.txt" file supplied in the same folder as the 3dxml file. The file extension must be changed to "inp" instead of "txt".
lYou should open the "CAAScdFeaImportFEM" physical product. You should also check if all representations are loaded. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaImportFEMWithPythonSource.htmThis use case can be divided in seven steps:
1.Retrieves the simulation and its product2.Retrieves the FEM Root3.Retrieves the simulation importer4.Retrieves the importer arguments5.Sets the import parameters6.Manage the import units7.Execute the import
1.Retrieves the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model.
...myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the product service associated to the product editor
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myEntities = MyProductService.EditedContent...
2.Retrieves the FEM Root
In the next step, the UC retrieves theSimFemRoot object. We need to iterate on the Rep Instances to find the FEM Root object.
 ...for myEntity in myEntities:    myRef = myEntity    myReps = myRef.RepInstancesfor myRep in myReps:        myRepRef = myRep.ReferenceInstanceOf        attr = myRepRef.GetAttributeValue("V_discipline")
Page 48 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 49 ---

if (attr == "FEM"):            myFEMRoot = myRepRef.GetItem("SimFemRoot")...
3.Retrieves the simulation importer
In the next step the UC retrieves the FEM representation importer.
...mySimManagerSIMImport = myFEMRoot.GetItem("SimManagerSIMImport")...
4.Retrieves the importer arguments
In this step the UC retrieves the arguments object that allow to define the units, the export path, and some other options.
...mySimImportArgs = mySimManagerSIMImport.Args...
5.Sets the import parameters
In this step the UC defines the folder path where the importer can find the input file. Then the UC sets a parameter to allow the exporter to overwrite the export file if this one already exists.
...myImportFilePath=CATIA.SystemService.Environ("TMP") +  "\CAAScdFeaImportFEM.inp"mySimImportArgs.SetPath(myImportFilePath)...
6.Manage the import units
In this step the UC describes the units used into the input file.
...MyMagnitude = []MyUnits = []
MyMagnitude.append("LENGTH")MyUnits.append("mm")mySimImportArgs.SetUnits (MyMagnitude, MyUnits)...
7.Executes the import
In this step the UC executes the import.
...mySimManagerSIMImport.Import("Abaqus2Model")...
Managing Simulation Feature SupportThis article explains how to define and manage simulation feature support.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform a solve operation in the interactive session for a similar simulation toconfirm the licenses. 
Where to find the macro: CAAScdFeaLinkAccessSource.htmThis use case can be divided into seven steps:
1.Retrieving the active Product2.Creating the FEM Rep and Retrieving its Rep Manager3.Creating Sections4.Setting the Meshed Bolt support from Publication5.Setting the Shell Section supports from Product structure6.Replacing the first Shell Section support7.Removing all supports of the Shell Section
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Creating the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product that was just opened.
Page 49 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 50 ---

For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
3.Creating sections
In this step UC creates a shell section and a meshed bolt on the part. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
4.Setting the Meshed Bolt support from the Publication
In this step UC sets the meshed bolt support from the publication.
Note that setting support from publication does not require creations links. You can use the publication directly as an argument for the AddLink method.
... 'Retrieving the publication
Dim myPublications  As VPMPublicationsSet myPublications  = myModel.Publications
Dim mySupport As VPMPublicationSet mySupport = myPublications.GetItem("Bolt-1")
'Setting the meshed bolt support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myMeshedBolt.GetItem("SimLinkAccess")
myLinkAccess.AddLink "MainSupport", mySupport...
Important : Note that the "MainSupport" string is a default value. For connection features you will have to use "PRD1", "PRD2", etc... to set the different supports and "Handler0D" or "Handler1D" for fasteners placements.
5.Setting the shell section supports from the product structure
In this step UC sets the shell section supports from the product structure. It first retrieves usefull data to compose the link to the support and then adds this created link to the feature.
... 'Retrieving the ws3_bolt_part.2 part occurrence
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myPartOccurrence As PLMOccurrenceFor i = 1 to myRootOccurrence.Occurrences.CountIf myRootOccurrence.Occurrences.Item(i).Name = "ws3_bolt_part.2" ThenSet myPartOccurrence = myRootOccurrence.Occurrences.Item(i)End IfNext
'Retrieving the ws3_bolt_part.2 part rep instance
Dim myPartInstance As VPMInstanceSet myPartInstance = myPartOccurrence.InstanceOccurrenceOf
Dim myPartInstanceRef As VPMReferenceSet myPartInstanceRef = myPartInstance.ReferenceInstanceOf
Dim myPartRepInstance As VPMRepInstanceSet myPartRepInstance = myPartInstanceRef.RepInstances.Item(1)
'Retrieving the ws3_bolt_part.2 part body
Dim myPartRepInstanceRef As VPMRepReferenceSet myPartRepInstanceRef = myPartRepInstance.ReferenceInstanceOf
Dim myPart As PartSet myPart = myPartRepInstanceRef.GetItem("Part")
Dim myPartBody As BodySet myPartBody = myPart.MainBody
'Composing link to the ws3_bolt_part.2 part body
Dim myReference As ReferenceSet myReference = myPart.CreateReferenceFromObject(myPartBody)
Dim myLinkToFirstSupport As AnyObjectSet myLinkToFirstSupport = myProdService.ComposeLink(myPartOccurrence, myPartRepInstance, myReference)
'Setting the shell section first support
Set myLinkAccess = myShellSection.GetItem("SimLinkAccess")
myLinkAccess.AddLink "MainSupport", myLinkToFirstSupport...
6.Replacing the first Shell Section support
In this step UC replaces the first shell section support. 
... 'Retrieving the publication
Dim myNewSupport As VPMPublicationSet myNewSupport = myPublications.GetItem("Pipe")
'Removing first support
Page 50 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 51 ---

myLinkAccess.RemoveLink "MainSupport", myLinkToFirstSupport
'Setting the new support
myLinkAccess.AddLink "MainSupport", myNewSupport...
7.Removing all supports of the Shell Section
In this step UC removes all supports of the shell section. 
... myLinkAccess.RemoveAllLinks "MainSupport"...
Managing Simulation Feature SupportThis article explains how to define and manage simulation feature support.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
lMake sure that you have all of the licenses required for launching execution and perform a solve operation in the interactive session for a similar simulation toconfirm the licenses. 
Where to find the macro: CAAScdFeaLinkAccessWithPythonSource.htmThis use case can be divided into seven steps:
1.Retrieves the simulation and its product2.Creates the FEM Rep and retrieves its Rep Manager3.Creates sections4.Sets the meshed bolt support from publication5.Sets the shell section supports from product structure6.Replaces the first shell section support7.Removes all supports of the shell section
1.Retrieves the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model.
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the root assembly
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myEntities = MyProductService.EditedContentmyAssembly = myEntities.Item(1)...
2.Creates the FEM Rep and retrieves its Rep Manager
In this step UC creates a finite element representation model on the product that was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
3.Creates sections
In this step UC creates a shell section and a meshed bolt on the part. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
4.Sets the meshed bolt support from publication
In this step UC sets the meshed bolt support from the publication.
Note that setting support from publication does not require creations links. You can use the publication directly as an argument for the AddLink method.
... # Retrieves the publicationmyPublications  = myAssembly.PublicationsmySupport = myPublications.GetItem("Bolt-1")
# Sets the meshed bolt supportmyLinkAccess = myMeshedBolt.GetItem("SimLinkAccess")myLinkAccess.AddLink ("MainSupport", mySupport)...
Important : Note that the "MainSupport" string is a default value. For connection features you will have to use "PRD1", "PRD2", etc... to set the different supports and "Handler0D" or "Handler1D" for fasteners placements.
Page 51 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 52 ---

5.Sets the shell section supports from product structure
In this step UC sets the shell section supports from the product structure. It first retrieves usefull data to compose the link to the support and then adds this created link to the feature.
... # Retrieves the ws3_bolt_part.2 part occurrencemyRootOccurrence = MyProductService.RootOccurrence
iMaxCnt = myRootOccurrence.Occurrences.Count
for index inrange(1, iMaxCnt):if myRootOccurrence.Occurrences.Item(index).Name == "ws3_bolt_part.2":       myPartOccurrence = myRootOccurrence.Occurrences.Item(index)
# Retrieves the ws3_bolt_part.2 part rep instancemyPartInstance = myPartOccurrence.InstanceOccurrenceOfmyPartInstanceRef = myPartInstance.ReferenceInstanceOfmyPartRepInstance = myPartInstanceRef.RepInstances.Item(1)
# Retrieves the ws3_bolt_part.2 part bodymyPartRepInstanceRef = myPartRepInstance.ReferenceInstanceOfmyPart = myPartRepInstanceRef.GetItem("Part")myPartBody = myPart.MainBody
# Composes link to the ws3_bolt_part.2 part bodymyReference = myPart.CreateReferenceFromObject(myPartBody)myLinkToFirstSupport = myProdService.ComposeLink(myPartOccurrence, myPartRepInstance, myReference)
# Sets the shell section first supportmyLinkAccess = myShellSection.GetItem("SimLinkAccess")myLinkAccess.AddLink ("MainSupport", myLinkToFirstSupport)
# Retrieves the ws3_bolt_part.3 part occurrence
for index inrange(1, iMaxCnt):if myRootOccurrence.Occurrences.Item(index).Name == "ws3_bolt_part.3":       myPartOccurrence = myRootOccurrence.Occurrences.Item(index)
# Retrieves the ws3_bolt_part.3 part rep instancemyPartInstance = myPartOccurrence.InstanceOccurrenceOfmyPartInstanceRef = myPartInstance.ReferenceInstanceOfmyPartRepInstance = myPartInstanceRef.RepInstances.Item(1)
# Retrieves the ws3_bolt_part.3 part bodymyPartRepInstanceRef = myPartRepInstance.ReferenceInstanceOfmyPart = myPartRepInstanceRef.GetItem("Part")myPartBody = myPart.MainBody
# Composes link to the ws3_bolt_part.3 part bodymyReference = myPart.CreateReferenceFromObject(myPartBody)myLinkToSecondSupport = myProdService.ComposeLink(myPartOccurrence, myPartRepInstance, myReference)
# Sets the shell section second supportmyLinkAccess.AddLink ("MainSupport", myLinkToSecondSupport)...
6.Replaces the first shell section support
In this step UC replaces the first shell section support. 
... # Retrieves the publicationmyNewSupport = myPublications.GetItem("Pipe")
# Removes first supportmyLinkAccess.RemoveLink ("MainSupport", myLinkToFirstSupport)
# Sets the new supportmyLinkAccess.AddLink ("MainSupport", myNewSupport)...
7.Removes all supports of the shell section
In this step UC removes all supports of the shell section. 
... myLinkAccess.RemoveAllLinks ("MainSupport")...
Using ComposeLink methodThis article explains how to use the ComposeLink method of the PLMProductService object. It will show the different way to create a link memory object in Python.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
lMake sure that you have all of the licenses required for launching execution and perform a solve operation in the interactive session for a similar simulation toconfirm the licenses. 
Where to find the macro: CAAScdFeaComposeLinkWithPublicationInVBSource.htm
Where to find the macro: CAAScdFeaComposeLinkWithoutPublicationInVBSource.htmThis use case can be divided into seven steps:
1.Retrieves the active Product2.Creates link
Page 52 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 53 ---

3.Associates representation to FEM4.Creates a Shell section5.Sets the shell section attributes
1.Retrieves the active Product
As a first step, the UC retrieves the active product.
... ' As a first step, retrieve the product editor which is the actived oneDim myEditor As EditorSet myEditor = CATIA.ActiveEditor
' Then retrieve the product serviceDim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
' Retrieve the Root OccurrenceDim myRootOcc As VPMRootOccurrenceSet myRootOcc = myProdService.RootOccurrence
...
...' As a first step, retrieve the product editor which is the actived oneDim myEditor As EditorSet myEditor = CATIA.ActiveEditor
' Then retrieve the product serviceDim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
' Retrieve the Root OccurrenceDim myRootOcc As VPMRootOccurrenceSet myRootOcc = myProdService.RootOccurrence...
2.Creates link
In this step, the UC retrieves usefull data to compose link to the support.
The created link, a 3D Shape in this case, is used to associate the Pipe part to the FemRep.
...' retrieve the publications setDim myPublications As VPMPublicationsSet myPublications =  myRootOcc.ReferenceRootOccurrenceOf.Publications
' retrieve the Pipe_Extrude publication, it is a 3D ShapeDim myPublication  As VPMPublicationSet myPublication = myPublications.GetItem("Pipe_Extrude")
' Create the link with ComposeLink method.' As we use publication, we do not need to give the representation instance as the publication is under the product reference.' Set as third argument the retrieved publication defining the feature needed to be linkedDim myLink As AnyObjectSet myLink = myProdService.ComposeLink(myRootOcc, Nothing, myPublication)...
Used publication is aggregated to the part wanted to be associated and the publication points a 3D Shape element. So it has the exact path of the needed 3D Shape.
Using PublicationWithout Publication
Using PublicationWithout Publication
Page 53 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 54 ---

...' To create the correct link, retrieve the part occurence, needed for the first argument' Retrieve the part rep instance, needed for the second argument' Creates a reference for the 3D Shape object needed for the third argument' Be aware to retrieve the part occurence and the part rep instance to whom the 3D Shape is associated
' Retrieve the root occurrenceDim myRootOccurrence  As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
' Retrieve the ws3_pipe_neutral_fiber_part.1 part occurrenceDim myPartOccurrence As PLMOccurrence
For i = 1 to myRootOccurrence.Occurrences.CountIf myRootOccurrence.Occurrences.Item(i).Name = "ws3_pipe_neutral_fiber_part.1" ThenSet myPartOccurrence = myRootOccurrence.Occurrences.Item(i)End ifNext
' Retrieve the ws3_pipe_neutral_fiber_part.1 part rep instanceDim myPartInstance As VPMInstanceSet myPartInstance = myPartOccurrence.InstanceOccurrenceOf
Dim myPartInstanceRef As VPMReferenceSet myPartInstanceRef = myPartInstance.ReferenceInstanceOf
Dim myPartRepInstance As VPMRepInstanceSet myPartRepInstance = myPartInstanceRef.RepInstances.Item(1)
' Retrieve the ws3_pipe_neutral_fiber_part.1 part bodyDim myPartRepInstanceRef As VPMRepReferenceSet myPartRepInstanceRef = myPartRepInstance.ReferenceInstanceOf
Page 54 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 55 ---

Dim myPart As PartSet myPart = myPartRepInstanceRef.GetItem("Part")
Dim myPartBody As BodySet myPartBody = myPart.MainBody
' Retrieve the 3D shape Extrude.1Dim myExtrude As AnyObjectSet myExtrude = myPart.FindObjectByName("Extrude.1")
Dim myReference  As ReferenceSet myReference = myPart.CreateReferenceFromObject(myExtrude)
' Create the link with ComposeLink method.Dim myLink As AnyObjectSet myLink = myProdService.ComposeLink(myPartOccurrence, myPartRepInstance, myReference)...
Important :
To retrieve the needed path throught the compose link method, correct arguments have to been gived.
As First argument, it is necessary to give the part occurence because sometimes the root occurrence could have two same part as child occurrence. Due to this, created myReference argument is difficult to locate correctly, even if the correct PartRepInstance is given, the reference will be the same for each same object. See an example on the image below.
3.Associates representation to FEM
In this step, UC creates the FEM rep and associates the representation to it
...' Retrieve the Product representation factory to create a FEMDim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory =  myAssembly.GetItem("SimPrdRepFactory")
Dim MyFemRepRef  As VPMRepReferenceSet MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")
Dim MyFemRepRoot As SimFemRootSet MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")
' Add link to the FEM repMyFemRepRoot.AddAssociatedRep (myLink)
...
...' Retrieve the Product representation factory to create a FEMDim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory =  myAssembly.GetItem("SimPrdRepFactory")
Dim MyFemRepRef  As VPMRepReferenceSet MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")
Dim MyFemRepRoot As SimFemRootSet MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")
Using PublicationWithout Publication
Page 55 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 56 ---

' Add link to the FEM repMyFemRepRoot.AddAssociatedRep (myLink)
...
Important : When using publication, we do not need to create a link in memory. The publication can directly be setted as argument
MyFemRepRoot.AddAssociatedRep (myPublication)
4.Creates a Shell section
In this step, UC creates shell section
...' Retrieve the properties set Dim myPropertiesSet As SimPropertiesSet myPropertiesSet = MyFemRepRoot.GetSet("SimProperties")
' Create individual propertiesDim myShellSection As SimShellSectionSet myShellSection = myPropertiesSet.Add("SimShellSection")...
...' Retrieve the properties set Dim myPropertiesSet As SimPropertiesSet myPropertiesSet = MyFemRepRoot.GetSet("SimProperties")
' Create individual propertiesDim myShellSection As SimShellSectionSet myShellSection = myPropertiesSet.Add("SimShellSection")...
5.Set the shell section attributes
In this step, UC sets attributes to the created shell section
...' Set the section supportDim myLinkAccess As SimLinkAccessSet myLinkAccess = myShellSection.GetItem("SimLinkAccess")
' Add the link created beforemyLinkAccess.AddLink "MainSupport", myLinkmyShellSection.UniformThickness = 1.0...
...' Set the section supportDim myLinkAccess As SimLinkAccessSet myLinkAccess = myShellSection.GetItem("SimLinkAccess")
' Add the link created beforemyLinkAccess.AddLink "MainSupport", myLinkmyShellSection.UniformThickness = 1.0...
Important : When using publication, we do not need to create a link in memory. The publication can directly be setted as argument
myLinkAccess.AddLink ("MainSupport", myPublication)
Using PublicationWithout Publication
Using PublicationWithout Publication
Using ComposeLink methodThis article explains how to use the ComposeLink method of the PLMProductService object. It will show the different way to create a link memory object in Python.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
lMake sure that you have all of the licenses required for launching execution and perform a solve operation in the interactive session for a similar simulation toconfirm the licenses. 
Where to find the macro: CAAScdFeaComposeLinkWithPublicationInPythonSource.htm
Where to find the macro: CAAScdFeaComposeLinkWithoutPublicationInPythonSource.htmThis use case can be divided into seven steps:
1.Retrieves the simulation and its product2.Creates link3.Associates representation to FEM4.Creates a Shell section5.Sets the shell section attributes
1.Retrieves the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model.
Using PublicationWithout Publication
Page 56 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 57 ---

... # As a first step, retrieve the simulation editor which is the actived onemyEditor = CATIA.ActiveEditor
# Then retrieve the product servicemyProdService = myEditor.GetService("PLMProductService")
# Retrieve the Root OccurrencemyRootOccurrence = myProdService.RootOccurrence...
...# As a first step, retrieve the simulation editor which is the actived onemyEditor = CATIA.ActiveEditor
# Then retrieve the product servicemyProdService = myEditor.GetService("PLMProductService")
# Retrieve the PLMEntitiesmyEntities = myProdService.EditedContent
# Now retrieve the PLMEntitymyEntity = myEntities.Item(1)
# Get the simulation RootMySimulationRoot = myEntity
# Now retrieve the ModelmyModel = MySimulationRoot.Model
# UC Opens now the model to retrieve the root occurrence.# The root occurrence has to be retrieved to access to the part occurences.
oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myRootOccurrence = MyProductService.RootOccurrence...
2.Creates link
In this step, the UC retrieves usefull data to compose link to the support.
The created link, a 3D Shape in this case, is used to associate the Pipe part to the FemRep.
...# retrieve the publications setmyPublications = myRootOccurrence.ReferenceRootOccurrenceOf.Publications
# retrieve the Pipe_Extrude publication, it is a 3D ShapemyPublication = myPublications.GetItem("Pipe_Extrude")
# Create the link with ComposeLink method.# As we use publication, we do not need to give the representation instance as the publication is under the product reference.# Set as third argument the retrieved publication defining the feature needed to be linkedmyLink = myProdService.ComposeLink(myRootOccurrence, None, myPublication)...
Used publication is aggregated to the part wanted to be associated and the publication points a 3D Shape element. So it has the exact path of the needed 3D Shape.
Using PublicationWithout Publication
Page 57 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 58 ---

...# To create the correct link, retrieve the part occurence, needed for the first argument# Retrieve the part rep instance, needed for the second argument# Creates a reference for the 3D Shape object needed for the third argument# Be aware to retrieve the part occurence and the part rep instance to whom the 3D Shape is associated
# Retrieve the ws3_pipe_neutral_fiber_part.1 part occurrenceiMaxCnt = myRootOccurrence.Occurrences.Count
for index inrange(1, iMaxCnt+1):if myRootOccurrence.Occurrences.Item(index).Name == "ws3_pipe_neutral_fiber_part.1":       myPartOccurrence = myRootOccurrence.Occurrences.Item(index)
# Retrieve the ws3_pipe_neutral_fiber_part.1 part rep instancemyPartInstance = myPartOccurrence.InstanceOccurrenceOfmyPartInstanceRef = myPartInstance.ReferenceInstanceOfmyPartRepInstance = myPartInstanceRef.RepInstances.Item(1)
# Retrieve the ws3_pipe_neutral_fiber_part.1 part bodymyPartRepInstanceRef = myPartRepInstance.ReferenceInstanceOfmyPart = myPartRepInstanceRef.GetItem("Part")myPartBody = myPart.MainBody
# Retrieve the 3D shape Extrude.1myExtrude = myPart.FindObjectByName("Extrude.1")myReference = myPart.CreateReferenceFromObject(myExtrude)
# Create the link with ComposeLink method.myLink = myProdService.ComposeLink(myPartOccurrence, myPartRepInstance, myReference)...
Important :
To retrieve the needed path throught the compose link method, correct arguments have to been gived.
Page 58 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 59 ---

As First argument, it is necessary to give the part occurence because sometimes the root occurrence could have two same part as child occurrence. Due to this, created myReference argument is difficult to locate correctly, even if the correct PartRepInstance is given, the reference will be the same for each same object. See an example on the image below.
3.Associates representation to FEM
In this step, UC creates the FEM rep and associates the representation to it
...# retrieve the Product representation factory to create a FEMMyPrdRepFactory = myModel.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")
# Add link to the FEM repMyFemRepRoot.AddAssociatedRep (myLink)
...
...# retrieve the Product representation factory to create a FEMMyPrdRepFactory = myModel.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")
# Add link to the FEM repMyFemRepRoot.AddAssociatedRep (myLink)...
Important : When using publication, we do not need to create a link in memory. The publication can directly be setted as argument
MyFemRepRoot.AddAssociatedRep (myPublication)
4.Creates a Shell section
In this step, UC creates shell section
...# Retrieve the properties set myPropertiesSet = MyFemRepRoot.GetSet("SimProperties")
# Create individual propertiesmyShellSection = myPropertiesSet.Add("SimShellSection")...
...# Retrieve the properties set myPropertiesSet = MyFemRepRoot.GetSet("SimProperties")
# Create individual propertiesmyShellSection = myPropertiesSet.Add("SimShellSection")...
5.Set the shell section attributes
Using PublicationWithout Publication
Using PublicationWithout Publication
Page 59 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 60 ---

In this step, UC sets attributes to the created shell section
...# Set the section supportmyLinkAccess = myShellSection.GetItem("SimLinkAccess")# Add the link created beforemyLinkAccess.AddLink ("MainSupport", myLink)myShellSection.UniformThickness = 1.0...
...# Set the section supportmyLinkAccess = myShellSection.GetItem("SimLinkAccess")# Add the link created before.myLinkAccess.AddLink ("MainSupport", myLink)myShellSection.UniformThickness = 1.0...
Important : When using publication, we do not need to create a link in memory. The publication can directly be setted as argument
myLinkAccess.AddLink ("MainSupport", myPublication)
Using PublicationWithout Publication
Multiphysics Model Creation Object Model MapSee AlsoLegend
Page 60 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 61 ---

To retrieve the rootVPMReference object, see Browsing Product Contents.
Use the GetItem method to return theSimLinkAccess object from its aggregating object, such as theSimGroup object.
Dim oSimGroup As SimGroup...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimGroup.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimGroup.GetItem("SimLinkAccess")
 Available with the RBM - Simulation Scripting product only.
Use the GetItem method to return theSimLinkAccess object from its aggregating object, such as theSimVirtualBolt object.
Dim oSimVirtualBolt As SimVirtualBolt...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimVirtualBolt.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimVirtualBolt.GetItem("SimLinkAccess")
VBAPython
SimMCXProperties CollectionSee AlsoLegend
VBAPython
SimAbstractions CollectionSee AlsoLegend
Page 61 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 62 ---

Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimSurfaceFluidCavity object.
Dim oSimSurfaceFluidCavity As SimSurfaceFluidCavity...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimSurfaceFluidCavity.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimSurfaceFluidCavity.GetItem("SimLinkAccess")
Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimMeshedBolt object.
Dim oSimMeshedBolt As SimMeshedBolt
VBAPython
SimProperties CollectionSee AlsoLegend
VBAPython
Page 62 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 63 ---

...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimMeshedBolt.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimMeshedBolt.GetItem("SimLinkAccess")
SimAxisSystem ObjectSee AlsoLegend
SimConnectorSection ObjectSee AlsoLegend
Creating a FEM rep and managing its associated shapesThis use case primarily focuses on the methodology to create a FEM representation and to manage associated shapes.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
Where to find the macro: CAAScdFeaCreateFEMSource.htmThis use case can be divided in seven steps:
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"2.Retrieves the root product3.Retrieves the PartBody4.Creates the FEM representation and retrieve its root object5.Associates the PartBody with the FEM representation6.Checks if the FEM representation have at least one associated shape7.Removes an associated shapes
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"
As a first step, the UC retrieves the model named "CAAScdFeaProductWithoutFEM", loads it, and returns object of the Editor. 
... Dim myEditor As EditorOpenProduct myEditor...
The function OpenProduct returns MyEditor, an Editor object. After searching and opening of "CAAScdFeaProductWithoutFEM" product from underlying database the current active editor is returned inMyEditor.
2.Retrieves the root product
As a next step, the UC retrieves the root product object from the returned editor.
 ...Dim MyRootOcc As VPMRootOccurrenceSet MyRootOcc = MyEditor.ActiveObject
Dim MyRootProduct As VPMReferenceSet MyRootProduct = MyRootOcc.PLMEntity ...
3.Retrieves the PartBody
Page 63 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 64 ---

In this step UC retrieves the main body of the 3D shape aggregated by the root product.
...Dim MyContext As PLMProductServiceSet MyContext = MyEditor.GetService("PLMProductService")
Dim MyPart As PartDim MyPartInstance As VPMRepInstanceDim MyBody As BodyFor Each MyEntity In MyContext.EditedContentDim MyRef As VPMReferenceSet MyRef = MyEntity
Dim MyReps As VPMRepInstancesSet MyReps = MyRef.RepInstances
For Each MyRep In MyRepsDim MyRepRef As VPMRepReferenceSet MyRepRef = MyRep.ReferenceInstanceOfDim attr As String         attr = MyRepRef.GatAttributValue("V_discipline")
If (attr = "Design") ThenSet MyPart = MyRepRef.GetItem("Part")Set MyPartInstance = MyRepSet MyBody = MyPart.MainBodyEnd IfNextNext...
4.Creates the FEM representation and retrieve its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory has to be retrieved on the reference object which will aggregate the FEM representation.
...Dim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")Dim MyFemRepRef As VPMRepReferenceSet MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")Dim MyFemRepRoot As SimFemRootSet MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
5.Associates the PartBody with the FEM representation
In this step UC appends the main body previously retrieved to the associated shapes of the FEM representation.
...Dim MyProductService As PLMProductServiceSet MyProductService = MyEditor.GetService("PLMProductService")
Dim MyReference As ReferenceSet MyReference = MyPart.CreateReferenceFromObject(MyBody)Dim MyLink As AnyObjectSet MyLink = MyProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)MyFemRepRoot.AddAssociatedRep MyLink...
6.Checks if the FEM representation have at least one associated shape
In this step UC checks if the FEM representation has at least one associated shape.
...Dim bHasAnAssociatedRep As BooleanbHasAnAssociatedRep = MyFemRepRoot.HasAnAssociatedRepIf (bHasAnAssociatedRep = False) Then    MsgBox "Error while associating the PartBody to the FEM Rep!"Exit SubEnd If...
7.Removes an associated shapes
In this step UC removes the main body previously retrieved from the associated shapes of the new FEM representation.
...MyFemRepRoot.RemoveAssociatedRep MyLinkbHasAnAssociatedRep = MyFemRepRoot.HasAnAssociatedRepIf (bHasAnAssociatedRep = True) Then    MsgBox "Error while removing the associated shape from the FEM Rep!"Exit SubEnd If...
Creating a FEM rep and managing its associated shapesThis use case primarily focuses on the methodology to create a FEM representation and to manage associated shapes.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should open the product called CAASCDFeaProductWithtoutFEM. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaCreateFEMWithPythonSource.htm
Page 64 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 65 ---

This use case can be divided in seven steps:
1.Retrieves the simulation and its product2.Retrieves the PartBody3.Creates the FEM representation and retrieves its root object4.Associates the PartBody with the FEM representation5.Checks if the FEM representation have at least one associated shape6.Removes an associated shapes1.Retrieve the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor
 ...myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the simulation's Model.
...myModelRepInstances = myModel.RepInstances
for  myPartRepInstance in myModelRepInstances:     myPartInstanceRef = myPartRepInstance.ReferenceInstanceOf     attr = myPartInstanceRef.GetAttributeValue("V_discipline")if attr == "Design":        myPart = myPartInstanceRef.GetItem("Part")        myPartInstance = myPartRepInstance        myBody = myPart.MainBody...
3.Creates the FEM representation and retrieve its root object
In this step UC creates a new FEM representation object.
To perform the creation, a simulation representation factory has to be retrieved on the reference object which will aggregate the FEM representation.
...MyPrdRepFactory = myModel.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
4.Associates the PartBody with the FEM representation
In this step UC appends the main body previously retrieved to the associated shapes of the FEM representation.
First, the UC opens the model and retrieves the product editor and the root occurence
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)myProductEditor = CATIA.ActiveEditormyRootOcc = myProductEditor.ActiveObject
Now it creates the link to associate with the FEM
MyReference = myPart.CreateReferenceFromObject(myBody)
MyLink = myProdService.ComposeLink(myRootOcc,myPartInstance,MyReference)MyFemRepRoot.AddAssociatedRep (MyLink)...
5.Checks if the FEM representation have at least one associated shape
In this step UC checks if the FEM representation has at least one associated shape.
...bHasAnAssociatedRep = MyFemRepRoot.HasAnAssociatedRepif  bHasAnAssociatedRep == False: print "Error while associating the part body to the fem rep !"...
6.Removes an associated shapes
In this step UC removes the main body previously retrieved from the associated shapes of the new FEM representation.
...bHasAnAssociatedRep = MyFemRepRoot.HasAnAssociatedRepif  bHasAnAssociatedRep == True: print "Error while removing the associated shape from the FEM Rep!"...
Creating an Assembly of FEMs
This use case primarily focuses on the methodology to create an assembly of FEMs.
Before you begin: Note that:
Page 65 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 66 ---

lYou should first launch CATIA and import theCAAScdFeaFEMAssembly.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lThen, you should open the "CAAScdFeaFEMAssembly" physical product. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality. 
Where to find the macro: CAAScdFeaFEMAssemblySource.htmThis use case can be divided in six steps:
1.Retrieves the active editor2.Retrieves the root product3.Creates a FEM Rep and retrieve its root object4.Creates a link between the created FEM and the first occurrence FEM5.Creates a link between the created FEM and the second occurrence FEM6.Updates the assembly FEM Rep1.Retrieves the active editor
As a first step, the UC retrieves the active editor. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor...
2.Retrieves the root product
In the next step, the UC retrieves the root product from the active editor.
 ...Dim MyRootOcc As VPMRootOccurrenceSet MyRootOcc = MyEditor.ActiveObject
Dim MyRootProduct As VPMReferenceSet MyRootProduct = MyRootOcc.PLMEntity...
3.Creates a FEM Rep and retrieve its root object
In the next step the UC creates the assembly FEM Rep which contains links to the other FEM Rep. The assembly FEM Rep is aggregated under the root product.
...Dim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")Dim MyFemRepRef As VPMRepReferenceSet MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")Dim MyFemRepRoot As SimFemRootSet MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
4.Creates a link between the created FEM and the first occurrence FEM
In this step theUC retrieves the FEM Rep which is aggregated by the first product occurrence. Then the UC creates a path element that will be used to create the link between the retrieved FEM Rep and the assembly FEM Rep.
...'Retrieve the first product occurrenceDim myRootOccurrences As VPMOccurrencesSet myRootOccurrences = MyRootOcc.OccurrencesDim myOccurrence As VPMOccurrenceSet myOccurrence = myRootOccurrences.Item(1)
'Retrieve the occurrence representation instanceDim MyRepInstances As VPMRepInstancesSet MyRepInstances = myOccurrence.InstanceOccurrenceOf.ReferenceInstanceOf.RepInstances
'Retrieve the FEM RepDim attr As StringDim myRepRef As VPMRepReferenceDim MyLink As AnyObjectFor Each myRep In MyRepInstancesSet myRepRef = myRep.ReferenceInstanceOf  attr = myRepRef.GetAttributeValue("V_discipline")If (attr = "FEM") Then'Create a path object from the root occurrence to the FEM RepSet MyLink = MyProductService.ComposeLink(myOccurrence, myRep, Nothing)End IfNext
'Create the link between the assembly FEM Rep and the retrieved FEM RepMyFemRepRoot.AddChild MyLink...
5.Creates a link between the created FEM and the second occurrence FEM
In a manner similar to the one shown above, the UC retrieves the FEM Rep which is aggregated by the second product and creates the path element from the root occurence to the retrieved FEM Rep.
...'Retrieve the FEM Rep of the second product occurrenceSet myOccurrence = myRootOccurrences.Item(2)Set MyRepInstances = myOccurrence.InstanceOccurrenceOf.ReferenceInstanceOf.RepInstancesFor Each myRep In MyRepInstancesSet myRepRef = myRep.ReferenceInstanceOf  attr = myRepRef.GetAttributeValue("V_discipline")If (attr = "FEM") Then'Create a path object from the root occurrence to the FEM Rep    Set MyLink = MyProductService.ComposeLink(myOccurrence, myRep, Nothing)End If
Page 66 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 67 ---

Next
'Create the link between the assembly FEM Rep and the retrieved FEM RepMyFemRepRoot.AddChild MyLink...
6.Updates the assembly FEM Rep
In this step the UC updates the assembly FEM Rep.
...MyFemRepRoot.Update... Fig.1: Generated FEM Rep
Creating an Assembly of FEMsThis use case primarily focuses on the methodology to create an assembly of FEMs.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaFEMAssembly.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lThen, you should open the "CAAScdFeaFEMAssembly" physical product as advanced with all representations. 
lCreate a structural simulation with launching the structural scenario apps. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaFEMAssemblyWithPythonSource.htmThis use case can be divided in six steps:
1.Retrieves the simulation and its product2.Gets the root occurrence3.Creates a FEM Rep and retrieve its root object4.Creates a link between the created FEM and the first occurrence FEM5.Creates a link between the created FEM and the second occurrence FEM6.Updates the assembly FEM Rep1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor.
 ...myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)
Page 67 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 68 ---

MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Gets the root occurrence
In the next step, the UC retrieves the root occurence and the root product from the product editor and gets the PLMProductService associated with this editor.
 ...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)myProductEditor = CATIA.ActiveEditormyRootOcc = myProductEditor.ActiveObjectmyRootProduct = myRootOcc.PLMEntitymyProductService = myProductEditor.GetService("PLMProductService")...
3.Creates the FEM representation and retrieves its root object.
In the next step the UC creates the assembly FEM Rep which contains links to the other FEM Rep. The assembly FEM Rep is aggregated under the root product.
...MyPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
4.Creates a link between the created FEM and the first occurrence FEM
In this step the UC retrieves the FEM Rep which is aggregated by the first product occurrence. Then the UC creates a path element that will be used to create the link between the retrieved FEM Rep and the assembly FEM Rep.
...# Retrieves the first product occurrencemyOccurrence = myRootOccurrences.Item(1)
# Retrieve the occurrence representation instanceMyRepInstances = myOccurrence.InstanceOccurrenceOf.ReferenceInstanceOf.RepInstances
# Retrieves the FEM Repfor myRep in MyRepInstances :    myRepRef = myRep.ReferenceInstanceOf    attr = myRepRef.GetAttributeValue("V_discipline")if attr == "FEM":# Create a path object from the root occurrence to the FEM Rep       MyLink = myProductService.ComposeLink(myOccurrence, myRep, None)
# Create the link between the assembly FEM Rep and the retrieved FEM RepMyFemRepRoot.AddChild (MyLink)...
5.Creates a link between the created FEM and the second occurrence FEM
In a manner similar to the one shown above, the UC retrieves the FEM Rep which is aggregated by the second product and creates the path element from the root occurence to the retrieved FEM Rep.
...# Retrieves the second product occurrencemyOccurrence2 = myRootOccurrences.Item(2)
# Retrieve the occurrence representation instanceMyRepInstances2 = myOccurrence2.InstanceOccurrenceOf.ReferenceInstanceOf.RepInstances
# Retrieves the FEM Repfor myRep2 in MyRepInstances2 :    myRepRef2 = myRep2.ReferenceInstanceOf    attr = myRepRef2.GetAttributeValue("V_discipline")if attr == "FEM":# Create a path object from the root occurrence to the FEM Rep       MyLink2 = myProductService.ComposeLink(myOccurrence2, myRep2, None)
# Create the link between the assembly FEM Rep and the retrieved FEM RepMyFemRepRoot.AddChild (MyLink2)...
6.Updates the assembly FEM Rep
In this step the UC updates the assembly FEM Rep.
...MyFemRepRoot.Update... Fig.1: Generated FEM Rep
Page 68 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 69 ---

Mesh Part creation
Mesh Part creation is managed the Add method of the mesh part collection object.
A "late type" must be given to indicate which type of mesh part is to be created:
Mesh Parts and Their AttributesTechnical ArticleAbstract
The following reference article describes the different types of mesh parts, their attributes and usage.
This paper explains two types of mesh parts:
lThe Beam Mesher. See Beam Mesh Part Attributes. The description of all attributes of the Beam mesh part.
lThe Coating 1D Mesher. See Coating 1D Mesh Part Attributes. The description of all attributes of the Coating 1D mesh part.
lThe Coating 2D Mesher. See Coating 2D Mesh Part Attributes. The description of all attributes of the Coating 2D mesh part.
lThe Extrusion Offset. See Extrusion Offset Mesh Part Attributes. The description of all attributes of the Extrusion Offset mesh part.
lThe Extrusion Rotation. See Extrusion Rotation Mesh Part Attributes. The description of all attributes of the Extrusion Rotation mesh part.
lThe Extrusion Spine. SeeExtrusion Spine Mesh Part Attributes. The description of all attributes of the Extrusion Spine mesh part.
lThe Extrusion Symmetry. See Extrusion Symmetry Mesh Part Attributes. The description of all attributes of the Extrusion Symmetry mesh part.
lThe Extrusion Translation. See Extrusion Translation Mesh Part Attributes. The description of all attributes of the Extrusion Translation mesh part.
lThe Hex-Dominant Mesher. See Hex-Dominant Mesher Attributes. The description of all attributes of the Hex-Dominant mesh part.
lThe Octree Mesher. See Octree Mesher Attributes. The description of all attributes of the Octree mesh part.
lThe Offset Mesher. See Offset Mesh Part Attributes. The description of all attributes of the Offset mesh part.
lThe Partition Hex Mesher. See Partition Hex Mesher Attributes. The description of all attributes of the Partition Hex mesh part.
lThe Quadrangle Surface Mesher. See Surface Quadrangle Mesh Part Attributes. The description of all attributes of the Surface Quadrangle mesh part.
lThe Rotation Mesher. See Rotation Mesh Part Attributes. The description of all attributes of the Rotation mesh part.
lThe Sweep 3D Mesher. See Sweep 3D Mesh Part Attributes. The description of all attributes of the Sweep 3D mesh part.
lThe Symmetry Mesher. See Symmetry Mesh Part Attributes. The description of all attributes of the Symmetry mesh part.
lThe Tetrahedron Mesher. See Tetrahedron Mesh Part Attributes. The description of all attributes of the Tetrahedron mesh part.
lThe Tetrahedron Filler Mesher. See Tetrahedron Filler Mesh Part Attributes. The description of all attributes of the Tetrahedron Filler mesh part.
lThe Translation Mesher. See Translation Mesh Part Attributes. The description of all attributes of the Translation mesh part.
lThe Triangle Surface Mesher. See Surface Triangle Mesh Part Attributes. The description of all attributes of the Surface Triangle mesh part.
This paper describes also how to access to:
lMesh Part Creation
lGlobal Attributes. 
lLocal Topology Specifications. 
lLocal Mesh Specifications. 
lMeshing Rules. 
lMesh Quality.
Page 69 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 70 ---

Global Attributes
Global attributes is managed using SimMeshPart object:
lSetAttributeValue ( iSetType As String, iAttribute As String, iValue ) to set an attribute value.
lGetAttributeValue ( iSetType As String, iAttribute As String, oValue ) to get an attribute value. 
iAttribute is the global attribute's name and iSetType is the type of specification:
liSetType ="Mesh" for Global Mesh Attributes. 
liSetType ="Topology" for Global Topology Attributes. 
Local Topology Specifications
Local topology specifications are created by theAdd method of the SimTopologySpecifications object.
lAdd ( iType As String ) with:
¡iType is the late type of the topology specification to create. 
The Item and theRemove methods work with an index which is the position of the specification in the collection. The position index starts from 1.
The support of the local topology specification is managed by theSimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String )
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
The specification values are managed by the following methods:
lGetAttributeValue ( iAttribute As String, oValue ) 
lSetAttributeValue ( iAttribute As String, iValue ) 
¡iAttribute is the attribute name to set/retrieve. 
Local Mesh Specifications
Local mesh specifications are created by the Add method of theSimMeshSpecifications object.
lAdd (iType As String ) with: 
¡iType is the late type of the mesh specification to create. 
TheItem and the Remove methods work with an index which is the position of the specification in the collection. The position index starts from 1.
The support of the local topology specification is managed by the SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject ) 
¡iName is the name of the link container, here it's "ConnectorList"
The specification values are managed by the following methods:
lGetAttributeValue ( iAttribute As String, oValue ) 
lSetAttributeValue ( iAttribute As String, iValue ) 
¡iAttribute is the attribute name to set/retrieve. 
Meshing Rules
A Meshing Rule can be used to manage the mesh part parameters by using SetRule method of the SimMeshPart object.
lSetRule ( iRuleName As String, iExtension As String ) with: 
Mesh part Late typeBeam CATFmtBeamRulesMesherCoating 2D CATFmtCoating2DMesherExtrusion OffsetCATFmtExtrusionOffsetMesherExtrusion RotationCATFmtExtrusionRotationMesherExtrusion SpineCATFmtExtrusionSpineMesherExtrusion SymmetryCATFmtExtrusionSymmetryMesherExtrusion TranslationCATFmtExtrusionTranslationMesherHex-Dominant MesherCATFmtHexMesherOctree 2D CATFmtOctree2DRulesMesherOctree 3D CATFmtOctree3DRulesMesherOffset CATFmtOffsetMesherPartition Hex MesherCATFmtPartitionHexMesherQuadrangle SurfaceCATFmtSurfQuadMesherRotation CATFmtRotationMesherSweep 3D CATFmtSweep3DMesherSymmetryCATFmtSymmetryMesherTetrahedronCATFmt3DRulesMesherTetrahedron FillerCATFmtGHS3DMesherTranslationCATFmtTranslationMesherTriangle SurfaceCATFmtSurfTriaMesher
Page 70 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 71 ---

¡iRuleName is the name of the meshing rule. 
¡iExtension is the extension of the meshing rule. 
Mesh Quality
The mesh quality analysis can be exported from the SimMeshPart or SimFemRoot objects.If the export is called on a SimMeshPart, the mesh quality analysis will be done on the mesh part only.If the export is called on the SimFemRoot, the mesh quality analysis will be done on the complete mesh set.
The mesh quality analysis can be exported by using theCreateCSVFile method of the SimMeshQuality object. This object can be retrieved by calling GetItem("SimMeshQuality") method on the SimMeshPart or SimFemRoot objects.
lCreateCSVFile ( iPath As String, iOverwrite As Boolean ) with: 
¡iPath is the full path with the file name and its extension where to export the CSV file.
¡iOverwrite to allow to overwrite an existing file.
History
Fig.1: Meshing Rule PLM Attributes
Version: 1 [Oct 2014]Document created
Creating Mesh PartThis use case primarily focuses on the methodology to create a Mesh Part.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaCreateMPSource.htmThis use case can be divided in nine steps:
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"2.Retrieves the root product3.Retrieves the PartBody4.Creates the FEM representation and retrieve its root object5.Retrieves the mesh set6.Creates a Mesh Part7.Creates a local topology specification8.Creates a local mesh specification9.Generates the mesh
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"
As a first step, the UC retrieves a model "CAAScdFeaProductWithoutFEM" from DB and loads it and returns object of the Editor. 
... Dim myEditor As EditorOpenProduct MyEditor...
The function OpenProduct returns MyEditor, an Editor object. After searching and opening of "CAAScdFeaProductWithoutFEM" product from underlying database the current active editor is returned inMyEditor.
2.Retrieves the root product
As a next step, the UC retrieves the root product object from the returned editor.
 ...Dim MyRootOcc As VPMRootOccurrenceSet MyRootOcc = MyEditor.ActiveObject
Dim MyRootProduct AsVPMReferenceSet MyRootProduct = MyRootOcc.PLMEntity ...
3.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the root product.
...Dim MyContext As PLMProductServiceSet MyContext = MyEditor.GetService("PLMProductService")
Page 71 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 72 ---

Dim MyPart As PartDim MyPartInstance As VPMRepInstanceDim MyBody As BodyFor Each MyEntity In MyContext.EditedContentDim MyRef As VPMReferenceSet MyRef = MyEntity
Dim MyReps As VPMRepInstancesSet MyReps = MyRef.RepInstances
For Each MyRep In MyRepsDim MyRepRef As VPMRepReferenceSet MyRepRef = MyRep.ReferenceInstanceOfDim attr As String         attr = MyRepRef.GatAttributValue("V_discipline")
If (attr = "Design") ThenSet MyPart = MyRepRef.GetItem("Part")Set MyPartInstance = MyRepSet MyBody = MyPart.MainBodyEnd IfNextNext...
4.Creates the FEM representation and retrieve its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object onaggregated.
...Dim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")Dim MyFemRepRef As VPMRepReferenceSet MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")Dim MyFemRepRoot As SimFemRootSet MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")
The 3D Shape is linked to the FEM representation as assiocated shape.
Dim MyProductService As PLMProductServiceSet MyProductService = MyEditor.GetService("PLMProductService")
Dim MyReference As ReferenceSet MyReference = MyPart.CreateReferenceFromObject(MyBody)Dim MyLink As AnyObjectSet MyLink = MyProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)MyFemRepRoot.AddAssociatedRep MyLink...
5.Retrieves the mesh set
In this step UC retrieves the mesh set and the collection object of all the mesh parts. 
...Dim MyMeshSet As SimMeshSetSet MyMeshSet = MyFemRepRoot.GetSet("SimNodesElements")Dim MyMeshParts As SimMeshPartsSet MyMeshParts = MyMeshSet.MeshParts...
6.Creates a Mesh Part
In this step UC creates a surfacic triangle mesh part. The kind of mesher depends of the late type which it's given as argument of the Add method. 
...Dim MyMeshPart As SimMeshPartSet MyMeshPart = MyMeshParts.Add("CATFmtSurfTriaMesher")
Then, you should set the mesh part support. A link to the support object must be created first.
'Set the Mesh Part supportSet MyPartSupp = MyPart.FindObjectByName("Fill.1")Set MyReference = MyPart.CreateReferenceFromObject(MyPartSupp)Set MyLink = MyContext.ComposeLink(MyRootOcc, MyPartInstance, MyReference)MyMeshPart.AddSupport MyLink
Finally, the mesh part attributes can be valuated.
'Define the Mesh PartMyMeshPart.SetAttributeValue "Mesh", "MeshSizeValue", "20 mm"MyMeshPart.SetAttributeValue "Mesh", "ElementOrder", 2MyMeshPart.SetAttributeValue "Mesh", "AbsoluteSag", 2MyMeshPart.SetAttributeValue "Mesh", "AbsoluteSagValue", "2 mm"...
For further informations about the mesher late type and their attributes, please refer to the "Mesh Parts and Their Attributes" article. [1]
7.Creates a local topology specification
In this step UC creates a local topology specification which will be used as support of a mesh specification. As the mesh part creation, the topology specification contains three steps : feature creation, support definition and attributes valuation.
...Dim MyTopologySpecifications As SimTopologySpecificationsSet MyTopologySpecifications = MyMeshPart.GetTopologySpecificationsDim MyTopologySpecification As SimTopologySpecificationSet MyTopologySpecification = MyTopologySpecifications.Add("CATFmtExternalCurveLocalSpec")
Page 72 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 73 ---

References
'Set the mesh specification supportSet MySpecSupp = MyPart.FindObjectByName("MyLine")Set MyReference = MyPart.CreateReferenceFromObject(MySpecSupp)Set MyLink = MyContext.ComposeLink(MyRootOcc, MyPartInstance, MyReference)Dim MyLinkAccess As SimLinkAccessSet MyLinkAccess = MyTopologySpecification.GetItem("SimLinkAccess")MyLinkAccess.AddLink "ConnectorList", MyLink
'Define the topology specificationMyTopologySpecification.SetAttributeValue "ToleranceValue", "1 mm"...
For further informations about the topology specification late type and their attributes, please refer to the "Mesh Parts and Their Attributes" article. [1]
8.Creates a local mesh specification
In a manner similar to the one shown above, UC creates a local mesh specification.
...Dim MyMeshSpecifications As SimMeshSpecificationsSetMyMeshSpecifications = MyMeshPart.GetMeshSpecificationsDim MyMeshSpecification As SimMeshSpecificationSetMyMeshSpecification = MyMeshSpecifications.Add("CATFmtStudioDistributionSpec")
'Set the mesh specification supportSetMyLinkAccess = MyMeshSpecification.GetItem("SimLinkAccess")MyLinkAccess.AddLink "ConnectorList", MyTopologySpecification
'Define the mesh specificationMyMeshSpecification.SetAttributeValue "Type", 3MyMeshSpecification.SetAttributeValue "NbElementsValue", 10MyMeshSpecification.SetAttributeValue "Symmetry", 2MyMeshSpecification.SetAttributeValue "RatioValue", 3...
For further informations about the mesh specification late type and their attributes, please refer to the "Mesh Parts and Their Attributes" article. [1]
9.Generates the mesh
In this step UC generates the mesh by the update process.
...MyMeshPart.Update...
Fig.1: Generated Mesh
[1]Mesh Part and Their Attributes
Creating Mesh PartThis use case primarily focuses on the methodology to create a Mesh Part.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should open the product called CAASCDFeaProductWithtoutFEM. 
lLaunch the structural scenario App and create a structural simulation. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality. 
Where to find the macro: CAAScdFeaCreateMPWithPythonSource.htm
Page 73 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 74 ---

This use case can be divided in nine steps:
1.Retrieves the simulation and its product2.Retrieves the PartBody3.Creates the FEM representation, Retrieves its root object and Associates the PartBody to this4.Retrieves the mesh set5.Creates a mesh part6.Creates a local topology specification7.Creates a local mesh specification8.Generates the mesh
1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the simulation's Model.
...myModelRepInstances = myModel.RepInstances
for  myPartRepInstance in myModelRepInstances:     myPartInstanceRef = myPartRepInstance.ReferenceInstanceOf     attr = myPartInstanceRef.GetAttributeValue("V_discipline")if attr == "Design":        myPart = myPartInstanceRef.GetItem("Part")        myPartInstance = myPartRepInstance        myBody = myPart.MainBody...
3.Creates the FEM representation, Retrieves its root object and Associates the PartBody to this 
In this step UC creates a new FEM representation object.
To perform the creation, a simulation representation factory has to be retrieved on the reference object which will aggregate the FEM representation.
...MyPrdRepFactory = myModel.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")... 
Now UC appends the main body previously retrieved to the associated shapes of the FEM representation.
First, the UC opens the model and retrieves the product editor and the root occurence
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)myProductEditor = CATIA.ActiveEditormyRootOcc = myProductEditor.ActiveObject
Now it creates the link to associate with the FEM 
MyReference = myPart.CreateReferenceFromObject(myBody)myProductService = myProductEditor.GetService("PLMProductService")MyLink = myProdService.ComposeLink(myRootOcc,myPartInstance,MyReference)MyFemRepRoot.AddAssociatedRep (MyLink)...
4.Retrieves the mesh set
In this step UC retrieves the mesh set and the collection object of all the mesh parts. 
...myMeshSet = MyFemRepRoot.GetSet("SimNodesElements")myMeshParts = myMeshSet.MeshParts...
5.Creates a mesh part
In this step UC creates a surfacic triangle mesh part. The kind of mesher depends of the late type which it's given as argument. 
...myMeshPart = myMeshParts.Add("CATFmtSurfTriaMesher")...
Then, you should set the mesh part support. A link to the support object must be created first.
...MyPartSupp = myPart.FindObjectByName("Fill.1")MyReference = myPart.CreateReferenceFromObject(MyPartSupp)MyLink = myProductService.ComposeLink(myRootOcc, myPartInstance, MyReference)myMeshPart.AddSupport (MyLink)...
Finally, the mesh part attributes can be valuated.
Page 74 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 75 ---

References
...myMeshPart.SetAttributeValue("Mesh", "MeshSizeValue", "20 mm")myMeshPart.SetAttributeValue("Mesh", "ElementOrder", 2)myMeshPart.SetAttributeValue("Mesh", "AbsoluteSag", 2)myMeshPart.SetAttributeValue("Mesh", "AbsoluteSagValue", "2 mm")...
For further informations about the mesher late type and their attributes, please refer to the "Mesh Parts and Their Attributes" article. [1]
6.Creates a local topology specification 
In this step UC creates a local topology specification which will be used as support of a mesh specification. As the mesh part creation, the topology specification contains three steps : feature creation, support definition and attributes valuation.
...MyTopologySpecifications = myMeshPart.GetTopologySpecifications()MyTopologySpecification = MyTopologySpecifications.Add("CATFmtExternalCurveLocalSpec")
MySpecSupp = myPart.FindObjectByName("MyLine")MyReference = myPart.CreateReferenceFromObject(MySpecSupp)MyLink = myProductService.ComposeLink(myRootOcc, myPartInstance, MyReference)MyLinkAccess = MyTopologySpecification.GetItem("SimLinkAccess")MyLinkAccess.AddLink("ConnectorList", MyLink)
MyTopologySpecification.SetAttributeValue("ToleranceValue", "1 mm")
For further informations about the topology specification late type and their attributes, please refer to the "Mesh Parts and Their Attributes" article. [1]
7.Creates a local mesh specification 
In a manner similar to the one shown above, UC creates a local mesh specification.
...MyMeshSpecifications = myMeshPart.GetMeshSpecifications()MyMeshSpecification = MyMeshSpecifications.Add("CATFmtStudioDistributionSpec")
MyLinkAccess = MyMeshSpecification.GetItem("SimLinkAccess")MyLinkAccess.AddLink("ConnectorList", MyTopologySpecification)
MyMeshSpecification.SetAttributeValue("Type", 3)MyMeshSpecification.SetAttributeValue("NbElementsValue", 10)MyMeshSpecification.SetAttributeValue("Symmetry", 2)MyMeshSpecification.SetAttributeValue("RatioValue", 3)...
For further informations about the mesh specification late type and their attributes, please refer to the "Mesh Parts and Their Attributes" article. [1]
8.Generates the mesh 
In this step UC generates the mesh by the update process.
...myMeshPart.Update...
Fig.1: Generated Mesh
[1]Mesh Part and Their Attributes
Beam Mesh Part AttributesTechnical Article
Abstract
This article presents an overview of the One Node Beam Mesh Part attributes and its local specifications. 
Page 75 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 76 ---

Beam Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is tobe created.
In the case of the Beam mesh part, the late type is "CATFmtBeamRulesMesher"
The Beam mesh part can be created by using Add method of SimMeshParts object.
Beam Mesh Part Support Definition
Beam Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupportAs AnyObject ) to add a new support to the mesh part 
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
MeshSizeValue
ElementOrder
AbsoluteSag
Beam Mesh Part Creation
Beam Mesh Part Support Definition:
Global Mesh Specifications:
lMeshSizeValue
lElementOrder
lAbsoluteSag
lAbsoluteSagValue
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Global Topology Specifications:
lAngleBetweenCurves
Local Topology Specifications:
lCATFmtExternalPointLocalSpec (Imposed Point): 
¡ToleranceValue
¡ProjectOnGeometry
Local Mesh 1D Specifications:
lCATFmtStudioDistributionSpec (Edge Distribution): 
¡Type
¡Combination
¡CombinationUnif
¡NbElementsValue
¡RatioValue
¡Size1Value
¡Size2Value
¡Symmetry
¡Reverse
type: double valuated to mesh elements size.
default value:10. Attribute which specifies the mesh element target size that the mesher tries to respect.
type: integer valuated to:
l1: to get a mesh with linear elements
l2: to get a mesh with quadratic elements
default value: 1 
Attribute which specifiesthe number of intermediate nodes per element edge, either linear BAR (on the left picture) or quadratic BAR3 (on the right picture).
type: integer valuated to:
Page 76 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 77 ---

AbsoluteSagValue
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
Global Topology Specifications
Global topology specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetTypeAs String, iAttribute As String, iValue) to set a topology attribute
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a topology attribute 
iType is the type of specification and iType ="Topology" for Global Topology Specifications.
AngleBetweenCurves
Local Topology Specifications
CATFmtExternalPointLocalSpec
l1: to create a mesh that does not respect sag
l2: to create a mesh that respects sag 
default value: 1 
Attribute which specifies if the mesh is created with a maximum imposed sag.
type: double valuated to the target maximum sag when AbsoluteSagattribute is valuated to 2.
default value: 1.0 
Attribute which specifies the maximum value of the absolute sag (distance between the geometry of the mesh ).
WARNING: It is taken into account only if theAbsoluteSag attribute is equal to 2
type: integer valuated to:
l1: to ignore automatic mesh capture
l2: to compute automatic mesh capture 
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0. 
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if theAutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
type: double (radian unit)valuated to the angle under which vertices are nactivated
default value: 20°
Attribute which specifies the maximum angle under which a vertex connected exactly to two constrainededges can be inactivated.
Specification attributes are managed usingSimTopologySpecification interface:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lToleranceValue: doublevaluated to the maximum distance between external point and its projection on geometry to mesh. 
default value: 0.
lProjectOnGeometry:integer valuated to the target geometry choice
default value: 1
Description: This specification is used in order to project external points (points that don't belong to the geometry to mesh) in order to constrain the mesh. External points definition(supports) and projection tolerance are mandatory. The overall behavior is the following:
lif the distance between an external point and the geometry to mesh is greater than theToleranceValue, the point will not be projected 
lif thedistance between an external point and the geometry to mesh islower than the ToleranceValue, the point will be projected. The final location of this point depends on ProjectOnGeometry attribute: 
¡if ProjectOnGeometry is equal to 1, the node representing the point will be located exactly on the projection point on the surface geometry 
¡ifProjectOnGeometry is equal to 2, the node representing the point projection will be located exactly on the external point (same Cartesian coordinates)
Page 77 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 78 ---

Local Mesh 1D Specifications
WARNING: 1D grouping specifications are the only supports possible for Local Mesh 1D Specifications. Before creating aLocal Mesh 1D Specification, it is mandatory to create at least one 1D Grouping Specification with the targeted geometry supports.
CATFmtStudioDistributionSpec
History
Distribution specification (named for examplelocalSpec) can be applied only on one edge resulting of an unique grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lType: integer defining the type of distribution valuated to: 
¡1: for a Uniform distribution (Isometric)
¡2: for an Arithmetic distribution 
¡3: for a Geometric distribution 
¡4: for a distribution defined by a Law 
default value: 1
lCombination: integer indicating what are the possible combination for Arithmetic or Geometric distributionsvaluated to: 
¡1: for a distribution defined by the number of elements (NbElements) and the size ratio of the elements (Ratio21) 
¡2: for a distribution defined by the number of elements (NbElements) and the size (Size1) at first vertex 
¡3: for a distribution defined by the number of elements (NbElements) and the size (Size2) at second vertex 
¡4: for a distribution defined by the size ratio (Ratio21) and the size (Size1) at first vertex 
¡5:for a distribution defined by the size ratio (Ratio21) and the size (Size2) at second vertex 
¡6: for a distribution defined by the size (Size1) at first vertex and the size (Size2) at second vertex 
default value: 1
lCombinationUnif:integer indicating what are the possible combination for Uniform distributions valuated to: 
¡1: for a distribution defined by the number of elements (NbElements)
¡2: for a distribution defined by the size (Size1) of the elements 
default value: 1
lNbElementsValue:integer defining the number of elements (NbElements)
default value: 4
lRatioValue: double defining the ratio between the max element size and the min element size (Ratio21)
default value: 1.
lSize1Value: double defining the size at first vertex (Size1) 
default value: 0.
lSize2Value:double defining the size at second vertex (Size2)
default value: 0.
lSymmetry: integer valuated to:
¡1: to keep the distribution unchanged 
¡2: to compute a symmetric distribution with current attributes
default value: 1
lReverse: integer usable for Law and non Uniform distribution valuated to: 
¡1: to keep the distribution unchanged 
¡2: to invert the distribution
default value: 1
Description: This specification creates a node distribution on an edge resulting of a 1D grouping specification. Depending on the choice of the distribution type (Type attribute), Combination or CombinationUnif attributes several various distributions "Option" can be computed. The next table summarize all "Option":
lIsometric (Uniform) distribution is defined by only one attributes(Option 1 and 2): 
¡Nbelements (CombinationUnif= 1) 
¡Size1 (CombinationUnif= 2) 
lNon isometric distribution is defined by two attributes as indicated in the next table. There are six couples of attributes (Option 3 to 8): 
¡Nbelements andRatio21 (Combination = 1) 
¡NbElements andSize1 (Combination = 2) 
¡NbElements andSize2 (Combination = 3) 
¡Ratio21 andSize1 (Combination = 4) 
¡Ratio21 andSize2 (Combination = 5) 
¡Size1 andSize2 (Combination = 6) 
The next table shows examples of various distributions using additional Symmetry and Law attributes.
Version:1 [December 2016]Document created
Page 78 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 79 ---

Coating 1D Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Coating 1D Mesh Part, the late type is "CATFmtCoating1DMesher".
The Coating 1D Mesh Part can be created by using Add method of SimMeshParts object.
Coating 1D Mesh Part Support Definition
The Coating 1D Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Mesh attributes of the Coating 1D mesh part
The attributes referenced in this section drive the Mesh specification of Coating 2D mesh and define precisely what type of mesh is wanted by user.
Mesh specifications can be set or retrieved using the type "Mesh" on the  SetAttributeValue and GetAttributeValue services of the SimMeshPart object.
ExtractionType
Local specifications of the Coating 1D mesh part
The Coating 1D Mesh Part has only one kind of local specifications:mesh local specifications. These specifications are managed by collection object:
lSimMeshSpecifications: for the collection of local mesh specifications 
You should use the following methods ofSimMeshPart object to retrieve these collections:
lGetMeshSpecifications to retrieve the local mesh specification collection 
Local specifications are managed from the collection objects:
lAdd (iType As String) to create a new local specification with: 
¡iType is the late type of the specification to create 
lItem (iIndex) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Attribute of local specification are set using following method from SimMeshSpecification orSimTopologySpecification object depending of the kind of localspecification:
lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute value 
In a manner similar, attribute of local specification are retrieved using following method:
lGetAttributeValue (iAttribute As String, iValue) to retrieve a local specification
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
Coating 1D Mesh Parts AttributesTechnical ArticleAbstract
This article presents an overview of the Coating 1D Mesh Part attributes and its local specifications.
Coating 1D Mesh Part Creation
Coating 1D Mesh Part Support Definition
The Mesh Attributes:
lExtractionType
The Local Specifications:
lCATFmtCoatingLocalSpecification
Type:int
Valuated to 
l1 to generate a 1D element for each edge of the 2D meshes (All Edges). 
l2 to generate a 1D element for each boundary edge of the 2D meshes (Boundary Edges). 
l3 to generate a 1D element for each internal edge of the 2D meshes (Internal Edges). 
l4 to generate a 1D element for each constrained edge of the 2D meshes (Constrained Edges). 
l5 to generate a 1D element for each unconstrained edge of the 2D meshes (Non Constrained Edges).
l6 to generate a 1D element only for local specifications (None). 
Default Value: 1 
This attribute specifies which edges should be extracted from the support. 
Page 79 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 80 ---

lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
CATFmtCoatingLocalSpecification
This specification specifies the edges which are to be included or excluded while computing the coating mesh. You can specify multiple edges to one local specification. If you want to include some edges, and exclude some other then you need to create at least two local specifications. All the edges which are to be included, can be added as support to one local specification with the attribute "LocalExtractionType" valuated to 1. Similarly edges which are to be exclude can be added as support to other local specification with the attribute "LocalExtractionType" valuated to 2.
LocalExtractionType
History
Coating 2D Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Coating 2D Mesh Part, the late type is "CATFmtCoating2DMesher".
The Coating 2D Mesh Part can be created by using Add method of SimMeshParts object.
Coating 2D Mesh Part Support Definition
The Coating 2D Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Mesh attributes of the Coating 2D mesh part
The attributes referenced in this section drive the Mesh specification of Coating 2D mesh and define precisely what type of mesh is wanted by user.
Mesh specifications can be set or retrieved using the type "Mesh" on the  SetAttributeValue and GetAttributeValue services of the SimMeshPart object.
ExtractionType
Local specifications of the Coating 2D mesh part
The Coating 2D Mesh Part has only one kind of local specifications:mesh local specifications. These specifications are managed by collection object:
lSimMeshSpecifications: for the collection of local mesh specifications 
Type:int
Valuated to 
l1 to include the edges defined as support of the local specification 
l2 to exclude the edges defined as support of the local specification
Default Value: 1 
This attribute specifies if the edges defined as support of the local specification should be included (1) or excluded (2).
Version:1 [August 2018]Document created
Coating 2D Mesh Parts AttributesTechnical ArticleAbstract
This article presents an overview of the Coating 2D Mesh Part attributes and its local specifications.
Coating 2D Mesh Part Creation
Coating 2D Mesh Part Support Definition
The Mesh Attributes:
lExtractionType
The Local Specifications:
lCATFmtCoatingLocalSpecification
Type:int
Valuated to 
l1 to extract all the boundary faces 
l2 to don't extract any face
Default Value: 1 
This attribute specifies if the support boundary faces should be extracted from the support mesh (1) or not (2). 
Page 80 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 81 ---

You should use the following methods ofSimMeshPart object to retrieve these collections:
lGetMeshSpecifications to retrieve the local mesh specification collection 
Local specifications are managed from the collection objects:
lAdd (iType As String) to create a new local specification with: 
¡iType is the late type of the specification to create 
lItem (iIndex) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Attribute of local specification are set using following method from SimMeshSpecification orSimTopologySpecification object depending of the kind of localspecification:
lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute value 
In a manner similar, attribute of local specification are retrieved using following method:
lGetAttributeValue (iAttribute As String, iValue) to retrieve a local specification
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
CATFmtCoatingLocalSpecification
This specification specifies the faces which are to be included or excluded while computing the coating mesh. You can specify multiple faces to one local specification. If you want to include some faces, and exclude some other then you need to create at least two local specifications. All the faces which are to be included, can be added as support to one local specification with the attribute "LocalExtractionType" valuated to 1. Similarly faces which are to be exclude can be added as support to other local specification with the attribute "LocalExtractionType" valuated to 2.
LocalExtractionType
History
Hex-Dominant Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the hex-dominant mesh part, the late type is "CATFmtHexMesher".
The hex-dominant mesh part can be created by using Add method of SimMeshParts object.
Type:int
Valuated to 
l1 to include the faces defined as support of the local specification 
l2 to exclude the faces defined as support of the local specification
Default Value: 1 
This attribute specifies if the faces defined as support of the local specification should be included (1) or excluded (2).
Version:1 [August 2018]Document created
Hex-Dominant Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Hex-Dominant Mesh Part attributes and its local specifications.
Hex-Dominant Mesh Part Creation
Hex-Dominant Mesh Part Support Definition
Global Mesh Specifications
lSize
lMinSize
lAngle
lUseBoundaryLayers
lSize1Value
lUseNbElements
lNbElementsValue
lSplitting
Local Mesh Specifications
lCATFmtHexLocalMeshSizeFace
lCATFmtHexLocalMeshSizeBox
Page 81 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 82 ---

Hex-Dominant Mesh Part Support Definition
The Hex-Dominant Mesh Part support can be initialized and managed using the AddSupport method ofSimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part 
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods ofSimMeshPart object: 
lSetAttributeValue ( iSetType As String, iAttribute As String, iValue ) to set a mesh attribute
lGetAttributeValue ( iSetType As String, iAttribute As String, oValue ) to get a mesh attribute value 
iAttribute is the name of specification and iSetType = "Mesh" for all Global MeshSpecifications.
Size
MinSize
Angle
UseBoundaryLayers
Size1Value
UseNbElements
NbElementsValue
Splitting
Local Mesh Specifications
Local mesh specifications are created by the Add method of theSimMeshSpecifications object.
lAdd (iType As String ) with: 
¡iType is the late type of the mesh specification to create. 
Type: double
Valuated to mesh elements maximum target size. This attribute specifies the maximum mesh element size that the mesher tries to respect. 
Type: double
Valuated to mesh elements minimum target size. This attribute specifies the minimum mesh element size that the mesher tries to respect. 
Type:double (radians)
Valuated to the angle under which edges are not captured. 
This attribute specifies the smallest angle θ between adjacent faces that will result in an edge between meshelement faces.
Type:int
Valuated to 
l1 to produce a mesh without boundary layers 
l2 to produce a mesh with boundary layers
This attribute specifies whether boundary layers should be added to the mesh (2) or not (1).
Type: double
Valuated the expected thickness for the first layer. 
This attribute specifies the thickness of the first layer of elements that the mesher tries to respect along the boundary.
Warning: this attribute is only taken into account if UseBoundaryLayers is set to 2.
Type:int
Valuated to 
l1 to let the mesher compute the number of boundary layers automatically 
l2 to specify the expected number of boundary layers 
This attribute specified if the number of boundary layers is an user input (2) or not (1).If it is set to 1, the mesher will compute the number of boundary layers automatically based on the mesh size to ensure smooth transition towards the interior of the volume.
Warning: this attribute is only taken into account if UseBoundaryLayers is set to 2. 
Type:int
Valuated to the expected number of boundary layers.
This attribute specified the number of boundary layers to be generated along the boundary.
Warning: this attribute is only taken into account if UseBoundaryLayers andUseNbElements are both set to 2. 
Type: int
Valuated to 
l1 to use the default method which provides better accuracy in capturing sharp edges. 
l2 to use the alternative method, the "Standard edge capture", which is typically more robust when dealing with complex, dirty geometry. 
This attribute specified which method is used to manage edge capture while creating a hex-dominant mesh.
Page 82 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 83 ---

The Item and the Remove methods work with an index which is the position of the specification in the collection. The position index starts from 1.
The support of the local topology specification is managed by theSimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String )
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
The specification values are managed by the following methods ofSimMeshSpecification:
lGetAttributeValue (iAttribute As String, oValue ) 
lSetAttributeValue (iAttribute As String, iValue ) 
¡iAttribute is the attribute name to set/retrieve. 
CATFmtHexLocalMeshSizeFace
CATFmtHexLocalMeshSizeBox
Octree Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Octreee Mesh Part, the late type is "CATFmtOctree3DRulesMesher" for a tri-dimensional mesh (to mesh a solid with tetrahedron elements) and "CATFmtOctree2DRulesMesher" for a surface mesh (to mesh a surface with triangle elements).
The size to be applied on the support faces is specified through GetAttributeValue andSetAttributeValue with iName = "SizeValue" (typedouble). 
This specification is used to refine the mesh along a given set of faces.The target size should be lower than the maximum mesh size given through the global Size attribute. 
All specification attributes are specified through GetAttribute and SetAttribute:
lOriginX (type double): the X coordinate of the lower left corner of the box 
lOriginY (type double): the Y coordinate of the lower left corner of the box 
lOriginZ (type double): the Z coordinate of the lower left corner of the box 
lVector0X (type double): the dimension of the box along the X axis 
lVector1Y (type double): the dimensionof the box along the Y axis 
lVector2Z (type double): the dimension of the box along the Z axis 
lSizeValue (typedouble): the target mesh size inside the box 
This specification is used to refine the mesh inside a given Cartesian box: the box is defined by its lower left corner and a vector transforming it into the upper right corner, as shown on the picture below.The target size should be lower than the maximum mesh size given through the global Size attribute.
Octree Mesh Parts AttributesTechnical ArticleAbstract
This article presents an overview of the Octree Mesh Parts attributes and their local specifications.
Octree Mesh Part Creation
Octree Mesh Part Support Definition
The Mesh Attributes:
lMeshSizeValue
lElementOrder
lAbsoluteSag
lAbsoluteSagValue
lProportionalSag
lProportionalSagValue
lMinMeshSize
lQualityCriteria
lInteriorSize
lInteriorSizeValue
lMeshSimplification
lMeshSimplificationValue
lMinJacobian
lMinJacobianValue
lGlobalSplit
The Local Specifications:
lCATFmtLocalSpecLocalSize
lCATFmtLocalMeshDistribution
lCATFmtImposedGeometries
lCATFmtPreserveGeometries
Page 83 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 84 ---

The Octree Mesh Part can be created by using Add method of SimMeshParts object.
Octree Mesh Part Support Definition
The Octree Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Mesh attributes of the Octree mesh part
The attributes referenced in this section drive the Mesh specification of Octree mesh and define precisely what type of mesh is wanted by user.
Mesh specifications can be set or retrieved using the type "Mesh" on the  SetAttributeValue and GetAttributeValueservices of the SimMeshPart object.
MeshSizeValue
ElementOrder
AbsoluteSag
AbsoluteSagValue
ProportionalSag
ProportionalSagValue
type: this argument is a doublevaluated to the wanted size for mesh elements (it is an objective).
Attribute which specifies the global size of the mesh (it's an objective, Octree mesher tried toapproach nearest possible from this size).WARNING: the size value is the objective size for "skin" mesh, for 3-dimensional mesh user must give an interior size, else 3D Octree mesher tried to create interior element as biggest as possible. 
type: this argument is aninteger valuated to,
l1 if user wantsto mesh with linear elements (TR3orTR4depending from the type of Octree mesh part: 2D or 3D);
l2 if user wants to mesh with parabolic elements (TR6orTR10). 
Attribute which specifies the degree ofelements that user wants to create: there is two possibilities, linear elements (TR3 or TR4 depending from the Octree mesh part type (2D or 3D)) and parabolic elements (TR6 or TR10).
type: this argument is aninteger valuated to,
l1 if user doesn't want to apply mesh with absolute sag; 
l2 if user wants to apply mesh with absolute sag. 
Attribute which specifies if the mesh is created with an imposed absolute minimum sag. This attribute is linked to the AbsoluteSagValue attribute.
type: this argument is a doublevaluated to the wanted proportionalsag. 
Attribute which specifies the size of the maximum absolute sag accepted, this attribute is active when the "AbsoluteSag" attribute is active only. The maximum size of the sag isimposed and contrary to the proportional sag this one doesn't take in account the "local" size of the mesh: in other terms if the curvature radius of the geometry is big, the imposed sag can imply a very small size for the mesh.
Example: in the right picture the curvature radius is biggest in the first case, that's why, in order to satisfy the imposed sag condition, the size of the mesh is smaller than in the second case. 
This attribute is used only when the AbsoluteSag attribute isactive.
type: this argument is aninteger valuated to,
l1 if user doesn't want to apply mesh with proportional sag; 
l2 if user wants to apply mesh with proportional sag. 
Attribute which specifies if the mesh is created with an imposed proportional minimum sag. This attribute is linked to the ProportionalSagValue attribute.
Attribute which specifies the size of the maximum relative 
Page 84 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 85 ---

MinMeshSize
QualityCriteria
InteriorSize
InteriorSizeValue
MeshSimplification
MeshSimplificationValue
type: this argument is a doublevaluated to the wanted proportionalsag. 
sag accepted, this attribute is active when the"ProportionalSag" attribute is active only. The relative sag iscalculated by the quotient between the Sag and the length of the edge of a mesh element: Sag/Length.
This attribute is used only when the ProportionalSag attribute is active.
type: this argument is adouble valuated to the minimum size for elements even ifthe sag required a smaller size for mesh.
Attribute which specifies the minimum size for mesh. An "objective" size for mesh is specified (MeshSizeValue attribute) but the constrain sag required may implies the decrease of the mesh size in order to satisfy it's condition, that's why a minimum size condition exist even if the Octree mesher tries to approach the global mesh size specified.
type: this argument is aninteger  valuated to,
l1 if user wants to respect "Skewness" factor for the mesh; 
l2 if user wants to respect "Stretch" factor for the mesh; 
l3 if user wants to respect "Shape" factor for the mesh.
Attribute which specifies the factor that user wants to respect for the elements of the mesh. Octree mesher provide the possibility for user to control one of thesearguments.
type: this argument is aninteger  valuated to,
l1 if userdoesn't want to apply an imposed maximum interior size for mesh;
l2 if user  wants to apply an    maximum imposed interior size for mesh. 
WARNING: this attribute is active when the part isan octree 3D only (because interior size has no sense for surface mesh).
Attribute which specifies if user wants toapply an imposed maximum size for the interior size of the 3D mesh; because, by default, Octree mesher tried to mesh the interior of the solid as biggest as possible. This attribute provide to user the possibility to limit this expansion by imposing a maximum size.Example: On the right example, the first picture represent the mesh without imposed interior size contrary to the second one where the interior size was imposed at the same size than the global mesh size(the mesh is more regular) .
type: this argument is a doublevaluated to the wanted proportional sag. Attributes which specifies the value of the imposed interior size for 3D mesh when the InteriorSizeattribute is active.
type: this argument is aninteger valuated to,
l1 if user doesn't want to apply a minimum size for mesh elements; 
l2if user wants to apply a minimum size for mesh elements.
Attribute which specifies the minimum size for a mesh edge, in order to optimize the regularity of the mesh, user can apply the suppression of small mesh elements by activation of this attribute. 
The right example show the difference between an octree mesh without mesh edges suppression (the highest picture) and with the suppression of smallest mesh edges.
Page 85 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 86 ---

MinJacobian
MinJacobianValue
GlobalSplit
Local specifications of the Octree mesh part
The Octree Mesh Part has only one kind of local specifications: mesh local specifications. These specifications are managed by collection object:
lSimMeshSpecifications: for the collection of local mesh specifications 
You should use the following methods ofSimMeshPart object to retrieve these collections:
lGetMeshSpecifications to retrieve the local mesh specification collection 
Local specifications are managed from the collection objects:
lAdd (iType As String) to create a new local specification with: 
¡iType is the late type of the specification to create 
lItem (iIndex) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Attribute of local specification are set using following method from SimMeshSpecification orSimTopologySpecification object depending of the kind of localspecification:
lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute value 
In a manner similar, attribute of local specification are retrieved using following method:
lGetAttributeValue (iAttribute As String, iValue) to retrieve a local specification
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
type: this argument is a doublevaluated to the wanted mesh simplification. Attributes which specifies the value of the minimum size for mesh elements when the MeshSimplification attribute is active.
Warning: This attribute is available only for parabolic tetrahedron elements (TE10).
type: this argument is an integer valuated to,
l1 if user doesn't want to project intermediate mesh nodes on geometry;
l2 if user wants to project intermediate mesh nodes ongeometry.  
Attribute which specifies if the intermediate mesh nodes are created on the geometry. This attribute is linked to theMinJacobianValue attribute.
type: this argument is a doublevaluated to the wanted minimum size for Jacobian value for which the intermediate nodes is on geometry.
Attribute which specifies the minimum Jacobian accepted for each parabolic element of the mesh when the MinJacobian attribute is active.
type: this argument is aninteger valuated to,
l1 if user doesn't want ensure at least two layer elements in the tickness of thin geometry; 
l2 if user wants ensure at least twolayer elements in the tickness of thin geometry; 
This Attribute concerns only tri-dimensional mesh (to mesh a solid withtetrahedron elements) 
Attribute which specifies if the minimum of two mesh elements layers in thin geometries.
Page 86 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 87 ---

CATFmtLocalSpecLocalSize
This specification is used in order to specify a local mesh size or sag. Support,  0D, 1D, 2D or 3D supports are authorized
SizeValue
AbsoluteSag
AbsoluteSagValue
CATFmtLocalMeshDistribution
NbElementsValue
Size1Value
CATFmtImposedGeometries
type:this argument is a doubleused in order to specify a local mesh size to points, edges, faces or volumes of the geometry. Attribute  which define a local size for mesh in a set of faces or edges.
type: this argument is aninteger used in order to specify a local mesh sag tofaces or edges of the geometry:
l1 if user doesn't want to apply a local mesh sag 
l2 if user wants to Apply a local mesh sag 
Attribute which specifies if the specification is created with an local sag on 1D or 2D supports.This attribute is linked to the AbsoluteSagValue attribute.
type: this argument is a length (double) value that specifies the local mesh sag value applied tofaces or edges of the geometry.
Specification  which define a local sag for mesh in faces of edges. See also the definition of the sag.
This attribute is used only when the AbsoluteSag attribute is active.
type: this attribute is an integerwhich specifies the number of mesh edges wanted on a specified geometry:
Authorized supports: 1D and 2D supports are authorized only.
Specification which specifies an imposed meshdistribution on edges of the geometry.
type: this attribute is a double value used in order to impose the size of mesh edges wanted on the specified edges of the geometry.
Authorized supports: 1D and 2D supports are authorized only.
Specification which specifies an imposed mesh distribution  edges size of the geometry.
Page 87 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 88 ---

CATFmtPreserveGeometries
History
Offset Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Offset mesh part, the late type is "CATFmtOffsetMesher".
type: this specification is used in order to impose mesh (nodes) on points of the geometry.
Authorized supports: 0D supports are authorized only.
ToleranceValue: doublevaluated to the maximum distance between external point and its projection on geometry to mesh. 
Specification which specifies imposed nodes of the mesh.
lif the distance between an external point and the geometry to mesh is greater than the ToleranceValue, the point will not be projected
lif the distance between an external point and the geometry to mesh is lower than the ToleranceValue, the point will be projected
type: this specification is used in order to preserve mesh nodes and mesh edges of a specified mesh part geometry.
Authorized supports: 0D, 1D and 2D supports are authorized only. For 2D support, faces boundaries are preserved
Specification which preserve nodes and edges of the mesh for a given geometry of mesh part.
Version:1 [October 2014]Document created
Offset Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Offset Mesh Part attributes and its local specifications.
Offset Mesh Part Creation
Offset Mesh Part Support Definition
Global Mesh Specifications:
lDistance
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
lNbCopies
Page 88 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 89 ---

The Offset mesh part can be created by usingAdd method of SimMeshParts object.
Offset Mesh Part Support Definition
Offset Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupportAs AnyObject ) to add a new support to the mesh part 
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Distance
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
NbCopies
History
type:double valuated to a length.
default value: 0.2 Attribute which specifies the distance of the offset between the two meshes.
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
type:integer valuated to the number of offsetedmeshes.
default value: 1 Attribute which specifies the number of offset meshes that we want to create.
Version:1 [October 2014]Document created
Offset Extrusion Mesh Part AttributesTechnical Article
Abstract
This article presents an overview of the Offset Extrusion Mesh Part attributes and its local specifications.
Offset Extrusion Mesh Part Creation
Offset Extrusion Mesh Part Support Definition
Global Mesh Specifications:
lStart
lEnd
lType
lRatioValue
lNbElementsValue
Page 89 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 90 ---

Offset Extrusion Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Offset Extrusion mesh part, the late type is "CATFmtExtrusionOffsetMesher".
The Offset Extrusion mesh part can be created by using Add method of SimMeshParts object.
Offset Extrusion Mesh Part Support Definition
Offset Extrusion Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Start
End
Type
RatioValue
NbElementsValue
lSymmetry
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
type:double valuated to a length.
default value: 0. Attribute which specifies the distance from the original mesh where the extrusion will begin. This attribute is linked to the attribute End.
type: double valuated to a length.
default value: 0. Attribute which specifies the distance from the original mesh where the extrusion will stop. This attribute is linked to the attribute Start. 
type: integer valuated to:
l1: to get an uniform distribution 
l2: to get an arithmetic distribution 
l3: to get a geometric distribution
default value: 1
This attribute specifies the size distribution to be applied to the mesh. 
The picture shows how a uniform distribution (at the bottom) differs from a geometric one (at the top, using a ratio of 3).
type: double valuated to the size ratio between the first and last layer thicknesses.
default value: 1.0
This attribute specifies thesize ratio R between the first layer thickness h1 and lastlayer thickness h2.
R = h2 /h1
WARNING: It is taken into account only if theTypeattribute is equal to 2 or 3. 
type: integer valuated to the expected number of layers.
default value: 1 This attribute specifies the number of layers to be added to the volume mesh.
Page 90 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 91 ---

Symmetry
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
History
type: boolean valuated to create an extrusion which is symmetric.
default value: false
Attribute which specifies if we want to create a symmetric extrusion, thesymmetrical plane is located ad the middle of the extrusion.
WARNING: It is taken into account only if theType attribute is equal to 2 or 3.
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
Version: 1 [November 2014]Document created
Partition Hex Mesh Part AttributesTechnical Article
Abstract
This article presents an overview of the Partition Hex Mesh Part attributes and its local specifications.
Partition Hex Mesh Part Creation
Partition Hex Mesh Part Support Definition
Global Mesh Specifications
lMeshSizeValue
lElementOrder
lNonHexShapeAndOrder
Local Mesh Specifications
lCATFmtStudioDistributionSpec (Edge Distribution): 
¡Type
¡Combination
¡CombinationUnif
¡NbElementsValue
¡RatioValue
¡Size1Value
¡Size2Value
¡Symmetry
Page 91 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 92 ---

Partition Hex Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the partition hex mesh part, the late type is "CATFmtPartitionHexMesher".
The partition hex mesh part can be created by using Add method of SimMeshParts object.
Partition Hex Mesh Part Support Definition
The Partition Hex Mesh Part support can be initialized and managed using the AddSupport method ofSimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part 
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods ofSimMeshPart object: 
lSetAttributeValue ( iSetType As String, iAttribute As String, iValue ) to set a mesh attribute
lGetAttributeValue ( iSetType As String, iAttribute As String, oValue ) to get a mesh attribute value 
iAttribute is the name of specification and iSetType = "Mesh" for all Global Mesh Specifications.
MeshSizeValue
ElementOrder
NonHexShapeAndOrder
Local Mesh Specifications
Local mesh specifications are created by the Add method of theSimMeshSpecifications object.
lAdd (iType As String ) with: 
¡iType is the late type of the mesh specification to create. 
The Item and the Remove methods work with an index which is the position of the specification in the collection. The position index starts from 1.
The support of the local topology specification is managed by theSimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String )
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
The specification values are managed by the following methods ofSimMeshSpecification:
lGetAttributeValue (iAttribute As String, oValue ) 
lSetAttributeValue (iAttribute As String, iValue ) 
¡iAttribute is the attribute name to set/retrieve. 
CATFmtStudioDistributionSpec
¡Reverse
Type:double
valuated to the wanted size for mesh elements (it isan objective). 
Attribute which specifies the global size of the mesh (it's an objective, Partition Hex mesher tried to approach nearest possible from this size). 
Type:integer
valuated to: 
l1: to get a mesh withlinear hexaedron (HE8) 
l2: to get a mesh with quadratic hexaedron (HE20) 
default value: 1
Attribute which specifies the number of intermediate nodes per element edge, as shown on the pictures (the left one shows a linear hexahedron and the right one shows a parabolic hexahedron). 
Type:integer
valuated to: 
l1: to get a mesh with quadratic tetrahedrons (TE10). 
l2: to get a mesh with linear tetrahedrons (TE4). 
l3: to use a mesh with linear tetrahedrons and pyramids (TE4 and PY5 or TE10 and PY13)
default value: 1 
This attribute specifies the which kind of elements will be used for the non hex elements.
Distribution specification (named for example localSpec) can be applied only on one edge
Page 92 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 93 ---

resulting of an unique grouping specification.Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lType: integer defining the type of distribution valuated to: 
¡1: for a Uniform distribution (Isometric) 
¡2: for an Arithmetic distribution 
¡3: for a Geometric distribution 
¡4: for a distribution defined by a Law 
default value: 1
lCombination:integer indicating what are the possible combination for Arithmetic or Geometric distributions valuated to: 
¡1:for a distribution defined by the number of elements (NbElements) and the size ratio of the elements (Ratio21) 
¡2: for a distribution defined by thenumber of elements (NbElements) and the size (Size1) at first vertex 
¡3: for a distribution defined by the number of elements (NbElements) and the size (Size2) at second vertex 
¡4: for a distribution defined by the size ratio (Ratio21) and the size (Size1) at first vertex 
¡5:for a distribution defined by the size ratio (Ratio21) and the size (Size2) at second vertex 
¡6: for a distribution defined by the size (Size1) at first vertex and the size (Size2) at second vertex 
default value: 1
lCombinationUnif:integer indicating what are the possible combination for Uniform distributions valuated to: 
¡1: for a distribution defined by the number of elements (NbElements)
¡2: for a distribution defined by the size (Size1) of the elements 
default value: 1
lNbElementsValue:integer defining the number of elements (NbElements)
default value: 4
lRatioValue: double defining the ratiobetween the max element size and the min element size (Ratio21)
default value: 1.
lSize1Value: double defining the size at first vertex (Size1) 
default value: 0.
lSize2Value:double defining the size at second vertex (Size2)
default value: 0.
lSymmetry: integer valuated to:
¡1: to keep the distribution unchanged 
¡2: to compute a symmetric distribution with current attributes
default value: 1
lReverse: integer usable for Law and nonUniform distribution valuated to: 
¡1: to keep the distribution unchanged 
¡2: to invert the distribution
default value: 1
Description: This specification creates a node distribution on an edge resulting of a 1D grouping specification.Depending on the choice of the distribution type (Type attribute), Combination or CombinationUnif attributes several various distributions "Option" can be computed. The next table summarize all "Option":
lIsometric (Uniform) distribution is defined by only one attributes(Option 1 and 2): 
¡Nbelements (CombinationUnif= 1) 
¡Size1 (CombinationUnif= 2) 
lNon isometric distribution is defined by two attributes as indicated in the next table. There are six couples of attributes (Option 3 to 8): 
¡Nbelements andRatio21 (Combination = 1) 
¡NbElements andSize1 (Combination = 2) 
¡NbElements andSize2 (Combination = 3) 
¡Ratio21 andSize1 (Combination = 4) 
¡Ratio21 andSize2 (Combination = 5) 
¡Size1 andSize2 (Combination = 6) 
The next table shows examples of various distributions using additional Symmetry and Law attributes.
Rotation Mesh Part AttributesTechnical Article
Page 93 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 94 ---

Rotation Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Rotation mesh part, the late type is "CATFmtRotationMesher".
The Rotation mesh part can be created by usingAdd method of SimMeshParts collection object.
Rotation Mesh Part Support Definition
Rotation Mesh Part support can be can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Geometry
The Rotation Mesh Part axis can be set or unset using following methods of the SimMeshPart object:
lSetExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to set the rotation axis where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the rotation axis where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Angle
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
Abstract
This article presents an overview of the Rotation Mesh Part attributes and its local specifications.
Rotation Mesh Part Creation
RotationMesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lAngle
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
lNbCopies
type:double valuated to an angle.
default value: 90deg Attribute which specifies the angle between the original mesh and the new mesh that we want to create thanks to a Rotation transformation. 
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
Page 94 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 95 ---

NbCopies
History
Rotation Extrusion Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Rotation Extrusion mesh part, the late type is "CATFmtExtrusionRotationMesher".
The Rotation Extrusion mesh part can be created by using Add method of SimMeshParts object.
Rotation Extrusion Mesh Part Support Definition
Rotation Extrusion Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Geometry
The Rotation Extrusion Mesh Part axis can be set or unset using following methods of theSimMeshPart object:
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to set the rotation axis where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the rotation axis where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Start
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
type:integer valuated to the number of translatedmeshes.
default value: 1 Attribute which specifies the number of translated meshes that we want to create.
Version:1 [October 2014]Document created
Rotation Extrusion Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Rotation Extrusion Mesh Part attributes and its local specifications.
Rotation Extrusion Mesh Part Creation
Rotation Extrusion Mesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lStart
lEnd
lType
lRatioValue
lNbElementsValue
lSymmetry
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Page 95 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 96 ---

End
Type
RatioValue
NbElementsValue
Symmetry
AutomaticMeshCapture
type: doublevaluated to an angle.
default value: 0.deg Attribute which specifies the angle from the original mesh where the extrusion will begin. This attribute is linked to the attributeEnd. 
type: doublevaluated to an angle. 
default value: 0.deg Attribute which specifies the angle from the original mesh where the extrusion will stop. This attribute is linked to the attributeStart. 
type: integer valuated to:
l1: to get an uniform distribution 
l2: to get an arithmetic distribution 
l3: to get a geometricdistribution 
default value: 1
This attribute specifies the size distribution to be applied to the mesh.
The picture shows how a uniform distribution (at the bottom) differs from a geometric one (at the top, using a ratio of 3).
type: double valuated to the size ratio between the first and last layer thicknesses.
default value: 1.0
This attribute specifies the size ratioR between the first layer thickness h1 and last layer thickness h2.
R = h2 / h1
WARNING: It is taken into account only if the Typeattribute is equal to 2 or 3.
type: integer valuated to the expected number of layers. 
default value: 1 This attribute specifies the number of layers to be added to the volume mesh.
type: boolean valuated to create an extrusion which is symmetric.
default value: false
Attribute which specifies if we want to create a symmetric extrusion, the symmetrical plane is located ad the middle of the extrusion.
WARNING: It is taken into account only if theType attribute is equal to 2 or 3.
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
Page 96 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 97 ---

AutomaticMeshCaptureTolValue
History
Spine Extrusion Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is tobe created.
In the case of the Spine Extrusion mesh part, the late type is "CATFmtExtrusionSpineMesher".
The Spine Extrusion mesh part can be created by using Add method of SimMeshParts object.
Spine Extrusion Mesh Part Support Definition
Spine Extrusion Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Geometry
The Spine Extrusion Mesh Part spine can be set or unset using following methods of the SimMeshPart object:
lSetExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to set the spine where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric spine
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the spine where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric spine
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Start
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
Version: 1 [November 2014]Document created
Spine Extrusion Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Spine Extrusion Mesh Part attributes and its local specifications. 
Spine Extrusion Mesh Part Creation
Spine Extrusion Mesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lStart
lEnd
lAnchorPoint
lType
lRatioValue
lNbElementsValue
lSymmetry
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Page 97 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 98 ---

End
AnchorPoint
Type
RatioValue
NbElementsValue
Symmetry
type: doublevaluated to a length.
default value: 0. Attribute which specifies the distance from the original mesh where the extrusion will begin. This attribute is linked to the attribute End.
type: double valuated to a length.
default value: 0. Attribute which specifies the distance from the original mesh where the extrusion will stop. This attribute is linked to the attribute Start. 
type:point valuated to define the beginning of the curve that we take into account for the extrusion Attribute which specifies the first point from the the spine curve that the extrusion algorithm will take intoaccount in order to generate the extruded mesh.
type: integer valuated to: 
l1: to get an uniform distribution 
l2: to get an arithmetic distribution 
l3: to get a geometricdistribution 
default value: 1
This attribute specifies the size distribution to be applied to the mesh. 
The picture shows how auniform distribution (at the bottom) differs from a geometric one (at the top, using a ratio of 3).
type: double valuated to the size ratio between the first and last layer thicknesses.
default value: 1.0
This attribute specifies thesize ratio R between the first layer thickness h1 and lastlayer thickness h2.
R = h2 / h1
WARNING: It is taken into account only if the Typeattribute is equal to 2 or 3.
type: integer valuated to the expected number of layers.
default value: 1 This attribute specifies the number of layers to be added to the volume mesh.
type: boolean valuated to create anextrusion which is symmetric. 
default value: false
Attribute which specifies if we want to create a symmetric extrusion, thesymmetrical plane is located ad the middle of the extrusion.
WARNING: It is taken into account only if theType attribute is equal to 2 or 3.
Page 98 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 99 ---

AutomaticMeshCapture
AutomaticMeshCaptureTolValue
History
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
Version: 1 [November 2014]Document created
Surface Quadrangle Mesh Part AttributesTechnical Article
Abstract
This article presents an overview of the Surface Quadrangle Mesh Part attributes and its local specifications.
Surface Quadrangle Mesh Part Creation:
Surface Quadrangle Mesh Part Support Definition:
lCleanedGeometry
lCleaningMode
Global Mesh Specifications:
lMeshSizeValue
lElementShape
lAutoMap
lElementOrder
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Global Topology Specifications:
lAngleBetweenCurves
lAngleBetweenFaces
lCurvatureAngle
lOffsetValue
lOffsetFromThickness
lAutomaticCurveCapture
lGeometrySimplification
lGeometrySimplificationValue
l2DHolesSuppression
l2DHolesMaxDiameter
lLogosSuppression
lLogosMaxHeight
lLogosMaxSize
Local Specifications:
Local Topology Specifications:
lCATFmtConstrainEdgeLocalSpec (Constrain Edge) 
lCATFmtUnconstrainEdgeLocalSpec (Unconstrain Edge) 
lCATFmtConstrainHoleLocalSpec (Constrain Hole) 
lCATFmtUnconstrainHoleLocalSpec (Unconstrain Hole) 
lCATFmtGroupingLocalSpec (Group Geometries) 
lCATFmtExternalPointLocalSpec (Imposed Point): 
¡ToleranceValue
¡ProjectOnGeometry
lCATFmtExternalCurveLocalSpec (Imposed Curve): 
¡ToleranceValue
lCATFmtExternalCurveWeldLocalSpec (Imposed Weld Curve): 
¡ReuseConnectionParameters
¡ToleranceValue
¡NbRows
¡Height1
¡Height2
¡Height3
Page 99 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 100 ---

Surface Quadrangle Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Surface Quadrangle Mesh Part, the late type is "CATFmtSurfQuadMesher".
The Surface Quadrangle Mesh Part can be created by using Add method of SimMeshParts object.
Surface Mesh Part Support Definition
The Surface Quadrangle Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
CleanedGeometry
Surface Quadrangle Mesh Part support can be optionally modified to keep a subset of the previous geometry. For that purpose, the list of geometry to keep or to removehas to be managed using the following methods with iSetType = "Topology" and iAttribute = "CleanedGeometry":
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to add external reference to the mesh part 
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to remove external reference from the mesh part
Other mesh part attributes support definition are managed using following methods:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute with an integer value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute with an integer value 
where iType is the type of specification and iType ="Topology" for support definition and iName the attribute name.
CleaningMode
¡SelfWelding
Local Mesh 1D Specifications:
lCATFmtStudioDistributionSpec (Edge Distribution): 
¡Type
¡Combination
¡CombinationUnif
¡NbElementsValue
¡RatioValue
¡Size1Value
¡Size2Value
¡Symmetry
¡Reverse
lCATFmtStudioHoleSpec (Edge Distribution around Hole): 
¡NbElements
¡NbRows
¡Heigth1
¡Heigth2
¡Heigth3
lCATFmtStudioBoundaryLayerSpec (Edges Distribution around Curves): 
¡NbRows
¡Heigth1
¡Heigth2
¡Heigth3
lCATFmtStudioCaptureSpec (Element Capture): 
¡ManualMeshCaptureMode
¡ManualMeshCaptureTolValue
lCATFmtStudioPropagationSpec (Distribution Propagation): 
¡PropagationMode
¡Geometry
Local Mesh 2D Specifications:
lCATFmtStudioFrontQuadSpec (Frontal Quadrangle Method): 
¡SizeValue
lCATFmtStudioFrontTriaSpec (Frontal Triangle Method): 
¡SizeValue
lCATFmtStudioMappedSpec (Mapped Method): 
¡SizeValue
lCATFmtStudioMappedFreeMinimalSpec (Mapped Minimal Method): 
¡TriangularShape
lCATFmtStudioMappedFreeSpec (Mapped Free Method): 
¡SizeValue
¡TriangularShape
lCATFmtStudioBeadSpec (Bead Method):
¡SizeValue
lCATFmtStudioHalfBeadSpec (Half Bead Method): 
¡SizeValue
lCATFmtStudioFaceCaptureSpec (Face Capture): 
¡MeshSources
¡Tolerance
¡ManualMeshCaptureMode
type: integer valuated to:
l1: to exclude geometry of CleanedGeometry of supportAttribute which specifies if the geometries stored in CleanedGeometry external references have to 
Page 100 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 101 ---

Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute with an integer value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute with an integer value 
iType is the type of specification and iType ="Mesh" for Global Mesh Specifications.
MeshSizeValue
ElementShape
AutoMap
ElementOrder
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
l2: to keep only geometry of CleanedGeometry as support
default value: 1
be removed from the mesh part support definition or if this geometries will replace the initial support.
type: double valuated to mesh elements size
default value: 0.0 Attribute which specifies the mesh element target size that surface mesher tries torespect.
type: integer valuated to:
l1: to get a mixed mesh with triangle and quadrangle elements 
l2: to get a mesh only with quadrangle elements 
l3: to get a mesh with a minimal number of quadrangle and triangle elements 
default value: 1
There is two different elements types:quadrangle elements and triangle elements.
Attribute which specifies the type of mesh. The mesh can have:
lboth triangle and quadrangle elements with usually more quadrangle than triangle elements ("Quads Dominant") 
lonly quadrangle elements ("Quads Only") 
lboth triangle and quadrangle elements ("Quads Minimum"). Only topologically and geometrically (4 corners) valid domains are taken into account.
type:integer valuated to:
l1: do not map mesh the support 
l2: map mesh the support whereappropriate 
default value: 1
This attribute specifies whether map mesh is applied on support where appropriate.
WARNING:  It is taken into account only if the ElementShape attribute is equal to 1.
type: integer valuated to:
l1: to get a mesh with linear elements (TR3 or QD4depending on Element Shape choice)
l2: to get a mesh with quadratic elements ( TR6 orQD8 depending on Element Shape choice) 
default value: 1 
Attribute which specifies the number of intermediate nodes per element edge, for example in a case ofquadrangle element we get linear QD4 (on the left picture) or quadratic QD8 (on the right picture).
type: integer valuated to:
l1: to ignore automatic mesh capture
l2: to compute automatic mesh capture 
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0. 
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the geometry than this tolerance, it will not be captured even if theAutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart interface can be used:
lSetMeshPartsToCapture ()
To retrieve the parents mesh parts another method ofSimMeshPart interface can be used:
Page 101 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 102 ---

Global Topology Specifications
Global topology specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetTypeAs String, iAttribute As String, iValue) to set a topology attribute
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a topology attribute 
iType is the type of specification and iType ="Topology" for Global Topology Specifications.
AngleBetweenCurves
AngleBetweenFaces
CurvatureAngle
OffsetValue
OffsetFromThickness
AutomaticCurveCapture
lParent
type: double (radian unit)valuated to the angle under which vertices are inactivated
default value: 20°
Attribute which specifies the maximum angle under which a vertex connected exactly to two constrained edges can be inactivated.
type: double (radian unit)valuated to the angle under which edges are inactivated.
default value: 20°
Attribute which specifies the maximum angle under which an edge connected exactly to two faces can beinactivated during topology computation.
type: double (radian unit)valuated to the angle over which edges are activated.
default value: 20°
Attribute which specifies the minimum angle computed along filleted surfaces over which edges are activated. For a given fillet, when the computed curvature angle isgreater than CurvatureAngle all boundary edges of this fillet are activated otherwise they are not.
type: double valuated to the offset between the geometry and the mesh.
default value: 0.
Attribute which specifies the distance of the offset between the mesh and the geometry.
type: integer valuated to:
l1: if OffsetValue has not been computed from geometry thickness 
l2: if OffsetValue has beencomputed from geometry thickness 
default value: 0.
Attribute which specifies ifOffsetValue has been computed from geometry thickness using forexample CATIGSMThicknessinterface.
type: integer valuated to:
l1: to ignore automatic capture of external curves 
l2: to activate automatic capture of external curves
default value: 1
Attribute which specifies if external curves must be captured automatically. It is possible toautomatically capture curve only when AutomaticMeshCapture attribute value is set to 2 (enabled). The geometries used to compute the projections are the support of the mesh part to be captured. The tolerance used to compute the projections isAutomaticMeshCaptureTolValue.
Page 102 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 103 ---

GeometrySimplification
GeometrySimplificationValue
2DHolesSuppression
2DHolesMaxDiameter
LogosSuppression
LogosMaxHeight
LogosMaxSize
type:integervaluated to:
l1: to keep grouping topologysimplification without additional simplification 
l2: to compute topology simplification 
default value: 2
Attribute which specifies if topology simplification is computed. Topology simplification objective is to minimize the number of bad elements regarding the Min Height element quality criterion. 
type: double valuated to the Min Height criterion targeted for mesh elements.
default value: 0.5 * MeshSizeValue
When geometry simplification is computed, various topology modifications are done automatically using a set of topological operators in order to respectGeometrySimplificationValue(kind of minimum element size quality criterion):
lVertex Creation/Activation/Inactivation
lEdge Creation/Activation/Inactivation 
lEdge collapse (see picture) 
lEdge Merge 
type: integer valuated to:
l1: to ignore hole control suppression
l2: to control hole suppression 
default value: 1 
Attribute which specifies whether hole suppression will be done. Hole suppression is computed from hole diameter value.
For example in the right picture, a suppress hole size (2DHolesMaxDiameter attribute) was specified for the meshpart. Hole 1 diameter is below than this value and was ignoredconversely to Hole 2.
type: double valuated to the maximum diameter under which a hole is ignored.
default value: 0.
Attribute which specifies the maximum diameter allowed for hole suppression. This value is computed as the maximum distance between two points of a hole discretization.
WARNING: It is taken into account only if the 2DHolesSuppression attribute is equal to 2.
type: integer valuated to:
l1: to ignore logos control suppression
l2: to control logos suppression 
default value: 1 
Attribute which specifies whether logossuppression will be done.
Logos suppression consists of ignoring small features of the geometry that are useless for the mesh (small height regarding the mesh size). Logos suppression is driven by two attributes: LogosMaxHeight and LogosMaxSize.
For example on the right picture, an ignored logo can be seen.
type: double valuated to the max height of a detectable logo
default value: 0.1 *MeshSizeValue 
Attribute which specifies the maximal heightallowed to detect logos. 
The maximum height of a logo can be defined as the maximum distance of any points on the logo faces to the extrapolated bounding surfaces.
Page 103 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 104 ---

Local Specifications
The Surface Quadrangle Mesh Part has two kind of local specifications: topology and mesh local specifications. These specifications are managed by collection object:
lSimMeshSpecifications: for the collection of local mesh specifications 
lSimTopologySpecifications: for the collection of local topology specifications 
You should use the following methods of SimMeshPart object to retrieve these collections:
lGetMeshSpecifications to retrieve the local mesh specification collection 
lGetTopologySpecification to retrieve the local topology specification collection 
Local specifications are managed from the collection objects:
lAdd (iType As String) to create a new local specification with:
¡iType is the late type of the specification to create
lItem (iIndex) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection 
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Attribute of local specification are set using following method from SimMeshSpecification orSimTopologySpecification object depending of the kind of localspecification:
lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute value 
In a manner similar, attribute of local specification are retrieved using following method:
lGetAttributeValue (iAttribute As String, iValue) to retrieve a local specification
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
Local Topology Specifications
CATFmtConstrainEdgeLocalSpec
CATFmtUnconstrainEdgeLocalSpec
CATFmtConstrainHoleLocalSpec
CATFmtUnconstrainHoleLocalSpec
CATFmtGroupingLocalSpec
type: double valuated to the max size of a detectable logo
default value:MeshSizeValue 
Attribute which specifies the maximal sizeallowed to detect logos. 
The maximum size of a logo can be defined as the maximum distance between two points on the logo boundary (maximum diameter).
Specification attributes are managed usingSimTopologySpecification object:
lOnly geometric attribute (supports)Description: This specification is used in order to constrain a set of edges.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)Description: This specification is used in order to unconstrain a set of edges.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)Description: This specification is used in order to constrain a hole.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)Description: This specification is used in order to unconstrain a hole.
Description: This specification is used in order to group geometries from a set of supports (internal 1D or 2D geometries that belong to the geometry to mesh). The overall behavior is the 
Page 104 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 105 ---

CATFmtExternalPointLocalSpec
CATFmtExternalCurveLocalSpec
CATFmtExternalCurveWeldLocalSpec
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
following:
lif 1D geometries have been selected the program tries to create an edge of the topology per group of connected selected 1D geometries. 1D selected geometries are also constrainedduring this execution.
WARNING: It is possible to select only one support which useful to set local mesh specifications
lif 2D geometries have been selected the program tries to create a domain of the topology per group of connected selected 2D geometries. Consequently, all boundary edges of new created domains are constrained and all internal edges of new created domainsare unconstrained.
Specification attributes are managed usingSimTopologySpecification interface:
lGeometric attribute (supports) 
Other attributes are managed using(GetAttributeValue, SetAttributeValue):
lToleranceValue: doublevaluated to the maximum distance between external point and its projection on geometry to mesh. 
default value: 0.
lProjectOnGeometry:integer valuated to the target geometry choice
default value: 1
Description: This specification is used in order to project external points (points that don't belong to the geometry to mesh) in order to constrain the mesh. External points definition (supports) and projection tolerance are mandatory. The overall behavior is the following:
lif the distance between an external point and the geometry to mesh is greater than theToleranceValue, the point will not be projected
lif thedistance between an external point and the geometry to mesh islower than the ToleranceValue, the point will be projected. The final location of this point depends on ProjectOnGeometry attribute: 
¡if ProjectOnGeometry is equal to 1, the node representing the point will belocated exactly on the projection point on the surface geometry
¡if ProjectOnGeometry is equal to 2, thenode representing the point projection will be locatedexactly on the external point (same Cartesian coordinates)
Specification attributes are managed usingSimTopologySpecification interface:
lGeometric attribute (supports) 
Other attributes are managed using(GetAttributeValue, SetAttributeValue):
lToleranceValue attribute is set and retrieved with: 
¡SetAttributeValue 
¡GetAttributeValue
type: double valuated to the maximum distance between external curves and its projection on geometry to mesh.
default value: 0.
Description: This specification is used in order to project external curves (curves that don't belong to the geometry to mesh) in order to constrain the mesh. External curves definition (supports) and projection tolerance are mandatory. Only relimitations of curves located below this value are projected on the geometry to mesh.
This Imposed Weld Curve specification can be applied on a set of multiple curves whatever the connexity between curves may be. Specification attributes are managed usingSimTopologySpecification interface:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue,SetAttributeValue):
lReuseConnectionParameters attribute : boolean
¡1: to don't reuse connection parameters 
¡2: to reuse connection parameters
lToleranceValue attribute : double
Valuate to the maximum distance between external curves and its projection on geometry to mesh.
¡default value: 0. 
lNbRows attribute :integer
Valuate the number of regular layers (row) of mesh around the edges. The possible value are{0,1,2,3}
¡default value: 0. 
lHeight1, Height2 and Height3 attributes:double
Valuate respectively to the element height of the first, second and third row if specified.
¡Height1 default value: 0.
Description:This specification enables to project a set of curves within a geometric tolerance value. Only relimitations of curves located below this value are projected on the geometry to mesh. An uniform distribution is also created per each group of contiguous projected curves. The nodes distribution of any set of contiguous projected curves is the projection of the uniform nodesdistribution (based on the mesh size value) computed on the set of the corresponding curves to be projected. Thus the number of nodes of each resulting distribution is not dependent of the projected curves. If at least one row is requested, additional regular layers of elements are created along each sides of the projected curves. To use this specification the following attributes have to be set:
lNbRow
lHeight1, Height2, Height3 depending on the value of NbRows:
¡if NbRows is equal to 1, Height1 attribute has to be set
¡if NbRows is equal to 2, Height1 and Height2 attributes have to be set 
¡if NbRows is equal to 3, Height1, Height2 and Height3 attributes have to be set 
Page 105 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 106 ---

Local Mesh 1D Specifications
WARNING: 1D grouping specifications are the only supports possible for Local Mesh 1D Specifications. Before creating aLocal Mesh 1D Specification, it is mandatory to create at least one 1D Grouping Specification with the targeted geometry supports.
CATFmtStudioDistributionSpec
¡Height2 default value: 0. 
¡Height3 default value: 0. 
lSelfWelding attribute :boolean
¡1: To disable self welding capability. 
¡2: To enable self welding capability.
¡default value: 1. 
Distribution specification (named for examplelocalSpec) can be applied only on one edge resulting of an unique grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lType: integer defining the type of distribution valuated to: 
¡1: for a Uniform distribution (Isometric)
¡2: for an Arithmetic distribution 
¡3: for a Geometric distribution 
¡4: for a distribution defined by a Law 
default value: 1
lCombination: integer indicating what are the possible combination for Arithmetic or Geometric distributions valuated to: 
¡1: for a distribution defined by the number of elements (NbElements) and the size ratio of the elements (Ratio21) 
¡2: for a distribution defined by the number of elements (NbElements) and the size (Size1) at first vertex 
¡3: for a distribution defined by the number of elements (NbElements) and the size (Size2) at second vertex 
¡4: for a distribution defined by the size ratio (Ratio21) and the size (Size1) at first vertex 
¡5:for a distribution defined by the size ratio (Ratio21) and the size (Size2) at second vertex 
¡6: for a distribution defined by the size (Size1) at first vertex and the size (Size2) at second vertex 
default value: 1
lCombinationUnif:integer indicating what are the possible combination for Uniform distributions valuated to: 
¡1: for a distribution defined by the number of elements (NbElements)
¡2: for a distribution defined by the size (Size1) of the elements 
default value: 1
lNbElementsValue:integer defining the number of elements (NbElements)
default value: 4
lRatioValue: double defining the ratio between the max element size and the min element size (Ratio21)
default value: 1.
lSize1Value: double defining the size at first vertex (Size1) 
default value: 0.
lSize2Value:double defining the size at second vertex (Size2)
default value: 0.
lSymmetry: integer valuated to:
¡1: to keep the distribution unchanged 
¡2: to compute a symmetric distribution with current attributes
default value: 1
Description: This specification creates a node distribution on an edge resulting of a 1D grouping specification. Depending on the choice of the distribution type (Type attribute),Combination or CombinationUnif attributes several various distributions "Option" can be computed; The next table summarize all "Option":
lIsometric (Uniform) distribution is defined by only one attributes(Option 1 and 2):
¡Nbelements (CombinationUnif = 1)
¡Size1 (CombinationUnif = 2) 
lNon isometric distribution is defined by two attributes as indicated in the next table. There are six couples of attributes (Option 3 to 8):
¡Nbelements and Ratio21 (Combination = 1) 
¡NbElements and Size1 (Combination = 2) 
¡NbElements and Size2 (Combination = 3) 
¡Ratio21 and Size1 (Combination = 4) 
¡Ratio21 and Size2 (Combination = 5) 
¡Size1 and Size2 (Combination = 6)
The next table shows examples of various distributions using additional Symmetry and Law attributes.
Page 106 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 107 ---

CATFmtStudioHoleSpec
CATFmtStudioBoundaryLayerSpec
CATFmtStudioCaptureSpec
lReverse: integer usable for Law and non Uniform distribution valuated to: 
¡1: to keep the distribution unchanged 
¡2: to invert the distribution
default value: 1
Hole specification can be applied only on one closed edge resulting ofan unique 1D grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using(GetAttributeValue, SetAttributeValue):
lNbElements:integer valuatedto the number of elements created on the contour
default value: 3
lNbRows: integer valuated to the number of regular layers (row) of mesh around the contour. The possible value are {1,2,3}
default value: 1
lHeight1, Height2 and Height3:double valuated respectively to the element height of the first, second and third row if specified 
Height1 default value: 0.
Height2 default value: 0.
Height3 default value: 0.
Description: This specification creates an uniform node distribution on a internal closed contour resulting of a 1D grouping specification and to get a regular mesh around this contour. To use this specification the following attributes have to be set:
lNbElements 
lNbRows
lHeight1, Height2, Height3 depending on the value of NbRows:
¡if NbRows is equal to 1, Height1 attribute has to be set
¡if NbRows is equal to 2, Height1 and Height2 attributes have to be set 
¡if NbRows is equal to 3, Height1, Height2 and Height3 attributes have to be set 
This mesh around edge specification can be applied only on any edges resulting of 1D grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue,SetAttributeValue):
lNbRows: integer valuated to the number of regular layers (row) of mesh around theedges. The possible value are {1,2,3}
default value: 1
lHeight1, Height2 and Height3: double valuated respectively to the element height of the first, second andthird row if specified 
Height1 default value: 0.
Height2 default value: 0.
Height3 default value: 0.
Description: This specification creates an uniform node distribution on each side of the edges (free ornot) resulting of a 1D grouping specification and to get a regular mesh around these. To use this specification the following attributes have to be set:
lNbRows 
lHeight1, Height2, Height3 depending on the value of NbRows:
¡if NbRows is equal to 1, Height1 attribute has to be set 
¡if NbRows is equal to 2, Height1 and Height2 attributes have to be set 
¡if NbRows is equal to 3, Height1, Height2 and Height3 attributes have to be set
Capture specification can be applied only on oneedge resulting of an unique 1D grouping Description: This specification captures external mesh in order to create compatible meshes with or without geometrically coinciding or duplicated nodes.
Page 107 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 108 ---

CATFmtStudioPropagationSpec
Local Mesh 2D Specifications
WARNING: 2D grouping specifications are the only supports possible for Local Mesh 2D Specifications. It is therefore mandatory to create before one or more grouping 2D specifications with the targeted geometry supports.
CATFmtStudioFrontQuadSpec
specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using methods (GetAttributeValue, SetAttributeValue):
lManualCaptureMeshMode:integervaluated to the capture mode (see picture fordetailed explanations) with possible values {1,2,3}
default value: 1
lManualCaptureMeshTolValue:doublevaluated to the maximum distance under which external mesh is captured. 
default value: 0.
Propagation specification can be applied on a setedges resulting of one or more 1D grouping specifications (supports). Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lPropagationMode:integer valuated to the propagation mode (see picture for detailed explanations) with possible values {1,2,3}
default value: 1
Description: This specification propagates one or more 1D mesh local specifications (specification sources) on several edges (target supports) resulting of one or more 1D grouping specifications. PropagationMode attribute indicates how propagation is computed:
lif PropagationMode is equal to 1 (proportional mode), propagation is computed proportionally (see picture) 
lif PropagationMode is equal to 2 (projection mode), propagation is computed by projection (see picture) 
lifPropagationMode is equal to 3 (directional mode), propagation is computed following a direction given by a geometry. This geometry is managed using following method of SimMeshPart object (with iAttribute="Geometry"):
¡SetExternalReferences 
Frontal Quad 2D mesh specification can be applied on a set of domains resulting of one or more 2D grouping specifications. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
Description: This specification provides quadrangle dominant elements meshes on one or more domains defined by a list of 2Dgrouping specifications.
Page 108 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 109 ---

CATFmtStudioFrontTriaSpec
CATFmtStudioMappedSpec
CATFmtStudioMappedFreeMinimalSpec
lSizeValue:double valuated to the mesh size
default value: 10.
Frontal Tria 2D mesh specification can be applied on a set of domains resulting of one or more 2D grouping specifications. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
Description: This specification provides full triangle elements meshes on one or more domains defined by a list of 2D grouping specifications.
Mapped 2D mesh specification can be applied on one domain resulting ofonly one 2D grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
Description: This specification provides mapped mesh with quadrangle or triangle elements on one domain with quadrangular shape (four corners) defined by only one of 2D grouping specification.
Minimal mesh specification can be applied on only one domain resulting of one 2D grouping specification. Specification attributes are managed usingSimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lTriangularShape: integer valuated to the type of shape of the domain to be meshed:
¡1: the domain to mesh has a quadrangular shape
¡2: the domain to mesh has a triangular shape
Description: This specification provides minimal mesh on one domain with quadrangular or triangular shape (three or four corners) defined by one of 2D grouping specification. Minimal mesh is computed with the minimum of nodes on the domain boundary (a node on each existing nodes or vertices of the topology and a mesh edge between two nodes). The mesh is not dependent of any mesh size. 
Page 109 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 110 ---

CATFmtStudioMappedFreeSpec
CATFmtStudioBeadSpec
CATFmtStudioHalfBeadSpec
default value: 1
Mapped Free mesh specification can be applied on only one domain resulting of only one 2D grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue,SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
lTriangularShape:integer valuated to the type of shape of the domain to be meshed:
¡1: the domain to mesh has a quadrangular shape
¡2: the domain to mesh has a triangular shape
default value: 1
Description: This specification provides mapped free mesh (regular mesh with transitional triangle elements) on one domain with quadrangular or triangular shape (three or four corners) defined by one of 2D groupingspecification.
Bead mesh specification can be applied on only one domain resulting ofonly one 2D grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
Description: This specification provides a specific mesh for bead on one domain defined by one of 2D grouping specification. The domain must have at least two verticeson the boundary to indicate the location of triangle elements.
Half Bead mesh specification can be applied on only one domain resulting of only one 2D grouping 
Description: This specification provides a specificmesh for half bead on one domain defined by one of 2D grouping specification. The domain must have at least three vertices on the boundary to indicate the location of triangle elements.
Page 110 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 111 ---

CATFmtStudioFaceCaptureSpec
History
specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
Face capture specification can be applied on a set of external faces containing the mesh to capture. Specification attributes are managed usingSimMeshSpecification object.
The supports of the specification (external faces) are managed using SimLinkAccess object with iName = "ConnectorList":
lAddLink
lRemoveLink 
lGetAllLinks 
Mesh to capture associated to external faces are managed using SimLinkAccess object withiName= "MeshSources":
lAddLink
lRemoveLink 
lGetAllLinks 
Other attributes are managed using methods (GetAttributeValue, SetAttributeValue):
lManualMeshCaptureMode:integer valuated to the capture mode with possible values{1,2,3}
default value: 1
lTolerance: double valuated to the maximum distance under which external mesh is captured.
default value: 0.
Description: This specification captures external mesh in order to create compatible meshes with or without geometrically coinciding or duplicated nodes. The overallbehavior is the following:
lif ManualMeshCaptureMode is equal to 1 then mesh nodes are located at the captured nodes projection on mesh. 
lif ManualMeshCaptureMode is equal to 2 then mesh nodes are coincident with captured nodes. 
lif ManualMeshCaptureMode is equal to 3 then mesh nodes are shared with captured nodes.
Version:1 [September 2010]Document created
Surface Triangle Mesh Part AttributesTechnical Article
Abstract
This article presents an overview of the Surface Triangle Mesh Part attributes and its local specifications.
Surface Triangle Mesh Part Creation:
Surface Triangle Mesh Part Support Definition:
lCleanedGeometry
lCleaningMode
Global Mesh Specifications:
lMeshSizeValue
lAutoMap
lElementOrder
lAbsoluteSag
lAbsoluteSagValue
lProportionalSag
lProportionalSagValue
lMinCellsPerGap
lMinCellsPerGapValue
lMinMeshSize
lGrowthRatioSurface
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Page 111 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 112 ---

Surface Triangle Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Surface Triangle Mesh Part, the late type is "CATFmtSurfTriaMesher".
The Surface Triangle Mesh Part can be created by using Add method of SimMeshParts object.
Surface Mesh Part Support Definition
The Surface Triangle Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
CleanedGeometry
Surface Triangle Mesh Part support can be optionally modified to keep a subset of the previous geometry. For that purpose, the list of geometry to keep or to removehas to be managed using the following methods with iSetType = "Topology" and iAttribute = "CleanedGeometry":
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to add external reference to the mesh part 
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to remove external reference from the mesh part
Global Topology Specifications:
lAngleBetweenCurves
lAngleBetweenFaces
lCurvatureAngle
lOffsetValue
lOffsetFromThickness
lAutomaticCurveCapture
lGeometrySimplification
lGeometrySimplificationValue
l2DHolesSuppression
l2DHolesMaxDiameter
lLogosSuppression
lLogosMaxHeight
lLogosMaxSize
Local Specifications:
Local Topology Specifications:
lCATFmtConstrainEdgeLocalSpec (Constrain Edge) 
lCATFmtUnconstrainEdgeLocalSpec (Unconstrain Edge) 
lCATFmtConstrainHoleLocalSpec (Constrain Hole) 
lCATFmtUnconstrainHoleLocalSpec (Unconstrain Hole) 
lCATFmtGroupingLocalSpec (Group Geometries) 
lCATFmtExternalPointLocalSpec (Imposed Point): 
¡ToleranceValue
¡ProjectOnGeometry
lCATFmtExternalCurveLocalSpec (Imposed Curve): 
¡ToleranceValue
Local Mesh 1D Specifications:
lCATFmtStudioDistributionSpec (Edge Distribution): 
¡Type
¡Combination
¡CombinationUnif
¡NbElementsValue
¡RatioValue
¡Size1Value
¡Size2Value
¡Symmetry
¡Reverse
lCATFmtStudioHoleSpec (Edge Distribution around Hole): 
¡NbElements
¡NbRows
¡Heigth1
¡Heigth2
¡Heigth3
lCATFmtStudioCaptureSpec (Element Capture): 
¡ManualMeshCaptureMode
¡ManualMeshCaptureTolValue
lCATFmtStudioPropagationSpec (Distribution Propagation): 
¡PropagationMode
¡Geometry
Local Mesh 2D Specifications:
lCATFmtLocalSpecLocalSize (Local Mesh Size) 
lCATFmtStudioFrontTriaSpec (Frontal Triangle Method): 
¡SizeValue
lCATFmtStudioMappedSpec (Mapped Method): 
¡SizeValue
lCATFmtStudioFaceCaptureSpec (Face Capture): 
¡MeshSources
¡Tolerance
¡ManualMeshCaptureMode
Page 112 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 113 ---

Other mesh part attributes support definition are managed using following methods:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute with an integer value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute with an integer value 
where iType is the type of specification and iType ="Topology" for support definition and iName the attribute name.
CleaningMode
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute with an integer value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute with an integer value 
iType is the type of specification and iType ="Mesh" for Global Mesh Specifications.
MeshSizeValue
AutoMap
ElementOrder
AbsoluteSag
AbsoluteSagValue
ProportionalSag
type: integer valuated to:
l1: to exclude geometry of CleanedGeometry of support
l2: to keep only geometry of CleanedGeometry as support
default value: 1
Attribute which specifies if the geometries stored in CleanedGeometry external references have to be removed from the mesh part support definition or if this geometries will replace the initial support.
type:double valuated to mesh elements size.
default value:10. Attribute which specifies the mesh element target size that surface mesher tries torespect.
type:integer valuated to:
l1: do not map mesh the support 
l2: map mesh the support whereappropriate 
default value: 2
This attribute specifies whether map mesh is applied on support where appropriate.
type: integer valuated to:
l1: to get a mesh with linear elements
l2: to get a mesh with quadratic elements
default value: 1 
Attribute which specifiesthe number of intermediate nodes per element edge, either linear TR3 (on the left picture) or quadratic TR6 (on the right picture).
type: integer valuated to:
l1: to create a mesh that does not respect sag
l2: to create a mesh that respects sag 
default value: 1 
Attribute which specifies if the mesh is created with a maximum imposed sag.
type: double valuated to the target maximum sag when AbsoluteSagattribute is valuated to 2.
default value: 1.0 
Attribute which specifies the maximum value of the absolute sag (distance between the geometry of the mesh ).
WARNING: It is taken into account only if theAbsoluteSag attribute is equal to 2
type: integer valuated to:
l1: to create a mesh that does not respect proportional sag 
l2: to create a mesh that respectsproportional sag 
default value: 1
Attribute which specifies if the mesh is created with a imposed maximum proportional sag which is the ratio of the Sag by the Length of a mesh edge element. (Sag/Length).
Page 113 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 114 ---

ProportionalSagValue
MinMeshSize
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
GrowthRatioSurface
MinCellsPerGap
MinCellsPerGapValue
Global Topology Specifications
Global topology specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetTypeAs String, iAttribute As String, iValue) to set a topology attribute
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a topology attribute 
type: double valuated to target proportional sag when ProportionalSag attribute is valuated to 2.
default value: 0.2
Attribute which specifies the maximum value of the proportional sag.
WARNING: It is taken into account only if the ProportionalSag attribute is equal to 2
type: double valuated to target minimum size for elements when AbsoluteSag or ProportionalSag attributes are valuated to 2.
default value: 0.
Attribute which specifies the minimum size when mesh is computed with absolute sag or proportional sag. In that cases, the mesh minimum size can be very small regarding the targetMeshSizeValue and it becomes necessary to control minimum size in order to prevent to have too many elements
WARNING: this attribute is taken into account only if AbsoluteSag orProportionalSag attribute is equal to 2.
type: integer valuated to:
l1: to ignore automatic mesh capture
l2: to compute automatic mesh capture 
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0. 
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the geometry than this tolerance, it will not be captured even if theAutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
type: double valuated to the mesh size growth.
default value: 1.41
Attribute which controls the mesh size growth between neighboring elements on the surface
WARNING: It is taken into account only if the AbsoluteSag orProportionalSagor MinCellsPerGap attribute is equal to2
type: integer valuated to:
l1:to keep the default mesh 
l2:to refine the mesh 
default value: 1
Attribute which specifies the mesh refinement to be applied in narrow regions.
type: integer valuated to the expected number of layers across the thickness.
default value: 1
Attribute which specifies the number of expected layers across the thickness. The mesh is refined (see picture above).
WARNING: It is taken into account only if theMinCellsPerGap attribute is equal to 2.
Page 114 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 115 ---

iType is the type of specification and iType ="Topology" for Global Topology Specifications.
AngleBetweenCurves
AngleBetweenFaces
CurvatureAngle
OffsetValue
OffsetFromThickness
AutomaticCurveCapture
GeometrySimplification
type: double (radian unit)valuated to the angle under which vertices are nactivated
default value: 20°
Attribute which specifies the maximum angle under which a vertex connected exactly to two constrainededges can be inactivated.
type: double (radian unit)valuated to the angle under which edges are inactivated.
default value: 20°
Attribute which specifies the maximum angle under which an edge connected exactly to two faces can beinactivated during topology computation. 
type: double (radian unit)valuated to the angle over which edges areactivated.
default value: 20°
Attribute which specifies the minimum angle computed along filleted surfaces over which edges are activated. For a given fillet, when the computed curvature angleis greater than CurvatureAngleValue all boundary edges of this fillet are activated otherwise they are not.
type: double valuated to the offset between the geometry and the mesh.
default value: 0.
Attribute which specifies the distance of the offset between the mesh and the geometry.
type: integer valuated to:
l1: if OffsetValue has not been computed from geometry thickness 
l2:if OffsetValue has been computed from geometry thickness 
default value: 0.
Attribute which specifies if OffsetValue has been computed from geometry thickness using for example CATIGSMThicknessinterface.
type: integer valuated to:
l1: to ignore automatic capture of external curves 
l2: to activate automatic capture of external curves
default value: 1
Attribute which specifies if external curves must be captured automatically. It is possible toautomatically capture curve only when AutomaticMeshCapture attribute value is set to 2 (enabled). The geometries used to compute the projections are the support of the mesh part to be captured. The tolerance used to compute the projections isAutomaticMeshCaptureTolValue.
Page 115 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 116 ---

GeometrySimplificationValue
2DHolesSuppression
2DHolesMaxDiameter
LogosSuppression
LogosMaxHeight
LogosMaxSize
type:integervaluated to:
l1: to keep grouping topologywithout additional simplification 
l2: to compute topologysimplification 
default value: 2
Attribute which specifies if topology simplification is computed. Topology simplification objective is to minimize the number of bad elements regarding the Min Height element quality criterion. 
type: double valuated to the Min Height criterion targeted for mesh elements.
default value: 0.1 * MeshSizeValue
When topology simplication is computed, different topology modifications are done automatically using a set of topological operators in order to respect Min Height element qualitycriterion:
lVertex Creation/Activation/Inactivation 
lEdge Creation/Activation/Inactivation 
lEdge collapse (see picture)
lEdge Merge 
type: integer valuated to:
l1: to ignore hole control suppression
l2: to control hole suppression 
default value: 1 
Attribute which specifies whether hole suppression will be done. Hole suppression is computed from hole diameter value.
For example in the right picture, a suppress hole size (2DHolesMaxDiameter attribute) was specified for the meshpart. Hole 1 diameter is below than this value and was ignoredconversely to Hole 2.
type: double valuated to the maximum diameter under which a hole is ignored.
default value: 0.
Attribute which specifies the maximum diameter allowed for hole suppression. This value is computed as the maximum distance between two points of a hole discretization.
WARNING: It is taken into account only if the 2DHolesSuppression attribute is equal to 2.
type: integer valuated to:
l1: to ignore logos control suppression
l2: to control logos suppression 
default value: 1 
Attribute which specifies whether logossuppression will be done. 
Logos suppression consists of ignoring small features of the geometry that are useless for the mesh (smallheight regarding the mesh size). Logos suppression is driven by two attributes: LogosMaxHeight and LogosMaxSize.
For example on the right picture, an ignored logo can be seen.
type: double valuated to the max height of a detectable logo
default value: 0.1 *MeshSizeValue 
Attribute which specifies the maximal heightallowed to detect logos. 
The maximum height of a logo can be defined as the maximum distance of any points on the logo faces to the extrapolated bounding surfaces.
Page 116 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 117 ---

Local Specifications
The Surface Triangle Mesh Part has two kind of local specifications: topology and mesh local specifications. These specifications are managed by collection object:
lSimMeshSpecifications: for the collection of local mesh specifications 
lSimTopologySpecifications: for the collection of local topology specifications 
You should use the following methods of SimMeshPart object to retrieve these collections:
lGetMeshSpecifications to retrieve the local mesh specification collection 
lGetTopologySpecification to retrieve the local topology specification collection 
Local specifications are managed from the collection objects:
lAdd (iType As String) to create a new local specification with:
¡iType is the late type of the specification to create
lItem (iIndex) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection 
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Attribute of local specification are set using following method from SimMeshSpecification orSimTopologySpecification object depending of the kind of localspecification:
lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute value 
In a manner similar, attribute of local specification are retrieved using following method:
lGetAttributeValue (iAttribute As String, iValue) to retrieve a local specification
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
Local Topology Specifications
CATFmtConstrainEdgeLocalSpec
CATFmtUnconstrainEdgeLocalSpec
CATFmtConstrainHoleLocalSpec
CATFmtUnconstrainHoleLocalSpec
CATFmtGroupingLocalSpec
type: double valuated to the max size of a detectable logo
default value:MeshSizeValue 
Attribute which specifies the maximal sizeallowed to detect logos. 
The maximum size of a logo can be defined as the maximum distance between two points on the logo boundary (maximum diameter).
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
Description: This specification is used in order to constrain a set of edges resulting of one or more 1Dgrouping specifications.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
Description: This specification is used in order to unconstrain a set of edges resulting of one or more1D grouping specifications.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
Description: This specification is used in order to constrain a hole resulting of one or more 1D grouping specifications.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
Description: This specification is used in order to unconstrain a hole resulting of one or more 1D grouping specifications.
Description: This specification is used in order to group geometries from a set of supports (internal 1D or 2D geometries that belong to the geometry to mesh). The 
Page 117 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 118 ---

CATFmtExternalPointLocalSpec
CATFmtExternalCurveLocalSpec
Local Mesh 1D Specifications
WARNING: 1D grouping specifications are the only supports possible for Local Mesh 1D Specifications. Before creating aLocal Mesh 1D Specification, it is mandatory to create at least one 1D Grouping Specification with the targeted geometry supports.
CATFmtStudioDistributionSpec
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
overall behavior is the following:
lif 1D geometries have been selected the program tries to create an edge of the topology per group of connected selected 1D geometries. 1D selectedgeometries are also constrained during this execution.
WARNING: It is possible to select only one support which useful to set local mesh specifications
lif 2D geometries have been selected the program tries to create a domain of the topology per group of connected selected 2D geometries. Consequently, all boundary edges of new created domains are constrained and all internal edges of new created domains are unconstrained.
Specification attributes are managed usingSimTopologySpecification interface:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lToleranceValue: doublevaluated to the maximum distance between external point and its projection on geometry to mesh. 
default value: 0.
lProjectOnGeometry:integer valuated to the target geometry choice
default value: 1
Description: This specification is used in order to project external points (points that don't belong to the geometry to mesh) in order to constrain the mesh. External points definition(supports) and projection tolerance are mandatory. The overall behavior is the following:
lif the distance between an external point and the geometry to mesh is greater than theToleranceValue, the point will not be projected 
lif thedistance between an external point and the geometry to mesh islower than the ToleranceValue, the point will be projected. The final location of this point depends on ProjectOnGeometry attribute: 
¡if ProjectOnGeometry is equal to 1, the node representing the point will be located exactly on the projection point on the surface geometry 
¡ifProjectOnGeometry is equal to 2, the node representing the point projection will be located exactly on the external point (same Cartesian coordinates)
Specification attributes are managed usingSimTopologySpecification interface:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lToleranceValue attribute is set and retrieved with: 
¡SetAttributeValue 
¡GetAttributeValue
type: double valuated to the maximum distance between external curves and its projection on geometry to mesh.
default value: 0.
Description: This specification is used in order to project external curves (curves that don't belong to the geometry to mesh) in order to constrain the mesh. Externalcurves definition (supports) and projection tolerance are mandatory. Onlyrelimitations of curves located below this value are projected on the geometry to mesh.
Distribution specification (named for examplelocalSpec) can be applied only on one edge resulting of an unique grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lType: integer defining the type of distribution valuated to: 
¡1: for a Uniform distribution (Isometric)
¡2: for an Arithmetic distribution 
¡3: for a Geometric distribution 
¡4: for a distribution defined by a Law 
default value: 1
lCombination: integer indicating what are the possible combination for Arithmetic or Geometric distributionsvaluated to: 
¡1: for a distribution defined by the number of elements (NbElements) and the size ratio of the elements (Ratio21) 
¡2: for a distribution defined by the number of elements (NbElements) and the size (Size1) at first vertex 
Description: This specification creates a node distribution on an edge resulting of a 1D grouping specification. Depending on the choice of the distribution type (Type attribute), Combination or CombinationUnif attributes several various distributions "Option" can be computed. The next table summarize all "Option":
lIsometric (Uniform) distribution is defined by only one attributes(Option 1 and 2): 
¡Nbelements (CombinationUnif= 1) 
¡Size1 (CombinationUnif= 2) 
lNon isometric distribution is defined by two attributes as indicated in the next table. There 
Page 118 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 119 ---

CATFmtStudioHoleSpec
CATFmtStudioCaptureSpec
¡3: for a distribution defined by the number of elements (NbElements) and the size (Size2) at second vertex 
¡4: for a distribution defined by the size ratio (Ratio21) and the size (Size1) at first vertex 
¡5:for a distribution defined by the size ratio (Ratio21) and the size (Size2) at second vertex 
¡6: for a distribution defined by the size (Size1) at first vertex and the size (Size2) at second vertex 
default value: 1
lCombinationUnif:integer indicating what are the possible combination for Uniform distributions valuated to: 
¡1: for a distribution defined by the number of elements (NbElements)
¡2: for a distribution defined by the size (Size1) of the elements 
default value: 1
lNbElementsValue:integer defining the number of elements (NbElements)
default value: 4
lRatioValue: double defining the ratio between the max element size and the min element size (Ratio21)
default value: 1.
lSize1Value: double defining the size at first vertex (Size1) 
default value: 0.
lSize2Value:double defining the size at second vertex (Size2)
default value: 0.
lSymmetry: integer valuated to:
¡1: to keep the distribution unchanged 
¡2: to compute a symmetric distribution with current attributes
default value: 1
lReverse: integer usable for Law and non Uniform distribution valuated to: 
¡1: to keep the distribution unchanged 
¡2: to invert the distribution
default value: 1
are six couples of attributes (Option 3 to 8): 
¡Nbelements andRatio21 (Combination = 1) 
¡NbElements andSize1 (Combination = 2) 
¡NbElements andSize2 (Combination = 3) 
¡Ratio21 andSize1 (Combination = 4) 
¡Ratio21 andSize2 (Combination = 5) 
¡Size1 andSize2 (Combination = 6) 
The next table shows examples of various distributions using additional Symmetry and Law attributes.
Hole specification can be applied only on one closed edgeresulting of an unique 1D grouping specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lNbElements:integer valuated to the number of elements created on the contour
default value: 3
lNbRows: integer valuated to the number of regular layers (row) of mesh around the contour. The possible value are {1,2,3}
default value: 1
lHeight1, Height2 and Height3:double valuated respectively to the element height of the first, second and third row if specified 
Height1 default value: 0.
Height2 default value: 0.
Height3 default value: 0.
Description: This specification creates an uniform node distribution on a internal closed contour resulting of a 1D grouping specification and to get a regular mesh around this contour.
Capture specification can be applied only on one edge resulting of an unique 1D grouping 
Page 119 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 120 ---

CATFmtStudioPropagationSpec
Local Mesh 2D Specifications
WARNING: Except forCATFmtLocalSpecLocalSize which works with geometrical elements as an input, 2D grouping specifications are the only supports possible for all the other Local Mesh 2D Specifications. It is therefore mandatory to create before one or more grouping 2D specifications with the targeted geometry supports.
CATFmtLocalSpecLocalSize
specification. Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using methods (GetAttributeValue, SetAttributeValue):
lManualCaptureMeshMode:integervaluated to the capture mode with possible values{1,2,3}
default value: 1
lManualCaptureMeshTolValue:doublevaluated to the maximum distance under which external mesh is captured. 
default value: 0.
Description: This specification captures external mesh in order to create compatible meshes with or without geometrically coinciding or duplicated nodes. The overall behavior is the following:
lif ManualCaptureMeshMode is equal to 1 then mesh nodes are located at the captured nodes projection on mesh. 
lif ManualCaptureMeshMode is equal to 2 then mesh nodes are coincident with captured nodes. 
lif ManualCaptureMeshMode is equal to 3 then mesh nodes are shared with captured nodes.
Propagation specification can be applied on a setedges resulting of one or more 1D grouping specifications (supports). Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lPropagationMode:integer valuated to the propagation mode (see picture for detailed explanations) with possible values {1,2,3}
default value: 1
Description: This specification propagates one or more 1D mesh local specifications(specification sources) on several edges (target supports) resulting of one or more 1D grouping specifications. PropagationMode attribute indicates how propagation is computed:
lifPropagationMode is equal to 1 (proportional mode), propagation is computed proportionally (see picture) 
lif PropagationMode is equal to 2 (projection mode), propagation is computed by projection(see picture) 
lif PropagationMode is equal to 3 (directional mode), propagation is computed following a direction given by a geometry. This geometry is managed using following method ofSimMeshPart object (with iAttribute="Geometry"): 
¡SetExternalReferences
Specification attributes are managed usingSimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using(GetAttributeValue, SetAttributeValue):
lSizeValue:double valuated to the target size on the support
lAbsoluteSag: int valuated to 
¡1: to specify only a target mesh size (default) 
¡2: to specify a local sag as well 
lAbsoluteSagValue: double valuated to the target sag on the support (only taken into 
Description: This specification is used in order to specify a local mesh size or sag on a set of faces.
Page 120 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 121 ---

CATFmtStudioFrontTriaSpec
CATFmtStudioMappedSpec
CATFmtStudioFaceCaptureSpec
History
accoung if the AbsoluteSag attribute above is set to 2)
Frontal Tria 2D mesh specification can be applied on a set of domains resulting of one or more 2D grouping specifications.Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue,SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
Description: This specification provides full triangle elements meshes on one or more domains defined by a list of 2D grouping specifications.
Mapped 2D mesh specification can be applied on one domain resulting ofonly one 2D grouping specification. Specification attributes aremanaged using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttributeValue, SetAttributeValue):
lSizeValue:double valuated to the mesh size
default value: 10.
Description: This specification provides mapped mesh with triangle elements on one domain with quadrangular shape (four corners) defined by only one of 2D grouping specification.
Face capture specification can be applied on a set of external faces containing the mesh to capture. Specification attributes are managed usingSimMeshSpecification object.
The supports of the specification (external faces) are managed using SimLinkAccess object with iName = "ConnectorList":
lAddLink
lRemoveLink 
lGetAllLinks 
Mesh to capture associated to external faces are managed using SimLinkAccess object withiName= "MeshSources":
lAddLink
lRemoveLink 
lGetAllLinks 
Other attributes are managed using methods (GetAttributeValue, SetAttributeValue):
lManualMeshCaptureMode:integer valuated to the capture mode with possible values{1,2,3}
default value: 1
lTolerance: double valuated to the maximum distance under which external mesh is captured.
default value: 0.
Description: This specification captures external mesh in order to create compatible meshes with or without geometrically coinciding or duplicated nodes. The overallbehavior is the following:
lif ManualMeshCaptureMode is equal to 1 then mesh nodes are located at the captured nodes projection on mesh. 
lif ManualMeshCaptureMode is equal to 2 then mesh nodes are coincident with captured nodes. 
lif ManualMeshCaptureMode is equal to 3 then mesh nodes are shared with captured nodes. 
Version:1 [Oct 2014]Document created
Sweep 3D Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Sweep 3D Mesh Part attributes and its local specifications.
Page 121 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 122 ---

Sweep 3D Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.In the case of the sweep 3D mesh part, the late type is "CATFmtSweep3DMesher".The sweep 3D mesh part can be created by usingAdd method of SimMeshParts collection object.
Sweep 3D Mesh Part Support Definition
The Sweep 3D Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Source
The Sweep 3D Mesh Part source support can be set or unset using following methods of theSimMeshPart object:
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to set the source face where: 
¡iSetType="Topology"
¡iAttribute="Source"
¡iSupport is a geometric face
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the source face where: 
¡iSetType="Topology"
¡iAttribute="Source"
¡iSupport is a geometric face
Target
The Sweep 3D Mesh Part target support can be set or unset using following methods of theSimMeshPart object:
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to set the target face where: 
¡iSetType="Topology"
¡iAttribute="Target"
¡iSupport is a geometric face
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the target face where: 
¡iSetType="Topology"
¡iAttribute="Target"
¡iSupport is a geometric face
WARNING: If no Source andTarget support are set they will be automatically computed at mesh update.
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of theSimMeshPart object:
lSetAttributeValue (iSetTypeAs String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
ElementOrder
Sweep 3D Mesh Part Creation
Sweep 3D Mesh Part Support Definition:
lSource
lTarget
Global Mesh Specifications:
lElementOrder
lNbElementsValue
lType
lRatioValue
lSymmetry
lAutomatic2DMeshCreation
lMeshSize
lAutomaticMeshCaptureTolValue
Local Specifications
Local Topology Specifications:
lCATFmtSweep3DGeometryImposedGuide
lCATFmtSweep3DGeometryExcludedGuide
type: integervaluated to:
l1: to get a mesh with linear hexaedron (HE8) 
l2: to get a mesh with quadratic hexaedron (HE20) 
Attribute which specifies the number of intermediate nodes per element edge. 
Page 122 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 123 ---

NbElementsValue
Type
RatioValue
Symmetry
Automatic2DMeshCreation
MeshSize
AutomaticMeshCaptureTolValue
Local Specifications
The local specifications are managed by collection object:
lSimTopologySpecifications is the collection ofSimTopologySpecification object (local topology specification)
lSimMeshSpecifications is the collection ofSimMeshSpecification object (local mesh specification) 
You should use the following methods of SimMeshPart object to retrieve this collection:
lGetTopologySpecification to retrieve the local topology specification collection 
lGetMeshSpecification to retrieve the local mesh specification collection 
Local specifications are managed from the collection object:
lAdd (iType As String, oSpec) to create a new local specification with: 
¡iType is the late type of the specification to create
¡oSpec is a local specification ( SimTopologySpecification orSimMeshSpecification ) 
lItem (iIndex, oSpec ) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection 
¡oSpec is a local specification (SimTopologySpecification or SimMeshSpecification )
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Local specification attibutes are managed using the local specification object:
default value: 1 
type: integervaluated to the number of sweep layers.This attribute specifies the number of sweep layers.
type: integer valuated to:
l1: to get an uniform distribution 
l2: to get an arithmetic distribution 
l3: to get a geometric distribution 
default value: 1 
This attribute specifies the sweep layers distribution.
type: double valuated to the size ratio between the first and last layer thicknesses.
default value: 1.0 
This attribute specifies the size ratio R between the first layer thickness h1 and last layer thickness h2.
WARNING: It is taken into account only if the Type attribute is equal to 2 or 3.
type: integer valuated to:
l1: to keep the distribution unchanged
l2: to compute a symmetric distribution with current attributes 
default value: 1 
This attribute specifies the sweep layers distribution as symmetric or not.
WARNING: It is taken into account only if the Type attribute is equal to 2 or 3.
type: integervaluated to:
l1 to reuse existing mesh by capture 
l2 to generate an (intermediate) surface mesh on Source face(s) 
This attribute specifies whether (intermediate) surface mesh should be generated on the Source face(s) (2) or not (1). 
type: double valuated to mesh elements size.Attribute which specifies the mesh element target size that mesher tries to respect on the Source face(s).
WARNING: It is taken into account only if theAutomatic2DMeshCreation is set to 2. 
type: doublevaluated to the maximum distance under which mesh is captured.
default value: 0. 
Attribute which specifies the maximum distance for mesh capture: if a mesh is farthest from the geometry than this tolerance, it will not be captured. 
To precise exactly the list of mesh parts to capture the method SetMeshPartsToCapture of SimMeshPartobject can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used: 
lParent () 
WARNING: It is taken into account only if the Automatic2DMeshCreation is set to1. 
Page 123 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 124 ---

lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute where: 
¡iAttribute is the attribute's name 
¡iValue is the attribute's value
lGetAttributeValue (iAttribute As String, oValue) to get a local specification attribute where:
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject )
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLinkAs AnyObject ) 
¡iName is the name of the link container, here it's "ConnectorList"
Local Topology Specifications
CATFmtSweep3DGeometryImposedGuide
CATFmtSweep3DGeometryExcludedGuide
Symmetry Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Symmetry mesh part, the late type is "CATFmtSymmetryMesher".
The Symmetry mesh part can be created by usingAdd method of SimMeshParts collection object.
Symmetry Mesh Part Support Definition
Symmetry Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport (iSupport As AnyObject ) to add a new support to the mesh part 
Geometry
The Symmetry Mesh Part plane can be set or unset using following methods of theSimMeshPart object:
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to set the symmetry plane where: 
¡iSetType="Mesh"
¡iAttribute="Geometry"
¡iSupport is a geometric plane
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the symmetry plane where: 
¡iSetType="Mesh"
¡iAttribute="Geometry"
¡iSupport is a geometric plane
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports) Description: This specification is used to impose geometric edges as sweep guides.
Specification attributes are managed usingSimTopologySpecification object.
lOnly geometric attribute (supports)
Description: This specification is used to exclude geometric edges from the sweepguides.
Symmetry Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Symmetry Mesh Part attributes and its local specifications. 
Symmetry Mesh Part Creation
Symmetry Mesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Page 124 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 125 ---

¡oValue is the attribute's value 
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
History
Symmetry Extrusion Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Symmetry Extrusion mesh part, the late type is "CATFmtExtrusionSymmetryMesher".
The Symmetry Extrusion mesh part can be created by using Add method of SimMeshParts object.
Symmetry Extrusion Mesh Part Support Definition
Symmetry Extrusion Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Geometry
The Symmetry Extrusion Mesh Part plane can be set or unset using following methods of theSimMeshPart object:
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to set the symmetry plane where: 
¡iSetType="Mesh"
¡iAttribute="Geometry"
¡iSupport is a geometric plane
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the symmetry plane where: 
¡iSetType="Mesh"
¡iAttribute="Geometry"
¡iSupport is a geometric plane
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
Version: 1 [October 2014]Document created
Symmetry Extrusion Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Symmetry Extrusion Mesh Part attributes and its local specifications.
Symmetry Extrusion Mesh Part Creation
Symmetry Extrusion Mesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lType
lRatioValue
lNbElementsValue
lSymmetry
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Page 125 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 126 ---

¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Type
RatioValue
NbElementsValue
Symmetry
AutomaticMeshCapture
AutomaticMeshCaptureTolValue
type: integer valuated to:
l1: to get an uniform distribution 
l2: to get an arithmetic distribution 
l3: to get a geometric distribution
default value: 1
This attribute specifies the size distribution to be applied to the mesh.
The picture shows how a uniform distribution (at the bottom) differs from a geometric one (at the top, using a ratio of 3).
type: double valuated to the size ratio between the first and last layer thicknesses.
default value: 1.0
This attribute specifies thesize ratio R between the first layer thickness h1 and lastlayer thickness h2.
R = h2 / h1
WARNING: It is taken into account only if theTypeattribute is equal to 2 or 3.
type: integer valuated to the expected number of layers.
default value: 1 This attribute specifies the number of layers to be added to the volume mesh.
type: boolean valuated to create anextrusion which is symmetric.
default value: false
Attribute which specifies if we want to create a symmetric extrusion, thesymmetrical plane is located ad the middle of the extrusion.
WARNING: It is taken into account only if theType attribute is equal to 2 or 3. 
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under 
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of 
Page 126 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 127 ---

History
Tetrahedron Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Surface Quadrangle Mesh Part, the late type is "CATFmt3DRulesMesher".
The Tetrahedron Mesh Part can be created by using Add method of SimMeshParts object.
Tetrahedron Mesh Part Support Definition
The Tetrahedron Mesh Part support can be initialized and managed using the AddSupport method of SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Global Mesh Specifications
which mesh is captured.
default value: 0.
SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
Version: 1 [November 2014]Document created
Tetrahedron Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Tetrahedron Mesh Part attributes and its local specifications.
Tetrahedron Mesh Part Creation
Tetrahedron Mesh Part Support Definition
Global Mesh Specifications
lMeshSizeValue
lAutoMap
lElementOrder
lAbsoluteSag
lAbsoluteSagValue
lBoundaryLayersMode
lBoundaryLayersDistribution
lBoundaryLayersNumber
lBoundaryLayersRatio
lBoundaryLayersHeight1
lBoundaryLayersTetsOnly
lProportionalSag
lProportionalSagValue
lMinMeshSize
lMinCellsPerGap
lMinCellsPerGapValue
lGrowthRatioSurface
lGrowthRatioVolume
Global Topology Specifications
lAngleBetweenCurves
lAngleBetweenFaces
lCurvatureAngle
lGeometrySimplification
lGeometrySimplificationValue
lLogosSuppression
lLogosMaxHeight
lLogosMaxSize
Local Specifications
Local Topology Specifications
lCATFmtExternalPointLocalSpec (Imposed Points) 
lCATFmtPreserveGeometries (Preserved Boundaries) 
Local Mesh 2D Specifications
lCATFmtLocalSpecLocalSize (Local Mesh Size) 
Local Mesh 3D Specifications
lCATFmtBoundaryLayerSpecification (Boundary Layers) 
lCATFmtExcludedBoundaryLayerSpecification (Excluded Boundary Layers)
Page 127 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 128 ---

Global mesh specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute with an integer value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute with an integer value 
iType is the type of specification and iType ="Mesh" for Global Mesh Specifications.
ElementOrder
MeshSizeValue
AutoMap
AbsoluteSag
AbsoluteSagValue
BoundaryLayersMode (only available starting from 3DEXPERIENCE 2015x FD01)
BoundaryLayersDistribution (only available starting from 3DEXPERIENCE 2015x FD01)
BoundaryLayersNumber (only available starting from 3DEXPERIENCE 2015x FD01)
BoundaryLayersRatio (only available starting from 3DEXPERIENCE 2015x FD01)
type: integervaluated to: 
l1: to get a mesh with linear tetrahedra (TE4) 
l2: to get a mesh with quadratic tetrahedra (TE10) 
default value: 1
Attribute which specifies thenumber of intermediate nodes per element edge, as shown on the pictures (the left one shows a linear tetrahedron and the right one shows a parabolic tetrahedron). 
type: doublevaluated to mesh elements size. 
default value:10 Attribute which specifies the mesh element target size that mesher tries to respect on the surface. 
type:integer valuated to:
l1: do not map mesh the surfaces 
l2: map mesh the surfaces whereappropriate 
default value: 2
This attribute specifies whether map mesh is applied on surfaces where appropriate.
type: integervaluated to: 
l1: to create a mesh that does not respect sag 
l2: to create a mesh that respects sag
default value: 1 
Attribute which specifies if the mesh is created with a maximum imposed sag.
type:double valuated to the target maximum sag whenAbsoluteSagattribute is valuated to 2.
default value: 0
Attribute which specifies the maximum value of the absolute sag (distance between the geometry of the mesh). 
WARNING: It is taken into account only if the AbsoluteSag attribute is equal to 2. 
type: integer valuated to:
l1: to get a mesh without boundary layers
l2: to get a mesh with boundary layers 
default value: 1
This attribute specifies whether boundary layers should be added everywhere in the volume mesh or not.
type:integer valuated to: 
l1: to get an uniform distribution 
l2: to get an arithmetic distribution
l3: to get a geometric distribution 
default value: 1
This attribute specifies the size distribution to be applied to the boundary layers. 
The picture shows how a uniform distribution (at the top) differs from a geometric one (at the bottom, using a ratio of 3). 
type: integer valuated to the expected number of boundary layers. 
default value: 1 This attribute specifies the number of boundary layers to be added to the volume mesh. 
Page 128 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 129 ---

BoundaryLayersHeight1 (only available starting from 3DEXPERIENCE 2015x FD01)
BoundaryLayersTetsOnly (only available starting from 3DEXPERIENCE 2015x FD01)
ProportionalSag
ProportionalSagValue
MinMeshSize
MinCellsPerGap
MinCellsPerGapValue
GrowthRatioSurface
type: double valuated to the sizeratio between the first and last layer thicknesses. 
default value: 1.0
This attribute specifies the size ratio R between the first layer thickness h1 and last layer thickness h2. R = h2 / h1
WARNING: It is taken into account only if theBoundaryLayersDistribution attribute is equal to 2 or 3. 
type: double valuated to the expected thickness of the first layer of boundary elements. 
default value: 1.0
This attribute specifies the thickness of the first layer of elements in the boundary layers.
type: integer valuated to:
l1: to get wedges and pyramids in the boundary layers
l2: to get tetrahedra only in the boundary layers
default value: 1
This attribute specifies the elements to be generated in the boundary layers. If set to 2, elements in the boundary layers will be split into tetrahedra. 
type: integervaluated to: 
l1: to create a mesh that does not respect proportional sag 
l2: to create a mesh that respects proportional sag 
default value: 1
Attribute which specifies if the mesh is created with a imposed maximum proportional sag which is the ratio of the Sag by the Length of a mesh edge element (Sag/Length). 
type:double valuated to target proportional sag when ProportionalSag attribute is valuated to 2. 
default value: 0
Attribute which specifies the maximum value of the proportional sag. 
WARNING: It is taken into account only if the ProportionalSag attribute isequal to 2. 
type: double valuated to the minimum mesh elements size. 
default value:0.2 * MeshSizeValue
Attribute which specifies the minimum mesh element size that mesher tries to respect on the surface. 
This attribute is only needed when AbsoluteSag is set to 2 or ProportionalSag is set to 2.
type: integervaluated to: 
l1: to keep the default mesh
l2: to split tetrahedra 
l3: to refine the surface
default value: 1
Attribute which specifies the treatment to be applied in narrow regions. Tetrahedra can either be split to ensure two layers of elements everywhere or the surface mesh can be refined, as shown on the picture below.
type: integer valuated to the expected number of layers across the thickness.
default value: 0
Attribute which specifies the number of expected layers across the thickness. The surface mesh is refined (see picture above). 
WARNING: It is taken into account only if the MinCellsPerGap attribute is equal to 3.
type: double valuated to the mesh size growth.
default value: 1.41 
Attribute which controls the mesh size growth between neighboring elements on the surface. 
WARNING: It is taken into account only if the AbsoluteSag,ProportionalSag or MinCellsPerGap attribute is equal to 2. 
Page 129 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 130 ---

GrowthRatioVolume
Global Topology Specifications
Global topology specifications can be set or retrieved using following methods:
lSetAttributeValue (iSetTypeAs String, iAttribute As String, iValue) to set a topology attribute
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a topology attribute 
iType is the type of specification and iType ="Topology" for Global Topology Specifications.
AngleBetweenCurves
AngleBetweenFaces
CurvatureAngle
GeometrySimplification
GeometrySimplificationValue
type: doublevaluated to the expected growth ratio throughout the volume.
default value:1.0
This attribute specifies the amount by which adjacentelements through the volume can differ in size. It controls the smoothness of transitions in mesh size, as shown on the pictures on the right.
type: double (radian unit) valuated to the angle under which vertices are inactivated 
default value: 20°
Attribute which specifies the maximum angle under which avertex connected exactly to two constrained edges can be inactivated.
type: double (radian unit) valuated to the angle under which edges are inactivated.  
default value: 20°
Attribute which specifies the maximum angle under which an edge connected exactly to two faces can be inactivated during topologycomputation. 
type: double (radian unit) valuated to the angle over which edges are activated. 
default value: 20°
Attribute which specifies the minimum angle computed along filleted surfaces over which edges are activated. For a given fillet, when the computed curvature angle is greater thanCurvatureAngle all boundary edges of this fillet are activated otherwise they are not.
type:integer valuated to: 
l1: to keep grouping topology without additional simplification 
l2: to compute topology simplification 
default value: 2
Attribute which specifies if topology simplification is computed. Topology simplification objective is to minimize the number of bad elements regarding the Min Height element quality criterion. 
Page 130 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 131 ---

LogosSuppression
LogosMaxHeight
LogosMaxSize
Local Specifications
The Tetrahedron Mesh Part has two kind of local specifications: topology and mesh local specifications. These specifications are managed by collection object:
lSimMeshSpecifications: for the collection of local mesh specifications 
lSimTopologySpecifications: for the collection of local topology specifications 
You should use the following methods of SimMeshPart object to retrieve these collections:
lGetMeshSpecifications to retrieve the local mesh specification collection 
lGetTopologySpecification to retrieve the local topology specification collection 
Local specifications are managed from the collection objects:
lAdd (iType As String) to create a new local specification with:
¡iType is the late type of the specification to create
lItem (iIndex) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection 
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Attribute of local specification are set using following method from SimMeshSpecification orSimTopologySpecification object depending of the kind of localspecification:
type:double valuated to the Min Height criterion targeted for mesh elements. 
default value: 0.1 * MeshSizeValue
When topology simplication is computed, different topology modifications are doneautomatically using a set of topological operators in order to respect Min Height element quality criterion: 
lVertex Creation/Activation/Inactivation 
lEdge Creation/Activation/Inactivation 
lEdge collapse (see picture)
lEdge Merge 
type:integer valuated to:
l1: to ignore logos control suppression
l2: to control logos suppression
default value: 1 
Attribute which specifies whether logos suppression will be done. 
Logos suppression consists of ignoring small features of the geometry that are useless for the mesh (small height regarding the mesh size). Logos suppression is driven by two attributes:LogosMaxHeight and LogosMaxSize.
For example on the right picture, an ignored logo can be seen.
type:double valuated to the max height of a detectable logo 
default value: 0.1 * MeshSizeValue
Attribute which specifies the maximal height allowed to detect logos. 
The maximum height of a logo can be defined as the maximum distance of any points on the logo faces to the extrapolated bounding surfaces. 
type:double valuated to the max size of a detectable logo 
default value: MeshSizeValue 
Attribute which specifies the maximal size allowed to detect logos. 
The maximum size of a logo can be defined as the maximum distance between two points on the logo boundary (maximumdiameter). 
Page 131 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 132 ---

lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute value 
In a manner similar, attribute of local specification are retrieved using following method:
lGetAttributeValue (iAttribute As String, iValue) to retrieve a local specification
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject )
¡iName is the name of the link container, here it's"ConnectorList"
Local Topology Specifications
CATFmtExternalPointLocalSpec
CATFmtPreserveGeometries
Local Mesh 2D Specifications
CATFmtLocalSpecLocalSize
Local Mesh 3D Specifications
CATFmtBoundaryLayerSpecification
Specification attributes are managed usingSimTopologySpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttribute,SetAttribute):  
lToleranceValue:doublevaluated to the maximum distance between external  point and its projection on geometry to mesh.
default value: 0.
lProjectOnGeometry:integer valuated to the target geometry choice
default value: 1
Description: This specification is used in order to project external points (points that don't belong to thegeometry to mesh) in order to constrain the mesh. External points definition (supports) and projection tolerance are mandatory. The overall behavior is the following: 
lif the distance between an external point and the geometry to mesh isgreater than the ToleranceValue,the point will not be projected
lif thedistance between an external point and the geometry to mesh is lower than the ToleranceValue,the point will be projected. The final location of this point depends on ProjectOnGeometry attribute: 
¡ifProjectOnGeometry is equal to 1, thenode representing the point will belocated exactly on the projection point on the surface geometry
¡ifProjectOnGeometry is equal to 2, thenode representing the point projection will belocatedexactly on the external point (same Cartesian coordinates)
Specification attributes are managed using SimTopologySpecification object.
lOnly geometric attribute (supports)
Description: This specification is used in order to preserve a set of faces, edges or points while meshing i.e. to prevent them from being simplified. 
The picture shows how a small geometrical element can be preserved by selecting its faces as a support of the preserved geometries specification. 
Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttribute, SetAttribute): 
lSizeValue:double valuated to the target size on the support
lAbsoluteSag: int valuated to 
¡1: to specify only a target mesh size (default) 
¡2: to specify a local sag as well 
lAbsoluteSagValue: double valuated to the target sag on the support (only taken into accoung if the AbsoluteSag attribute above is set to 2) 
Description: This specification is used in order to specify a local mesh size or sag on a set of faces.
Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttribute, SetAttribute):
lOffset: double valuated to the total thickness of the boundary layers 
lTetsOnly: int valuated to
¡1: to get wedges and pyramids in the boundary layers (default) 
¡2: to get tetrahedra only in the boundary layers
lType: int valuated to 
¡1: to get an uniform distribution (default) 
¡2: to get an arithmetic distribution Description: This specification is used to create boundary layers only on a given set of faces. 
Page 132 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 133 ---

CATFmtExcludedBoundaryLayerSpecification (only available starting from 3DEXPERIENCE 2015x FD01) 
History
Tetrahedron Filler Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the tetrahedron filler mesh part, the late type is "CATFmtGHS3DMesher".
The tetrahedron filler mesh part can be created by using Add method of SimMeshParts object.
Tetrahedron Filler Mesh Part Support Definition
Tetrahedron Filler Mesh Part support can be initialized and managed using the AddSupport method ofSimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
ElementOrder
MinCellsPerGap
¡3: to get a geometric distribution
lNbElementsValue: int valuated to the number of expected boundary layers 
lRatioValue: double valuated to the expected ratio of thicknesses between the first and last boundary layers 
lSymmetry: int valuated to
¡1: to get a standard distribution (default)
¡2: to get a symmetric distribution 
TheRatioValue and Symmetry attributes are only taken into account if Type is set to 2 or 3. 
It can be used to override the global specification locally.
Specification attributes are managed using SimMeshSpecification object.
lOnly geometric attribute (supports)
Description: This specification is used to prevent the creation of boundary layers on its support faces. 
This is particularly useful when boundary layers are needed everywhere (they can be applied through Global Mesh Specifications) except in a handful of locations. 
Version:1 [October 2014]Document created
Tetrahedron Filler Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Tetrahedron Filler Mesh Part attributes and its local specifications.
Tetrahedron Filler Mesh Part Creation
Tetrahedron Filler Mesh Part Support Definition
Global Mesh Specifications:
lElementOrder
lMinCellsPerGap
lPropagation
Local Specifications
Local Mesh Specifications:
lCATFmtBoundaryLayerSpecification (Boundary Layers) 
type: integervaluated to:
l1: to get a mesh with linear tetrahedra (TE4) 
l2: to get a mesh with quadratic tetrahedra (TE10) 
default value: 1
Attribute which specifies thenumber of intermediate nodes per element edge, as shown on the pictures (the left one shows a linear tetrahedron and the right one shows a parabolic tetrahedron).
Page 133 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 134 ---

Propagation
Local Specifications
The local specifications are managed by collection object:
lSimTopologySpecifications is the collection ofSimTopologySpecification object (local topology specification)
lSimMeshSpecifications is the collection ofSimMeshSpecification object (local mesh specification) 
You should use the following methods of SimMeshPart object to retrieve this collection:
lGetTopologySpecification to retrieve the local topology specification collection 
lGetMeshSpecification to retrieve the local mesh specification collection 
Local specifications are managed from the collection object:
lAdd (iType As String, oSpec) to create a new local specification with: 
¡iType is the late type of the specification to create
¡oSpec is a local specification ( SimTopologySpecification orSimMeshSpecification ) 
lItem (iIndex, oSpec ) to retrieve a local specification with: 
¡iIndex is the index of the local specification in its collection 
¡oSpec is a local specification (SimTopologySpecification or SimMeshSpecification )
lRemove (iIndex) to delete a local specification with: 
¡iIndex is the index of the local specification in its collection 
Local specification attibutes are managed using the local specification object:
lSetAttributeValue (iAttribute As String, iValue) to set a local specification attribute where: 
¡iAttribute is the attribute's name 
¡iValue is the attribute's value
lGetAttributeValue (iAttribute As String, oValue) to get a local specification attribute where:
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Geometric attribute of local specification (supports) are managed using SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject )
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLinkAs AnyObject ) 
¡iName is the name of the link container, here it's "ConnectorList"
Local Mesh Specifications
CATFmtBoundaryLayerSpecification
type: integer valuated to:
l1: to keep the default mesh 
l2: to split tetrahedra 
default value: 1
Attribute which specifies the treatment to be applied in narrow regions. Tetrahedra can either be split to ensure two layers of elements everywhere or the surface mesh can be refined, as shown on 
the picture below. 
type: double valuated to the expected growth ratio throughout the volume.
default value: 1.0
This attribute specifies the amount by which adjacent elements through the volume can differ in size. It controls thesmoothness of transitions in mesh size, as shown on the pictures on the right.
Specification attributes are managed using SimMeshSpecification object:
lGeometric attribute (supports) 
Other attributes are managed using (GetAttribute, SetAttribute):
lOffset: double valuated to the total thickness of the boundary layers 
lTetsOnly: int valuated to
¡1: to get wedges and pyramids in the boundary layers (default) 
¡2: to get tetrahedra only in the boundary layers
lType: int valuated to 
¡1: to get an uniform distribution (default) 
¡2: to get an arithmetic distribution 
¡3: to get a geometric distribution
lNbElementsValue: int valuated to the number of expected boundary layers 
lRatioValue: double valuated to the expected ratio of thicknesses between the first and last boundary layers 
Description: This specification is used to create boundary layers only on a given set of faces. 
It can be used to override the global specification locally.
Page 134 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 135 ---

History
Translation Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is tobe created.
In the case of the Translation mesh part, the late type is "CATFmtTranslationMesher"
The Translation mesh part can be created by using Add method of SimMeshParts object.
Translation Mesh Part Support Definition
Translation Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Geometry
The Translation Mesh Part direction can be set or unset using following methods of theSimMeshPart object:
lSetExternalReference (iSetTypeAs String, iAttribute As String, iSupport As AnyObject) to set the translation direction where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the translation direction where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
Global Mesh Specifications
Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Distance
AutomaticMeshCapture
lSymmetry: int valuated to
¡1: to get a standard distribution (default)
¡2: to get a symmetric distribution 
TheRatioValue and Symmetry attributes are only taken into account if Type is set to 2 or 3. 
Version: 1 [October 2014]Document created
Translation Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Translation Mesh Part attributes and its local specifications.
Translation Mesh Part Creation
Translation Mesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lDistance
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
lNbCopies
type:double valuated to a length.
default value: 0.2 Attribute which specifies the distance between the original mesh and the new mesh that we want to create thanks to a translation transformation.
type:integer valuated to:
l1: to ignore automatic mesh capture Attribute which specifies if external meshes must be captured. This attribute is linked to the attribute
Page 135 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 136 ---

AutomaticMeshCaptureTolValue
NbCopies
History
Translation Extrusion Mesh Part Creation
A "late type" must be given to indicate which type of mesh part is to be created.
In the case of the Translation Extrusion mesh part, the late type is "CATFmtExtrusionTranslationMesher".
The Translation Extrusion mesh par can be created by using Add method ofSimMeshParts object.
Translation Extrusion Mesh Part Support Definition
Translation Extrusion Mesh Part support can be set using following method of the SimMeshPart object:
lAddSupport ( iSupport As AnyObject ) to add a new support to the mesh part
Geometry
The Translation Extrusion Mesh Mesh Part direction can be set or unset using following methods of the SimMeshPart object:
lSetExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to set the translation direction where:
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
lRemoveExternalReference (iSetType As String, iAttribute As String, iSupport As AnyObject) to unset the translation direction where: 
¡iSetType="Topology"
¡iAttribute="Geometry"
¡iSupport is a geometric line
Global Mesh Specifications
l2: to compute automatic mesh capture
default value: 1 
AutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
type:integer valuated to the number of translatedmeshes.
default value: 1 Attribute which specifies the number of translated meshes that we want to create.
Version:1 [October 2014]Document created
Translation Extrusion Mesh Part AttributesTechnical ArticleAbstract
This article presents an overview of the Translation Extrusion Mesh Part attributes and its local specifications.
Translation Extrusion Mesh Part Creation
Translation Extrusion Mesh Part Support Definition:
lGeometry
Global Mesh Specifications:
lStart
lEnd
lType
lRatioValue
lNbElementsValue
lSymmetry
lAutomaticMeshCapture
lAutomaticMeshCaptureTolValue
Page 136 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 137 ---

Global mesh specifications can be set or retrieved using following methods of the SimMeshPart object:
lSetAttributeValue (iSetType As String, iAttribute As String, iValue) to set a mesh attribute where:
¡iSetType="Mesh"
¡iAttribute is the attribute's name
¡iValue is the attribute's value
lGetAttributeValue (iSetType As String, iAttribute As String, oValue) to get a mesh attribute where: 
¡iSetType="Mesh"
¡iAttribute is the attribute's name 
¡oValue is the attribute's value 
Start
End
Type
RatioValue
NbElementsValue
Symmetry
type: doublevaluated to a length.
default value: 0. Attribute which specifies the distance from the original mesh where the extrusion will begin. This attribute is linked to the attributeEnd.
type: double valuated to a length.
default value: 0. Attribute which specifies the distance from the original mesh where the extrusion will stop. This attribute is linked to the attribute Start.
type: integer valuated to:
l1: to get an uniform distribution 
l2: to get an arithmetic distribution 
l3: to get a geometricdistribution 
default value: 1
This attribute specifies the size distribution to be applied to the mesh.
The picture shows how a uniform distribution (at the bottom) differs from a geometric one (at the top, using a ratio of 3).
type: double valuated to the size ratio between the first and last layer thicknesses.
default value: 1.0
This attribute specifies thesize ratio R between the first layer thickness h1 and lastlayer thickness h2.
R = h2 /h1
WARNING: It is taken into account only if theTypeattribute is equal to 2 or 3.
type: integer valuated to the expected number of layers.
default value: 1 This attribute specifies the number of layers to be added to the volume mesh.
type: boolean valuated to create an extrusion which is symmetric.
default value: false
Attribute which specifies if we want to create a symmetric extrusion, the symmetrical plane is located ad the middle of the extrusion.
WARNING: It is taken into account only if theType attribute is equal 
Page 137 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 138 ---

AutomaticMeshCapture
AutomaticMeshCaptureTolValue
History
Group creation
Group creation can be managed the SimGroupSet object by calling the Add method from it.
A "late type" must be given to indicate which type of group is to be created:
to 2 or 3.
type:integer valuated to:
l1: to ignore automatic mesh capture 
l2: to compute automatic mesh capture
default value: 1 
Attribute which specifies if external meshes must be captured. This attribute is linked to the attributeAutomaticMeshCaptureTolValue.
type: double valuated to the maximum distance under which mesh is captured.
default value: 0.
Attribute which specifies the maximum distance for mesh capture: if a mesh (element edges) is farthest from the support than this tolerance, it will not be captured even if the AutomaticMeshCapture attribute is valuated to 2.
WARNING: to precise exactly the list of mesh parts to capture, the method SetMeshPartsToCapture of SimMeshPart object can be used:
lSetMeshPartsToCapture () 
To retrieve the parents mesh parts another method of SimMeshPart object can be used:
lParent ()
Version: 1 [November 2014]Document created
Groups and Their AttributesTechnical ArticleAbstract
The following reference article describes the different types of groups, their attributes and usage.
This paper describes how to access to:
lGroup Creation
lGroup Type Definition
This paper explains attributes of seven type of groups:
lThe Geometric Group. See Geometric Group Attributes. The description of all attributes of the Geometry Group.
lThe Proximity Group. See Proximity Group Attributes. The description of all attributes of the Proximity Group.
lThe Spatial Group. See Spatial Group Attributes. The description of all attributes of the Spatial Group.
lThe Boundary Group. See Boundary Group Attributes. The description of all attributes of the Boundary Group.
lThe Union Group. SeeUnion Group Attributes. The description of all attributes of the Union Group.
lThe Intersection Group. SeeIntersection Group Attributes. The description of all attributes of the Intersection Group.
lThe Difference Group. See Difference Group Attributes. The description of all attributes of the Difference Group.
Group Late type
Page 138 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 139 ---

Group Type
Group type can be set by theSetGroupType method of the SimGroup object.
A string must be given to indicate which kind of elements the group will contain:
Group Support
The support of the groups is managed by the SimLinkAccess object:
lAddLink ( iName As String, iLink As AnyObject ) 
lRemoveAllLinks ( iName As String ) 
lRemoveLink ( iName As String, iLink As AnyObject ) 
¡iName is the name of the link container, here it's : 
n"MainSupport" for all the groups which need a support. 
n"Boundary" to specify boundary geometry of boundary group. 
n"MainSupport" for the Groups A support list of difference group. 
n"DifferenceGroups" for the Groups B support list of difference group. 
Geometry Group Attributes
Proximity Group Attributes
Spatial Group Attributes
Geometric GroupCATFmtGroupByAssociativityProximity GroupCATFmtGroupByProximitySpatial GroupCATFmtGroupSpatialBoundary GroupCATFmtGroupByBoundaryUnion GroupCATFmtGroupUnionIntersection GroupCATFmtGroupIntersectionDifference GroupCATFmtGroupDifference
String DescriptionCATFmtGroupTypeNodeThe group contains only the nodes of the supportCATFmtGroupTypeEdgeThe group contains only edgesCATFmtGroupTypeFaceThe group contains only 3D elements faces of the supportCATFmtGroupTypeElementThe group contains only elements of the support
CnxElementAllowed (type integer): valuated to: 
l1: to don't allow connection element in the group content 
l2: to allow connection element in the group content Attribute which specifies if connection elements are allowed in the group content.
Tolerance (typedouble): valuated to group tolerance. Attribute which specifies the tolerance in which the mesh entities will be captured.CnxElementAllowed (type integer): valuated to: 
l1: to don't allow connection element in the group content 
l2: to allow connection element in the group content Attribute which specifies if connection elements are allowed in the group content.
Mode (type integer): valuated to:
l1: to get a box mode 
l2: to get a sphere modeAttribute which specifies the kind of the bounding selection
The following attributes are used to define the box in case of spatial group with a box mode.
lOriginX (type double): the X coordinate of the lower left corner of the box 
lOriginY (type double): the Y coordinate of the lower left corner of the box 
lOriginZ (type double): the Z coordinate of the lower left corner of the box 
lVector0X (type double): the dimension of the box along the X axis 
lVector1Y (type double): the dimension of the box along the Y axis 
lVector2Z (type double): the dimension of the box along the Z axis 
The box is defined by its lower left corner and a vector transforming it into the upper right corner, as shown on the picture below. 
The following attributes are used to define the sphere in case of spatial group with a sphere mode.
lCenterX (type double): the X coordinate of the sphere center 
lCenterY (type double): the Y coordinate of the sphere center 
lCenterZ (type double): the Z coordinate of the sphere center 
lRadius (type double): the radius of the sphere 
Attributes which specifies the sphere
CnxElementAllowed (type integer): valuated to: 
l1: to don't allow connection element in the group content Attribute which specifies if connection elements are allowed in the group content.
Page 139 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 140 ---

Boundary Group Attributes
Union Group Attributes
Intersection Group Attributes
Difference Group Attributes
History
l2: to allow connection element in the group content 
No specific attribute for this group. 
CnxElementAllowed (type integer): valuated to:
l1: to don't allow connection element in the group content
l2: to allow connection element in the group contentAttribute which specifies if connection elements are allowed in the group content.
CnxElementAllowed (type integer): valuated to: 
l1: to don't allow connection element in the group content 
l2: to allow connection element in the group content Attribute which specifies if connection elements are allowed in the group content.
CnxElementAllowed (type integer): valuated to: 
l1: to don't allow connection element in the group content 
l2: to allow connection element in the group content Attribute which specifies if connection elements are allowed in the group content.
Version:1 [Oct 2014]Document created
Managing FEM group featuresThis use case primarily focuses on the methodology to create/delete FEM groups.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaGroupsSource.htmThis use case can be divided in eight steps:
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"2.Retrieves the root product3.Retrieves the PartBody4.Creates the FEM representation and retrieve its root object5.Creates/Retrieves the group set6.Creates a geometric group7.Creates a proximity group8.Remove the proximity group
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"
As a first step, the UC retrieves a model "CAAScdFeaProductWithoutFEM" from DB and loads it and returns object of the Editor. 
... Dim myEditor As EditorOpenProduct MyEditor...
The function OpenProduct returns MyEditor, an Editor object. After searching and opening of "CAAScdFeaProductWithoutFEM" product from underlying database the current active editor is returned inMyEditor.
2.Retrieves the root product
As a next step, the UC retrieves the root product object from the returned editor.
 ...Dim MyRootOcc As VPMRootOccurrenceSet MyRootOcc = MyEditor.ActiveObject
Dim MyRootProduct AsVPMReferenceSet MyRootProduct = MyRootOcc.PLMEntity ...
3.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the root product.
...Dim MyContext As PLMProductServiceSet MyContext = MyEditor.GetService("PLMProductService")
Dim MyPart As Part
Page 140 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 141 ---

Dim MyPartInstance As VPMRepInstanceDim MyBody As BodyFor Each MyEntity In MyContext.EditedContentDim MyRef As VPMReferenceSet MyRef = MyEntity
Dim MyReps As VPMRepInstancesSet MyReps = MyRef.RepInstances
For Each MyRep In MyRepsDim MyRepRef As VPMRepReferenceSet MyRepRef = MyRep.ReferenceInstanceOfDim attr As String         attr = MyRepRef.GatAttributValue("V_discipline")
If (attr = "Design") ThenSet MyPart = MyRepRef.GetItem("Part")Set MyPartInstance = MyRepSet MyBody = MyPart.MainBodyEnd IfNextNext...
4.Creates the FEM representation and retrieve its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...Dim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")Dim MyFemRepRef As VPMRepReferenceSet MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")Dim MyFemRepRoot As SimFemRootSet MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")
The 3D Shape is linked to the FEM representation as assiocated shape.
Dim MyProductService As PLMProductServiceSet MyProductService = MyEditor.GetService("PLMProductService")
Dim MyReference As ReferenceSet MyReference = MyPart.CreateReferenceFromObject(MyBody)Dim MyLink As AnyObjectSet MyLink = MyProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)MyFemRepRoot.AddAssociatedRep MyLink...
5.Creates/Retrieves the group set
In this step UC retrieves, or creates if doesn't exist, the group set. 
...Dim MyGroupSet As SimGroupsSet MyGroupSet = MyFemRepRoot.GetSet("SimGroups")...
6.Creates a geometric group
In this step UC creates a geometric group.
...Dim MyGroupByAssociativity As SimGroupSet MyGroupByAssociativity = MyGroupSet.Add("CATFmtGroupByAssociativity")' Set the group supportSet MyPartSupp = MyPart.FindObjectByName("Fill.1")Set MyReference = MyPart.CreateReferenceFromObject(MyPartSupp)Set MyLink = MyProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)Dim MyLinkAccess As SimLinkAccessSet MyLinkAccess = MyGroupByAssociativity.GetItem("SimLinkAccess")MyLinkAccess.AddLink "MainSupport", MyLink' Set the group typeMyGroupByAssociativity.SetGroupType ("CATFmtGroupTypeFace")' Set the group nameMyGroupByAssociativity.Name = "Geometric Group.1"...
7.Creates a proximity group
In this step UC creates a proximity group.
...Dim MyGroupByProximity As SimGroupSet MyGroupByProximity = MyGroupSet.Add("CATFmtGroupByProximity")' Set the group supportSet MyPartSupp = MyPart.FindObjectByName("Fill.1")Set MyReference = MyPart.CreateReferenceFromObject(MyPartSupp)Set MyLink = MyProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)Set MyLinkAccess = MyGroupByAssociativity.GetItem("SimLinkAccess")MyLinkAccess.AddLink "MainSupport", MyLink' Set the group typeMyGroupByProximity.SetGroupType ("CATFmtGroupTypeFace")' Set the group toleranceMyGroupByProximity.SetAttributeValue "Tolerance", 3' Set the group nameMyGroupByProximity.Name = "Proximity Group.1"...
8.Remove the proximity group
Page 141 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 142 ---

In this step UC removes the proximity group.
...MyGroupSet.Remove (2)...
Managing FEM group featuresThis use case primarily focuses on the methodology to create/delete FEM groups.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should open the product called CAASCDFeaProductWithtoutFEM. 
lLaunch the structural scenario App and create a structural simulation. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality. 
Where to find the macro: CAAScdFeaGroupsWithPythonSource.htmThis use case can be divided in eight steps:
1.Retrieves the simulation and its product2.mRetrieves the PartBody3.Creates the FEM representation, Retrieves its root object and Associates the PartBody to this4.Creates/Retrieves the group set5.Creates a geometric group6.Creates a proximity group7.Remove the proximity group
1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor
...myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the simulation's Model.
...myModelRepInstances = myModel.RepInstances
for  myPartRepInstance in myModelRepInstances:     myPartInstanceRef = myPartRepInstance.ReferenceInstanceOf     attr = myPartInstanceRef.GetAttributeValue("V_discipline")if attr == "Design":        myPart = myPartInstanceRef.GetItem("Part")        myPartInstance = myPartRepInstance        myBody = myPart.MainBody...
3.Creates the FEM representation, Retrieves its root object and Associates the PartBody to this
In this step UC creates a new FEM representation object.
To perform the creation, a simulation representation factory has to be retrieved on the reference object which will aggregate the FEM representation.
...MyPrdRepFactory = myModel.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
Now UC appends the main body previously retrieved to the associated shapes of the FEM representation.
First, the UC opens the model and retrieves the product editor and the root occurence
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)myProductEditor = CATIA.ActiveEditormyRootOcc = myProductEditor.ActiveObject...
Now it creates the link to associate with the FEM 
...MyReference = myPart.CreateReferenceFromObject(myBody)myProductService = myProductEditor.GetService("PLMProductService")MyLink = myProdService.ComposeLink(myRootOcc,myPartInstance,MyReference)MyFemRepRoot.AddAssociatedRep (MyLink)...
4.Creates/Retrieves the group set
In this step UC retrieves, or creates if doesn't exist, the group set. 
Page 142 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 143 ---

...MyGroupSet = MyFemRepRoot.GetSet("SimGroups")...
5.Creates a geometric group
In this step UC creates a geometric group.
...MyGroupByAssociativity = MyGroupSet.Add("CATFmtGroupByAssociativity")
# Set the group supportMyPartSupp = myPart.FindObjectByName("Fill.1")MyReference = myPart.CreateReferenceFromObject(MyPartSupp)MyLink = myProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)
MyLinkAccess = MyGroupByAssociativity.GetItem("SimLinkAccess")MyLinkAccess.AddLink ("MainSupport", MyLink)
# Set the group typeMyGroupByAssociativity.SetGroupType("CATFmtGroupTypeFace")
# Set the group nameMyGroupByAssociativity.Name = "Geometric Group.1"...
6.Creates a proximity group
In this step UC creates a proximity group.
...MyGroupByProximity = MyGroupSet.Add("CATFmtGroupByProximity")
# Set the group supportMyPartSupp = myPart.FindObjectByName("Fill.1")MyReference = myPart.CreateReferenceFromObject(MyPartSupp)MyLink = myProductService.ComposeLink(MyRootOcc, MyPartInstance, MyReference)MyLinkAccess = MyGroupByAssociativity.GetItem("SimLinkAccess")MyLinkAccess.AddLink ("MainSupport", MyLink)
# Set the group typeMyGroupByProximity.SetGroupType("CATFmtGroupTypeFace")
# Set the group toleranceMyGroupByProximity.SetAttributeValue ("Tolerance", 3)
# Set the group nameMyGroupByProximity.Name = "Proximity Group.1"...
7.Remove the proximity group
In this step UC removes the proximity group.
...MyGroupSet.Remove (2)...
Creating a XRep and managing its datasThis use case primarily focuses on the methodology to create a XRep and to manage data files.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should also copy into the folder pointed by the "TEMP" environment variable the "RootProduct.inp.txt" file supplied in the same folder as the 3dxml file. The file extension must be changed to "inp" instead of "txt". 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality.
Where to find the macro: CAAScdFeaCreateXRepSource.htmThis use case can be divided in nine steps:
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"2.Retrieves the root product3.Retrieves the PartBody4.Creates a new XRep5.Sets the data file name associated to the XRep6.Imports the data file in the XRep7.Generates the nav rep and import it into the XRep8.Adds a relation in the XRep9.Exports the data of the XRep
1.Searches and opens model which is named as "CAAScdFeaProductWithoutFEM"
As a first step, the UC retrieves a model "CAAScdFeaProductWithoutFEM" from DB and loads it and returns object of the Editor. 
... Dim myEditor As EditorOpenProduct MyEditor...
The function OpenProduct returns MyEditor, an Editor object. After searching and opening of "CAAScdFeaProductWithoutFEM" product from underlying database the current active editor is returned inMyEditor.
Page 143 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 144 ---

2.Retrieves the root product
As a next step, the UC retrieves the root product object from the returned editor.
 ...Dim MyRootOcc As VPMRootOccurrenceSet MyRootOcc = MyEditor.ActiveObject
Dim MyRootProduct AsVPMReferenceSet MyRootProduct = MyRootOcc.PLMEntity ...
3.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the root product.
...Dim MyContext As PLMProductServiceSet MyContext = MyEditor.GetService("PLMProductService")
Dim MyPart As PartDim MyPartInstance As VPMRepInstanceDim MyBody As BodyFor Each MyEntity In MyContext.EditedContentDim MyRef As VPMReferenceSet MyRef = MyEntity
Dim MyReps As VPMRepInstancesSet MyReps = MyRef.RepInstances
For Each MyRep In MyRepsDim MyRepRef As VPMRepReferenceSet MyRepRef = MyRep.ReferenceInstanceOfDim attr As String         attr = MyRepRef.GatAttributValue("V_discipline")
If (attr = "Design") ThenSet MyPart = MyRepRef.GetItem("Part")Set MyPartInstance = MyRepSet MyBody = MyPart.MainBodyEnd IfNextNext...
4.Creates a new XRep
In this step UC creates a new XRep object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the XRep will be aggregated.
...Dim MyPrdRepFactory As SimPrdRepFactorySet MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")
Dim MyXRepRef As VPMRepReferenceSet MyXRepRef = MyPrdRepFactory.CreatePrdRep("XRep")
Dim MyXRep As SimXRepSet MyXRep = MyXRepRef.GetItem("SimXRep")...
5.Sets the data file name associated to the XRep
In this step UC defines the name of the data file.
...MyXRep.FileName = "RootProduct.inp"...
6.Imports the data file in the XRep
In this step UC imports datas from the data file.
...Dim sFolderPath As StringsFolderPath = CATIA.SystemService.Environ("TEMP")MyXRep.ImportFile sFolderPath, True...
7.Generates the nav rep and import it into the XRep
In this step UC generates the cgr file and imports it into the XRep.
...Dim sFilePath As StringsFilePath = CATIA.SystemService.Environ("TEMP") & "\RootProduct.inp"MyXRep.GenerateNavRep sFilePath, "METER"...
8.Adds a relation in the XRep
In this step UC add the associated shape of the new representation.
...MyFemRepRoot.RemoveAssociatedRep MyLinkbHasAnAssociatedRep = MyFemRepRoot.HasAnAssociatedRepIf (bHasAnAssociatedRep = True) Then    MsgBox "Error while removing the associated shape from the FEM Rep!"Exit SubEnd If
Page 144 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 145 ---

...
9.Exports the data of the XRep to a data file
In this step UC exports the XRep datas into an "inp" file.
...MyXRep.FileName = "RootProductOut.inp"MyXRep.ExportFile sFolderPath...
Creating a XRep and managing its datasThis use case primarily focuses on the methodology to create a XRep and to manage data files.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaProductWithoutFEM.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should also copy into the folder pointed by the "TEMP" environment variable the "RootProduct.inp.txt" file supplied in the same folder as the 3dxml file. The file extension must be changed to "inp" instead of "txt". 
lYou should open the product called CAASCDFeaProductWithtoutFEM. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaCreateXRepWithPythonSource.htmThis use case can be divided in eight steps:
1.Retrieves the simulation and its product2.Retrieves the PartBody3.Creates a new XRep4.Sets the data file name associated to the XRep5.Imports the data file in the XRep6.Adds a relation in the XRep7.Exports the data of the XRep
1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor.
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the root occurence and the root product.
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myRootOcc = MyProductService.RootOccurrenceMyRootProduct = myRootOcc.PLMEntity...
2.Retrieves the PartBody
In this step UC retrieves the main body of the 3D shape aggregated by the simulation's Model.
...MyEntities = MyProductService.EditedContent
for MyEntity in MyEntities:    MyRef = MyEntity    MyReps = MyRef.RepInstancesfor MyRep in MyReps :        MyRepRef = MyRep.ReferenceInstanceOf        attr = MyRepRef.GetAttributeValue("V_discipline")if attr == "Design":           myPart = MyRepRef.GetItem("Part")           myPartInstance = MyRep           myBody = myPart.MainBody...
3.Creates a new XRep
In this step UC creates a new XRep object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the XRep will be aggregated.
...MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")MyXRepRef = MyPrdRepFactory.CreatePrdRep("XRep")MyXRep = MyXRepRef.GetItem("SimXRep")...
4.Sets the data file name associated to the XRep
In this step UC defines the name of the data file.
Page 145 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 146 ---

Mesh Parts Late Types
For further information about the mesh parts late types refer to the article "Mesh Parts and Their Attributes"
Properties Late Types
Properties creation is managed by theSimProperties collection by calling the Add method from it.
A "late type" must be given to indicate which type of property is to be created:
Connection Properties Late Types
Connection properties creation is managed by the SimMCXProperties collection by calling the Add method from it.
A "late type" must be given to indicate which type of connection property is to be created:
 Available with the RBM - Simulation Scripting product only.
...MyXRep.FileName = "RootProduct.inp"...
5.Imports the data file in the XRep
In this step UC imports datas from the data file.
...sFolderPath = CATIA.SystemService.Environ("TEMP")MyXRep.ImportFile (sFolderPath, True)...
6.Adds a relation in the XRep
In this step UC add the associated shape of the new representation.
...MyLink = MyProductService.ComposeLink(myRootOcc, myPartInstance , None)
MyXRep.AddRelation(MyLink, win32com.client.constants.SimXRepTo3DShapeRelation)...
7.Exports the data of the XRep
In this step UC exports the XRep datas into an "inp" file.
...MyXRep.FileName = "RootProductOut.inp"MyXRep.ExportFile(sFolderPath)...
Creation Late Types for Model FeaturesTechnical ArticleAbstract
The following reference article documents the different late types that can be used to create model features.
lMesh Parts Late Types
lProperties Late Types
lConnection Properties Late Types
lBehaviors Late Types
lAbstractions Late Types
Related TopicsSimProperties CollectionSimMCXProperties CollectionSimAbstractions CollectionMultiphysics Model Creation Object Model Map
Section Late type1D Link SectionSim1DLinkSectionBeam Section SimBeamSectionComposite Shell SectionSimCompositeShellSectionContinuum Shell SectionSimContinuumShellSectionFluid Section SimFluidSectionGasket PropertySimGasketPropertyMeshed Bolt SimMeshedBoltShell Section SimShellSectionSolid Section SimSolidSectionCohesive PropertySimCohesiveProperty
Connection propertyLate typeConnectorSimConnectorCoupling SimCouplingLine FastenerSimLineFastener
Point FastenerSimPointFastener
Rigid ConnectionSimRigidConnectionSpring SimSpringTie SimTie
Virtual Bolt SimVirtualBoltVirtual Pin SimVirtualPin
Page 146 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 147 ---

Behaviors Late Types
Behaviors creation is managed by the SimBehaviors collection by calling the Add method from it.
A "late type" must be given to indicate which type of behavior is to be created:
Abstractions Late Types
Abstractions creation is managed by the SimAbstractions collection by calling theAdd method from it.
A "late type" must be given to indicate which type of abstraction is to be created:
History
BehaviorLate typeBeam ProfileSimBeamProfile
AbstractionLate typeAcoustic AbsorberSimAcousticAbsorberAcoustic CouplingSimAcousticCouplingAnalytic Rigid SurfaceSimAnalyticRigidSurfaceMass Rotary InertiaSimMassRotaryInertiaCyclic SymmetrySimCyclicSymmetryFluid Cavity SimFluidCavityMass Per LengthSimMassPerLengthMass Per Area SimMassPerAreaMass Per VolumeSimMassPerVolumeRigid Body ConstraintSimRigidBodyConstraintSurface Fluid CavitySimSurfaceFluidCavity
Version: 1 [Jan 2015]Document created
Managing FEM Section FeaturesThis use case primarily focuses on the methodology to create/delete FEM sections.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaSectionsSource.htmThis use case can be divided in eight steps:
1.Retrieving the active product2.Retrieving the parts3.Retrieving the publications4.Creating the FEM representation and retrieving its root object5.Retrieving the properties set6.Creating individual properties7.Setting individual attributes8.Retrieving/Remove individual properties9.Retrieving Shell Section attributes : Thickness, Integration Method...
1.Retrieving the active product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the Parts
In this step UC retrieves the 3D shapes aggregated by the root product.
... Dim myProductInstance As VPMInstanceDim myPartInstance as VPMRepInstanceDim myPart as PartFor Each myProductInstance in myRootProduct.Instances    Dim myProductInstanceRef as VPMReference    Set myProductInstanceRef = myProductInstance.ReferenceInstanceOf
    For Each myPartInstance in myProductInstanceRef.RepInstances        Dim myPartInstanceRef as VPMRepReference
Page 147 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 148 ---

        Set myPartInstanceRef = myPartInstance.ReferenceInstanceOf
        If (myPartInstanceRef.GetAttributeValue("V_discipline") = "Design") Then            Set myPart = myPartInstanceRef.GetItem("Part")        End If    NextNext...
3.Retrieving the publications
In this step UC retrieves the publications aggregated by the root product.
 ...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myPublication as VPMPublicationSet myPublication = myPublications.GetItem("Pipe") ...
4.Creating the FEM representation and retrieving its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...Dim myPrdRepFactory As SimPrdRepFactorySet myPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")
Dim myFemRepRef As VPMRepReferenceSet myFemRepRef = myPrdRepFactory.CreatePrdRep("FEM")
Dim myFemRepRoot As SimFemRootSet myFemRepRoot = myFemRepRef.GetItem("SimFemRoot")
The 3D Shapes are linked to the FEM representation as associated shapes.
Dim myRootOccurrence as VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLink As AnyObjectSet myLink = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myPublication)MyFemRepRoot.AddAssociatedRep myLink...
5.Retrieving the properties set
In this step UC retrieves the properties set. 
...Dim myPropertiesSet As SimPropertiesSetmyPropertiesSet = myFemRepRoot.GetSet("SimProperties")...
6.Creating individual properties
In this step UC creates a solid section and a shell section feature.
...Dim mySolidSection As SimSolidSectionSet mySolidSection = myPropertiesSet.Add("SimSolidSection")
Dim myShellSection As SimShellSectionSet myShellSection = myPropertiesSet.Add("SimShellSection")...
You can find the available late types for properties creation in the Creation Late Types for Model Features article. 
7.Setting individual attributes
In this step UC sets individual attributes of the sections.
...' Sets the section supportDim myLinkAccess As SimLinkAccessSet myLinkAccess = myShellSection.GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLink
' Sets the material behaviormyShellSection.MaterialBehaviorByName = "Behavior.1"
' Sets the orientationDim myOrientation As SimOrientationSet myOrientation = myShellSection.Orientation
Dim myAxisSystem As SimAxisSystemSet myAxisSystem = myOrientation.AxisSystemmyAxisSystem.CoordinateType = SimAxisSystemCartesian
myOrientation.OrientationFlag = TruemyOrientation.AxisOfRotation = SimOrientationAxis2myOrientation.AngleOfRotation = 90
' Sets others attributesmyShellSection.IntegrationScheme = SimShellSectionSimpsonIntegration
Page 148 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 149 ---

myShellSection.PoissonMethod = SimShellSectionPoissonDefaultmyShellSection.UniformThickness = 0.002...
8.Retrieving/Remove individual properties
In this step UC retrieves the created properties and remove the solid section.
...Dim myRetrievedSolidSection As SimSolidSectionSet myRetrievedSolidSection = myPropertiesSet.Item(1)
Dim myRetrievedShellSection As SimShellSectionSet myRetrievedShellSection = myPropertiesSet.Item(2)
myPropertiesSet.Remove(1)...
9.Retrieving Shell Section attributes : Thickness, Integration Method...
In this step UC retrieves the properties attributes.
...Dim myIntegrationScheme As SimShellSectionIntegrationSchememyIntegrationScheme = myRetrievedShellSection.IntegrationScheme
Dim myNumberOfIntegrationPoints As LongmyNumberOfIntegrationPoints = myRetrievedShellSection.NumIntPoints
If myRetrievedShellSection.UniformThicknessFlag Then    Dim myUniformThickness As Double    myUniformThickness = myRetrievedShellSection.UniformThicknessEnd If
Dim myMaterialBehavior As MaterialBehaviorSet myMaterialBehavior = myRetrievedShellSection.MaterialBehavior
Set myOrientation = myRetrievedShellSection.Orientation
If myOrientation.OrientationFlag Then    Dim myRotationAxis  As SimOrientationAxisOfRotation    myRotationAxis= myOrientation.AxisOfRotation
    Dim myAngleOfRotation As Double    myAngleOfRotation= myOrientation.AngleOfRotationEnd If...
Managing FEM Section FeaturesThis use case primarily focuses on the methodology to create/delete FEM sections.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaSectionsWithPythonSource.htmThis use case can be divided in eight steps:
1.Retrieves the simulation and its product2.Retrieves the Root occurrence and the root product3.Retrieves the publications4.Creates the FEM representation and retrieving its root object5.Retrieves the properties set6.Creates individual properties7.Sets individual attributes8.Retrieves/Removes individual properties9.Retrieves Shell Section attributes : Thickness, Integration Method...1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor. 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Retrieves the Root occurrence and the root product
In this step UC opens the simulation model and retrieves the root occurence and the root product.
... oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditormyProductService = myProductEditor.GetService("PLMProductService")
myProductEntities = myProductService.EditedContentmyRootProduct = myProductEntities.Item(1)
Page 149 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 150 ---

myRootOccurrence = myProductService.RootOccurrence...
3.Retrieves the publications
In this step UC retrieves the publications aggregated by the root product.
 ...myPublications  = myRootProduct.PublicationsmyPublication = myPublications.GetItem("Pipe")...
4.Creates the FEM representation and retrieving its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...MyPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
The 3D Shapes are linked to the FEM representation as associated shapes.
...myLink = myProductService.ComposeLink(myRootOccurrence, None, myPublication)MyFemRepRoot.AddAssociatedRep (myLink)...
5.Retrieves the properties set
In this step UC retrieves the properties set. 
...myPropertiesSet = MyFemRepRoot.GetSet("SimProperties")...
6.Creates individual properties
In this step UC creates a solid section and a shell section feature.
...mySolidSection = myPropertiesSet.Add("SimSolidSection")myShellSection = myPropertiesSet.Add("SimShellSection")...
You can find the available late types for properties creation in the Creation Late Types for Model Features article. 
7.Sets individual attributes
In this step UC sets individual attributes of the sections.
...# Sets the section supportmyLinkAccess = myShellSection.GetItem("SimLinkAccess")myLinkAccess.AddLink ("MainSupport", myLink)
# Sets the material behaviormyShellSection.MaterialBehaviorByName = "Behavior.1"
# Sets the orientationmyOrientation = myShellSection.Orientation
myAxisSystem = myOrientation.AxisSystemmyAxisSystem.CoordinateType = win32com.client.constants.SimAxisSystemCartesian
myOrientation.OrientationFlag = TruemyOrientation.AxisOfRotation = win32com.client.constants.SimOrientationAxis2myOrientation.AngleOfRotation = 90
# Sets others attributesmyShellSection.IntegrationScheme = win32com.client.constants.SimShellSectionSimpsonIntegrationmyShellSection.PoissonMethod = win32com.client.constants.SimShellSectionPoissonDefaultmyShellSection.UniformThickness = 0.002...
8.Retrieves/Removes individual properties
In this step UC retrieves the created properties and remove the solid section.
...myRetrievedSolidSection = myPropertiesSet.Item(1)
myRetrievedShellSection = myPropertiesSet.Item(2)
myPropertiesSet.Remove(1)...
9.Retrieves Shell Section attributes : Thickness, Integration Method...
In this step UC retrieves the properties attributes.
...
myIntegrationScheme = myRetrievedShellSection.IntegrationScheme
myNumberOfIntegrationPoints = myRetrievedShellSection.NumIntPoints
Page 150 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 151 ---

bHasUniformThickness = myRetrievedShellSection.UniformThicknessFlagif  bHasUniformThickness == True:    myUniformThickness = myRetrievedShellSection.UniformThickness
myMaterialBehavior = myRetrievedShellSection.MaterialBehavior
myOrientation = myRetrievedShellSection.Orientation
bHasOrientation = myOrientation.OrientationFlagif  bHasOrientation == True:    myRotationAxis = myOrientation.AxisOfRotation    myAngleOfRotation = myOrientation.AngleOfRotation... 
Creating Numbering SpecificationsThis use case primarily focuses on the methodology to create nodes and elements numbering specifications for an assembly.
Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaAssemblyForNumbering.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
Where to find the macro: CAAScdFeaNumberingSource.htmThis use case can be divided in eleven steps:
1.Retrieves the active editor2.Retrieves the root product3.Retrieves the assembly FEM Rep4.Creates global numbering specifications5.Creates a link between the assembly FEM and the first occurrence FEM6.Sets numbering offsets7.Retrieves the mesh part of the first occurrence FEM8.Creates mesh part numbering specifications9.Retrieves the group of the first occurrence FEM10.Creates group numbering specifications11.Updates the assembly FEM Rep1.Retrieves the active editor
As a first step, the UC retrieves the active editor. 
... Dim MyEditor As EditorSet MyEditor = CATIA.ActiveEditor...
2.Retrieves the root product
In this step, the UC retrieves the root product from the active editor.
 ...Dim MyRootOcc As VPMRootOccurrenceSet MyRootOcc = MyEditor.ActiveObject
Dim MyRootProduct As VPMReferenceSet MyRootProduct = MyRootOcc.PLMEntity...
3.Retrieves the assembly FEM Rep
In this step, the UC retrieves the FEM Rep of the assembly.
 ...Dim MyProductService As PLMProductServiceSet MyProductService = MyEditor.GetService("PLMProductService")
Dim MyFEMRoot As SimFemRootFor Each MyEntity In MyProductService.EditedContentDim MyRef As VPMReferenceSet MyRef = MyEntity
Dim MyReps As VPMRepInstancesSet MyReps = MyRef.RepInstances
For Each MyRep In MyRepsDim MyRepRef As VPMRepReferenceSet MyRepRef = MyRep.ReferenceInstanceOfDim attr AsString    attr = MyRepRef.GetAttributeValue("V_discipline")
If (attr = "FEM") ThenSet MyFEMRoot = MyRepRef.GetItem("SimFemRoot")End IfNextNext...
4.Creates global numbering specifications
In this step, the UC creates global nodes and elements numbering specifications for the assembly.
 ...Dim MyNumberingEntity As SimNumberingSet MyNumberingEntity = MyFEMRoot.GetItem("SimNumbering")MyNumberingEntity.SetAttributeValue "NodesLowerBoundValue", 1MyNumberingEntity.SetAttributeValue "NodesUpperBoundValue", 1000000
Page 151 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 152 ---

MyNumberingEntity.SetAttributeValue "ElementsLowerBoundValue", 1MyNumberingEntity.SetAttributeValue "ElementsUpperBoundValue", 2000000...
5.Creates a link between the assembly FEM and the first occurrence FEM
In this step, the UC retrieves the FEM Rep which is aggregated by the first product occurrence. Then the UC creates a path element that will be used to create the link between the retrieved FEM Rep and the assembly FEM Rep.
 ...Dim MyRootOccurrences As VPMOccurrencesSet MyRootOccurrences = MyRootOcc.OccurrencesDim MyOccurrence As VPMOccurrenceSet MyOccurrence = MyRootOccurrences.Item(1)
Dim MyRepInstances As VPMRepInstancesSet MyRepInstances = MyOccurrence.InstanceOccurrenceOf.ReferenceInstanceOf.RepInstances
Dim MyFirstFEMRoot As SimFemRootDim MyFirstLink As AnyObjectFor Each MyRep In MyRepInstancesSet MyRepRef = MyRep.ReferenceInstanceOf  attr = MyRepRef.GetAttributeValue("V_discipline")If (attr = "FEM") ThenSet MyFirstFEMRoot = MyRepRef.GetItem("SimFemRoot")Set MyFirstLink = MyProductService.ComposeLink(MyOccurrence, MyRep, Nothing)End IfNext...
6.Sets numbering offsets
In this step, the UC sets nodes and elements numbering offsets of the first occurence FEM
 ...MyFEMRoot.SetNumberingOffsetValue "nodes", MyFirstLink, 500000MyFEMRoot.SetNumberingOffsetValue "elements", MyFirstLink, 600000...
7.Retrieves the mesh part of the first occurrence FEM
In this step, the UC retrieves the mesh part of the first occurrence FEM.
 ...Dim MyMeshSet As SimMeshSetSet MyMeshSet = MyFirstFEMRoot.GetSet("SimNodesElements")Dim MyMeshParts As SimMeshPartsSet MyMeshParts = MyMeshSet.MeshPartsDim MyMeshPart As SimMeshPartSet MyMeshPart = MyMeshParts.Item(1)...
8.Creates mesh part numbering specifications
In this step, the UC creates nodes and elements numbering specifications for the mesh part.
 ...Set MyNumberingEntity = MyMeshPart.GetItem("SimNumbering")MyNumberingEntity.SetAttributeValue "NodesLowerBoundValue", 100001MyNumberingEntity.SetAttributeValue "NodesUpperBoundValue", 102000MyNumberingEntity.SetAttributeValue "ElementsLowerBoundValue", 103001MyNumberingEntity.SetAttributeValue "ElementsUpperBoundValue", 105000...
9.Retrieves the group of the first occurrence FEM
In this step, the UC retrieves the group of the first occurrence FEM.
 ...Dim MyGroups As SimGroupsSet MyGroups = MyFirstFEMRoot.GetSet("SimGroups")Dim MyGroup As SimGroupSet MyGroup = MyGroups.Item(1)...
10.Creates group numbering specifications
In this step, the UC creates nodes numbering specifications for the group.
 ...Set MyNumberingEntity = MyGroup.GetItem("SimNumbering")MyNumberingEntity.SetAttributeValue "NodesLowerBoundValue", 105101MyNumberingEntity.SetAttributeValue "NodesUpperBoundValue", 105200...
11.Updates the assembly FEM Rep
In this step, the UC updates the assembly FEM Rep.
 ...MyFEMRoot.Update...
Creating Numbering Specifications
This use case primarily focuses on the methodology to create nodes and elements numbering specifications for an assembly.
Page 152 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 153 ---

Before you begin: Note that:
lYou should first launch CATIA and import theCAAScdFeaAssemblyForNumbering.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lYou should open the product called CAAScdFeaAssemblyForNumbering. 
lLaunch the structural scenario App and create a structural simulation. 
Where to find the macro: CAAScdFeaNumberingWithPythonSource.htmThis use case can be divided in eleven steps:
1.Retrieve the simulation and its product2.Retrieves the assembly FEM Rep3.Creates global numbering specifications4.Creates a link between the assembly FEM and the first occurrence FEM5.Sets numbering offsets6.Retrieves the mesh part of the first occurrence FEM7.Creates mesh part numbering specifications8.Retrieves the group of the first occurrence FEM9.Creates group numbering specifications10.Updates the assembly FEM Rep
1.Retrieve the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model.
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then opens the simulation model and retrieves the root occurence.
oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myRootOcc = MyProductService.RootOccurrence...
2.Retrieves the assembly FEM Rep
In this step, the UC retrieves the FEM Rep of the assembly.
...myProductEntities = MyProductService.EditedContent
for  myProductEntity in myProductEntities:     myRef = myProductEntity     myReps = myRef.RepInstances
for myRep in myReps:         myRepRef = myRep.ReferenceInstanceOf         attr = myRepRef.GetAttributeValue("V_discipline")if attr == "FEM":            myFEMRoot = myRepRef.GetItem("SimFemRoot")...
3.Creates global numbering specifications
In this step, the UC creates global nodes and elements numbering specifications for the assembly.
...MyNumberingEntity = myFEMRoot.GetItem("SimNumbering")MyNumberingEntity.SetAttributeValue ("NodesLowerBoundValue", 1)MyNumberingEntity.SetAttributeValue ("NodesUpperBoundValue", 1000000)MyNumberingEntity.SetAttributeValue ("ElementsLowerBoundValue", 1)MyNumberingEntity.SetAttributeValue ("ElementsUpperBoundValue", 2000000)...
4.Creates a link between the assembly FEM and the first occurrence FEM
In this step, the UC retrieves the FEM Rep which is aggregated by the first product occurrence. Then the UC creates a path element that will be used to create the link between the retrieved FEM Rep and the assembly FEM Rep.
...MyRootOccurrences = myRootOcc.OccurrencesMyOccurrence = MyRootOccurrences.Item(1)
MyRepInstances = MyOccurrence.InstanceOccurrenceOf.ReferenceInstanceOf.RepInstances
for MyRep2 in MyRepInstances:    MyRepRef2 = MyRep2.ReferenceInstanceOf    attr = MyRepRef2.GetAttributeValue("V_discipline")if attr == "FEM":       MyFirstFEMRoot = MyRepRef2.GetItem("SimFemRoot")       MyFirstLink = MyProductService.ComposeLink(MyOccurrence, MyRep2, None)
...
5.Sets numbering offsets
Page 153 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 154 ---

In this step, the UC sets nodes and elements numbering offsets of the first occurence FEM
...myFEMRoot.SetNumberingOffsetValue ("nodes", MyFirstLink, 500000)myFEMRoot.SetNumberingOffsetValue ("elements", MyFirstLink, 600000)...
6.Retrieves the mesh part of the first occurrence FEM
In this step, the UC retrieves the mesh part of the first occurrence FEM.
...MyMeshSet = MyFirstFEMRoot.GetSet("SimNodesElements")MyMeshParts = MyMeshSet.MeshPartsMyMeshPart = MyMeshParts.Item(1)...
7.Creates mesh part numbering specifications
In this step, the UC creates nodes and elements numbering specifications for the mesh part.
...MyNumberingEntity = MyMeshPart.GetItem("SimNumbering")MyNumberingEntity.SetAttributeValue ("NodesLowerBoundValue", 100001)MyNumberingEntity.SetAttributeValue ("NodesUpperBoundValue", 102000)MyNumberingEntity.SetAttributeValue ("ElementsLowerBoundValue", 103001)MyNumberingEntity.SetAttributeValue ("ElementsUpperBoundValue", 105000)...
8.Retrieves the group of the first occurrence FEM
In this step, the UC retrieves the group of the first occurrence FEM.
...MyGroups = MyFirstFEMRoot.GetSet("SimGroups")MyGroup = MyGroups.Item(1)...
9.Creates group numbering specifications
In this step, the UC creates nodes numbering specifications for the group.
...MyNumberingEntity = MyGroup.GetItem("SimNumbering")MyNumberingEntity.SetAttributeValue ("NodesLowerBoundValue", 105101)MyNumberingEntity.SetAttributeValue ("NodesUpperBoundValue", 105200)...
10.Updates the assembly FEM Rep
In this step, the UC updates the assembly FEM Rep.
...myFEMRoot.Update...
Creating a Connection PropertyThis use case primarily focuses on the methodology to create a connection property.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\, where InstallRootFolderis the folder where the API CD-ROM is installed. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality. 
Where to find the macro: CAAScdFeaConnectionsSource.htmThis use case can be divided into seven steps:
1.Retrieving the active product2.Retrieving the publications and composing links3.Creating a rigid engineering connection4.Creating the FEM representation and retrieving its root object5.Retrieving the MCX property manager6.Creating a spring connection property7.Setting the spring connection attributes
1.Retrieving the active product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
Page 154 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 155 ---

2.Retrieving the publications and composing links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myCoverContactFace As VPMPublicationSet myCoverContactFace= myPublications.GetItem("Cover_Contact_Face")
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToCoverContactFace As AnyObjectSet myLinkToCoverContactFace = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myCoverContactFace)...
3.Creating a rigid engineering connection
In this step UC creates a rigid engineering connection.
For further information about creating a rigid engineering connection refer to the article Creating an Assembly Constraint Between Two Instances of a Basic Pad.
4.Creating the FEM representation and retrieving its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory has to be retrieved on the reference object on which the FEM rep will be aggregated.
...Dim myPrdRepFactory As SimPrdRepFactorySet myPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")
Dim myFemRepRef As VPMRepReferenceSet myFemRepRef = myPrdRepFactory.CreatePrdRep("FEM")
Dim myFemRepRoot As SimFemRootSet myFemRepRoot = myFemRepRef.GetItem("SimFemRoot")...
5.Retrieving the MCX property manager
In this step UC retrieves the MCX property manager. 
...Dim myMCXProperties As SimMCXPropertiesSet myMCXProperties = myNewRigidEngineeringConnection.GetItem("SimMCXProperties")...
6.Creating a spring connection property
In this step UC creates a spring connection property.
...' Creation of the spring connection property
Dim mySpringConnection As SimSpringSet mySpringConnection = myMCXProperties.Add("SimSpring", myFemRepRoot)
' Setting of the Spring connection property supports
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = mySpringConnection.GetItem("SimLinkAccess")
myLinkAccess.AddLink "PRD1", myLinkToCoverContactFace ' PRD1 attribute is for main surfacemyLinkAccess.AddLink "PRD2", myLinkToPumpHousingContactFace ' PRD2 attribute is for secondary surface...
You can find the available late types for connection properties creation in the Creation Late Types for Model Features article. 
Important : For connection features you will have to use "PRD1", "PRD2", etc... to set the different supports and "Handler0D" or "Handler1D" for fastenerplacements.
7.Setting the spring connection attributes
In this step UC retrieves the connector section of the spring and sets its elasticities.
...' Retrieving the connector section
mySpringConnection.SpringType = SimGeneralSpring
Dim myConnectionSection As SimConnectorSectionSet myConnectionSection = mySpringConnection.ConnectorSection
' Retrieving the behavior
Dim myConnectionBehavior As SimConnectorBehaviorSet myConnectionBehavior = myConnectionSection.ConnectorBehavior
' Retrieving the elasticities
Dim myConnectorElasticities 'As SimConnectorElasticitiesSet myConnectorElasticities = myConnectionBehavior.ConnectorElasticities
Page 155 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 156 ---

' Retrieving the first elasticity
Dim myConnectorElasticity1 As SimConnectorElasticitySet myConnectorElasticity1 = myConnectorElasticities.Item(1)
myConnectorElasticity1.ElasticityOrder = SimConnectorElasticityNonLinear
' Retrieving the stiffness column
Dim myStiffnessColumn1 As SimTableColumnSet myStiffnessColumn1 = myConnectorElasticity1.GetTableColumn(SimConnectorElasticityStiffness)
' Retrieving the position column
Dim myPositionColumn1 As SimTableColumnSet myPositionColumn1 = myConnectorElasticity1.GetTableColumn(SimConnectorElasticityPosition)
' Setting data
myStiffnessColumn1.SetCellData 1, 0.17myPositionColumn1.SetCellData 1, 0.008...
Creating a Connection PropertyThis use case primarily focuses on the methodology to create a connection property.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\, where InstallRootFolderis the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation.
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality.
Where to find the macro: CAAScdFeaConnectionsWithPythonSource.htmThis use case can be divided into seven steps:
1.Retrieves the simulation and its product2.Retrieves the publications and composes links3.Creates a rigid engineering connection4.Creates constraints5.Creates the FEM representation and retrieves its root object6.Retrieves the MCX property manager7.Creates a spring connection property8.Sets the spring connection attributes
1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor. 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then, opens the simulation model and retrieves the root occurence and the root product
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditormyProductService = myProductEditor.GetService("PLMProductService")
myProductEntities = myProductService.EditedContentMyRootProduct = myProductEntities.Item(1)
myRootOccurrence = myProductService.RootOccurrence...
2.Retrieves the publications and composing links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications = MyRootProduct.PublicationsmyCoverContactFace= myPublications.GetItem("Cover_Contact_Face")...
then, composes link to the publication 
...myLinkToCoverContactFace = myProductService.ComposeLink(myRootOccurrence, None, myCoverContactFace)...
3.Creates a rigid engineering connection and creates constraints
In this step UC creates a rigid engineering connection.
First, Retrieve the engineering connection manager
Page 156 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 157 ---

...myEngineeringConnections = MyRootProduct.GetItem("CATEngConnections")...
Create the list of impacted product
...myImpacted = []myImpacted.append("ws3_cover_part.1")myImpacted.append("ws3_pump_housing_part.1")...
Create a rigid engineering connection
...myNewRigidEngineeringConnection = myEngineeringConnections.Add(win32com.client.constants.catRigid, myImpacted)...
4.Creates constraints
In this step UC creates constraints.
First, retrieve the assembly constraint manager
...myAssemblyConstraints = myNewRigidEngineeringConnection.AssemblyConstraints...
Create coincidence constraint between two hole axis
...myGeometries = []myGeometries.append("Cover_Hole2_Axis")myGeometries.append("Pump_Housing_Hole2_Axis")
myCoincidenceConstraint1 = myAssemblyConstraints.Add(win32com.client.constants.catCoincidenceLineLine, myGeometries)...
5.Creates the FEM representation and retrieves its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory has to be retrieved on the reference object on which the FEM rep will be aggregated.
...MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
6.Retrieves the MCX property manager
In this step UC retrieves the MCX property manager. 
...myMCXProperties = myNewRigidEngineeringConnection.GetItem("SimMCXProperties")...
7.Creates a spring connection property
In this step UC creates a spring connection property.
...mySpringConnection = myMCXProperties.Add("SimSpring", MyFemRepRoot)...
Setting of the Tie connection property supports
...myLinkAccess = mySpringConnection.GetItem("SimLinkAccess")...
Adding links for master and slave surface
...# PRD1 attribute is for master surface myLinkAccess.AddLink ("PRD1", myLinkToCoverContactFace)
# PRD2 attribute is for slave surface myLinkAccess.AddLink ("PRD2", myLinkToPumpHousingContactFace)...
You can find the available late types for connection properties creation in the Creation Late Types for Model Features article. 
Important : For connection features you will have to use "PRD1", "PRD2", etc... to set the different supports and "Handler0D" or "Handler1D" for fastenerplacements.
8.Sets the spring connection attributes
In this step UC retrieves the connector section of the spring and sets its elasticities.
...# Retrieving the connector sectionmySpringConnection.SpringType = win32com.client.constants.SimGeneralSpring
myConnectionSection = mySpringConnection.ConnectorSection
Page 157 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 158 ---

# Retrieving the behaviormyConnectionBehavior = myConnectionSection.ConnectorBehavior
# Retrieving the elasticitiesmyConnectorElasticities = myConnectionBehavior.ConnectorElasticities
# Retrieving the first elasticitymyConnectorElasticity1 = myConnectorElasticities.Item(1)
myConnectorElasticity1.ElasticityOrder = win32com.client.constants.SimConnectorElasticityNonLinear
# Retrieving the stiffness columnmyStiffnessColumn1 = myConnectorElasticity1.GetTableColumn(win32com.client.constants.SimConnectorElasticityStiffness)
# Retrieving the position columnmyPositionColumn1 = myConnectorElasticity1.GetTableColumn(win32com.client.constants.SimConnectorElasticityPosition)
# Setting data
myStiffnessColumn1.SetCellData (1, 0.17)myPositionColumn1.SetCellData (1, 0.008)...
Managing Connection Property FeaturesThis use case primarily focuses on the methodology to include and exclude connection property into the FEM representation.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaManagingConnectionPropertySource.htmThis use case can be divided in seven steps:
1.Retrieving the active product2.Creating the FEM representation and retrieving its root object3.Adding associated rep to the FEM rep4.Creating meshes on the Cover and the Pump Housing5.Creating and including a connection property6.Checking the connection property inclusion7.Updating the FEM representation8.Excluding the connection property9.Including the connection property again
1.Retrieving the active product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Creating the FEM representation and retrieving its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...Dim myPrdRepFactory As SimPrdRepFactorySet myPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")
Dim myFemRepRef As VPMRepReferenceSet myFemRepRef = myPrdRepFactory.CreatePrdRep("FEM")
Dim myFemRepRoot As SimFemRootSet myFemRepRoot = myFemRepRef.GetItem("SimFemRoot")...
3.Adding associated rep to the FEM rep
In this step UC associates 3D shape with the FEM representation.
For further information about managing the FEM associated representation refer to the "Associates the PartBody with the FEM representation" section of the article Creating a FEM rep and managing its associated shapes. 
4.Creating meshes on the Cover and the Pump Housing
In this step UC creates mesh parts on the cover and pump housing shapes.
For further information about creates mesh part refer to the "Creates a Mesh Part" section of the article Creating Mesh Part. 
5.Creating connection property
Page 158 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 159 ---

In this step UC creates connection property and includes it in the FEM representation upon addition.
For further information about creating a connection property refer to the "Creating a spring connection property" section of the article Creating a Connection Property.
6.Checking the connection property inclusion
In this step UC checks whether the connection property is included or not.
...myFemRepRoot.IsIncludedPropertyConnection myRootOccurrence, mySpringConnection ' Connection property is created upon addition...
7.Updating the FEM representation
In this step UC updates the FEM representation with the previously included connection property.
...myFemRepRoot.Update...
8.Excluding the connection property
In this step UC excludes the connection property from the FEM representation.
...myFemRepRoot.ExcludePropertyConnection myRootOccurrence, mySpringConnection...
9.Including the connection property again
In this step UC includes the connection property in the FEM representation again.
...myFemRepRoot.IncludePropertyConnection myRootOccurrence, mySpringConnection...
Managing Connection Property FeaturesThis use case primarily focuses on the methodology to include and exclude connection property into the FEM representation.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaManagingConnectionPropertyWithPythonSource.htmThis use case can be divided in seven steps:
1.Retrieves the simulation and its product2.Creates the FEM representation and retrieves its root object3.Creates a spring property connection4.Checks the connection property inclusion5.Updates the FEM representation6.Excludes the connection property7.Includes the connection property again
1.Retrieves the simulation and its product
As a first step, the UC retrieves the simulation and its product from the simulation editor. 
...myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
Then, opens the simulation model and retrieves the root occurence and the root product
...oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditormyProductService = myProductEditor.GetService("PLMProductService")
myProductEntities = myProductService.EditedContentMyRootProduct = myProductEntities.Item(1)
myRootOccurrence = myProductService.RootOccurrence...
2.Creates the FEM representation and retrieves its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...
Page 159 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 160 ---

MyPrdRepFactory = MyRootProduct.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
3.Creates connection property
In this step UC creates connection property and includes it in the FEM representation upon addition.
For further information about creating a connection property refer to the spring connection property section of the article Creating a Connection Property. 
4.Checks the connection property inclusion
In this step UC checks whether the connection property is included or not.
...MyFemRepRoot.IsIncludedPropertyConnection (myRootOccurrence, mySpringConnection)...
5.Updates the FEM representation
In this step UC updates the FEM representation with the previously included connection property.
...MyFemRepRoot.Update...
6.Excludes the connection property
In this step UC excludes the connection property from the FEM representation.
...MyFemRepRoot.ExcludePropertyConnection (myRootOccurrence, mySpringConnection)...
7.Includes the connection property again
In this step UC includes the connection property in the FEM representation again.
...MyFemRepRoot.IncludePropertyConnection (myRootOccurrence, mySpringConnection)...
Creating a Fastener Connection PropertyThis use case primarily focuses on the methodology to create a fastener connection property.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolderis the folder where the API CD-ROM is installed. 
lCA media is required in order to create and edit fasteners. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality. 
Where to find the macro: CAAScdFeaFastenersSource.htmThis use case can be divided in seven steps:
1.Retrieving the active product2.Retrieving the publications and composing links3.Creating and initializing a core material4.Creating an engineering connection5.Creating the FEM representation and retrieving its root object6.Creating and initializing a line fastener connection property7.Creating and initializing a point fastener connection property
1.Retrieving the active product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the publications and composing links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myPumpHousing As VPMPublicationSet myPumpHousing = myPublications.GetItem("Pump_Housing")
Page 160 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 161 ---

...
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToPumpHousing As AnyObjectSet myLinkToPumpHousing = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myPumpHousing)...
3.Creating and initializing a core material
In this step UC creates a core material which will be applied on fastener properties.
For further information about creating a core material refer to the article Creating and Modifying Simulation Material Domain. 
4.Creating an engineering connection
In this step UC creates an engineering connection.
For further information about creating a rigid engineering connection refer to the article Creating an Assembly Constraint Between Two Instances of a Basic Pad.
5.Creating the FEM representation and retrieving its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...Dim myPrdRepFactory As SimPrdRepFactorySet myPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")
Dim myFemRepRef As VPMRepReferenceSet myFemRepRef = myPrdRepFactory.CreatePrdRep("FEM")
Dim myFemRepRoot As SimFemRootSet myFemRepRoot = myFemRepRef.GetItem("SimFemRoot")...
6.Creating and initializing a line fastener connection property
In this step UC creates a line fastener connection property.
...' Creating the line fastener connection property
Dim myMCXProperties As SimMCXPropertiesSet myMCXProperties = myEngineeringConnection.GetItem("SimMCXProperties")
Dim myLineFastener As SimLineFastenerSet myLineFastener = myMCXProperties.Add("SimLineFastener", myFemRepRoot)
' Setting the line fastener connection property supports
Dim myLineFastenerLinkAccess As SimLinkAccessSet myLineFastenerLinkAccess = myLineFastener.GetItem("SimLinkAccess")
myLineFastenerLinkAccess.AddLink "PRD1", myLinkToPumpHousing ' PRD1 attribute is for master surfacemyLineFastenerLinkAccess.AddLink "PRD2", myLinkToCover ' PRD2 attribute is for slave surfacemyLineFastenerLinkAccess.AddLink "Handler1D", myLinkToLine ' Handler1D attribute is for fasteners placements
' Setting the line fastener connection property material
Dim myLinkToLineFastener As AnyObjectSet myLinkToLineFastener = myProdService.ComposeLink(myRootOccurrence, Nothing, myLineFastener)
Dim myCoreAppliedMaterial As AppliedMaterialmyMaterialService.SetMaterialCore myLinkToLineFastener, myCoreMatRef, myCoreAppliedMaterial
' Setting the line fastener connection property attributes
myLineFastener.ConstructType = SimLineFastenerShellmyLineFastener.CouplingType = SimCouplingKinematicmyLineFastener.MeshCompatibility = SimLineFastenerNonCompatiblemyLineFastener.Height = 0.001myLineFastener.MaximumAngle = 2myLineFastener.Spacing = 0.003myLineFastener.Width = 0.004...
7.Creating and initializing a point fastener connection property
In this step UC creates a point fastener connection property.
...' Creating the point fastener connection property
Dim myPointFastener As SimPointFastenerSet myPointFastener = myMCXProperties.Add("SimPointFastener", myFemRepRoot)
' Setting the point fastener connection property supports
Dim myPointFastenerLinkAccess As SimLinkAccessSet myPointFastenerLinkAccess = myPointFastener.GetItem("SimLinkAccess")
myPointFastenerLinkAccess.AddLink "PRD1", myLinkToPumpHousing ' PRD1 attribute is for master surfacemyPointFastenerLinkAccess.AddLink "PRD2", myLinkToCover ' PRD2 attribute is for slave surface
Page 161 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 162 ---

myPointFastenerLinkAccess.AddLink "Handler0D", myLinkToLine ' Handler0D attribute is for fasteners placements
' Setting the point fastener connection property material
Dim myLinkToPointFastener As AnyObjectSet myLinkToPointFastener = myProdService.ComposeLink(myRootOccurrence, Nothing, myPointFastener)
myMaterialService.SetMaterialCore myLinkToPointFastener, myCoreMatRef, myCoreAppliedMaterial
' Setting the point fastener connection property attributes
myPointFastener.ConstructType = SimPointFastenerRigidmyPointFastener.CouplingType = SimCouplingKinematicmyPointFastener.FastenerDiameter = 0.002
Dim myPointFastenerPlacement As SimPointFastenerPlacementSet myPointFastenerPlacement = myPointFastener.PointFastenerPlacementmyPointFastenerPlacement.FastenerPlacementMethod = SimPointFastenerPlacementLinemyPointFastenerPlacement.NumberOfFastenersAlongLines = 20...
Creating a Fastener Connection PropertyThis use case primarily focuses on the methodology to create a fastener connection property.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolderis the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation.
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality.
Where to find the macro: CAAScdFeaFastenersWithPythonSource.htmThis use case can be divided in seven steps:
1.Retrieves the simulation and its product2.Retrieves the publications and composing links3.Creates and initializes a core material4.Creates an engineering connection5.Creates the FEM representation and retrieves its root object6.Creates and initializes a line fastener connection property7.Creates and initializes a point fastener connection property
1.Retrieves the simulation and its product
As a first step, the UC retrieves the active editor and retrieves the simulation model.
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model
Then opens the simulation model and retrieves the root occurence.
oOpenService = CATIA.GetSessionService("PLMOpenService")oOpenService.PLMOpen (myModel)
myProductEditor = CATIA.ActiveEditorMyProductService = myProductEditor.GetService("PLMProductService")
myEntities = MyProductService.EditedContentmyRootProduct = myEntities.Item(1)
myRootOccurrence = MyProductService.RootOccurrence...
2.Retrieves the publications and composing links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications  = myRootProduct.Publications
myPumpHousing = myPublications.GetItem("Pump_Housing")
# Composing link to the publicationmyLinkToPumpHousing = myProdService.ComposeLink(myRootOccurrence, None, myPumpHousing)...
3.Creates and initializes a core material
In this step UC creates a core material which will be applied on fastener properties.
For further information about creating a core material refer to the article Creating and Modifying Simulation Material Domain With Python.
4.Creates an engineering connection
In this step UC creates an engineering connection.
...# Creating a free engineering connectionmyEngineeringConnections = myRootProduct.GetItem("CATEngConnections")
Page 162 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 163 ---

# Create the list of impacted productmyImpacted = []myImpacted.append("ws3_pump_housing_part.1")myImpacted.append("ws3_cover_part.1")
# Create a rigid engineering connectionmyEngineeringConnection = myEngineeringConnections.Add(win32com.client.constants.catFree, myImpacted)
...
5.Creates the FEM representation and retrieves its root object
In this step UC creates a new FEM representation object. To perform the creation, a simulation representation factory have to be retrieved on the reference object on which the FEM rep will be aggregated.
...MyPrdRepFactory = myRootProduct.GetItem("SimPrdRepFactory")MyFemRepRef = MyPrdRepFactory.CreatePrdRep("FEM")MyFemRepRoot = MyFemRepRef.GetItem("SimFemRoot")...
6.Creates and initializes a line fastener connection property
In this step UC creates a line fastener connection property.
...# Creating the line fastener connection propertymyMCXProperties = myEngineeringConnection.GetItem("SimMCXProperties")myLineFastener = myMCXProperties.Add("SimLineFastener", MyFemRepRoot)
# Setting the line fastener connection property supportsmyLineFastenerLinkAccess = myLineFastener.GetItem("SimLinkAccess")
# PRD1 attribute is for master surfacemyLineFastenerLinkAccess.AddLink ("PRD1", myLinkToPumpHousing)
# PRD2 attribute is for slave surfacemyLineFastenerLinkAccess.AddLink ("PRD2", myLinkToCover)
# Handler1D attribute is for fasteners placementsmyLineFastenerLinkAccess.AddLink ("Handler1D", myLinkToLine)
# Setting the line fastener connection property materialmyLinkToLineFastener = myProdService.ComposeLink(myRootOccurrence, None, myLineFastener)
myCoreAppliedMaterial = myMaterialService.SetMaterialCore (myLinkToLineFastener, myCoreMatRef, None)
# Setting the line fastener connection property attributesmyLineFastener.ConstructType = win32com.client.constants.SimLineFastenerShellmyLineFastener.CouplingType = win32com.client.constants.SimCouplingKinematicmyLineFastener.MeshCompatibility = win32com.client.constants.SimLineFastenerNonCompatiblemyLineFastener.Height = 0.001myLineFastener.MaximumAngle = 2myLineFastener.Spacing = 0.003myLineFastener.Width = 0.004...
7.Creates and initializes a point fastener connection property
In this step UC creates a point fastener connection property.
...# Creating the point fastener connection propertymyPointFastener = myMCXProperties.Add("SimPointFastener", MyFemRepRoot)
# Setting the point fastener connection property supportsmyPointFastenerLinkAccess = myPointFastener.GetItem("SimLinkAccess")
myPointFastenerLinkAccess.AddLink ("PRD1", myLinkToPumpHousing) # PRD1 attribute is for master surfacemyPointFastenerLinkAccess.AddLink ("PRD2", myLinkToCover) # PRD2 attribute is for slave surfacemyPointFastenerLinkAccess.AddLink ("Handler0D", myLinkToLine) # Handler0D attribute is for fasteners placements
# Setting the point fastener connection property material
myLinkToPointFastener = myProdService.ComposeLink(myRootOccurrence, None, myPointFastener)
myCoreAppliedMaterial = myMaterialService.SetMaterialCore (myLinkToPointFastener, myCoreMatRef, None)
# Setting the point fastener connection property attributes
myPointFastener.ConstructType = win32com.client.constants.SimPointFastenerRigidmyPointFastener.CouplingType = win32com.client.constants.SimCouplingKinematicmyPointFastener.FastenerDiameter = 0.002
myPointFastenerPlacement = myPointFastener.PointFastenerPlacementmyPointFastenerPlacement.FastenerPlacementMethod = win32com.client.constants.SimPointFastenerPlacementLinemyPointFastenerPlacement.NumberOfFastenersAlongLines = 20...
Automated FEM ProceduresTechnical Article
Abstract
This article is in addition to the one about Automated FEM tool in the product documentation.SeeSimulation\Physics Simulation\Model AssemblyDesign\Automated Modeling 
It describes the available Automated FEM procedures to create mesh parts and it gives you some explanations to create your own user procedure.
Page 163 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 164 ---

How to test out of the box procedures
For 3D procedures :
lLaunch CATIA and import the CAAScdFeaSample3DForAutomatedModeling.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\where InstallRootFolder is the folder where the API CD-ROM is installed.
lOpen the"CAAScdFeaSample3DForAutomatedModeling" and launch the Model Assembly Design apps. 
lLaunch the Automated FEM tool in the Automated FEM section. 
For 2D procedures :
lLaunch CATIA and import the CAAScdFeaSample2DForAutomatedModeling.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaModeling\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed.
lOpen the"CAAScdFeaSample2DForAutomatedModeling" and launch the Model Assembly Design apps. 
lLaunch the Automated FEM tool in the Automated FEM section. 
Out of the box procedures
The table below describes the existing procedures that you can use.
There are two types of procedures : 
lRule based 
lParameter based 
User procedures
This section explains how to create User procedures.
The Automated FEM tool allows to mesh assemblies using existing procedures or created user procedures.  When using user procedures you can automate many tasks in addition to the predefined meshing procedures. 
User procedures must follow a specific format to be used within the automated fem application.
Procedure type
All the procedures are in VB scripts. The extension is ".catvbs"
Global variable
Two global variables definition, SHAPE and FEM, are available and can be used.
The global variable SHAPE refers to the 3D Shape selection in the Batch Modeling dialog box. It is used for scripting geometry operations, such as defeaturing ormidsurface extraction.
The global variable FEM refers to the finite element model representation associated with a 3D Shape. It is used for finite element operations, such as creating meshes or property assignments for use in simulations.
Inputs
The input definition is used to create an UI with the described parameters and let the user set interactively the required parameters. These must be entered before theprocedure can be run.
Inputs are written in HTML as a comment in vb script to let the Automated FEM tool generates each requested UI. And then, during the script execution, these 
How to test out of the box procedures
Out of the box procedures
User procedures
lProcedure type
lGlobal variable
lInputs
lProcedure syntax
Example : Generate 3D mesh procedure
Procedure nameUsed Mesh partLate type ProcedureGenerate3DMeshTetrahedronCATFmtTetRulesMesherCAAScdFeaGenerate3DMeshGenerate3DOctreeMesh Octree 3DCATFmtOctree3DRulesMesher CAAScdFeaGenerate3DOctreeMeshGenerate3DSweepMesh Sweep 3DCATFmtSweep3DRulesMesher CAAScdFeaGenerate3DSweepMeshGenerateMidSurfWithAbsShape Quadrangle Surface CATFmtSurfQuadMesher CAAScdFeaGenerateMidSurfWithAbsShapeGenerateSurfQuadMesh Quadrangle SurfaceCATFmtSurfQuadMesher CAAScdFeaGenerateSurfQuadMeshGenerateSurfTriaMesh Triangle SurfaceCATFmtSurfTriaMesher CAAScdFeaGenerateSurfTriaMesh
Procedure name Used Mesh part Late type ProcedureGenerate3DOctreeMeshParameters Octree 3DCATFmtOctree3DRulesMesher CAAScdFeaGenerate3DOctreeMeshParametersGenerate3DSweepMeshParameters Sweep 3DCATFmtSweep3DMesherCAAScdFeaGenerate3DSweepMeshParametersGenerate3DTetMeshParametersTetrahedronCATFmtTetRulesMesherCAAScdFeaGenerate3DTetMeshParametersGenerateMidSurfWithAbsShapeParametersQuadrangle SurfaceCATFmtSurfQuadMesherCAAScdFeaGenerateMidSurfWithAbsShapeParametersGenerateSurfQuadMeshParametersQuadrangle SurfaceCATFmtSurfQuadMesherCAAScdFeaGenerateSurfQuadMeshParametersGenerateSurfTriaMeshParameters Triangle SurfaceCATFmtSurfTriaMesherCAAScdFeaGenerateSurfTriaMeshParameters
Page 164 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 165 ---

information are given as input arguments to the VB script 
Input definition is optional for user procedures. You can directly give the needed information on the VB script to run directly without setting interactively the required parameters.
Procedure syntax
The syntax is the standard VB scripting one. All the steps must be in between Sub main and end sub.
When using Inputs definitions, you have to give the same number of argument as input to the Sub main ( iInput_1, iInput_2, ... , iInput_n)
Otherwise, there is no input argument for the Sub main.
For more information see "About the Automated FEM Application" and " "About User Procedures" in the product documentation ( Simulation / Physics Simulation / Model Assembly Design / Automated Modeling )
Example : Generate 3D mesh procedure
This procedure can be divided in 2 parts
1.Inputs definition2.VB Script  
The script can be divided in six steps 
1.Retrieve created FEM Rep2.Create Mesh Part3.Create Solid Property4.Retrieve Mesh Part Support if it is not given as argument 5.Add support to Mesh part 6.Set Rule to Mesh part 
1.Inputs definition
In this example, three inputs are defined : Support, Meshing Rule and Property.
Automated FEM tool generates a specific dialog box and lets the user valuate each input. 
'<Inputs>  '<InputName = "Support" Type ="Port" Mand ="false" Nls ="Support"/>  '<InputName = "MeshingRule" Type ="DmtDocument" SubType ="CATFmtTetRule" Mand ="true" Nls ="Rule"/>  '<InputName = "Property" Type ="Boolean" Mand ="true" Nls ="CreateSolid"/>'</Inputs>
For each input four arguments have to been given.
Important: This part does not set the inputs value. It just defines requested inputs.2.VB Script
1.Retrieve created FEM Rep
The Fem rep is created before the script execution and stored on the FEM global variable.
We retrieve in this step the SimFemRoot object on the created FEM
...Dim FEMRoot As CATIAFmtFemRootSet FEMRoot = FEM.GetItem("SimFemRoot")...
2.Create Mesh Part
Then we create the rule based 3D Mesh
 ...' Retrieve the mesh setDim MeshSet As CATIAFmtMeshSetSet MeshSet = FEMRoot.GetSet("SimNodesElements")
' Retrieve the mesh parts collectionDim MeshParts As CATIAFmtMeshPartsSet MeshParts = MeshSet.MeshParts
' Add a new Mesh part to the collection of mesh partsDim MeshPart As CATIAFmtMeshPartSet MeshPart = MeshParts.Add("CATFmtTetRulesMesher")...
3.Create a Solid Property
If requested, we then create a Solid property
 ...' Retrieve the property set object SimProperties Dim PropertySet As SimPropertiesSet PropertySet = FEMRoot.GetSet("SimProperties")
' Add a Solid section to the property setDim SolidSection As SimSolidSection
Name The name of the inputTypeThe Type of the inputMand This argument is a boolean. It has to be setted as True if this input is mandatory. False in the other case NlsDescription name of the input
Page 165 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 166 ---

Set SolidSection = PropertySet.Add("SMAMpaSolidProperty")...
4.Retrieve Mesh Part Support
Then we retrieve the mesh part support if it is not given.
For that, we use the SHAPE global variable valuated before script execution.
 ...' Retrieve the shape reference from the global variable SHAPE Dim ShapeRef As VPMRepReferenceSet ShapeRef = SHAPE.ReferenceInstanceOf
' Retrieve the part associated to the shape referenceDim ThePart As PartSet ThePart = ShapeRef.GetItem("Part")
' Retrieve the main body of the partDim PartBody As AnyObjectSet PartBody = ThePart.MainBody...
5.Add support to Mesh part
when the support is explicitely defined, it has to been given directly as argument to the AddSupport method.
Otherwise create the link to add to the mesh part using the composeLink(iOccurence, iShape, iRef) method of te SimComposeLinkServices object.
 ...' Create the reference of the part body for the third argumentDim Ref As ReferenceSet Ref = ThePart.CreateReferenceFromObject(PartBody)
' First argument is not neededDim EmptyOcc As PLMOccurrenceSet EmptyOcc = Nothing
' Retrieve the SimComposeLinkServices and create the link associated to the part bodyDim FEMService As SimComposeLinkServicesSet FEMService = FEM.GetItem("SimComposeLinkServices")Set Link = FEMService.ComposeLink(EmptyOcc, SHAPE, Ref)
' Add link to mesh part MeshPart.AddSupport (Link)
' Add the link to the solid section if requested Dim LinkAccess As SimLinkAccessSet LinkAccess = SolidSection.GetItem("SimLinkAccess")LinkAccess.AddLink "MainSupport", Link...
6. Set Rule to Mesh part
Then set the rule to the mesh part
...MeshPart.SetRule iRule,"CATFmtTetRule"...
Automated FEM User MethodsTechnical Article
Abstract
This article describes how to write a User Method for Automated FEM App.
A user method is a xml file that describes the list of mesh and connection procedures to apply on several subsets of an assembly of products.
It defines a list of assigments applying a mesh or connection procedure on the result of a search (selector) with a set of input values (inputValueSet).
Description of tags and attributes
lmethod
¡id
¡displayName
lselectorSet
¡selector
nid
ntype
nsubType
nstring
ncomparator
lselectionSet
¡selection
nvalueName
npart
nid
noccurrencePath
nfeaturePath
Page 166 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 167 ---

Description of tags and attributes
lmethod
¡id
¡displayName
lselectorSet
¡selector
nid
ntype
linputValueSet
¡inputValue
nid
ninput
nkey
ntype
nsubType
nvalue
lstructuration
¡type
lgenerative
¡value
lassignmentSet
¡assignment
ntype
nid
nsearchDomain
nprocedure
ninputs
Examples of mesh procedure inputs
Example of connection procedure inputs
Example of user method
Mandatory:true
Root tag which defines the method.
Example :
<method DisplayName = "myMethod">
...
</method>
type: string
Mandatory:falseAttribute which defines the internal name of the method.
type: string
Mandatory:trueAttribute which defines the name of the method.
Mandatory:true
Tag which contains the list of searches
Example :
<selectorSet>
<selectorid = "PartFor2D" type = "Attribute" subType = "V_Name" string = "CAE" comparator = "="/>
</selectorSet>
Mandatory:trueTag which represents a query on the database and defines a list of parts on which an assignment is applied.
type: string
Mandatory:trueAttribute which defines the name of the search.
type: string
Mandatory:true
Attribute which defines the type of the search.
Available values:
l"All": Query all the parts under the root product. 
l"Visible": Query all the visible parts or shapes under the root product.
l"Attribute": Query products on a PLM attribute, the attribute is de fined byt the subType attribute. 
¡Required attribute : subType
l"MeshedSupport": Query meshed gometries.
Page 167 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 168 ---

nsubType
nstring
ncomparator
¡selectionSet
nselection
nvalueName
npart
nid
noccurrencePath
nfeaturePath
l"Publication": Query products on the first publication fitting the string according to the comparator. 
¡Required attribute : string
l"Path": (Only for connection procedure) Query products, parts or geometries based on their paths in the product structure. 
¡Required attribute : string
type: string
Mandatory: true if type="Attribute"
If the type is "Attribute" it defines the name of the PLM attribute.
Example : V_NAME
type: string
Mandatory: true if type="Attribute", "Publication" or "Path"
If the type is "Publication" it defines the substring of the publication name.
If the type is "Attribute" it defines the value of the PLM attribute.
If the type is "Path" it defines the search path that products, parts or geometries must comply with. Path in the product structure is built from the titles of product or part instances (the title of product reference in case of root product) and names of geometrical sets or features.
lthe product path to the part or product with "!" separating each object in the path. If the product path is not defined, search is performed on all the parts and products. 
ladding "|" and the geometrical path to the geometrical set or feature with "!" separating each object in the geometrical path. The first object must be a geometrical set. It the fisrt object is not defined, geometricalfeatures are searched in all geometrical sets.
Example :
–Product1!Product2!Part3
–Product1!Part2|GeomSet1!GeomFeat2
–|GeomSet1!GeomFeat2
–|!GeomFeat2
type: string
Mandatory:false
If the type is "Attribute" or "Publication"
Available values:
l"=": The attribute value or the publication name must contain the string attribute 
l"!=": The attribute value or the publication name must not contain the string attribute
Mandatory:false
Tag which contains the list of selections
Example :
<selectionSet>
<selectionvalueName = "PointPlacementSelection"/>
<partid = "1" occurrencePath = "DesignSolution_Body.1!Fasteners.1" featurePath = "Point_Fasteners 1"/>
</selection>
</selectionSet>
Mandatory:falseThis tag is needed in case the type of an input is "Selection".
type: string
Mandatory:trueAttribute which defines the name of the selection.
Mandatory:trueTag which defines an item of the selection.
type: string
Mandatory:trueAttribute which defines the id of the part.
type:string 
Mandatory:true
Attribute which defines the product path to the part or product with "!" separating each object in the path. If the product path is not defined, search is performed on all the parts and products.
Remark: the Root Product is defined by the reference name and the other products and parts by the instance name.
Example : Product1!Product2!Part3
type:string 
Mandatory:
Attribute which defines the geometrical path to the geometrical set or feature with "!" separating each object in the geometrical path. The first object must be a geometrical set. If the first object is not defined, geometrical features are searched in all geometrical sets.
Page 168 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 169 ---

¡inputValueSet
ninputValue
nid
ninput
nkey
ntype
nsubType
nvalue
¡structuration
true Example : GeomSet1!GeomFeat2 or !GeomFeat2
Mandatory:true
Tag which contains the list of inputs.
Example :
<inputValueSet>
<inputValueid = "inputValueSet1">
<inputkey = "SelectionMode" type = "List" subType = "SelectionDefinition" value = "1"/>
<inputkey = "Support" type ="Port" value = "" />
<inputkey = "MeshingRule" type = "DmtDocument" subType = "CATFmtTetRule" value = "3D_Rule"/>
<inputkey = "Property" type = "Boolean" value = "TRUE"/>
</inputValue>
</inputValueSet>
Mandatory:true
Tag which defines a set of parameters needed as input for mesh or connection procedures.
A procedure needs a specific list of inputs (more details in Automated FEM Procedures).
An example of inputs list for some out-of-the-box mesh procedures can be find below in Examples of mesh procedure inputs.
Each input only requires from this specific list the key, the type (eventually thesubType) and thevalue.
There is no need to specify the attributes Mand, Nls, Min, Max, MinExcl, MaxExcl.
The inputs must be written in the same order as given in the mesh procedures.
type: string
Mandatory:trueAttribute which defines the name used by the assignment.
Mandatory:trueTag which defines an input for mesh or connection procedures.
type: string
Mandatory:trueAttribute which defines the name of the input.
type: string
Mandatory:true
Attribute which defines the type of the input.For more information, see the Simulation | Physics Simulation | Model Assembly Design | Automated FEM | About User Procedures section of the User Assistance
type subType valueInteger, Double, String, Boolean - integer, double, string, boolean value
DmtDocumentextension of the dmt document name of the dmtdocument (meshing rule, connection rule, ...) 
List name of the list in the inputs definitioninteger value (starting at 1) giving the position in the list
Enum name of the enum in the inputs definitioninteger value (starting at 1) giving the position in the enum
Dimension kind of dimension (Length, Angle, ...)literal value containing units("10mm")
DimensionRangekind of dimension (Length, Angle, ...)min/max values separated by |("0mm|20mm")
Port - string value giving the name ofpublication
Selection selection type (MonoSelectionSolids, MultiSelectionSolids, MultiSelectionLinePlacement,...)string value giving the name of the selection defined in selectionSet
Search - string value giving the name of the search defined in selectorSet
type:string 
Mandatory:false
Attribute which defines the subtype of the input depending on the type.
Example : SelectionDefinition (List type), Length (Dimension type), ElementOrder (Enum)
type: string
Mandatory:trueAttribute which defines the value of the input depending on the type.
Page 169 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 170 ---

ntype
¡generative
nvalue
¡assignmentSet
nassignment
ntype
nid
nsearchDomain
nprocedure
ninputs
Examples of mesh procedure inputs
Here are some examples of inputs for the out-of-the-box mesh procedures available in Automated FEM.
Mandatory:false
default value:"AOM"Tag which defines the AOM/MOA mode.
type: string
Mandatory:false
Attribute which defines the type of structuration.
Available values:
l"AOM": Create one FEM per part 
l"MOA": Create one FEM containing all the meshes
Mandatory:false
default value:"false"
Tag which defines the storage of connection procedures and results in an automated specification.
The supported connection procedures are: Read From Design procedure with "In current finite element model" as Creation location, and the other procedures with "In current finite element model" as Creation location and applied on "Meshed Supports".
It enables user to relaunch connection procedures according to design and model changes.
type: string
Mandatory:false
Attribute which defines the generative storage.
Available values:
l"true"
l"false"
Mandatory:true
Tag which contains the list of assignments.
Example :
<assignmentSet>
<assignmenttype = "Mesh" id = "1" searchDomain = "PartFor2D" procedure = "GenerateSurfQuadMesh" inputs = "inputValueSet1" />
<assignmenttype = "Mesh" id = "2" searchDomain = "PartFor3D" procedure = "Generate3DMesh" inputs = "inputValueSet2" />
</assignmentSet>
Mandatory:true Tag which defines an assignment. An assignment applies a mesh or connection procedure on the result of a search with a set of input values.
type: string
Mandatory:true
Attribute which defines the type of the assignment.
Available values:
l"Mesh": Applies a mesh procedure 
l"Connection": Applies a connection procedure 
type: string
Mandatory:trueAttribute which defines the id of the assignment.
type:string 
Mandatory:trueAttribute which defines the name of the selector.
type: string
Mandatory:true
Attribute which defines the name of the procedure. This procedure contains the instructions to populate the FEM.
Example for mesh procedure: "Generate3DTetMeshParameters", "Ignore"…
Example for connection procedure: "GeometricalDetection", "GeometricalLineDetection", "GeometricalPointDetection","ImportFromFSR".
type: string
Mandatory:trueAttribute which defines the name of the inputs set.
Mesh procedure UI List of inputs
Page 170 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 171 ---

Remarks:
The input list of subType = "SelectionDefinition" can take 3 integer values:
¡"1": for "MainBody". 
¡"2": for "AllGeometries". 
¡"2": for "VisibleGeometries". 
The input list for key = "ElementOrder" can take 2 integer values:
¡"1": for "Linear".
¡"2": for "Quadratic".
 <inputValueid = "MidSurface_Rule_Based">   <inputkey = "SelectionMode" type = "List" subType = "SelectionDefinition"  <inputkey = "PublicationName" type = "String" value = "To_Mesh"/> <inputkey = "Defeaturing" type = "Boolean" value = "TRUE">   <inputkey = "FilletRadius" type = "DimensionRange" subType = "Length" value   <inputkey = "HoleDiameter" type = "DimensionRange" subType = "Length" value   <inputkey = "ChamferLength" type = "DimensionRange" subType = "Length" value   <inputkey = "DraftAngle" type = "DimensionRange" subType = "Angle" value   <inputkey = "LogoFilter" type = "Boolean" value = "FALSE"/> </input> <inputkey = "MeshDefinition" type = "Enum" subType  = "MeshDefinition"    <inputkey = "MeshingRule" type = "DmtDocument" subType = "CATFmtSurfQuadRule" value   <inputkey = "MeshSize" type = "Dimension" subType = "Length" value   <inputkey = "ElementOrder" type = "Enum" subType = "ElementOrder" value </input> <inputkey = "ShellSection" type = "List" subType = "ThicknessDefinition"    <inputkey = "Specified" type = "Dimension" subType = "Length" value </input>  </inputValue>
 <inputValueid = "SurfTria_Parameters_Based">   <inputkey = "SelectionMode" type = "List" subType = "SelectionDefinition"     <inputkey = "Support" Port = "Boolean" value = "SolidBody"/> </input> <inputkey = "MeshDefinition" type = "Enum" subType  = "MeshDefinition"    <inputkey = "MeshingRule" type = "DmtDocument" subType = "" value   <inputkey = "MeshSize" type = "Dimension" subType = "Length" value   <inputkey = "ElementOrder" type = "Enum" subType = "ElementOrder" value </input> <inputkey = "ShellSection" type = "List" subType = "ThicknessDefinition"    <inputkey = "Specified" type = "Dimension" subType = "Length" value </input> </inputValue>
 <inputValueid = "3DTet_Rule_Based">   <inputkey = "SelectionMode" type = "List" subType = "SelectionDefinition"     <inputkey = "Support" Port = "Boolean" value = ""/> </input> <inputkey = "Defeaturing" type = "Boolean" value = "FALSE">   <inputkey = "FilletRadius" type = "DimensionRange" subType = "Length" value   <inputkey = "HoleDiameter" type = "DimensionRange" subType = "Length" value   <inputkey = "ChamferLength" type = "DimensionRange" subType = "Length" value   <inputkey = "DraftAngle" type = "DimensionRange" subType = "Angle" value   <inputkey = "LogoFilter" type = "Boolean" value = "FALSE"/> </input> <inputkey = "MeshDefinition" type = "Enum" subType  = "MeshDefinition"    <inputkey = "MeshingRule" type = "DmtDocument" subType = "" value   <inputkey = "MeshSize" type = "Dimension" subType = "Length" value   <inputkey = "ElementOrder" type = "Enum" subType = "ElementOrder" value </input> <inputkey = "ShellSection" type = "List" subType = "ThicknessDefinition"    <inputkey = "Specified" type = "Dimension" subType = "Length" value </input> </inputValue>
Page 171 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 172 ---

The input list for key = "ThicknessDefinition" can take 4 integer values:
¡"1": for "No shell section".
¡"2": for "Specified". 
¡"3": for "From thin part feature". 
¡"4": for "From midsurface". 
Example of connection procedure inputs
Here are some examples of inputs for each type of available connection procedures.
¡Geometrical Point Detection
<inputValueid = "UserConnInputs2">   <inputkey = "PointRule" type = "DmtDocument" subType = "SMAFeaPointFastenerRule" value = "PF" revision = "---.000"  />  <inputkey = "PointPlacement" type = "List" subType = "PlacementDefinition" value = "1">  <inputkey = "PointPlacementSearch" type = "Search" value = "UserInputSearch2_1"/>  <inputkey = "PointPlacementSelection" type = "Selection" subType = "MultiSelectionPointPlacement" value = ""/> </input> <inputkey = "Tolerance" type = "Dimension" subType = "Length" value = "15mm"/>  <inputkey = "Prefix" type = "String" value = "PF_"/>  <inputkey = "CreationLocation" type = "List" subType = "" value = "2"/></inputValue><selectorSet>  <selectorid = "UserInputSearch2_1" type = "Attribute" subType = "V_Name" string = "|Point" comparator = "="/></selectorSet>
¡Geometrical Line Detection
<inputValueid = "UserConnInputs3">   <inputkey = "PointRule" type = "DmtDocument" subType = "SMAFeaLineFastenerRule" value = "Seam Weld (NVH)" revision = "---.000"  />  <inputkey = "PlacementMethod" type = "List" subType = "PlacementMethodDefinition" value = "1"/> <inputkey = "LinePlacement" type = "List" subType = "PlacementDefinition" value = "2">  <inputkey = "LinePlacementSearch" type = "Search" value = "UserInputSearch3_1"/>  <inputkey = "LinePlacementSelection" type = "Selection" subType = "MultiSelectionLinePlacement" value = "Selection1_3"/> </input> <inputkey = "Tolerance" type = "Dimension" subType = "Length" value = "10mm"/>  <inputkey = "Prefix" type = "String" value = "LF_"/>  <inputkey = "CreationLocation" type = "List" subType = "" value = "3"/></inputValue><selectionSet>  <selectionvalueName = "Selection1_3">    <partid = "1" occurrencePath = "NDIVehicleReference ---.000!DesignSolution_Body.1!Fasteners.1" featurePath = "Adhesives"/>  </selection></selectionSet>
¡Read From Design
<inputValueid = "UserConnInputs1">   <inputkey = "PointRule" type = "DmtDocument" subType = "SMAFeaPointFastenerRule" value = "PF" revision = "---.000"/>  <inputkey = "Prefix" type = "String" value = "FSR_"/>  <inputkey = "CreationLocation" type = "List" subType = "" value = "1"/>
¡Virtual Bolt Detection
<inputValueid = "UserConnInputs4"> <inputkey = "Geometry" type = "List" value = "1"/>    <inputkey = "PlacementMethod" type = "List" subType = "PlacementMethodDefinition" value = "1">  <inputkey = "PointPlacement" type = "List" subType = "PlacementDefinition" value = "1">   <inputkey = "PointPlacementSearch" type = "Search" value = "UserInputSearch1_1"/>   <inputkey = "PointPlacementSelection" type = "Selection" subType = "MultiSelectionPointPlacement" value = ""/>  </input>  <inputkey = "PointPlacementTolerance" type = "Dimension" subType = "Length" value = ""/>   <inputkey = "LinePlacement" type = "List" subType = "PlacementDefinition" value = "1">   <inputkey = "LinePlacementSearch" type = "Search" value = "UserInputSearch1_2"/>   <inputkey = "LinePlacementSelection" type = "Selection" subType = "MultiSelectionLinePlacement" value = ""/>  </input>  <inputkey = "LinePlacementTolerance" type = "Dimension" subType = "Length" value = ""/> </input> <inputkey = "CircularShape" type = "Boolean" value = "false"/> <inputkey = "Diameter" type = "DimensionRange" subType = "Length" value = "0mm|50mm"/> <inputkey = "Width" type = "DimensionRange" subType = "Length" value = "10mm|60mm"/> <inputkey = "DiameterTolerance" type = "Dimension" subType = "Length" value = "2mm"/> <inputkey = "Length" type = "DimensionRange" subType = "Length" value = "20mm|70mm"/> <inputkey = "MaxOffsetBetweenHoles" type = "Dimension" subType = "Length" value = "5mm"/> <inputkey = "MaxAngleBetweenAxes" type = "Dimension" subType = "Angle" value = "10deg"/> <inputkey = "VirtualBoltRule" type = "DmtDocument" subType = "SMAFeaVirtualBoltRule" value = "SMAFeaVirtualBoltRule" revision <inputkey = "Prefix" type = "String" value = "Test_"/>  <inputkey = "CreationLocation" type = "List" subType = "" value = "4"/></inputValue><selectorSet>  <selectorid = "UserInputSearch1_1" type = "Path" string = "" comparator = "="/>  <selectorid = "UserInputSearch1_2" type = "Path" string = "" comparator = "="/></selectorSet>
Remarks:
The input list of subType = "PlacementDefinition" can take 2 integer values:
n"1": for "PointPlacementSearch" or "LinePlacementSearch". 
n"2": for "PointPlacementSelection" or "LinePlacementSelection". 
The input list for key = "CreationLocation" can take 4 integer values:
n"1": for "One engineering connection for all connection properties". 
n"2": for "One engineering connection per connected parts". 
n"3": for "One engineering connection per connection property". 
n"4": for "In current finite element model". 
Page 172 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 173 ---

The input list of subType = "PlacementMethodDefinition" (for line fasteners) can take 2 integer values:
n"1": for "Line". 
n"2": for "Support boundary". 
The input list of subType = "PlacementMethodDefinition" (for virtual bolts) can take 3 integer values:
n"1": for "Free"; no Placement block is required. 
n"2": for "Point": the first Placement block is required. 
n"3": for "Line": the second Placement block is required. 
Tolerance value is set as maximum projection distance of detected connections, instead of maximum projection distance of connection rule.
Example of user method
Here is an example of a user method containing two mesh assignments and one connection assignment.
<?xml version='1.0' encoding='UTF-8' ?><methoddisplayName = "ODTmethod">  <selectorSet>    <selectorid = "PartFor2D" type = "Attribute" subType = "V_Name" string = "CAE" comparator = "="/>    <selectorid = "PartFor3D" type = "Attribute" subType = "V_Name" string = "NDISeat" comparator = "="/>    <selectorid = "ConnecSupport" type = "MeshedSupport"/>  </selectorSet>
  <selectionSet>    <selectionvalueName = "Selection1_1">      <partid = "1" occurrencePath = "L8D2-5K091-A-PIA-01_51 ---.000!L8D2-5K091-A-PIA-26_12.1" featurePath = "ON_SOLIDS"/>    </selection>  </selectionSet>
  <inputValueSet>    <inputValueid = "inputvalueSet1">      <inputkey = "SelectionMode" type = "List" subType = "SelectionDefinition" value = "1">      <inputkey = "Support" type ="Port" value = "To_Mesh" />      </input>      <inputkey = "MeshDefinition" type = "Enum" subType  = "MeshDefinition" value = "1" >        <inputkey = "MeshingRule" type = "DmtDocument" subType = "CATFmtSurfQuadRule" value = "2D_Quad_Rule"/>        <inputkey = "MeshSize" type = "Dimension" subType = "Length" value = ""/>         <inputkey = "ElementOrder" type = "Enum" subType = "ElementOrder" value = ""/>      </input>      <inputkey = "ShellSection" type = "List" subType = "ThicknessDefinition" value = "3">        <inputkey = "Specified" type = "Dimension" subType = "Length" visible = "2" value = ""/>      </input>    </inputValue>    <inputValueid = "inputvalueSet2">      <inputkey = "SelectionMode" type = "List" subType = "SelectionDefinition" value = "1">      <inputkey = "Support" type ="Port" value = "" />      </input>      <inputkey = "MeshDefinition" type = "Enum" subType  = "MeshDefinition" value = "1" >        <inputkey = "MeshingRule" type = "DmtDocument" subType = "CATFmtTetRule" value = "3D_Rule"/>        <inputkey = "MeshSize" type = "Dimension" subType = "Length" value = ""/>         <inputkey = "ElementOrder" type = "Enum" subType = "ElementOrder" value = ""/>      </input>      <inputkey = "Property" type = "Boolean" value = "TRUE"/>    </inputValue>    <inputValue id = "UserConnInputs1">      <inputkey = "LineRule" type = "DmtDocument" subType = "SMAFeaLineFastenerRule" value = "Seam Weld (NVH)" revision = "---.000"/>      <inputkey = "PlacementMethod" type = "List" subType = "PlacementMethodDefinition" value = "2"/>      <inputkey = "LinePlacement" type = "List" subType = "PlacementDefinition" value = "2">        <inputkey = "LinePlacementSearch" type = "Search" value = "UserInputSearch1_1"/>        <inputkey = "LinePlacementSelection" type = "Selection" subType = "MultiSelectionLinePlacement" value = "Selection1_1"/>      </input>      <inputkey = "Tolerance" type = "Dimension" subType = "Length" value = "10mm"/>      <inputkey = "Prefix" type = "String" value = "DETECTED_"/>      <inputkey = "CreationLocation" type = "List" subType = "" value = "2"/>    </inputValue>  </inputValueSet>
  <structurationtype = "AOM"/>
  <assignmentSet><assignmenttype = "Mesh" id = "1" searchDomain = "PartFor2D" procedure = "GenerateSurfQuadMesh" inputs = "inputvalueSet1"/><assignmenttype = "Mesh" id = "2" searchDomain = "PartFor3D" procedure = "Generate3DMesh" inputs = "inputvalueSet2"/><assignmenttype = "Connection" id = "MyLineConnection" searchDomain = "ConnecSupport" procedure = "GeometricalDetection" inputs  </assignmentSet></method>
 Connection Services 
This article describe how to use available connection services throught the object SimConnectionServices, used to create automatic connections.  It also provides use cases for each method.
Example :
lGiven a SimFemRoot object you can retrieve a SimConnectionServices object as following: 
Dim myFEMRepRootAs SimFemRoot 
...
Dim myConnectionServices As SimConnectionServices
Set myConnectionServices = myFEMRepRoot.GetItem("SimConnectionServices")
Page 173 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 174 ---

 ImportFromFSR
Sub ImportFromFSR (CATBSTR iPrefix) 
Creates points fastener from importing FSR Products.
lParameter :[in] iPrefix : Prefix for the name of all created fastener connections.
Important : The method searches for FSR products on the root product associated to the FEM representation.
Example : For this example, import CAAScdFeaImportFromFSRModel.3DXml.
Important :Make sure to open the model with its FEM Reps before launching the script.
Where to find the macro: CAAScdFeaImportFromFSRSource.htm
This use case is divided in 8 steps.
1.Opens the assembly product 2.Retrieves the active editor 3.Retrieves the root occurrence4.Retrieves the active product 5.Retrieves the rep instance 6.Retrieves the FEM Representation 7.Retrieves the connection services object 
... 
Dim myConnectionService As SimConnectionServicesSet myConnectionService = MyFemRepRoot.GetItem("SimConnectionServices")
...
8.Import point fastener from FSR product  
...
myConnectionService.ImportFromFSR "Test_"
...
 ImportFromXML
SubImportFromXML ( CATBSTR iXMLFilePath, CATBSTR iPrefix)
Creates fastener connections from an XML file import containing all necessary data.
lParameters :[in] iXMLFilePath : Full path of the XML file to import.[in] iPrefix : Prefix for the name of all created fastener connections.
Example : For this example, import CAAScdFeaXMLImportModel.3DXml.
Important :Make sure to open the model with its FEM Reps before launching the script.
You should also copy into the folder pointed by the "TEMP" environment variable the "importTest.xml.txt" file supplied in the same folder as the 3dxml file. The file extension must be changed to "xml" instead of "txt"
Where to find the macro: CAAScdFeaImportFromXMLSource.htm
This use case is divided in 8 steps.
Important : The FEM representation used for each method is the one on which the SimConnectionServices object is retrieved. 
Before you begin :
lLaunch CATIA and then import and open the model corresponding to each method. These files are supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed.Four methods are provided to create fastener connections
1.ImportFromFSR
Creates point fasteners from FSR products. 
2.ImportFromXML
Creates fasteners connections from an XML file import containing all necessary data. 
3.CreatePointsFromSearch
Automatically creates point fasteners.
4.CreateLinesFromSearch
Automatically creates Line fasteners.
Page 174 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 175 ---

1.Opens the assembly product 2.Retrieves the active editor 3.Retrieves the root occurrence4.Retrieves the active product 5.Retrieves the rep instance 6.Retrieves the FEM Representation 7.Retrieves the connection services object 
... 
Dim myConnectionService As SimConnectionServicesSet myConnectionService = MyFemRepRoot.GetItem("SimConnectionServices")
...
8.Import fastener connection From XML file import 
...
Dim sTempPath As StringsTempPath =CATIA.SystemService.Environ("TEMP")
Dim sXMLPath As StringsXMLPath = sTempPath & "/" & "importTest.xml"
myConnectionService.ImportFromXML sXMLPath, "Test_"
...
 CreatePointsFromSearch
SubCreatePointsFromSearch (CATSafeArrayVariant iHandlers, CATBSTR iPrefix, CATVariant iTolerance) 
Automatically creates point fasteners by giving an handlers list containing point.
lParameters :[in] iHandlers : List of points or geometrical set containing the candidates points.[in] iPrefix : Prefix for the name of all created fastener connections.[in] iTolerance : Double value used to limit the projection of the point on the supports.
Important : Points are retrieved on the given iHandlers. The search domain is limited to meshed parts supports (automatically retrieved using the FEM representation).
Example : For this example, import CAAScdFeaFastenerImportModel.3DXml.
Important :Make sure to open the model with its FEM Reps before launching the script.
Where to find the macro: CAAScdFeaCreatePointsFromSearchSource.htm
This use case is divided in 9 steps.
1.Opens the assembly product 2.Retrieves the active editor 3.Retrieves the root occurrence4.Retrieves the active product 5.Retrieves the rep instance 6.Retrieves the FEM Representation and the part 7.Retrieves the connection services object 
... 
Dim myConnectionService As SimConnectionServicesSet myConnectionService = MyFemRepRoot.GetItem("SimConnectionServices")
...
8.Get the geometrical set named : Weld Edges for CAE 
...
Dim hander(0)Set hander(0) = MyPart.FindObjectByName("Weld Edges for CAE")
...
9.Creates point fasteners from search 
...
myConnectionService.CreatePointsFromSearch hander, "Test_", 10.0...
CreateLinesFromSearch
SubCreateLinesFromSearch (CATSafeArrayVariant iHandlers, CATBSTR iPrefix, CATVariant iTolerance) 
Automatically creates line fasteners by giving an handlers list containing lines.
lParameters :[in] iHandlers : List of lines or geometrical set containing the candidates lines.[in] iPrefix : Prefix for the name of all created fastener connections.[in] iTolerance : Double value used to limit the projection of the line on the supports.
Important : Lines are retrieved on the given iHandlers. The search domain is limited to meshed parts supports (automatically retrieved using the FEM representation).
Page 175 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 176 ---

Example : For this example, import CAAScdFeaFastenerImportModel.3DXml.
Important :Make sure to open the model with its FEM Reps before launching the script.
Where to find the macro: CAAScdFeaCreateLinesFromSearchSource.htm
This use case is divided in 9 steps.
1.Opens the assembly product 2.Retrieves the active editor 3.Retrieves the root occurrence4.Retrieves the active product 5.Retrieves the rep instance 6.Retrieves the FEM Representation and the part 7.Retrieves the connection services object 
... 
Dim myConnectionService As SimConnectionServicesSet myConnectionService = MyFemRepRoot.GetItem("SimConnectionServices")
...
8.Get the geometrical set named : Weld Edges for CAE 
...
Dim hander(0)Set hander(0) = MyPart.FindObjectByName("Weld Edges for CAE")
...
9.Creates Line fasteners from search 
...
myConnectionService.CreateLinesFromSearch hander, "Test_", 10.0
...
Use the GetItem method of theSimSpecsRepManager object to retrieve theSimScenarioManager object.
Dim oSimSpecsRepManager  As SimSpecsRepManager...Dim oSimScenarioManager As SimScenarioManagerSet oSimScenarioManager = oSimSpecsRepManager.GetItem("SimScenarioManager")
# Get the simulation editor and the simulation rootmyEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentMySimulationRoot = myEntities.Item(1)
# Retrieve the Scenario Manager myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")
Multiphysics Scenario Creation Object Model MapSee AlsoLegend
VBAPython
Setup ObjectsSee AlsoLegend
Page 176 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 177 ---

Use theFeatures property of the SimAnalysisCase object to retrieve the SimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new setup feature, such as aSimAmplitude object.
Dim oSimAmplitude As SimAmplitudeSet oSimAmplitude = cSimFeatures.Add("SimAmplitude")
...oSimAmplitude = cSimFeatures.Add("SimAmplitude")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
(' ', True)
VBAPython
VBAPython
VBAPython
SimSteps CollectionSee AlsoLegend
(' ', True)
(' ', True)
(' ', True)
Page 177 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 178 ---

Use theSteps property of the SimAnalysisCase object to retrieve the SimSteps collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimSteps As SimStepsSet cSimSteps = oSimAnalysisCase.Steps
...cSimSteps = oSimAnalysisCase.Steps...
Use theFeatures property of the SimAnalysisCase object to retrieve the SimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new initial condition, such as a SimInitialStress object.
Dim oSimInitialStress As SimInitialStressSet oSimInitialStress = cSimFeatures.Add("SimInitialStress")
...
(' ', True)
(' ', True)
(' ', True)
VBAPython
Initial Condition ObjectsSee AlsoLegend
VBAPython
VBAPython
Page 178 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 179 ---

oSimInitialStress = cSimFeatures.Add("SimInitialStress")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimInitialStress object.
Dim oSimInitialStress As SimInitialStress...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimInitialStress.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimInitialStress.GetItem("SimLinkAccess")...
SimGeneralContact and SimSurfaceBasedContact will not be documented here.
Use the Features property of theSimAnalysisCase object to retrieve theSimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new interaction, such as aSimPortRegion object.
Dim oSimPortRegion As SimPortRegionSet oSimPortRegion = cSimFeatures.Add("SimPortRegion")
...oSimPortRegion = cSimFeatures.Add("SimPortRegion")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimPortRegion object.
Dim oSimPortRegion As SimPortRegion...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimPortRegion.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimPortRegion.GetItem("SimLinkAccess")...
VBAPython
VBAPython
Interaction ObjectsSee AlsoLegend
VBAPython
VBAPython
VBAPython
VBAPython
Boundary Condition Objects
Page 179 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 180 ---

Use theFeatures property of the SimAnalysisCase object to retrieve the SimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new boundary condition, such as a SimAppliedRotation object.
Dim oSimAppliedRotation As SimAppliedRotationSet oSimAppliedRotation = cSimFeatures.Add("SimAppliedRotation")
...oSimAppliedRotation = cSimFeatures.Add("SimAppliedRotation")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
See AlsoLegend
VBAPython
VBAPython
VBAPython
Page 180 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 181 ---

Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimAppliedRotation object.
Dim oSimAppliedRotation As SimAppliedRotation...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimAppliedRotation.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimAppliedRotation.GetItem("SimLinkAccess")...
Use theFeatures property of the SimAnalysisCase object to retrieve the SimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
VBAPython
Load ObjectsSee AlsoLegend
VBAPython
Page 181 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 182 ---

...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new boundary condition, such as a SimBearingLoad object.
Dim oSimBearingLoad As SimBearingLoadSet oSimBearingLoad = cSimFeatures.Add("SimBearingLoad")
...oSimBearingLoad = cSimFeatures.Add("SimBearingLoad")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimBearingLoad object.
Dim oSimBearingLoad As SimBearingLoad...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimBearingLoad.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimBearingLoad.GetItem("SimLinkAccess")...
Use theFeatures property of the SimAnalysisCase object to retrieve the SimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new predefined field, such as a SimFieldEvolution object.
Dim oSimFieldEvolution As SimFieldEvolutionSet oSimFieldEvolution = cSimFeatures.Add("SimFieldEvolution")
...oSimFieldEvolution = cSimFeatures.Add("SimFieldEvolution")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
VBAPython
VBAPython
VBAPython
Predefined Field ObjectsSee AlsoLegend
VBAPython
VBAPython
Page 182 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 183 ---

Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
Use the GetItem method to return the SimLinkAccess object from its aggregating object, such as the SimFieldEvolution object.
Dim oSimFieldEvolution As SimFieldEvolution...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimFieldEvolution.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimFieldEvolution.GetItem("SimLinkAccess")...
Use theFeatures property of the SimAnalysisCase object to retrieve the SimFeatures collection.
Dim oSimAnalysisCase  As SimAnalysisCase ...Dim cSimFeatures As SimFeaturesSet cSimFeatures = oSimAnalysisCase.Features
...cSimFeatures = oSimAnalysisCase.Features...
Use the Add method of theSimFeatures collection to create a new output feature, such as a SimOutput object.
Dim oSimOutput As SimOutputSet oSimOutput = cSimFeatures.Add("SimOutput")
...oSimOutput = cSimFeatures.Add("SimOutput")...
Use the TypeName function to determine the type of an object retrieved from the SimFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
Use the GetItem method to return theSimLinkAccess object from its aggregating object, such as theSimOutput object.
Dim oSimOutput As SimOutput...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimOutput.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimOutput.GetItem("SimLinkAccess")...
VBAPython
VBAPython
Output ObjectsSee AlsoLegend
VBAPython
VBAPython
VBAPython
VBAPython
SimLinearLoadCases CollectionSee AlsoLegend
Page 183 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 184 ---

Use the LinearLoadCases property of either the SimHarmonicResponseStep orSimStaticPerturbationStep object to retrieve theSimLinearLoadCases collection.
Dim oSimHarmonicResponseStep As SimHarmonicResponseStep...Dim cSimLinearLoadCases As SimLinearLoadCasesSet cSimLinearLoadCases = oSimHarmonicResponseStep.LinearLoadCases
...cSimLinearLoadCases = oSimHarmonicResponseStep.LinearLoadCases...
VBAPython
Creating and Executing a SimulationThis article explains how to create and execute a simulation.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaStaticSimulationSource.htmThis use case can be divided in 12 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part5.Creating a Property6.Initializing and Creating the Simulation PLM Object7.Retrieving the Scenario Manager8.Associating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Features Set11.Creating features12.Launching the Simulation
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the Publications and Composing Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myCoverContactFace As VPMPublicationSet myCoverContactFace= myPublications.GetItem("Cover_Contact_Face")
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToCoverContactFace As AnyObjectSet myLinkToCoverContactFace = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myCoverContactFace)...
Page 184 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 185 ---

3.Creating the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creating a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creating a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Simulation PLM Object
In this step UC creates a simulation object.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimMechanicalScenarioCreation", "SimStructural"
' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewSimObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieving the Scenario Manager
In this step UC retrieves the scenario manager.
...Dim myScenarioManager As SimScenarioManagerSet myScenarioManager = mySimulationReference.GetItem("SimScenarioManager")...
8.Associating the Structural Analysis Case with the FEM Rep
In this step UC retrieves the analysis case and associates it with the FEM rep.
...Dim myAnalysisCases As SimAnalysisCasesSet myAnalysisCases = myScenarioManager.AnalysisCases
Dim myAnalysisCase As SimAnalysisCaseSet myAnalysisCase = myAnalysisCases.Item(1)
myAnalysisCase.FEMRep = myFEMRoot ...
9.Creating and Initializing the Static Step
In this step UC creates and initializes a static step.
...Dim mySteps As SimStepsSet mySteps = myAnalysisCase.Steps
Dim myStaticStep As SimStaticStepSet myStaticStep = mySteps.Add("SimStaticStep")
myAnalysisCase.CreateDefaultElementTypeAssignmentmyStaticStep.CreateAnalysisDefaultOutputRequestsmyStaticStep.MaximumIncrements = 1000...
10.Retrieving the Features Set
In this step UC retrieves the features set.
...Dim myFeatures As SimFeaturesSet myFeatures = myAnalysisCase.Features
Dim myFeatureStates As SimFeatureStatesSet myFeatureStates = myStaticStep.FeatureStates...
11.Creating features
Page 185 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 186 ---

In this step UC creates features for the simulation.
...Dim myClamp As SimClampSet myClamp = myFeatures.Add("SimClamp")
' Setting feature support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myClamp.GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToClampSupport
' Creating feature state
myFeatureStates.CreateFeatureState myClamp...
12.Launching the Simulation
In this step UC launch the simulation and shows the results.
...Dim myExecutionService As SimExecutionServiceSet myExecutionService = myEditor.GetService("SimExecutionService")
myExecutionService.BasicExecuteAll mySimulationReference
' Switching to the results visualization workbench
CATIA.StartWorkbench "SMAHvcResultsVisualizationWorkbench"...
Initializing and Executing a SimulationThis article explains how to initialize and execute a simulation.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation to test the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaStaticSimulationWithPythonSource.htmThis use case can be divided in 11 steps:
1.Retrieves the simulation and its model2.Retrieves the Publications and Composes Links3.Creates the FEM Rep and retrieves its Rep Manager4.Creates a Mesh on a Part5.Creates a Property6.Retrieves the Scenario Manager7.Associates the Structural Analysis Case with the FEM rep8.Creates and initializes the static step9.Retrieves the features and features states sets10.Creates features11.Launches the simulation
1.Retrieves the simulation and its model
As a first step, the UC retrieves the active simulation and its model. 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Retrieves the Publications and Composes Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications  = myModel.PublicationsmySupport = myPublications.GetItem("Pump_Housing")
# Composing linksmyLinkToSupport = myProdService.ComposeLink(None, None, mySupport)...
As we use publication, we just need to give it as third argument to compose the link
3.Creates the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
Page 186 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 187 ---

4.Creates a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creates a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Retrieves the Scenario Manager
In this step UC retrieves the scenario manager.
...myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")...
7.Associates the Structural Analysis Case with the FEM Rep
In this step UC retrieves the analysis case and associates it with the FEM rep.
...myAnalysisCases = myScenarioManager.AnalysisCasesmyAnalysisCase = myAnalysisCases.Item(1)myAnalysisCase.FEMRep = myFEMRoot ...
8.Creates and Initializes the Static Step
In this step UC creates and initializes a static step.
...mySteps = myAnalysisCase.StepsmyStaticStep = mySteps.Add("SimStaticStep")
myAnalysisCase.CreateDefaultElementTypeAssignment()myStaticStep.CreateAnalysisDefaultOutputRequests()
myStaticStep.MaximumIncrements = 1000...
9.Retrieves the Features Set
In this step UC retrieves the features set.
...myFeatures = myAnalysisCase.FeaturesmyFeatureStates = myStaticStep.FeatureStates...
10.Creates features
In this step UC creates features for the simulation.
...# Creates a Clamp featuremyClamp = myFeatures.Add("SimClamp")myLinkAccess = myClamp.GetItem("SimLinkAccess")myLinkAccess.AddLink ("MainSupport", myLinkToClampSupport)myFeatureStates.CreateFeatureState (myClamp)...
11.Launches the Simulation
In this step UC launch the simulation and shows the results.
...myExecutionService = myEditor.GetService("SimExecutionService")myExecutionService.BasicExecuteAll (MySimulationRoot)...
Creating and Executing a Thermal Structural SimulationThis article explains how to create and execute a thermal structural simulation.
Before you begin: Note that:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaThermalStructuralSimulationSource.htm
Page 187 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 188 ---

This use case can be divided in 15 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part5.Creating a Property6.Initializing and Creating the Simulation PLM Object7.Retrieving the Scenario Manager8.Associating the Thermal and Structural Analysis Cases with the FEM Rep9.Creating and Initializing the Steady State Heat Transfert Step10.Retrieving the Thermal Features Set11.Creating Thermal features12.Creating and Initializing the Static Step13.Retrieving the Structural Features Set14.Creating Structural features15.Launching the Simulation
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the Publications and Composing Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim mySupport As VPMPublicationSet mySupport = myPublications.GetItem("Pump_Housing")
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToSupport As AnyObjectSet myLinkToSupport = myProdService.ComposeLink(myRootOccurrence, myRepInstance, mySupport)...
3.Creating the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager refer to the article Creating FEM representation. 
4.Creating a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mesh parts refer to the article Creating Mesh Part. 
5.Creating a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties refer to the article Managing FEM section features. 
6.Initializing and Creating the Simulation PLM Object
In this step UC creates a simulation object.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimMechanicalScenarioCreation", "SimThermalStructural"
' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewSimObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
Page 188 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 189 ---

For further information about the initialization of a simulation object refer to the article Initializing a Simulation Object. 
7.Retrieving the Scenario Manager
In this step UC retrieves the scenario manager.
...Dim myScenarioManager As SimScenarioManagerSet myScenarioManager = mySimulationReference.GetItem("SimScenarioManager")...
8.Associating the Thermal and Structural Analysis Cases with the FEM Rep
In this step UC retrieves the analysis cases and associates it with the FEM rep.
...Dim myAnalysisCases As SimAnalysisCasesSet myAnalysisCases = myScenarioManager.AnalysisCases
Dim myThermalAnalysisCase As SimAnalysisCaseSet myThermalAnalysisCase = myAnalysisCases.Item(1)
myThermalAnalysisCase.FEMRep = myFEMRoot 
Dim myStructuralAnalysisCase As SimAnalysisCaseSet myStructuralAnalysisCase = myAnalysisCases.Item(2)
myStructuralAnalysisCase.FEMRep = myFEMRoot ...
9.Creating and Initializing the Steady State Heat Transfer Step
In this step UC creates and initializes a steady state heat transfer step.
...Dim myThermalSteps As SimStepsSet myThermalSteps = myThermalAnalysisCase.Steps
Dim mySteadyStateHeatTransferStep As SimSteadyStateHeatTransferStepSet mySteadyStateHeatTransferStep = myThermalSteps.Add("SimSteadyStateHeatTransferStep")
myThermalAnalysisCase.CreateDefaultElementTypeAssignment
mySteadyStateHeatTransferStep.CreateAnalysisDefaultOutputRequestsmySteadyStateHeatTransferStep.TotalTime = 1.0mySteadyStateHeatTransferStep.TimeIncrementationScheme = SimTimeIncrementation_AutomaticmySteadyStateHeatTransferStep.InitialTimeStep = 0.12mySteadyStateHeatTransferStep.MinimumTimeStep = 0.013mySteadyStateHeatTransferStep.MaximumTimeStep = 0.98mySteadyStateHeatTransferStep.MaximumNumberOfIncrements = 60...
10.Retrieving the Thermal Features Set
In this step UC retrieves the thermal features set.
...Dim myThermalFeatures As SimFeaturesSet myThermalFeatures = myThermalAnalysisCase.Features
Dim myThermalFeatureStates As SimFeatureStatesSet myThermalFeatureStates = mySteadyStateHeatTransferStep.FeatureStates...
11.Creating Thermal features
In this step UC creates thermal features for the simulation.
...Dim myTemperature1 As SimTemperatureSet myTemperature1 = myThermalFeatures.Add("SimTemperature")
myTemperature1.UniformMagnitude = 320.0
' Setting feature support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myTemperature1.GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToTemperatureSupport1
' Creating feature state
myThermalFeatureStates.CreateFeatureState myTemperature1...
12.Creating and Initializing the Static Step
In this step UC creates and initializes a static step.
...Dim myStructuralSteps As SimStepsSet myStructuralSteps = myStructuralAnalysisCase.Steps
Dim myStaticStep As SimStaticStepSet myStaticStep = myStructuralSteps.Add("SimStaticStep")
Page 189 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 190 ---

myStructuralAnalysisCase.CreateDefaultElementTypeAssignment
myStaticStep.CreateAnalysisDefaultOutputRequestsmyStaticStep.MaximumIncrements = 1000...
13.Retrieving the Structural Features Set
In this step UC retrieves the thermal features set.
...Dim myStructuralFeatures As SimFeaturesSet myStructuralFeatures = myStructuralAnalysisCase.Features
Dim myStructuralFeatureStates As SimFeatureStatesSet myStructuralFeatureStates = myStaticStep.FeatureStates...
14.Creating Structural features
In this step UC creates features for the simulation.
...Dim myClamp As SimClampSet myClamp = myStructuralFeatures.Add("SimClamp")
' Setting feature support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myClamp.GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToClampSupport
' Creating feature state
myStructuralFeatureStates.CreateFeatureState myClamp...
15.Launching the Simulation
In this step UC launch the simulation and shows the results.
...Dim myExecutionService As SimExecutionServiceSet myExecutionService = myEditor.GetService("SimExecutionService")
myExecutionService.BasicExecuteAll mySimulationReference
' Switching to the results visualization workbench
CATIA.StartWorkbench "SMAHvcResultsVisualizationWorkbench"...
Initializing and Executing a Thermal Structural SimulationThis article explains how to initialize and execute a thermal structural simulation.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a Thermal-structural simulation. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation to test the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access the functionality. 
Where to find the macro: CAAScdFeaThermalStructuralSimulationWithPythonSource.htmThis use case can be divided in 14 steps:
1.Retrieves the simulation and its product2.Retrieves the Publications and Composes Links3.Creates the FEM Rep and retrieves its Rep Manager4.Creates a Mesh on a Part5.Creates a Property6.Retrieves the Scenario Manager7.Associates the Structural Analysis Case with the FEM rep8.Creates and initializes the static step9.Retrieves the thermal features and features states sets10.Creates thermal features11.Creates and initializes the static step12.Retrieves the structural features and features states sets13.Creates features14.Launches the simulation
1.Retrieves the simulation and its model
As a first step, the UC retrieves the active simulation and its model. 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContent
Page 190 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 191 ---

myEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Retrieves the Publications and Composes Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications  = myModel.PublicationsmySupport = myPublications.GetItem("Pump_Housing")
# Composing linksmyLinkToSupport = myProdService.ComposeLink(None, None, mySupport)...
As we use publication, we just need to give it as third argument to compose the link
3.Creates the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creates a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creates a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Retrieves the Scenario Manager
In this step UC retrieves the scenario manager.
...myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")...
7.Associates the Structural Analysis Case with the FEM Rep
In this step UC retrieves the analysis cases and associates them with the FEM rep.
...myAnalysisCases = myScenarioManager.AnalysisCasesmyThermalAnalysisCase = myAnalysisCases.Item(1)myThermalAnalysisCase.FEMRep = myFEMRoot
myStructuralAnalysisCase = myAnalysisCases.Item(2)myStructuralAnalysisCase.FEMRep = myFEMRoot...
8.Creates and initializes the steady state heat transfer step
In this step UC creates and initializes a steady state heat transfer step. 
...myThermalSteps = myThermalAnalysisCase.Steps
mySteadyStateHeatTransferStep = myThermalSteps.Add("SimSteadyStateHeatTransferStep")
myThermalAnalysisCase.CreateDefaultElementTypeAssignment()mySteadyStateHeatTransferStep.CreateAnalysisDefaultOutputRequests()
mySteadyStateHeatTransferStep.TotalTime = 1.0mySteadyStateHeatTransferStep.TimeIncrementationScheme = win32com.client.constants.SimTimeIncrementation_AutomaticmySteadyStateHeatTransferStep.InitialTimeStep = 0.12mySteadyStateHeatTransferStep.MinimumTimeStep = 0.013mySteadyStateHeatTransferStep.MaximumTimeStep = 0.98mySteadyStateHeatTransferStep.MaximumNumberOfIncrements = 60...
9.Retrieves the thermal features and features states sets
In this step UC retrieves the thermal features set.
...myThermalFeatures = myThermalAnalysisCase.FeaturesmyThermalFeatureStates = mySteadyStateHeatTransferStep.FeatureStates...
10.Creates thermal features
In this step UC creates thermal features for the simulation.
...myTemperature1 = myThermalFeatures.Add("SimTemperature")myLinkAccess = myTemperature1.GetItem("SimLinkAccess")myLinkAccess.AddLink ("MainSupport", myLinkToTemperatureSupport1)
Page 191 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 192 ---

myTemperature1.UniformMagnitude = 320.0myThermalFeatureStates.CreateFeatureState (myTemperature1)...
11.Creates and initializes the static step
In this step UC creates and initializes a static step.
...myStructuralSteps  = myStructuralAnalysisCase.StepsmyStaticStep  = myStructuralSteps.Add("SimStaticStep")
myStructuralAnalysisCase.CreateDefaultElementTypeAssignment()myStaticStep.CreateAnalysisDefaultOutputRequests()
myStaticStep.MaximumIncrements = 1000...
12.Retrieves the structural features and features states sets
In this step UC retrieves the thermal features set.
...myStructuralFeatures  = myStructuralAnalysisCase.FeaturesmyStructuralFeatureStates = myStaticStep.FeatureStates...
13.Creates features
In this step UC creates features for the simulation.
...# Creates a Clamp featuremyClamp = myStructuralFeatures.Add("SimClamp")
# Set the feature supportmyLinkAccess = myClamp.GetItem("SimLinkAccess")myLinkAccess.AddLink ("MainSupport", myLinkToClampSupport)
# Create feature statemyStructuralFeatureStates.CreateFeatureState (myClamp)...
14.Launches the simulation
In this step UC launch the simulation and shows the results.
...myExecutionService = myEditor.GetService("SimExecutionService")myExecutionService.BasicExecuteAll (MySimulationRoot)
# Switching to the results visualization workbenchCATIA.StartWorkbench ("SMAHvcResultsVisualizationWorkbench")...
Creating a Contact FeatureThis article explains how to create a contact feature.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaContactsSource.htmThis use case can be divided into six steps:
1.Retrieving the active Product2.Initializing and Creating the Simulation PLM Object3.Retrieving the Features Set4.Creating and Initializing a Contact property feature5.Creating a Surface-based Contact feature6.Creating a General Contact feature
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Initializing and Creating the Simulation PLM Object
Page 192 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 193 ---

In this step UC initializes and creates a simulation PLM object with a static step.
For further information about initializing and creating a simulation PLM object with a static step, refer to the article Creating and Executing a Simulation. 
3.Retrieving the Features Set
In this step UC retrieves the features set.
...Dim myFeatures As SimFeaturesSet myFeatures = myAnalysisCase.Features
Dim myFeatureStates As SimFeatureStatesSet myFeatureStates = myStaticStep.FeatureStates...
4.Creating and Initializing a Contact property feature
In this step UC creates and initializes a Contact property feature.
...' Creating a contact property'----------------------------
Dim mySurfaceBasedContactProperty As SimSurfaceBasedContactPropertySet mySurfaceBasedContactProperty = myFeatures.Add("SimSurfaceBasedContactProperty")
' Adding a tangential behavior'-----------------------------
mySurfaceBasedContactProperty.TangentialBehaviorFlag = TRUE
Dim myTangentialBehavior As SimTangentialBehaviorSet myTangentialBehavior = mySurfaceBasedContactProperty.TangentialBehavior
myTangentialBehavior.FrictionType = SimTangentialBehaviorCoulomb
Dim myFrictionColumn As SimTableColumnSet myFrictionColumn = myTangentialBehavior.GetTableColumn(SimTangentialBehaviorFriction)
myFrictionColumn.SetCellData 1, 0.33myFrictionColumn.SetCellData 2, 0.66
myTangentialBehavior.ContactPressureDependentFlag = TRUE
Dim myContactPressureColumn As SimTableColumnSet myContactPressureColumn = myTangentialBehavior.GetTableColumn(SimTangentialBehaviorContactPressure)
myContactPressureColumn.SetCellData 1, 3myContactPressureColumn.SetCellData 2, 4
' Adding a normal behavior'-------------------------
mySurfaceBasedContactProperty.NormalBehaviorFlag = TRUE
Dim myNormalBehavior As SimNormalBehaviorSet myNormalBehavior = mySurfaceBasedContactProperty.NormalBehavior
myNormalBehavior.PressureOverClosureType = SimNormalBehaviorHard...
5.Creating a Surface-based Contact feature
In this step UC creates and initializes a Surface-based Contact feature.
...' Creating a Surface-based contact feature'------------------------------------------
Dim mySurfaceBasedContact As SimSurfaceBasedContactSet mySurfaceBasedContact = myFeatures.Add("SimSurfaceBasedContact")
myFeatureStates.CreateFeatureState mySurfaceBasedContact
' Setting attributes'-------------------
Dim myMainSurface As SimLinkAccessSet myMainSurface = mySurfaceBasedContact.MainSurfacemyMainSurface.AddLink "MainSupport", myLinkToContactSurface1
Dim mySecondarySurface As SimLinkAccessSet mySecondarySurface = mySurfaceBasedContact.SecondarySurfacemySecondarySurface.AddLink "MainSupport", myLinkToContactSurface2
mySurfaceBasedContact.ContactProperty = mySurfaceBasedContactProperty ...
6.Creating a General Contact feature
In this step UC creates and initializes a General contact feature.
...' Creating a General contact feature'------------------------------------
Dim mySimGeneralContact As SimGeneralContactSet mySimGeneralContact = myFeatures.Add("SimGeneralContact")
Page 193 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 194 ---

myFeatureStates.CreateFeatureState mySimGeneralContact
' Setting attributes'-------------------
mySimGeneralContact.SpecifyExcludedSurfacesFlag = TRUE
Dim mySurfaceExclusions As SimSurfaceExclusionsSet mySurfaceExclusions = mySimGeneralContact.SurfaceExclusions
Dim mySurfaceExclusion As SimSurfaceToSurfacePairSet mySurfaceExclusion = mySurfaceExclusions.Add()
Dim myFirstSurface As SimLinkAccessSet myFirstSurface = mySurfaceExclusion.FirstSurfacemyFirstSurface.AddLink "MainSupport", myLinkToContactSurface1
Dim mySecondSurface As SimLinkAccessSet mySecondSurface = mySurfaceExclusion.SecondSurfacemySecondSurface.AddLink "MainSupport", myLinkToContactSurface2...
Creating a Contact FeatureThis article explains how to create a contact feature.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaPumpModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lLaunch the structural scenario App and create a structural simulation. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaContactsWithPythonSource.htmThis use case can be divided into six steps:
1.Retrieves the simulation and its product 2.Initializes the Simulation PLM Object3.Retrieves the Features Set4.Creates and Initializes a Contact property feature5.Creates a Surface-based Contact feature6.Creates a General Contact feature1.Retrieves the simulation and its product 
As a first step, the UC retrieves the active product. 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)MySimulationRoot = myEntitymyModel = MySimulationRoot.Model...
2.Initializes the Simulation PLM Object
In this step UC initializes and creates a simulation PLM object with a static step.
For further information about initializing and creating a simulation PLM object with a static step, refer to the article Creating and Executing a Simulation. 
3.Retrieves the Features Set
In this step UC retrieves the features set.
...myFeatures = myAnalysisCase.FeaturesmyFeatureStates = myStaticStep.FeatureStates...
4.Creates and Initializes a Contact property feature
In this step UC creates and initializes a Contact property feature.
...# Creating a contact property# ----------------------------mySurfaceBasedContactProperty = myFeatures.Add("SimSurfaceBasedContactProperty")
# Adding a tangential behavior# -----------------------------mySurfaceBasedContactProperty.TangentialBehaviorFlag = TruemyTangentialBehavior = mySurfaceBasedContactProperty.TangentialBehaviormyTangentialBehavior.FrictionType = win32com.client.constants.SimTangentialBehaviorCoulomb
myFrictionColumn = myTangentialBehavior.GetTableColumn(win32com.client.constants.SimTangentialBehaviorFriction)
myFrictionColumn.SetCellData (1, 0.33)myFrictionColumn.SetCellData (2, 0.66)myTangentialBehavior.ContactPressureDependentFlag = TruemyContactPressureColumn = myTangentialBehavior.GetTableColumn(win32com.client.constants.SimTangentialBehaviorContactPressure)myContactPressureColumn.SetCellData (1, 3)myContactPressureColumn.SetCellData (2, 4)
Page 194 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 195 ---

Initializing a Simulation Object
The first step in creating a new simulation is to call theSetSimulationInitialization method ofSimInitializationService.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimMechanicalScenarioCreation", "SimStructural"...
The argument strings into theSetSimulationInitialization method maps to the App and Analysis Case of the Simulation as per the table below.
# Adding a normal behavior# -------------------------mySurfaceBasedContactProperty.NormalBehaviorFlag = True
myNormalBehavior = mySurfaceBasedContactProperty.NormalBehavior
myNormalBehavior.PressureOverlosureType = win32com.client.constants.SimNormalBehaviorHard...
5.Creates a Surface-based Contact feature
In this step UC creates and initializes a Surface-based Contact feature.
...# Creating a Surface-based contact feature# ------------------------------------------mySurfaceBasedContact = myFeatures.Add("SimSurfaceBasedContact")myFeatureStates.CreateFeatureState (mySurfaceBasedContact)
# Setting attributes# -------------------myMainSurface = mySurfaceBasedContact.MainSurfacemyMainSurface.AddLink ("MainSupport", myLinkToContactSurface1)
mySecondarySurface = mySurfaceBasedContact.SecondarySurfacemySecondarySurface.AddLink ("MainSupport", myLinkToContactSurface2)mySurfaceBasedContact.ContactProperty = mySurfaceBasedContactProperty...
6.Creates a General Contact feature
In this step UC creates and initializes a General contact feature.
...# Creating a General contact feature# ------------------------------------mySimGeneralContact = myFeatures.Add("SimGeneralContact")myFeatureStates.CreateFeatureState (mySimGeneralContact)
# Setting attributes# -------------------mySimGeneralContact.SpecifyExcludedSurfacesFlag = True
mySurfaceExclusions = mySimGeneralContact.SurfaceExclusionsmySurfaceExclusion = mySurfaceExclusions.Add()
myFirstSurface = mySurfaceExclusion.FirstSurfacemyFirstSurface.AddLink ("MainSupport", myLinkToContactSurface1)
mySecondSurface = mySurfaceExclusion.SecondSurfacemySecondSurface.AddLink ("MainSupport", myLinkToContactSurface2)...
Initializing a Simulation ObjectTechnical ArticleAbstract
The following reference section documents the required licensing for initializing various types of simulations.
lInitializing a Simulation Object
App AppName ArgumentAnalysis Case TypeName Argument Recommended Roles
SIMULIA Mechanical Scenario CreationSimMechanicalScenarioCreationGeneral SimGeneralSYE - Structural Analysis EngineerSSU - Structural Mechanics Engineer StructuralSimStructuralThermal SimThermalThermalStructuralSimThermalStructural
SIMULIA Structural Scenario CreationSimStructuralScenarioCreationStructuralSimStructuralSFO - Structural Performance EngineerThermal SimThermalThermalStructuralSimThermalStructural
SIMULIA Linear Structural Scenario Creation SimLinearStructuralScenarioCreationStructuralSimStructuralSLL - Structural EngineerThermal SimThermalSIMULIA Linear Structural ValidationSimLinearStructuralValidationStructuralSimStructuralSRD - Structural DesignerThermal SimThermalFrequencySimFrequency
Page 195 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 196 ---

Once the SetSimulationInitialization has been called, a new simulation can be created by calling PLMCreate method of SIMPLMService.
...' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewSimObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
History
Capability Summary
A custom Methodconfigures the Actions, commands, and the Assistant content displayed in the Simulation Status panel. (This is the same Simulation Status panel that is seen in the Simulation for Designers apps.) The Actions in the Simulation Status panel are selectable. Upon the selection of an Action, the Assistant content of the panel updates to show the associated help text (if any) and commands. This makes the Simulation Status panel integral to a custom Method.
Custom Methods incorporate the functionality of the Physics Simulation Scenario Creation apps. All of the commands available within the Scenario Creation apps can be used within a custom Method. (There are limitations on how the commands can be mixed together.)
Buckle SimBuckle
Version: 1 [Dec 2015]Document createdVersion:2 [Apr 2022]Document updated to remove deprecated method
Custom Method OverviewTechnical ArticleAbstract
A custom Method defines a standard process for setting up a simulation for a specific purpose, making the activity easier for non-simulation-centric engineers. Itfacilitates a clutter-free workflow by providing only the commands that are relevant to the simulation being set up.
The Physics Methods Reuse app does not license any simulation functionality. Therefore, for the simulation commands to be available within a custom Method, the corresponding Scenario Creation app must be licensed to the user.
Where Used
Users access the available custom Methods via the Physics Methods Reuse app.
Custom Method Definition
A custom Method is defined via an XML file. The Method file is created/edited via any xml/text editor. There is not a 3DEXPERIENCE app for creating/editing a custom Method. 
Deploying Custom Methods
Deploying custom Methods and configuring the Methods that are available to users is covered in the "Physics Methods Reuse - Administration" section of theInstallation and Administration guide. 
History
In the custom Methods XML schema descriptions, the descriptions of the XML elements contain a "Summary" section and a "Details" section. 
The Summary section uses regular expression notations:
l? The question mark indicates there is zero or one of the attached item. 
l* The asterisk indicates there is zero or more of the attached item. 
l+ The plus sign indicates there is one or more of the attached item. 
The Details section incorporates a few constructs of standard XML schema notation (use [required, optional], minOccurs, maxOccurs, type, etc.). 
History
The custom Method index file is used in deploying custom Methods. Its use is covered in the "Physics Methods Reuse - Administration" section of the Installation andAdministration guide (Installation and Administration | Content and Simulation | Physics Methods Reuse - Administration). 
Version: 1 [Jan 2016]Document created
Schema Documentation ConventionsTechnical Article
Version: 1 [Jan 2016]Document created
Method Index XML SchemaTechnical ArticleAbstract
This article details the schema of the custom Method index file.
Page 196 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 197 ---

Example index file.
Summary
<Index ... >   <Method ... />+</Index>
<Index name? nlsFile? >
<Method name? description? nlsFile? file />
Details
History
A custom Method is defined via an XML file. The Method file is created/edited via any xml/text editor. There is not a 3DEXPERIENCE app for creating/editing acustom Method. 
The custom Method file uses the extension ".xml".
An actual custom Method xsd schema is located in the 3DEXPERIENCE runtime view at
reffiles\SimulationProducts\SMAMpaMethodSchema.xsd
The xsd is not a fully validating schema. It is possible for a custom Method to contain errors that are caught only at runtime. It is strongly encouraged that you validate your custom Method instance document against this schema via a 3rd party tool.
Target Namespace
The custom Method schema is assigned the following target namespace:
urn:com.dassault_systemes.Simulia.2014.SimulationMethod
<Index The document root element.Required. 
   name
type=xs:stringSpecifies the Method-group name that is displayed in the Method selection dialog.The value is first treated as an NLS lookup key. (See nlsFile.) If the NLS lookup fails, the value is used as given. Therefore, it is not necessary to specify an NLS key.Optional - defaults to the name of the index file. (The default value is also used as a NLS key.)
   nlsFile
type=xs:stringThe name/path of the CATNls file for NLS lookups. (Extension omitted.) May include a relative sub-directory path.The location of the CATNls file is relative to the following:
lThe directory of the index file. 
lThe standard "resources/msgcatalog" runtime directory. 
Optional - defaults to the basename of the index file.A CATNls file is not necessary if NLS lookups are not needed.
   <MethodA declaration of a custom Method.minOccurs=1 maxOccurs=unbounded
      name
type=xs:stringSpecifies the Method name that is displayed in the Method selection dialog.The value is first treated as an NLS lookup key. (See nlsFile.) If the NLS lookup fails, the value is used as given. Therefore, it is not necessary to specify an NLS key.Optional - defaults to the basename of the Method file. (The default value is also used as a NLS key.)
      description
type=xs:stringSpecifies a description for the Method that is displayed in the Method selection dialog.The value is first treated as an NLS lookup key. (See nlsFile.) If the NLS lookup fails, the value is used as given. Therefore, it is not necessary to specify a NLS key.Optional - defaults to "<basename of the Method file>.Description". (The default value is used only as an NLS key. If the NLS lookup fails, the description field is left empty.)
      nlsFile
type=xs:stringThe name/path of the CATNls file for NLS lookups. (Extension omitted.) May include a relative sub-directory path.The location of the CATNls file is relative to the following:
lThe directory of the Method file. 
lThe standard "resources/msgcatalog" runtime directory. 
Optional - defaults to the basename of the Method file. Additionally the CATNls file associated with the <Index> element is also used. Therefore, the Method level CATNls entries can be put in the <Index> level CATNls file.A CATNls file is not necessary if NLS lookups are not needed.
      filetype=xs:stringThe path of the corresponding custom Method file. Can be either an absolute or a relative path. A relative path is relative to the path of the index file.Required.
Version: 1 [Jan 2016]Document createdVersion:1.1 [Feb 2016]Added link to example index file.
Custom Method XML SchemaTechnical ArticleAbstract
This article details the schema of the custom Method file.
Page 197 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 198 ---

Because of the targetNamespace declaration, the custom Method instance documents must include a corresponding namespace spec. For example:
<Method xmlns="urn:com.dassault_systemes.Simulia.2014.SimulationMethod"...>
This namespace spec is required. A custom Method that does not contain this namespace spec is not valid.
Limitations:
1.The namespace spec in the custom Method instance documents must be specified as the default namespace. That is, it cannot specify a namespace prefix. Therefore, the namespace spec must exactly match xmlns="urn:com.dassault_systemes.Simulia.2014.SimulationMethod"2.The custom Method instance documents are not validated against the schema. The consequences of this are: 
¡Extraneous XML content is not an error, but rather is quietly ignored. 
nThis means that misspellings are not caught. 
It is strongly encouraged that you validate your custom Method instance document via a 3rd party tool.
Method Element
Summary
<Method ... >   <Assistant>? ... </Assistant>   <EnableAcoustics>? ... </EnableAcoustics>   <Action>+ ... </Action></Method >
<Method schemaVersion? type name? nlsFile? >
Details
type: Conceptually corresponds to the intended analysis of the associated Simulation. 
lStructural- Creates a Structural Analysis Case. 
lThermal- Creates a Thermal Analysis Case. 
Action Element
Conceptually, an <Action> element corresponds to a workflow step. Thus, <Action> elements are used to define a workflow for setting up a Simulation.
Summary
<Action ... >   <Commands>?      <CommandHeader ... >*         <Description> ... </Description>?   </Commands>   <Assistant>? ... </Assistant></Action>
<Action name? nlsFile? type? id >
<CommandHeader headerId name? iconFile? >
<MethodThe document root element. 
schemaVersiontype=xs:decimalSpecifies the custom Method schema version. This comes from the version attribute of the <schema> element of schema document (SMAMpaMethodSchema.xsd).Optional - defaults to 1.0. 
type Enum:[ Structural, Thermal ]See details below.Required. 
name
type=xs:stringSpecifies the name that is shown in the UI. (Displayed at the top of the Action-Assistant panel).The value is first treated as an NLS lookup key. (See nlsFile.) If the NLS lookup fails, the value is used as given. Therefore, it is not necessary to specify an NLS key.Optional - defaults to the basename of the Method file. (The default value is also used as a NLS key.) 
nlsFile
type=xs:stringThe name/path of the CATNls file for NLS lookups. (Extension omitted.) May include a relative sub-directory path. The location of the CATNls file is relative to the following:
lThe directory of the Method file.
lThe standard "resources/msgcatalog" runtime directory.
Optional - defaults to the basename of the Method file. A CATNls file is not necessary if NLS lookups are not needed.
<Assistant>Specifies the Method level content of the Active Assistant. See "Assistant Element".minOccurs=0 maxOccurs=1 
<EnableAcoustics>Specifies that Acoustic option should be enabled for those commands which support acoustic capability. See "EnableAcoustics Element".Note: This capability will only activate if the user has a license to a product which normally enables the acoustic command options. If no license is available a warning will be issued and the acoustic version of the commands will not be enabled.minOccurs=0 maxOccurs=1
<Action>Specifies the Actions for this method. See "Action Element".minOccurs=1 maxOccurs=unbounded
Page 198 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 199 ---

Details
Notes
lEither the type attribute or the <Commands> child must be specified. 
lThe <Action> type attribute specifies a configured Action which contains a built-in list of commands. See "Commands Associated with Configured Action Types" below. The set of commands is not configurable; the built-in set of commands is always shown for a configured Action. 
lThe <Commands> element is used to fully customize the available commands. With the <Commands> element, only the specified commands are provided by theAction. 
lThe value for the <CommandHeader> headerId attribute is the internal 3DEXPERIENCE command header id (or command id). 
See also "Discovering Command Header Identifiers".
lThe only limitation on the commands that may be specified within a custom <Action> is that the command will run in the context of the Simulation being the UI-Active object. Therefore, it should be possible to use any 3DEXPERIENCE command that works correctly in the context of a Simulation. 
Assistant Element
For customizing the help text that appears in the Action-Assistant panel.
Summary
<Assistant ... >   <Elem>*      <Image ... />?      <Text ... />?   </Elem>   <Expander ... >*      <Elem>*         <Image ... />?         <Text ... />?      </Elem>   </Expander></Assistant>
<Assistant >
<Expander title?>
<Action
name
type=xs:stringSpecifies the name that is shown in the UI. (Displayed in the Action-Assistant panel).The value is first treated as an NLS lookup key. (See nlsFile.) If the NLS lookup fails, the value is used as given. Therefore, it is not necessary to specify an NLS key.Optional - defaults to the specifiedtype for this Action. (The default value is also used as a NLS key.) If the type is not specified the name will get set to an internal default. 
nlsFile
type=xs:stringThe name/path of the CATNls file for NLS lookups. (Extension omitted.) May include a relative sub-directory path. The location of the CATNls file is relative to the following:
lThe directory of the Method file.
lThe standard "resources/msgcatalog" runtime directory.
Optional - defaults to the Method's CATNls file. A CATNls file is not necessary if NLS lookups are not needed. 
type
Enum:[ManageMaterials, ManageAmplitudes, ManageFem, StructuralProcedures, ThermalProcedures, StructuralControls, InitialConditions, ThermalInitialConditions, Interactions, ThermalInteractions, StructuralRestraints, StructuralLoads, ThermalConditions, Solve, Results, MeshSetup, MeshCreate, MeshOperate, MeshGroup, ModelManage, ModelProperties, ModelAbstractions, ModelConnections ]Specified to use a pre-configured (canned) Action. See notes below.Conditionally required, mutually exclusive with the <Commands> element. 
id
type=xs:stringProvides a unique id; unique within the custom Method.This id is not visible to the user and is not used outside the context of the custom Method.Cannot be changed after a simulation created with the custom Method is saved.Required.(Note: There is a case in which an id is not required. However, it is best to always specify an id.)
<Commands>Contains the commands to associate with an Action. See notes below.minOccurs=0 maxOccurs=1Conditionally required, mutually exclusive with the <Action> type attribute.
<CommandHeaderSpecifies a command that is associated with the Action.All associated commands are displayed in the Simulation Status panel.minOccurs=1 maxOccurs=unbounded
headerIdtype=xs:stringThe command header id of the desired command. See notes below.Required.
name type=xs:stringThe name (title) to display in the Simulation Status panel for this command. This overrides the command's built-in name.Optional. 
iconFiletype=xs:stringThe file name of the icon to display in the Simulation Status panel for this command. This overrides the command's built-in icon.Note: the icon file must be in the 3DEXPERIENCE runtime view (under resources\graphic).Optional.
<Description>type=xs:stringThe description to display in the Simulation Status panel for this command. This overrides the command's built-in description.minOccurs=0 maxOccurs=1 
<Assistant>Specifies the Action level content of the Active Assistant. See "Assistant Element".minOccurs=0 maxOccurs=1
Page 199 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 200 ---

<Image file width? height? />
<Text> ... <Link url > ... </Link> ... </Text>
Details
Following is an example of using the <Text> and <Link> elements together.
<Text>inline text <Link url="...">hyperlinked text</Link> more inline text.</Text>
EnableAcoustics Element
This element is currently defined to be empty. Its existence specifies that the acoustic option should be enabled for those commands which support acoustic capability. Note: This capability will only activate if the user has a license to a product which normally enables the acoustic command options. If no license is available, a warning will be issued and the acoustic options of the commands will not be enabled.
The following products support acoustic analysis command options as of the R2017x release:
lSLD - Structural Vibration Analyst : Partial Acoustic Support 
lSAS - Noise & Vibration Analyst : Full Acoustic Support 
lSMU - Mechanical Analyst : Full Acoustic Support 
History
Examples in this article:
Structural Method with Configured Actions
Structural Method with Custom Actions
Thermal Method with Configured Actions
Structural Method with Configured Actions
This example is a complete definition of a Method for creating a structural Simulation, where all the Actions are configured Actions.
In this example all the Actions use their built in name.
<?xml version="1.0" encoding="utf-8"?>
<Method  type="Structural"          name="Structural Example"         schemaVersion="1"
<Assistant
<Elem> Specifies an entry in the Action-Assistant panel.An entry is similar to a table row.minOccurs=0 maxOccurs=unbounded
<Image Specifies an icon image to display on the left side of this entry. Use only if an icon is desired.minOccurs=0 maxOccurs=1
   file type=xs:stringThe name of the image file.This is expected to be a plain file name, no path. The file must be in the 3DEXPERIENCE runtime view (under resources\graphic).Required.
   width type=xs:integerSpecifies the desired display width of the icon.If not specified, a default width is used.Optional.
   height type=xs:integerSpecifies the desired display height of the icon.If not specified, a default height is used.Optional. 
<Text> ... </Text>type=xs:stringFree-form textual content. This text does not use NLS lookup. This is straight, free-form, multiline text.minOccurs=0 maxOccurs=1
<Link type=xs:stringCreates an in-line hyperlink. The element's text content is linked to the specified url.minOccurs=0 maxOccurs=unbounded
   url type=xs:stringThe hyperlink target.Required.
<ExpanderContains a group of entries. The group can be expanded/collapsed, as a whole, on the Action-Assistant panel.minOccurs=0 maxOccurs=unbounded
   title type=xs:stringSpecifies the title to display next to the expander widget.Optional
Version: 1 [Jan 2016]Document createdVersion:1.1 [Oct 2016]Changed examples to match XSD tag sequence (Assistant first)
Custom Method ExamplesTechnical ArticleAbstract
This article presents xml examples for custom Methods.
Page 200 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 201 ---

         xmlns="urn:com.dassault_systemes.Simulia.2014.SimulationMethod"         >
  <Assistant>    <Elem>      <Text>This Method creates a structural Simulation.</Text>    </Elem>    <Expander title="More info" >      <Elem>        <Text>Follow the steps above to create the Simulation.</Text>      </Elem>    </Expander>  </Assistant>        
  <Action type="ManageFem"  id="ManageFem"  >    <Assistant>      <Elem>        <Text>Create or assign a FEM Rep to the Simulation.</Text>      </Elem>    </Assistant>  </Action>
  <Action type="ManageMaterials"  id="ManageMaterials" >    <Assistant>      <Elem>        <Text>Apply material if there are unmaterialed Parts.</Text>      </Elem>    </Assistant>  </Action>
  <Action type="InitialConditions"  id="InitialConditions"  />
  <Action type="StructuralProcedures"  id="StructuralProcedures"  >    <Assistant>      <Elem>        <Text>Create the desired procedure.</Text>      </Elem>    </Assistant>  </Action>
  <Action type="ManageAmplitudes"  id="ManageAmplitudes"  />
  <Action type="Interactions"  id="Interactions"  />
  <Action type="StructuralControls"  id="StructuralControls"  />
  <Action type="StructuralRestraints"  id="StructuralRestraints"  >    <Assistant>      <Elem>        <Text>Add restraints.</Text>      </Elem>    </Assistant>  </Action>
  <Action type="StructuralLoads"  id="StructuralLoads" >    <Assistant>      <Elem>        <Text>Add loads.</Text>      </Elem>    </Assistant>  </Action>
  <Action type="Solve"  id="Solve" >    <Assistant>      <Elem>        <Text>Solve the Simulation.</Text>      </Elem>    </Assistant>  </Action>
  <Action type="Results"  id="Results" >    <Assistant>      <Elem>        <Text>Verify that the results are good.</Text>      </Elem>    </Assistant>  </Action>
</Method>
Structural Method with Custom Actions
This example is a complete definition of a Method for creating a structural Simulation, that contains custom Actions for the procedure, restraints, and loads. Also shows usage of the name attribute and the <Description> child of the <CommandHeader> element. 
<?xml version="1.0" encoding="utf-8"?>
<Method  type="Structural"          name="Structural Example"         schemaVersion="1"
         xmlns="urn:com.dassault_systemes.Simulia.2014.SimulationMethod"         >
  <Assistant>    <Elem>      <Text>This Method creates a structural Simulation.</Text>    </Elem>    <Expander title="More info" >      <Elem>        <Text>Follow the steps above to create the Simulation.</Text>      </Elem>    </Expander>  </Assistant>         
Page 201 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 202 ---

  <Action type="ManageFem"  id="ManageFem"  />
  <Action type="ManageMaterials"  id="ManageMaterials" />
  <Action name="Create Procedure" id="CreateProcedure" >    <Assistant>      <Elem>        <Text>Create a Static Stress procedure.</Text>      </Elem>    </Assistant>    <Commands>       <CommandHeader headerId="SMAExsStaticStressHdr" />       <CommandHeader headerId="SMAExsEditCurrentStepHdr" />       <CommandHeader headerId="SMAExsDeleteCurrentStepHdr" />    </Commands>  </Action>
  <Action type="ManageAmplitudes"  id="ManageAmplitudes"  />
  <Action type="InitialConditions"  id="InitialConditions"  />
  <Action type="Interactions"  id="Interactions"  />
  <Action type="StructuralControls"  id="StructuralControls"  />
  <Action name="Apply Restraint" id="ApplyRestraint" >    <Assistant>      <Elem>        <Text>Add restraints</Text>      </Elem>    </Assistant>    <Commands>      <CommandHeader headerId="SMAExsClampHdr" name="Clamp Face" >          <Description>Apply a clamp to the face on the right side.</Description>      </CommandHeader>      <CommandHeader headerId="SMAExsDisplacementRestraintHdr" />    </Commands>  </Action>
  <Action name="Apply Load" id="ApplyLoad" >    <Assistant>      <Elem>        <Text>Add loads</Text>      </Elem>    </Assistant>    <Commands>       <CommandHeader headerId="SMAExsPressureHdr" name="Side Pressure" >           <Description>Apply a pressure to the face on the left side.</Description>       </CommandHeader>       <CommandHeader headerId="SMAExsRemoteForceHdr" />    </Commands>  </Action>
  <Action type="Solve"  id="Solve" />
  <Action type="Results"  id="Results" />
</Method>
Thermal Method with Configured Actions
This example is a complete definition of a Method for creating a thermal Simulation, where all the Actions are configured Actions. 
In this example all the Actions use their built in name.
<?xml version="1.0" encoding="utf-8"?>
<Method  type="Thermal"          name="Thermal Example"         schemaVersion="1"
         xmlns="urn:com.dassault_systemes.Simulia.2014.SimulationMethod"         >
   <Assistant>     <Elem>       <Text>This Method creates a thermal Simulation.</Text>     </Elem>    <Expander title="More info" >      <Elem>        <Text>Follow the steps above to create the Simulation.</Text>      </Elem>    </Expander>   </Assistant>
   <Action type="ManageFem"  />
   <Action type="ManageMaterials"  />
   <Action type="ThermalProcedures"  />
   <Action type="ManageAmplitudes"  />
   <Action type="ThermalInitialConditions"  />
   <Action type="ThermalInteractions"  />
   <Action type="ThermalConditions"  />
   <Action type="Solve"  />
   <Action type="Results"  />
</Method >
Page 202 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 203 ---

History
Command to Run a VB Script
The SMAExsExecuteScriptCmdHdr command can be used to set up a command that executes a VB script.
The only limitation on VB script behavior is that the script will run in the context of the Simulation being the UI-Active object. Therefore, it should be possible to use any VB scripting functionality that works correctly in the context of a Simulation.
The details of the script to run are provided via an additional <ConfigSpec> schema element child of the <CommandHeader> element.
ConfigSpec Element
Provides the configuration information that identifies the script to execute.
Summary
<CommandHeader >   <ConfigSpec ... /></CommandHeader>
<ConfigSpec libraryName libraryRevision? libraryType scriptName functionName? >
Details
The library types are:
Example
  <Action name="Initialize FEM" id="InitFem" >    <Commands>      <CommandHeader headerId="SMAExsExecuteScriptCmdHdr" >        <ConfigSpec  libraryName="vbs 41723085-00000001"                      libraryType="PLM Directory"                       scriptName="InitFem1.CATScript"                       />      </CommandHeader>    </Commands>  </Action>
Additional Scripting Functionality
The ExecuteScript command provides the following functionalities:
lUser input parameters: a script can request user inputs. 
l"let" subroutine: a second script subroutine can be used to 
¡Get the default/initial values for the user inputs.
Version:1 [Feb 2016]Document createdVersion: 1.1 [Oct 2016]Changed examples to match XSD tag sequence (Assistant first)
VB Scripting IntegrationTechnical ArticleAbstract
This article details how to incorporate VB scripting into a custom Method.
<ConfigSpec
   libraryNametype=xs:stringThe name of the 3DEXPERIENCE macro library containing the intended script.This is the library's PLM name (or id) (This is separate from the library's title. The title can be modified, the name cannot.)Required.
   libraryRevisiontype=xs:stringThe desired revision of the PLM library.Optional - needed only if the library has multiple revisions.
   libraryTypeEnum:[ PLM Directory, PLM VBA Project, PLM VSTA Project ]See details below.Required.
   scriptNametype=xs:stringThe name of the intended script. This is the name as displayed within the3DEXPERIENCE Macro Library UI.Required.
   functionNametype=xs:stringThe name of the function to run within the specified script.(The script may be either a function or a subroutine; there is no distinction between the two.)Optional - defaults to "CATMain".
PLM DirectoryA3DEXPERIENCE PLM macro library that contains catvbs or catscript files.The type name displayed within the 3DEXPERIENCE UI could be either "PLM Directory" or "Macro library VB Script".
PLM VBA ProjectA3DEXPERIENCE VBA PLM macro library.The type name displayed within the 3DEXPERIENCE UI could be either "PLM VBA Project" or "Macro library VBA".
PLM VSTA ProjectA3DEXPERIENCE VSTA PLM macro library.The type name displayed within the 3DEXPERIENCE UI could be either "PLM VSTA Project" or "Macro library VSTA".
Page 203 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 204 ---

¡Block the call of the main script. 
lManage features: a script subroutine can return the Simulation preprocessing features it creates.
Script User Input Parameters
Overview
The ExecuteScript command provides a mechanism for a script to request user inputs. In such a case, a dialog is displayed for the user to provide the requested inputs. 
The values that the user enters are provided as arguments to the script subroutine. 
The supported input types are:
lSimple types: integer, double, string, Boolean
lLiterals: length, angle, etc. 
lEnum: a locally defined fixed set of choices. 
lPublication (Port). 
lMeshing rules document. 
lFace, Edge or Node Selection. 
This functionality leverages the user inputs functionality of the Automated Modeling (batch meshing) Procedures. See Automated Modeling User Procedures for details (Content and Simulation Apps | Physics Simulation | Model Assembly Design | Automated Modeling | About User Procedures).
Limitation:The Script User Input Parameters feature does not work with a VSTA project script. The script must be either a PLM Directory script or a VBA Project script.
If Cancel is selected on the dialog, the script execution is aborted.
Details
A script requests user inputs by adding a specific comment header, called a user input specification, to the script:
'<Inputs>'  <Input Name="Input1" Type="Integer" />'  <Input Name="Input2" Type="Double" />'</Inputs>
The displayed dialog will include a field for each input requested. The following table gives the default values for the dialog fields. 
The initial value to use for each field of the dialog can be specified via the secondary 'let' subroutine of the ExecuteScript command.
The script subroutine that is being called specifies an input parameter for each input requested. That is, for the input specification header given above, the script subroutine would be defined as
Sub CATMain( P1, P2 )
(any names can be used for 'P1' and 'P2'.)
User Input Specification Schema
Summary
<Enums>   <Enum ... />*      <Member ... />*   </Enum></Enums>
<Inputs>   <Input ... />*</Inputs>
<Enum Name >
<Member Name Nls >
<Input Name Type SubType? Mand Nls />
Details
Input typeDialog default valueInteger, Double0 (zero)String, Dimension, DmtDocument"" (empty string)Boolean False Port "" (empty string) Enum The first enum entrySelection An empty list
<Enums>Container for <Enum> specifications.Omitted if no <Enum> specifications are given.minOccurs=0 maxOccurs=1
<EnumDefines an enumeration.An enumeration defines a fixed set of choices for the possible values of an input field.minOccurs=0 maxOccurs=unbounded
   Nametype=xs:stringThe internal name of the enumeration.This is the name by which the enumeration is referenced in an <Input> element.
Page 204 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 205 ---

VB API
For the called subroutine, the type of each input parameter is based on the type of the corresponding input request, as given in the following table.
Example
'<Enums>'  <Enum Name="Color">'    <Member Name="red"   Nls="Red"/>'    <Member Name="green" Nls="Green"/>'    <Member Name="blue"  Nls="Blue"/>'   </Enum>'</Enums>
'<Inputs>'  <Input Name="Input01" Type="Integer" Mand="false" Nls="Integer" />'  <Input Name="Input02" Type="Double"  Mand="false" Nls="Double" />'  <Input Name="Input03" Type="String"  Mand="false" Nls="String" />'  <Input Name="Input04" Type="Boolean" Mand="false" Nls="On/Off" />
<MemberDefines a member of an enumeration.minOccurs=0 maxOccurs=unbounded
   Nametype=xs:stringThe internal name of the member.The user does not see this name.Required.
   Nlstype=xs:stringThe name that is displayed to the user.Required.
<Inputs>Container for <Input> specifications.minOccurs=1 maxOccurs=1
<InputSpecifies a desired user input.minOccurs=0 maxOccurs=unbounded
   Nametype=xs:stringThe internal name of this input item.Required.
   Type
enum: [ Integer, Double, String, Boolean, Dimension, Port, Enum, DmtDocument ]The type of the input field.Required.
Dimension, Enum, and DmtDocument must be further qualified by the SubType attribute.
Dimension represents a double value of a particular 3DEXPERIENCE dimension type.
Port is for selecting a Publication. The dialog displays a list of the Publications that are defined on the Simulation's associated Product.
DmtDocument is for selecting a meshing rules document.
Selection is for selecting a 1 or more Nodes, Edges or Faces.
   SubType
type=xs:stringQualifies the Dimension, Enum, and DmtDocument types.Optionally required: Required if Type is Dimension, Enum, or DmtDocument.
For Dimension, the value is a 3DEXPERIENCE dimension name. I.e., Length, Angle.
For Enum, the value is the name of the Enum to reference. (The Enum name is given by the Name attribute of the <Enum> element.)
For the DmtDocument, value is the extension of the meshing rules document (the file extension required for each type of meshing rule). For example: CATFmtOct2dRule, CATFmtOct3dRule, CATFmtSurfTriaRule, CATFmtSurfQuadRule, CATFmtTetRule.
For Selection, value is the type of entities to select:
lMonoSelectionNode - Allow selection of a single node.
lMonoSelectionEdge - Allow selection of a single edge.
lMultiSelectionEdge - Allow selection of multiple edges.
lMonoSelectionFace - Allow selection of a single face.
lMonoSelectionNode - Allow selection of a single node
lMultiSelectionFace - Allow selection of multiple faces.
   Mandtype=xs:booleanIndicates whether the user must enter a value for this input.Optional. Defaults to false.
   Nlstype=xs:stringSpecifies the field name that is displayed on the dialog.Required.
User Input Type VB Parameter TypeInteger IntegerDouble SingleString StringBooleanBooleanDimensionString, containing the numeric value and the associated current UI units (this string may not be the actual value and units that the user entered)Enum Integer, representing the ordinal value of the selected enum (1, 2, etc)
Port VPMPublication (Object)* will be Empty if a Publication is not actually selected on the Inputs dialog.
DmtDocumentString, the document name.* will be an empty string if a document is not actually selected on the Inputs dialog.
SelectionCollection of AnyObjectActual object type in collection changes based on selection of Node, Edge or Face.
Page 205 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 206 ---

'  <Input Name="Input05" Type="Dimension" SubType="Length" Mand="false" Nls="Length" />'  <Input Name="Input06" Type="Enum" SubType="Color" Mand="false" Nls="Enum: Color" />'  <Input Name="Input07" Type="Port" Mand="false" Nls="Publication" />'  <Input Name="Input08" Type="DmtDocument" SubType="CATFmtSurfTriaRule" Mand="false" Nls="Mesh Rule" />'</Inputs>
Sub CATMain( P1, P2, P3, P4, P5, P6, P7, P8 )
  Dim str as String  str = ""  str = str & "Integer = " & P1 & Chr(13)&Chr(10)  str = str & "Double = " & P2 & Chr(13)&Chr(10)  str = str & "String = " & P3 & Chr(13)&Chr(10)  str = str & "Boolean = " & P4 & Chr(13)&Chr(10)  str = str & "Length = " & P5 & Chr(13)&Chr(10)  str = str & "Color = " & P6 & Chr(13)&Chr(10)
  Dim FeatureName As String  FeatureName = "<Nada>"  Dim P7Type As String  P7Type = TypeName(P7)  If Not IsEmpty(P7) Then    If Not P7 Is Nothing Then       FeatureName = P7.Name    End If  End If
  str = str & "Port = " & FeatureName & Chr(13) & Chr(10)
  str = str & "Mesh Rule = " & P8 & Chr(13)&Chr(10)
  MSGBOX strEnd Sub
Let Subroutine
The ExecuteScript command supports a second subroutine that provides an opportunity to:
lblock the call of the main script subroutine, or 
lprovide default/initial values for the user inputs dialog. 
This subroutine is referred to as a "let" subroutine. As implied, this subroutine is called before the main subroutine (CATMain) is called.
Limitation:The let subroutine feature does not work with scripts in a PLM Directory library.
Let Subroutine Schema
The let subroutine is specified within the ExecuteScript command's associated <ConfigSpec> element, via the following schema:
Summary
<ConfigSpec letSub? >
Details
Note: The ExecuteScript command has only a single <ConfigSpec> element.
VB API
The let subroutine has the following prototype:
Sub LetFunction( ilFeatures(), olParams(), obBlockCall )
Where
param ilFeatures [in]
The list of features previously created by the main script subroutine (e.g. CATMain).
This is the list of features returned by the main subroutine on the last invocation.
If the "manageFeatures" option (described below) is not being used, this parameter will be a zero-length array.
param olParams [in/out]
List of default/initial values to use on the user inputs dialog.
Set the values as desired. 
The content of the array is based on the User Inputs Specification at the top of the script module.
The values are initialized with the internal default for each input type.
For Port values, the returned value can be either an actual VPMPublication object or a Publication name. In the case of a Publication name, the name will be resolved to the corresponding VPMPublication object for input to the main script subroutine.
param oBlockCall [out]
<ConfigSpec
   letSubtype=xs:stringThe name of the "let" subroutine. (Similar to the functionName attribute.)The let subroutine is in the same script as the main subroutine.Optional. 
Page 206 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 207 ---

Integer value passed back by this script that indicates whether to not call the main script subroutine.
0: do not block; run the main subroutine.
1: Do not run the main subroutine.
Otherwise: Do not run the main subroutine, and display an info message.
Example
Assume the following User Input Specification:
'<Enums>'  <Enum Name="Color">'    <Member Name="red"   Nls="Red"/>'    <Member Name="green" Nls="Green"/>'    <Member Name="blue"  Nls="Blue"/>'   </Enum>'</Enums>
'<Inputs>'  <Input Name="Input01" Type="Integer" Mand="false" Nls="Integer" />'  <Input Name="Input02" Type="Double"  Mand="false" Nls="Double" />'  <Input Name="Input03" Type="String"  Mand="false" Nls="String" />'  <Input Name="Input04" Type="Boolean" Mand="false" Nls="On/Off" />'  <Input Name="Input05" Type="Dimension" SubType="Length" Mand="false" Nls="Length" />'  <Input Name="Input06" Type="Enum" SubType="Color" Mand="false" Nls="Enum: Color" />'  <Input Name="Input07" Type="Port" Mand="false" Nls="Publication" />'  <Input Name="Input08" Type="DmtDocument" SubType="CATFmtSurfTriaRule" Mand="false" Nls="Mesh Rule" />'</Inputs>
Sub CATMain( P1, P2, P3, P4, P5, P6, P7, P8 )   ...End Sub
The let subroutine is defined as follows, in the same script files as CATMain:
Sub LetFunction1( ilFeatures(), olParams(), oBlockCall )
  olParams(0) = 123  olParams(1) = 234  olParams(2) = "This is it."  olParams(3) = True  olParams(4) = "456mm"  olParams(5) = 3         'corresponds to Color Blue.  olParams(6) = "Clamp"   'The name of the desired Publication.  olParams(7) = "ThisOne" 'The name of the rule document.
End Sub
Following is the setup of the ExecuteScript command:
  <Action name="Initialize FEM" id="InitFem" >    <Commands>      <CommandHeader headerId="SMAExsExecuteScriptCmdHdr" >        <ConfigSpec  libraryName="vbs 41723085-00000001"                      libraryType="PLM Directory"                       scriptName="InitFem1.CATScript"                     letSub="LetFunction1"                       />      </CommandHeader>    </Commands>  </Action>
Manage Features
The ExecuteScript command supports an option to enable the script to return the Simulation preprocessing features that the script creates. This is called the "manage features" option.
This list of features is provided as input to the secondary 'let' subroutine described above.
Manage Features Schema
The "manage features" option is specified within the ExecuteScript command's associated <ConfigSpec> element, via the following schema:
Summary
<ConfigSpec manageFeatures? >
Details
Note: The ExecuteScript command has only a single <ConfigSpec> element.
VB API
If the "manage features" option is specified, the main script subroutine must include an array input/output parameter. For example:
Sub CATMain( iolFeatures() )
<ConfigSpec
   manageFeaturestype=xs:booleanIndicates whether the "manageFeatures" option is active for the main subroutine (e.g. CATMain).Optional. Defaults to false.
Page 207 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 208 ---

If the "manage features" option is used along with the User Input Specification, the features array is the last parameter of the subroutine. For example:
Sub CATMain( P1, P2, iolFeatures() )
On the first call of the main subroutine, the passed in argument is a zero-length array. To return the created features, first the array size must be set, as in:
ReDim iolFeatures(d)
where "d" specifies the size of the array (see the ReDim command).
Example
Assume the following User Input Specification:
'<Inputs>'  <Input Name="Input01" Type="Integer" Mand="false" Nls="Integer" />'  <Input Name="Input02" Type="Double"  Mand="false" Nls="Double" />'</Inputs>
The main subroutine is defined as follows:
Sub CATMain( P1, P2, iolFeatures() )   ...
  ReDim iolFeatures(0)  Set iolFeatures(0) = myFeature1
End Sub
Following is the setup of the ExecuteScript command:
  <Action name="Initialize FEM" id="InitFem" >    <Commands>      <CommandHeader headerId="SMAExsExecuteScriptCmdHdr" >        <ConfigSpec  libraryName="vbs 41723085-00000001"                      libraryType="PLM Directory"                       scriptName="InitFem1.CATScript"                     manageFeatures="true"                       />      </CommandHeader>    </Commands>  </Action>
History
The following table lists the commands that are provided by each of the configured Action types. These commands can be specified within custom <Action>s.
A description of each command is given in addendum "Description of Simulation Commands".
Version: 1 [Jan 2016]Document createdVersion:1.1 [Feb 2016]Added examplesVersion: 1.2 [Jul 2016]Added selection keywords to input options
Commands Associated with Configured Action TypesTechnical ArticleAbstract
This article details the commands associated with configured Action types.
Limitation:A custom <Action> should contain commands from only a single configured Action type. Commands from different Action types should not be included together.Exception:The commands of the Action types marked with an asterisk (*) may be included together.
Action Type CommandHeaders
ManageFem SMAExsSelectFemCmdHdrSMAExsNewFemCmdHdrSMAExsSwitchToModelerHdr SMAExsElementTypeAssignmentHdr
ManageMaterials
SMAFeaAssignMaterialCmdHdrSMAFeaCreateMaterialCmdHdrSMAFeaEditAppliedMatCmdHdrSMAFeaPickerMatCmdHdrSMAFeaDeleteAppliedMatCmdHdr
Interactions
Applicability:Structural Analysis Case
SMAExsContactSearchHdr SMAExsContactPairHdrSMAExsGeneralContactHdr SMAExsContactPropertyHdrSMAExsContactInitializationHdr SMAExsContactInterferenceHdrSMAExsContactControlsHdr SMAExsDisconnectedPartsHdrSMAExsTouchContactHdrSMAExsIntersectContactHdrSMAExsChangeFrictionHdr
ThermalInteractions SMAExsThermalContactSearchHdrSMAExsThermalContactPairHdrSMAExsThermalContactPropertyHdr
Page 208 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 209 ---

Applicability:Thermal Analysis Case SMAExsTouchContactHdrSMAExsIntersectContactHdr
StructuralProcedures
Applicability:Structural Analysis Case
SMAExsEditCurrentStepHdrSMAExsDeleteCurrentStepHdr SMAExsStaticStressHdrSMAExsViscoStressHdrSMAExsImplicitDynamicStressHdrSMAExsExplicitDynamicStressHdrSMAExsStaticStressPerturbationHdrSMAExsFrequencyHdrSMAExsComplexFrequencyHdrSMAExsHarmonicResponseHdrSMAExsBuckleHdrSMAExsModalDynamicHdrThermalProcedures
Applicability:Thermal Analysis Case
SMAExsEditCurrentStepHdrSMAExsDeleteCurrentStepHdrSMAExsSteadyStateHeatTransferHdrSMAExsTransientHeatTransferHdr
ManageAmplitudes * SMAExsTabularAmplitudeHdrSMAExsSmoothStepAmplitudeHdrSMAExsPeriodicAmplitudeHdrInitialConditions *
Applicability:Structural Analysis Case
SMAExsInitialTemperatureHdrSMAExsInitialTranslationalVelocityHdrSMAExsInitialRotationalVelocityHdrSMAExsVoidRatioHdrStructuralControls *
Applicability:ExplicityDynamicStress, HarmonicResponse,ModalDynamic Procedures
SMAExsMassScalingHdrSMAExsDampingHdr
StructuralRestraints *
Applicability:Structural Analysis Case
SMAExsClampHdrSMAExsDisplacementRestraintHdr SMAExsPlanarSymmetryHdrSMAExsBoltRestraintHdr SMAExsBallJointHdr SMAExsSliderHdrSMAExsHingeHdrSMAExsConnectorDisplacementRestraintHdr
StructuralLoads *
Applicability:Structural Analysis Case
SMAExsPressureHdr SMAExsBearingLoadHdrSMAExsCavityPressureHdr SMAExsForceHdr SMAExsImportedForceHdrSMAExsRemoteForceHdr SMAExsTorqueHdr SMAExsRemoteTorqueHdrSMAExsGravityHdr SMAExsInertiaReliefHdr SMAExsBoltLoadHdrSMAExsBoltTorqueHdrSMAExsPrescribedBoltDisplacementHdrSMAExsAppliedTranslationHdrSMAExsAppliedRotationHdrSMAExsAppliedTranslationalVelocityHdrSMAExsAppliedRotationalVelocityHdrSMAExsAppliedTranslationalAccelerationHdrSMAExsAppliedRotationalAccelerationHdrSMAExsPrescribedTemperatureHdrSMAExsLoadSetHdr SMAExsLoadCaseHdrSMAExsCentrifugalForceHdrSMAExsRotaryAccelerationLoadHdrSMAExsDisplacementBaseMotionHdrSMAExsVelocityBaseMotionHdrSMAExsAccelerationBaseMotionHdrSMAExsConnectorForceHdrSMAExsConnectorMomentHdrSMAExsConnectorRelativeDisplacementHdrSMAExsConnectorRelativeRotationHdrSMAExsSlidingVelocityHdr ThermalInitialConditions *
Applicability:Thermal Analysis Case SMAExsInitialTemperatureHdr
ThermalConditions *
Applicability:Thermal Analysis Case
SMAExsTemperatureHdr SMAExsHeatFluxHdrSMAExsFilmConditionHdrSMAExsVolumetricHeatSourceHdrSMAExsRadiationAmbientHdrSMAExsRadiationCavityApproxHdr
Solve
SMAExsFieldOutputRequestHdrSMAExsSimulateHdr †
† As of R2016x, this command is no longer used in the Physics Simulation Scenario Creation apps. Usage of thiscommand is not support on cloud and is deprecated.As of R2016x FD03 maintenance release, use the following expert Scenario Createion app commands:SMAExsSimulationExecutionModelChecksCmdHdrSMAExsSimulationExecutionSolverChecksCmdHdrSMAExsSimulationExecutionFullSolveCmdHdr
Page 209 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 210 ---

Results
SMAHvcResultsVisualizationHdrSMAHvcCreateContourPlotHdr SMAHvcCreateSymbolPlotHdrSMAHvcCreateIsocontourPlotHdr SMAHvcCreateColorCodePlotHdrSMAHvcCreateHistoryPlotHdr SMAHvcImportHistoryCurveHdrSMAHvcCreateXYFromPathPlotHdr SMAHvcCreateSensorHdrSMAHvcCreateResultantSensorHdr SMAHvcCreateFrequencySensorHdrSMAHvcCreateBuckleModeSensorHdr SMAHvcStreamHdrSMAHvcDisplayGroupInitializeHdr SMAHvcCreateReportHdrSMAHvcCreateEnvelopeHdr SMAHvcCreateUserCsysHdrSMAHvcCreatePathPlotHdr SMAHvcPlayAnimationHdrSMAHvcCreatePlyStackPlotHdr SMAHvcExtremaToolbarHdrSMAHvcCutToolbarGPAHdr SMAHvcMultiVPFourSquareHdrSMAHvcMultiVPTriLeftHdr SMAHvcMultiVPTriBottomHdrSMAHvcMultiVPTwoRowHdr SMAHvcMultiVPTwoColumnHdrSMAHvcMultiVPOffHdr SMAHvcMultiVPSettingsHdrSMAHvcGlobalOptionsHdr SMAHvcRenderingSettingsHdr
MeshSetup CATFmtNewMeshingRulesEditorHdrAliasCATFmtFEMRepNumberingHdrAlias CATFmtNumberingManagerHdrAliasCATFmtNumberingVisuHdrAlias
MeshCreate
CATFmtMeshPartManagerHdrAliasCATFmtBeamHdrAlias CATFmtSurfaceTriaRulesMesherHdrAliasCATFmtOctree2DHdrAlias CATFmtSurfaceQuadRulesMesherHdrAliasCATFmt3DRulesMesherHdrAlias CATFmtOctree3DHdrAliasCATFmtGHS3DHdrAlias CATFmtVIDSweep3DMesherHdrAliasCATFmtHexMesherHdrAlias CATFmtCoating1DMesherHdrAliasCATFmtCoating2DMesherHdrAlias CATFmtHoleFillerMesherHdrAliasCATFmtPolyhedralMesherHdrAlias
MeshOperate
CATFmtTranslationHdrAliasCATFmtRotationHdrAlias CATFmtSymmetryHdrAliasCATFmtOffsetHdrAlias CATFmtAxisToAxisHdrAliasCATFmtExtrTranslationHdrAlias CATFmtExtrRotationHdrAliasCATFmtExtrSymmetryHdrAlias CATFmtExtrSpineHdrAliasCATFmtExtrOffsetMesherHdrAlias CATFmtInflationMesherHdrAliasCATFmtMeshingEditionToolsHdrAlias
MeshGroup
CATFmtGroupManagerHdrAliasCATFmtGroupByAssociativityHdrAlias CATFmtGroupByProximityHdrAliasCATFmtGroupSpatialHdrAlias CATFmtGroupByBoundaryHdrAliasCATFmtGroupByManualSelectionHdrAlias CATFmtGroupUnionHdrAliasCATFmtGroupIntersectionHdrAlias CATFmtGroupDifferenceHdrAlias
ModelManage CATFmtContributingPartsHdrAliasCATFmtContributingFemsHdrAlias SMAExsUpdateFEMHdrAliasSMAExsShipStructuresHdrAlias
ModelProperties
SMAExsSolidSectionHdrAliasSMAExsShellSectionHdrAlias SMAExsContinuumShellSectionHdrAliasSMAExsCompositeShellSectionHdrAliasSMAExsCompositeContinuumShellSectionHdrAliasSMAExsMembraneSectionHdrAlias SMAExsBeamSectionHdrAliasSMAExsBeamProfileHdrAlias SMAExsTrussSectionHdrAliasSMAExsSPHSectionHdrAlias SMAExsGasketSectionHdrAliasSMAExsPretensionSectionHdrAliasSMAExsRigidBodyConstraintPropertyHdrAliasSMAExsAnalyticalSurfacePropertyHdrAliasSMAExsMassRotaryInertiaPropertyHdrAliasSMAExsRemoteMassRotaryInertiaPropertyHdrAlias
Page 210 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 211 ---

Description of Commands
The following table provides a description of each of the commands given above. Caution: If copying the command header ids, be sure to remove the hyphens. The actual header ids do not contain any hyphen.
ModelAbstractions SMAExsMassPerVolumeHdrAlias SMAExsMassPerAreaHdrAliasSMAExsMassPerLengthHdrAlias SMAExsCyclicSymmetryHdrAlias
ModelConnections
SMAExsConnectionManagerHdrAliasSMAExsConnectionCheckerHdrAlias SMAExsVirtualBoltHdrAliasSMAExsBoltReplicationHdrAlias SMAExsVirtualPartHdrAliasSMAExsSpringHdrAlias SMAExsTieDetectionHdrAliasSMAExsTieHdrAlias SMAExsSpotWeldHdrAliasSMAExsPointFastenerOverrideHdrAlias SMAExsSeamWeldHdrAliasSMAExsLineFastenerOverrideHdrAlias SMAExsImportFastenerHdrAliasSMAExsGeneralConnectionHdrAlias SMAExsRigidConnectionHdrAliasSMAExsVirtualPinHdrAlias SMAExsDisconnectedPartsHdrAliasSMAExsTouchContactHdrAlias SMAExsIntersectContactHdrAlias
CommandHeader Id DescriptionFEMSMAExsSelectFemCmdHdrProvides to select an existing FEM Rep for an Analysis Case.SMAExsNewFemCmdHdrCreates a FEM Rep for an Analysis Case.
SMAExsSwitchToModelerHdrSwitches to the Modeling app.
SMAExsElementTypeAssignmentHdrCreates a local ElementTypeAssignment feature.
MaterialSMAFeaAssignMaterialCmdHdrAssign a material via PLM search.SMAFeaCreateMaterialCmdHdrCreates a new material.SMAFeaEditAppliedMatCmdHdrEdits the simulation properties of a material.SMAFeaPickerMatCmdHdrAssign a material via picking an already in-context material.SMAFeaDeleteAppliedMatCmdHdrUnassigns a material.
ContactSMAExsContactSearchHdrIdentifies contacting surfaces and creates structural surface-based contact between them.SMAExsContactPairHdrCreates a structural surface-based contact pair.SMAExsGeneralContactHdr Specifies general contact behavior between all components in a model.SMAExsContactPropertyHdr Specifies the structural behavior of contacting surfaces for a structural surface-based contact pair.SMAExsContactInitializationHdrAdjusts general contact surfaces to improve the solution.SMAExsContactInterferenceHdr Controls handling of over-closed surfaces.SMAExsContactControlsHdr Defines optional controls for surface-based contact.
SMAExsDisconnectedPartsHdrHighlights Parts that do not have any connections.SMAExsTouchContactHdr Highlights regions in a model where Parts come into contact.SMAExsIntersectContactHdrHighlights regions in a model where Parts intersect.SMAExsChangeFrictionHdrChange the values of friction properties from step to step.
SMAExsThermalContactSearchHdrIdentifies contacting surfaces and creates thermal surface-based contact between them.SMAExsThermalContactPairHdr Creates a thermal surface-based contact pair.SMAExsThermalContactPropertyHdr Specifies the thermal behavior of contacting surfaces for a thermal surface-based contact pair.
StepsSMAExsStaticStressHdrCreates a static stress analysis procedure.SMAExsViscoStressHdr Creates a quasi-static stress analysis procedure.SMAExsImplicitDynamicStressHdrCreates an implicit-dynamic analysis procedure.SMAExsExplicitDynamicStressHdrCreates an explicit-dynamic analysis procedure.SMAExsStaticStressPerturbationHdrCreates a linear perturbation static stress analysis procedure.SMAExsFrequencyHdr Creates a frequency extraction analysis procedure.SMAExsComplexFrequencyHdr Creates a complex frequency extraction analysis procedure.SMAExsHarmonicResponseHdr Creates a harmonic response analysis procedure.SMAExsBuckleHdr Creates a buckling analysis procedure.SMAExsModalDynamicHdrCreates a modal dynamic analysis procedure.
SMAExsSteadyStateHeatTransferHdrCreates a steady-state heat transfer analysis procedure.SMAExsTransientHeatTransferHdrCreates a transient heat transfer analysis procedure.
SMAExsEditCurrentStepHdrEdits the current procedure.
Page 211 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 212 ---

SMAExsDeleteCurrentStepHdr Deletes the current procedure.
AmplitudesSMAExsTabularAmplitudeHdrCreates an amplitude curve that is defined by a table of values.SMAExsSmoothStepAmplitudeHdr Creates an amplitude curve that is defined by smoothly varying curve.SMAExsPeriodicAmplitudeHdrCreates an amplitude curve that is defined by a Fourier series.
Initial ConditionsSMAExsInitialTemperatureHdrCreates an initial temperature.SMAExsInitial-TranslationalVelocityHdrCreates an initial translational velocity.SMAExsInitial-RotationalVelocityHdrCreates an initial rotational velocity.SMAExsVoidRatioHdr Initial void ratio value for a coupled pore fluid diffusion/stress simulation.
SMAExsMassScalingHdrCreates a mass scaling.SMAExsDampingHdr Creates a damping source.
Boundary ConditionsSMAExsClampHdr Creates a clamp.SMAExsDisplacementRestraintHdrCreates a displacement restraint.SMAExsPlanarSymmetryHdr Creates a planar symmetry restraint.SMAExsBoltRestraintHdrCreates a bolt restraint.SMAExsBallJointHdr Creates a balljoint restraint.SMAExsSliderHdr Creates a slider restraint.SMAExsHingeHdr Creates a hinge restraint.SMAExsCavityPressureHdr Creates a cavity pressure.SMAExsConnector-DisplacementRestraintHdrCreates a connector displacement restraint.
LoadsSMAExsPressureHdr Creates a pressure load.SMAExsBearingLoadHdrCreates a bearing load.SMAExsForceHdr Creates a force load.SMAExsImportedForceHdrCreates an imported force load.SMAExsRemoteForceHdr Creates a remote force load.SMAExsTorqueHdr Creates a torque load.SMAExsRemoteTorqueHdr Creates a remote torque load.SMAExsGravityHdr Creates a gravity load.SMAExsInertiaReliefHdr Creates an inertia relief load.SMAExsBoltLoadHdr Creates a bolt force load.SMAExsBoltTorqueHdr Creates a bolt torque load.SMAExsPrescribed-BoltDisplacementHdrCreates a bolt displacement load.SMAExsAppliedTranslationHdr Creates an applied translation load.SMAExsAppliedRotationHdrCreates an applied rotation load.SMAExsApplied-TranslationalVelocityHdrCreates an applied translational velocity load.SMAExsApplied-RotationalVelocityHdrCreates an applied rotational velocity load.SMAExsApplied-TranslationalAccelerationHdrCreates an applied translational acceleration load.SMAExsApplied-RotationalAccelerationHdrCreates an applied rotational acceleration load.SMAExsPrescribedTemperatureHdr Creates a prescribed temperature.SMAExsLoadSetHdr Creates a load set.SMAExsLoadCaseHdr Creates a load case.SMAExsCentrifugalForceHdr Creates a centrifugal force load.SMAExsRotaryAccelerationLoadHdrCreates a rotary acceleration load.SMAExsDisplacementBaseMotionHdr Creates a displacement motion load.SMAExsVelocityBaseMotionHdrCreates a velocity motion load.SMAExsAccelerationBaseMotionHdr Creates an acceleration motion load.SMAExsConnectorForceHdrCreates a connector force load.SMAExsConnectorMomentHdr Creates a connector moment load.SMAExsConnector-RelativeDisplacementHdrCreates a connector displacement load.SMAExsConnectorRelativeRotationHdrCreates a connector rotation load.SMAExsSlidingVelocityHdrPrescribes either a translational velocity along an axis or a rotational velocity about an axis.
ThermalSMAExsTemperatureHdrCreates a temperature condition.SMAExsHeatFluxHdr Creates a heat flux condition.SMAExsFilmConditionHdr Creates a film condition.SMAExsVolumetricHeatSourceHdr Creates a volumetric heat source condition.SMAExsRadiationAmbientHdr Creates an ambient radiation condition.SMAExsRadiationCavityApproxHdrCreates a cavity radiation condition.
SMAExsBodyforceHdr Creates a translational load on a body.
Output RequestsSMAExsFieldOutputRequestHdrCreates an output request.
SolveSMAExsSimulateHdr Runs the simulation.
Page 212 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 213 ---

SMAExsSimulationExecution-ModelChecksCmdHdr Checks the model for errors.
SMAExsSimulationExecution-SolverChecksCmdHdr Performs model and solver checks.
SMAExsSimulationExecution-FullSolveCmdHdrSubmits model for full simulation.
ResultsSMAHvcResultsVisualizationHdrToggles viewing the simulation results.SMAHvcCreateContourPlotHdr Creates a new contour plot.SMAHvcCreateSymbolPlotHdrCreates a new symbol plot.SMAHvcCreateIsocontourPlotHdr Creates a new isocontour plot.SMAHvcCreateColorCodePlotHdrCreates a new color code plot.SMAHvcCreateHistoryPlotHdr Creates an X-Y plot of your history output data.SMAHvcImportHistoryCurveHdr Creates a history plot from data imported from a file.SMAHvcCreateXYFromPathPlotHdr Creates an XY plot of results extracted along a Path Plot.SMAHvcCreateSensorHdr Determines the minimum and maximum values for a selected variable.SMAHvcCreateResultantSensorHdrComputes resultant force and moment for the selected support.SMAHvcCreateFrequencySensorHdr Creates parameters for each mode of the selected frequency step.SMAHvcCreateBuckleModeSensorHdr Creates parameters for each mode of the selected buckle step.
SMAHvcStreamHdr Creates a family of curves that are tangential to the velocity vector of the flow and show the direction a particle will travel at any point in time.SMAHvcDisplayGroupInitializeHdr Configures the options to remove/keep portions of the model from the display.SMAHvcCreateReportHdr Creates a report document that summarizes the results of your simulation.SMAHvcCreateEnvelopeHdr Create a user-specified coordinate system.SMAHvcCreateUserCsysHdrCreate a user-specified coordinate system.SMAHvcCreatePathPlotHdr Create Path PlotSMAHvcPlayAnimationHdr Starts animating the current set of plots.SMAHvcExtremaToolbarHdrHighlights where the maximum and minimum values occur.SMAHvcCutToolbarGPAHdr Creates a cut through the model to view its interior.SMAHvcMultiVPFourSquareHdr Visualize single/multiple plots in four symmetric views configuration.SMAHvcMultiVPTriLeftHdr Visualize single/multiple plots having main view on right.SMAHvcMultiVPTriBottomHdr Visualize single/multiple plots having main view on top.SMAHvcMultiVPTwoRowHdr Visualize single/multiple plots in two rows configuration.SMAHvcMultiVPTwoColumnHdrVisualize single/multiple plots in two column configuration.SMAHvcMultiVPOffHdr Visualize plot in single view configuration.SMAHvcMultiVPSettingsHdrCustomize layouts and it's synchronization settings.SMAHvcGlobalOptionsHdr Configures the global display settings.
SMAHvcRenderingSettingsHdrConfigures display of geometry associated with the simulation, including products or parts that did not participate in the simulation.
Mesh SetupCATFmtNewMeshingRulesEditorHdrAliasCreates rules for some kinds of meshes.CATFmtFEMRepNumberingHdrAlias Assigns ranges of numbers to nodes and elements.CATFmtNumberingManagerHdrAlias Manages node and element numbering.CATFmtNumberingVisuHdrAliasDisplays the numbers associated with nodes and elements.
Mesh CreateCATFmtMeshPartManagerHdrAliasAllows modification, update and delete of mesh parts.CATFmtBeamHdrAlias Creates a 1D mesh of beam elements.CATFmtSurfaceTriaRulesMesherHdrAliasCreates a surface mesh of triangular elements.CATFmtOctree2DHdrAlias Creates a 2D mesh of triangular elements.CATFmtSurfaceQuadRulesMesherHdrAliasCreates a surface mesh of quadrilateral elements.CATFmt3DRulesMesherHdrAlias Creates a 3D mesh of tetrahedron elements.CATFmtOctree3DHdrAliasCreates a 3D mesh of tetrahedron elements.CATFmtGHS3DHdrAlias Creates a 3D mesh of tetrahedron elements by filling a 2D surface boundary mesh.CATFmtVIDSweep3DMesherHdrAlias Creates a 3D mesh by sweeping a surface mesh through a volume.CATFmtHexMesherHdrAlias Creates a 3D mesh dominated by hexahedron elements.CATFmtCoating1DMesherHdrAlias Creates bar elements from the edges of surface elements.CATFmtCoating2DMesherHdrAlias Creates surface elements by extracting the external faces of solid elements.CATFmtHoleFillerMesherHdrAlias Creates a 2D radial mesh to cover a hole or for use as the fluid boundary in an open container.CATFmtPolyhedralMesherHdrAliasCreates a polyhedral mesh.
Mesh OperateCATFmtTranslationHdrAliasCreates a mesh by copying and translating an existing mesh.CATFmtRotationHdrAlias Creates a mesh by copying and rotating an existing mesh.CATFmtSymmetryHdrAlias Creates a mesh by copying an existing mesh through a symmetry plane.CATFmtOffsetHdrAlias Creates a mesh by copying and offsetting an existing mesh.CATFmtAxisToAxisHdrAlias Creates a mesh by copying and moving an existing mesh from one axis system to another.CATFmtExtrTranslationHdrAlias Creates a mesh by extruding and translating nodes or surface elements.CATFmtExtrRotationHdrAlias Creates a mesh by extruding and rotating nodes or surface elements.CATFmtExtrSymmetryHdrAlias Creates a mesh by extruding nodes or surface elements through a symmetry plane.CATFmtExtrSpineHdrAlias Cretes a mesh by extruding nodes or surface elements along an edge.CATFmtExtrOffsetMesherHdrAlias Creates a mesh by extruding and offsetting nodes or surface elements.CATFmtInflationMesherHdrAlias Creates a 3D mesh from a 2D mesh.CATFmtMeshingEditionToolsHdrAlias Accesses the manual editing tools.
Page 213 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 214 ---

Caution: If copying the above command header ids, be sure to remove the hyphens. The actual header ids do not contain any hyphen.
History
Mesh GroupCATFmtGroupManagerHdrAliasAllows modification, update and delete of groups.CATFmtGroupByAssociativityHdrAliasCreates a group containing all the mesh entities in a selected region.CATFmtGroupByProximityHdrAlias Creates a group of mesh entities by proximity.CATFmtGroupSpatialHdrAlias Creates a group of mesh entities that lie within a bounding box or sphere.CATFmtGroupByBoundaryHdrAlias Creates a group of mesh entities that lie within a boundary.CATFmtGroupByManualSelectionHdrAliasCreates a group of mesh entities using a manual selection process.CATFmtGroupUnionHdrAlias Creates a group of mesh entities from the union of existing groups.CATFmtGroupIntersectionHdrAlias Creates a group of mesh entities from the intersection of existing groups.CATFmtGroupDifferenceHdrAlias Creates a group of mesh entities from the difference between two groups.
Manage ModelCATFmtContributingPartsHdrAliasManages inclusion of 3D geometric entities.CATFmtContributingFemsHdrAlias Manages inclusion of component finite element models.SMAExsUpdateFEMHdrAlias Checks the finite element model.SMAExsShipStructuresHdrAliasCreates a functional structure finite element model.
SectionsSMAExsSolidSectionHdrAliasCreates a solid section.SMAExsShellSectionHdrAlias Creates a shell section.SMAExsContinuumShellSectionHdrAliasCreates a continuum shell section.SMAExsCompositeShellSectionHdrAliasCreates a composite shell section.SMAExsCompositeContinuumShellSectionHdrAliasCreates a composite continuum shell section.SMAExsMembraneSectionHdrAlias Creates a membrane section.SMAExsBeamSectionHdrAliasCreates a beam section.SMAExsBeamProfileHdrAlias Defines a beam profile.SMAExsTrussSectionHdrAlias Creates a truss section.SMAExsSPHSectionHdrAliasConverts a Lagrangian finite element mesh to smoothed particles.SMAExsGasketSectionHdrAlias Creates a gasket.SMAExsPretensionSectionHdrAlias Defines a planar surgace through the body of a fastener through which bolt loads and restraints are applied.
AbstractionsSMAExsRigidBodyConstraintPropertyHdrAliasCreates a rigid body.SMAExsAnalyticalSurfacePropertyHdrAliasCreates a rigid surface.SMAExsMassRotaryInertiaPropertyHdrAliasApplies nonstructural mass and inertial on a point.SMAExsRemoteMassRotaryInertiaPropertyHdrAliasApplies remote mass and inertia.SMAExsMassPerVolumeHdrAlias Applies nonstructural mass on a body.SMAExsMassPerAreaHdrAliasApplies nonstructural mass on a face.SMAExsMassPerLengthHdrAlias Applies nonstructural mass along a beam.SMAExsCyclicSymmetryHdrAlias Creates a cyclic symmetry model.
ConnectionsSMAExsConnectionManagerHdrAliasManages connections.SMAExsConnectionCheckerHdrAliasChecks connection validity.SMAExsVirtualBoltHdrAlias Creates a virtual bolt.SMAExsBoltReplicationHdrAliasIdentitifies and replicates bolts between parts.SMAExsVirtualPartHdrAlias Creates a virtual part.SMAExsSpringHdrAlias Creates a spring.SMAExsTieDetectionHdrAlias Identifies contacting surfaces and creates tie connections between them.SMAExsTieHdrAlias Creates a tie connection.SMAExsSpotWeldHdrAlias Creates a spot weld.SMAExsPointFastenerOverrideHdrAliasOverrides a point fastener's construct.SMAExsSeamWeldHdrAlias Creates a seam weld.SMAExsLineFastenerOverrideHdrAliasOverrides a line fastener's construct.SMAExsImportFastenerHdrAlias Imports point/line fasteners.SMAExsGeneralConnectionHdrAliasCreates a general connection.SMAExsRigidConnectionHdrAliasCreates a rigid connection.SMAExsVirtualPinHdrAlias Creates a virtual pin.SMAExsDisconnectedPartsHdrAliasHighlights parts that do not have any connections.SMAExsTouchContactHdrAliasHighlights regions in a model where parts come into contact but do not intersect or overlap.SMAExsIntersectContactHdrAliasHighlightes regions in a model where parts intersect or overlap.
Version: 1 [Jan 2016]Document created
Discovering Command Header IdentifiersTechnical ArticleAbstract
This article details how to use the Application Frame Structure Exposition command to obtain the command header identifier (for non-Simulation app commands) to use for the headerId attribute of the <CommandHeader> element.
Page 214 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 215 ---

The Application Frame Structure Exposition command generates a file that contains a listing of all the commands available in the selected context. This listing gives the internal command header identifier, shown as 'Id', for each command. This is the value to use for the headerId attribute.
To run the Application Frame Structure Exposition command:
lWithin the 3DEXPERIENCE desktop app,
¡Display the Status Bar (displays at the bottom of the window). 
¡In the Power Input field (right side of Status Bar), enter 
c:Application Frame Structure Exposition
On theStructure Exposition dialog,
lenter the desired target directory,
lselect the desired Workshop/Workbench in the list, 
lhit the Print button to have a file written to the given directory. 
TheApplication Frame Structure Exposition command will reveal only the commands that are available in the current context. Thus, to discover a command that is available in a particular app, the Application Frame Structure Exposition command must be run within that app.
The Application Frame Structure Exposition command may reveal commands that do not work with the custom Method <CommandHeader> element. This is a limitation of the command itself and cannot be resolved by the custom Method. Nevertheless, in such a case be sure to double check the spelling of the command header id.
History
Use the GetItem method of theSimSpecsRepManager object to retrieve theSimScenarioManager object.
Dim oSimSpecsRepManager  As SimSpecsRepManager...Dim oSimScenarioManager As SimScenarioManagerSet oSimScenarioManager = oSimSpecsRepManager.GetItem("SimScenarioManager")
# Get the simulation editor and the simulation rootmyEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentMySimulationRoot = myEntities.Item(1)
# Retrieve the Scenario Manager myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")
Version: 1 [Jan 2016]Document created
Multiphysics Scenario Creation Object Model MapSee AlsoLegend
VBAPython
Simulation Feature ObjectsSee AlsoLegend
Page 215 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 216 ---

 Available with the RBM - Simulation Scripting product only.
Use the Features property of theSimDesignImprovementStudyCase object to retrieve theSimDesignExplorationFeatures collection.
Dim oSimDesignImprovementStudyCase  As SimDesignImprovementStudyCase...Dim cSimDesignExplorationFeatures As SimDesignExplorationFeaturesSet cSimDesignExplorationFeatures = oSimDesignImprovementStudyCase.Features
...cSimDesignExplorationFeatures = oSimDesignImprovementStudyCase.Features...
Use the Add method of theSimDesignExplorationFeatures collection to create a new simulation feature, such as a SimDisplacementConstraint object.
Dim oSimDisplacementConstraint As SimDisplacementConstraintSet oSimDisplacementConstraint = cSimDesignExplorationFeatures.Add("SimDisplacementConstraint")
...oSimDisplacementConstraint = cSimDesignExplorationFeatures.Add("SimDisplacementConstraint")...
Use the AddSubFeature method of theSimDesignExplorationFeatures collection to create a new simulation feature under an aggregaring object, such as aSimPreservedRegion object.
Dim oSimDesignSpaceAs SimDesignSpaceSet oSimDesignSpace= cSimDesignExplorationFeatures.Add("SimDesignSpace")
Dim oSimPreservedRegion As SimPreservedRegionSet oSimPreservedRegion = cSimDesignExplorationFeatures.AddSubFeature("SimPreservedRegion",oDesignSpace)
...oSimPreservedRegion = oSimPreservedRegion .AddSubFeature("SimPreservedRegion",oDesignSpace)...
See Creation Late Types for Design Exploration Scenario Features to know how you can create the simulation features.
VBAPython
VBAPython
VBAPython
Page 216 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 217 ---

Use the TypeName function to determine the type of an object retrieved from theSimDesignExplorationFeatures collection in order to use its own properties and methods.
Dim oRetrievedObject As AnyObjectSet oRetrievedObject = cSimDesignExplorationFeatures.Item(3)Dim objectType As StringobjectType = TypeName(oRetrievedObject)
...oRetrievedObject = cSimFeatures.Item(3)objectType = TypeName(oRetrievedObject)...
Use the GetItem method to return theSimLinkAccess object from its aggregating object, such as theSimStressConstraint object.
Dim oSimStressConstraintAs SimStressConstraint...Dim oSimLinkAccess As SimLinkAccessSet oSimLinkAccess = oSimStressConstraint.GetItem("SimLinkAccess")
...oSimLinkAccess = oSimStressConstraint.GetItem("SimLinkAccess")...
 Available with the RBM - Simulation Scripting product only.
Use the Add method of theSimDesignExplorationFeatures collection to create a newSimDesignSpace object.
Dim cSimDesignExplorationFeatures As SimDesignExplorationFeatures...Dim oSimDesignSpace As SimDesignSpaceSet oSimDesignSpace = cSimFeatures.Add("SimDesignSpace")
...oSimDesignSpace = cSimDesignExplorationFeatures.Add("SimDesignSpace")...
VBAPython
VBAPython
SimDesignSpace ObjectSee AlsoLegend
VBAPython
Creating and Executing a Topology Design Improvement StudyThis article explains how to create and execute a topology design improvement study.
Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaBracketModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaDesignExplorationScenario\samples\ where InstallRootFolder is the folder where the APICD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaTopologyDesignImprovementStudySource.htm
This use case can be divided in 15 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part5.Creating a Property6.Initializing and Creating the Design Exploration PLM Object7.Retrieving the Scenario Manager8.Creating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Structural Analysis Case Features Set11.Creating Structural Analysis Case features12.Creating the Topology Design Improvement Study with the Structural Analysis Case
Page 217 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 218 ---

13.Retrieving the Design Improvement Study features14.Creating the Design Improvement Study features15.Launching the Shape Design Improvement Study
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the Publications and Composing Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myDesignSpaceSupport As VPMPublicationSet myDesignSpaceSupport = myPublications.GetItem("Design_Space")
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToPartitionSupport As AnyObjectSet myLinkToPartitionSupport = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myDesignSpaceSupport)
...
3.Creating the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creating a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creating a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Design Exploration Simulation PLM Object
In this step UC creates a simulation object.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimDesignexplorationCreation", "SimOptimization"
' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewDesignExplorationObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieving the Scenario Manager
Page 218 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 219 ---

In this step UC retrieves the scenario manager.
...Dim myScenarioManager As SimScenarioManagerSet myScenarioManager = mySimulationReference.GetItem("SimScenarioManager")...
8.Creating the Structural Analysis Case with the FEM Rep
In this step UC creates a structural analysis case and associates it with the FEM rep.
For further information about the creation and management of structural analysis case, refer to the article Creating and Executing a Simulation. 
9.Creating and Initializing the Static Step
In this step UC creates a static step under the structural analysis case and sets its individual attributes.
For further information about the creation and management of steps, refer to the article Creating and Executing a Simulation. 
10.Retrieving the Structural Analysis Case Features Set
In this step UC retrieves the features set for the structural analysis case.
For further information about the management of structural analysis case features set, refer to the article Creating and Executing a Simulation. 
11.Creating Structural Analysis Case features
In this step UC creates and initializes features for the structural anaylsis case.
For further information about the creation and management of structural analysis features, refer to the article Creating and Executing a Simulation. 
12.Creating the Topology Design Improvement Study with the Structural Analysis case
In this step UC creates a Topology Design Improvement Study and associates it with the structural analysis case.
...Dim myAnalysisCases As SimAnalysisCasesSet myAnalysisCases = myScenarioManager.AnalysisCases
Dim myTopologyStudy As SimTopologyDesignImprovementStudySet myTopologyStudy = myAnalysisCases.AddAnalysisCase("SimTopologyDesignImprovementStudy")
myTopologyStudy.AnalysisCase = myAnalysisCase...
13.Retrieving the Design Improvement Study Features Set
In this step UC retrieves the design exploration features set.
...Dim myTopologyFeatures As SimDesignImprovementFeaturesSet myTopologyFeatures = myTopologyStudy.Features...
14.Creating Design Improvement Study Features
In this step UC creates features for the simulation.
...Dim myDesignSpace As SimDesignSpaceSet myDesignSpace = myFeatures.Add("SimDesignSpace")
' Setting feature support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myDesignSpace .GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToPartitionSupport...
You can find the available late types for features creation in the Creation Late Types for Design Exploration Scenario Features article.
15.Launching the Simulation
In this step UC launch the topology design improvement study and shows the results.
...Dim myExecutionService As SimExecutionServiceSet myExecutionService = myEditor.GetService("SimExecutionService")
myExecutionService.BasicExecuteAll mySimulationReference
' Switching to the results visualization workbench
CATIA.StartWorkbench "SMAHvcResultsVisualizationWorkbench"...
Initializing and Executing a Topology Design Improvement Study
This article explains how to initialize and execute a topology design improvement study.
Page 219 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 220 ---

Before you begin:
lLaunch CATIA and then import and open the CAAScdFeaBracketModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaDesignExplorationScenario\samples\ where InstallRootFolder is the folder where the APICD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaTopologyDesignImprovementStudyWithPythonSource.htmThis use case can be divided in 12 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part5.Creating a Property6.Initializing and Creating the Design Exploration PLM Object7.Retrieving the Scenario Manager8.Creating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Structural Analysis Case Features Set11.Creating Structural Analysis Case features12.Creating the Topology Design Improvement Study with the Structural Analysis Case13.Retrieving the Design Improvement Study features14.Creating the Design Improvement Study features15.Launching the topology design improvement study
1.Retrieves the product
As a first step, the UC retrieves the active product 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)...
2.Retrieves the Publications and Composes Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications  = myModel.PublicationsmyDesignSpaceSupport = myPublications.GetItem("Design_Space")
# Composing linksmyLinkToPartitionSupport = myProdService.ComposeLink(None, None, myDesignSpaceSupport)...
As we use publication, we just need to give it as third argument to compose the link
3.Creates the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creates a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creates a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Design Exploration Simulation PLM Object
In this step UC creates a simulation object.
...# Creating and Initializing the design exploration PLM ObjectmyInitService = CATIA.GetSessionService("SimInitializationService")myInitService.SetSimulationInitialization "SimDesignexplorationCreation", "SimOptimization"mySimPLMService = CATIA.GetSessionService("SIMPLMService")mySimPLMService.PLMCreate "NewDesignExplorationObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieves the Scenario Manager
In this step UC retrieves the scenario manager.
...myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")
Page 220 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 221 ---

...
8.Creating the Structural Analysis Case with the FEM Rep
In this step UC retrieves the structural analysis case and associates it with the FEM rep.
For further information about the creation and management of structural analysis case, refer to the article Creating and Executing a Simulation (Python). 
9.Creating and Initializing the Static Step
In this step UC creates a static step under the structural analysis case and sets its individual attributes.
For further information about the creation and management of steps, refer to the article Creating and Executing a Simulation (Python). 
10.Retrieving the Structural Analysis Case Features Set
In this step UC retrieves the features set for the structural analysis case.
For further information about the management of structural analysis case features set, refer to the article Creating and Executing a Simulation (Python). 
11.Creating Structural Analysis Case features
In this step UC creates and initializes features for the structural anaylsis case.
For further information about the creation and management of structural analysis features, refer to the article Creating and Executing a Simulation (Python). 
12.Associates the Topology Design Improvement Study with the Structural Analysis Case
In this step UC retrieves the topology design improvement study and associates it with the structural analysis case
...myAnalysisCases = myScenarioManager.AnalysisCasesmyTopologyStudy = myAnalysisCases.AddAnalysisCase("SimTopologyDesignImprovementStudy")myTopologyStudy.AnalysisCase = myAnalysisCase ...
13.Retrieving the Design Improvement Study Features Set
In this step UC retrieves the features set.
...myTopologyFeatures = myTopologyStudy.Features...
14.Creating Design Improvement Study Features
In this step UC creates features for the topology design improvement study.
...# Creating Design Space feature and setting its supportmyDesignSpace = myFeatures.Add("SimDesignSpace")myLinkAccess = myDesignSpace .GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToPartitionSupport...
You can find the available late types for features creation in the Creation Late Types for Design Exploration Scenario Features article.
15.Launches the Topology Design Improvement Study
In this step UC launch the topology design improvement study and shows the results.
...myExecutionService = myEditor.GetService("SimExecutionService")myExecutionService.BasicExecuteAll (mySimulationReference)...
Creating and Executing a Shape Design Improvement StudyThis article explains how to create and execute a shape design improvement study.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaCarrierModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaDesignExplorationScenario\samples\ where InstallRootFolder is the folder where the APICD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaShapeDesignImprovementStudySource.htm
This use case can be divided in 15 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part
Page 221 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 222 ---

5.Creating a Property6.Initializing and Creating the Design Exploration PLM Object7.Retrieving the Scenario Manager8.Creating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Structural Analysis Case Features Set11.Creating Structural Analysis Case features12.Creating the Shape Design Improvement Study with the Structural Analysis Case13.Retrieving the Design Improvement Study features14.Creating the Design Improvement Study features15.Launching the Shape Design Improvement Study
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the Publications and Composing Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myDesignSpaceSupport As VPMPublicationSet myDesignSpaceSupport = myPublications.GetItem("Design_Space")
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToDisconnectSupport As AnyObjectSet myLinkToDisconnectSupport = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myDesignSpaceSupport)
...
3.Creating the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creating a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creating a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Design Exploration Simulation PLM Object
In this step UC creates a simulation object.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimDesignexplorationCreation", "SimOptimization"
' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewDesignExplorationObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieving the Scenario Manager
Page 222 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 223 ---

In this step UC retrieves the scenario manager.
...Dim myScenarioManager As SimScenarioManagerSet myScenarioManager = mySimulationReference.GetItem("SimScenarioManager")...
8.Creating the Structural Analysis Case with the FEM Rep
In this step UC creates a structural analysis case and associates it with the FEM rep.
For further information about the creation and management of structural analysis case, refer to the article Creating and Executing a Simulation. 
9.Creating and Initializing the Static Step
In this step UC creates a static step under the structural analysis case and sets its individual attributes.
For further information about the creation and management of steps, refer to the article Creating and Executing a Simulation. 
10.Retrieving the Structural Analysis Case Features Set
In this step UC retrieves the features set for the structural analysis case.
For further information about the management of structural analysis case features set, refer to the article Creating and Executing a Simulation. 
11.Creating Structural Analysis Case features
In this step UC creates and initializes features for the structural anaylsis case.
For further information about the creation and management of structural analysis features, refer to the article Creating and Executing a Simulation. 
12.Creating the Shape Design Improvement Study with the Structural Analysis case
In this step UC creates a Shape Design Improvement Study and associates it with the structural analysis case.
...Dim myAnalysisCases As SimAnalysisCasesSet myAnalysisCases = myScenarioManager.AnalysisCases
Dim myShapeStudyAs SimShapeDesignImprovementStudySet myShapeStudy= myAnalysisCases.AddAnalysisCase("SimShapeDesignImprovementStudy")
myShapeStudy.AnalysisCase = myAnalysisCase...
13.Retrieving the Design Improvement Study Features Set
In this step UC retrieves the design exploration features set.
...Dim myShapeFeatures As SimDesignImprovementFeaturesSet myShapeFeatures = myShapeFeatures.Features...
14.Creating Design Improvement Study Features
In this step UC creates features for the simulation.
...Dim myDesignSpace As SimDesignSpaceSet myDesignSpace = myFeatures.Add("SimDesignSpace")
' Setting feature support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myDesignSpace .GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToDisconnectSupport...
You can find the available late types for features creation in the Creation Late Types for Design Exploration Scenario Features article.
15.Launching the Shape Design Improvement Study
In this step UC launch the topology design improvement study and shows the results.
...Dim myExecutionService As SimExecutionServiceSet myExecutionService = myEditor.GetService("SimExecutionService")
myExecutionService.BasicExecuteAll mySimulationReference
' Switching to the results visualization workbench
CATIA.StartWorkbench "SMAHvcResultsVisualizationWorkbench"...
Initializing and Executing a Shape Design Improvement Study
This article explains how to initialize and execute a shape design improvement study.
Page 223 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 224 ---

Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaCarrierModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaDesignExplorationScenario\samples\ where InstallRootFolder is the folder where the APICD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaShapeDesignImprovementStudyWithPythonSource.htmThis use case can be divided in 12 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part5.Creating a Property6.Initializing and Creating the Design Exploration PLM Object7.Retrieving the Scenario Manager8.Creating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Structural Analysis Case Features Set11.Creating Structural Analysis Case features12.Creating the Shape Design Improvement Study with the Structural Analysis Case13.Retrieving the Design Improvement Study features14.Creating the Design Improvement Study features15.Launching the shape design improvement study
1.Retrieves the active product
As a first step, the UC retrieves the active product 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)...
2.Retrieves the Publications and Composes Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications  = myModel.PublicationsmyDesignSpaceSupport = myPublications.GetItem("Design_Space")
# Composing linksmyLinkToDisconnectSupport = myProdService.ComposeLink(None, None, myDesignSpaceSupport)...
As we use publication, we just need to give it as third argument to compose the link
3.Creates the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creates a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creates a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further informationabout the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Design Exploration Simulation PLM Object
In this step UC creates a simulation object.
...# Creating and Initializing the design exploration PLM ObjectmyInitService = CATIA.GetSessionService("SimInitializationService")myInitService.SetSimulationInitialization "SimDesignexplorationCreation", "SimOptimization"mySimPLMService = CATIA.GetSessionService("SIMPLMService")mySimPLMService.PLMCreate "NewDesignExplorationObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieves the Scenario Manager
In this step UC retrieves the scenario manager.
...myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")
Page 224 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 225 ---

...
8.Creating the Structural Analysis Case with the FEM Rep
In this step UC retrieves the structural analysis case and associates it with the FEM rep.
For further information about the creation and management of structural analysis case, refer to the article Creating and Executing a Simulation (Python). 
9.Creating and Initializing the Static Step
In this step UC creates a static step under the structural analysis case and sets its individual attributes.
For further information about the creation and management of steps, refer to the article Creating and Executing a Simulation (Python). 
10.Retrieving the Structural Analysis Case Features Set
In this step UC retrieves the features set for the structural analysis case.
For further information about the management of structural analysis case features set, refer to the article Creating and Executing a Simulation (Python). 
11.Creating Structural Analysis Case features
In this step UC creates and initializes features for the structural anaylsis case.
For further information about the creation and management of structural analysis features, refer to the article Creating and Executing a Simulation (Python). 
12.Associates the Shape Design Improvement Study with the Structural Analysis Case
In this step UC retrieves the Shape design improvement study and associates it with the structural analysis case
...myAnalysisCases = myScenarioManager.AnalysisCasesmyShapeStudy = myAnalysisCases.AddAnalysisCase("SimShapeDesignImprovementStudy")myShapeStudy.AnalysisCase = myAnalysisCase ...
13.Retrieving the Design Improvement Study Features Set
In this step UC retrieves the features set.
...myShapeFeatures = myShapeStudy.Features...
14.Creating Design Improvement Study Features
In this step UC creates features for the Shape design improvement study.
...# Creating Design Space feature and setting its supportmyDesignSpace = myFeatures.Add("SimDesignSpace")myLinkAccess = myDesignSpace .GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToDisconnectSupport...
You can find the available late types for features creation in the Creation Late Types for Design Exploration Scenario Features article.
15.Launches the Shape Design Improvement Study
In this step UC launch the Shape design improvement study and shows the results.
...myExecutionService = myEditor.GetService("SimExecutionService")myExecutionService.BasicExecuteAll (mySimulationReference)...
Creating and Executing a Bead Design Improvement StudyThis article explains how to create and execute a Bead design improvement study.
Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaClampModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaDesignExplorationScenario\samples\ where InstallRootFolder is the folder where the APICD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaBeadDesignImprovementStudySource.htm
This use case can be divided in 15 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part
Page 225 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 226 ---

5.Creating a Property6.Initializing and Creating the Design Exploration PLM Object7.Retrieving the Scenario Manager8.Creating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Structural Analysis Case Features Set11.Creating Structural Analysis Case features12.Creating the Bead Design Improvement Study with the Structural Analysis Case13.Retrieving the Design Improvement Study features14.Creating the Design Improvement Study features15.Launching the Bead Design Improvement Study
1.Retrieving the active Product
As a first step, the UC retrieves the active product. 
... Dim myEditor As EditorSet myEditor = CATIA.ActiveEditor
Dim myProdService As PLMProductServiceSet myProdService = myEditor.GetService("PLMProductService")
Dim myEntities As PLMEntitiesSet myEntities = myProdService.EditedContent
Dim myRootProduct As VPMReferenceSet myRootProduct = myEntities.Item(1)...
2.Retrieving the Publications and Composing Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...Dim myPublications  As VPMPublicationsSet myPublications  = myRootProduct.Publications
Dim myDesignSpaceSupport As VPMPublicationSet myDesignSpaceSupport = myPublications.GetItem("Design_Space")
' Composing link to the publication
Dim myRootOccurrence As VPMRootOccurrenceSet myRootOccurrence = myProdService.RootOccurrence
Dim myRepInstance As VPMRepInstanceSet myRepInstance = Nothing ' Because we use publications
Dim myLinkToDisconnectSupport As AnyObjectSet myLinkToDisconnectSupport = myProdService.ComposeLink(myRootOccurrence, myRepInstance, myDesignSpaceSupport)
...
3.Creating the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creating a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creating a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Design Exploration Simulation PLM Object
In this step UC creates a simulation object.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimDesignexplorationCreation", "SimOptimization"
' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewDesignExplorationObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieving the Scenario Manager
Page 226 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 227 ---

In this step UC retrieves the scenario manager.
...Dim myScenarioManager As SimScenarioManagerSet myScenarioManager = mySimulationReference.GetItem("SimScenarioManager")...
8.Creating the Structural Analysis Case with the FEM Rep
In this step UC creates a structural analysis case and associates it with the FEM rep.
For further information about the creation and management of structural analysis case, refer to the article Creating and Executing a Simulation. 
9.Creating and Initializing the Static Step
In this step UC creates a static step under the structural analysis case and sets its individual attributes.
For further information about the creation and management of steps, refer to the article Creating and Executing a Simulation. 
10.Retrieving the Structural Analysis Case Features Set
In this step UC retrieves the features set for the structural analysis case.
For further information about the management of structural analysis case features set, refer to the article Creating and Executing a Simulation. 
11.Creating Structural Analysis Case features
In this step UC creates and initializes features for the structural anaylsis case.
For further information about the creation and management of structural analysis features, refer to the article Creating and Executing a Simulation. 
12.Creating the Bead Design Improvement Study with the Structural Analysis case
In this step UC creates a Bead Design Improvement Study and associates it with the structural analysis case.
...Dim myAnalysisCases As SimAnalysisCasesSet myAnalysisCases = myScenarioManager.AnalysisCases
Dim myBeadStudyAs SimBeadDesignImprovementStudySet myBeadStudy= myAnalysisCases.AddAnalysisCase("SimBeadDesignImprovementStudy")
myBeadStudy.AnalysisCase = myAnalysisCase...
13.Retrieving the Design Improvement Study Features Set
In this step UC retrieves the design exploration features set.
...Dim myBeadFeatures As SimDesignImprovementFeaturesSet myBeadFeatures = myBeadFeatures.Features...
14.Creating Design Improvement Study Features
In this step UC creates features for the simulation.
...Dim myDesignSpace As SimDesignSpaceSet myDesignSpace = myFeatures.Add("SimDesignSpace")
' Setting feature support
Dim myLinkAccess As SimLinkAccessSet myLinkAccess = myDesignSpace .GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToDisconnectSupport ...
You can find the available late types for features creation in the Creation Late Types for Design Exploration Scenario Features article.
15.Launching the Bead Design Improvement Study
In this step UC launch the topology design improvement study and shows the results.
...Dim myExecutionService As SimExecutionServiceSet myExecutionService = myEditor.GetService("SimExecutionService")
myExecutionService.BasicExecuteAll mySimulationReference
' Switching to the results visualization workbench
CATIA.StartWorkbench "SMAHvcResultsVisualizationWorkbench"...
Initializing and Executing a Bead Design Improvement Study
This article explains how to initialize and execute a Bead design improvement study.
Page 227 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 228 ---

Before you begin:
lLaunch CATIA and then import and open theCAAScdFeaClampModel.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaDesignExplorationScenario\samples\ where InstallRootFolder is the folder where the APICD-ROM is installed. 
lMake sure that you have all of the licenses required for launching execution and perform the solve operation in the interactive session for a similar simulation totest the licenses. 
lNote: Creation of new PLM objects via scripting, as in this use case, requires an enabling license in addition to the interactive Roles needed to access thefunctionality. 
Where to find the macro: CAAScdFeaBeadDesignImprovementStudyWithPythonSource.htmThis use case can be divided in 12 steps:
1.Retrieving the active Product2.Retrieving the Publications and Composing Links3.Creating the FEM Rep and Retrieving its Rep Manager4.Creating a Mesh on a Part5.Creating a Property6.Initializing and Creating the Design Exploration PLM Object7.Retrieving the Scenario Manager8.Creating the Structural Analysis Case with the FEM Rep9.Creating and Initializing the Static Step10.Retrieving the Structural Analysis Case Features Set11.Creating Structural Analysis Case features12.Creating the Bead Design Improvement Study with the Structural Analysis Case13.Retrieving the Design Improvement Study features14.Creating the Design Improvement Study features15.Launching the Bead design improvement study
1.Retrieves the active product
As a first step, the UC retrieves the active product 
... myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")myEntities = myProdService.EditedContentmyEntity = myEntities.Item(1)...
2.Retrieves the Publications and Composes Links
In this step UC retrieves the publications aggregated by the root product and composes links.
...myPublications  = myModel.PublicationsmyDesignSpaceSupport = myPublications.GetItem("Design_Space")
# Composing linksmyLinkToDisconnectSupport = myProdService.ComposeLink(None, None, myDesignSpaceSupport)...
As we use publication, we just need to give it as third argument to compose the link
3.Creates the FEM Rep and Retrieving its Rep Manager
In this step UC creates a finite element representation model on the product which was just opened.
For further information about creating the FEM Rep and retrieving its Rep Manager, refer to the article Creating FEM representation. 
4.Creates a Mesh on a Part
In this step UC retrieves the nodes and elements set from the FEM Representation, creates a mesh on a part and sets the mesh attributes.
For further information about the creation and management of mash parts, refer to the article Creating Mesh Part. 
5.Creates a Property
In this step UC creates a solid section on the part and sets its individual attributes. 
For further information about the creation and management of properties, refer to the article Managing FEM section features. 
6.Initializing and Creating the Design Exploration Simulation PLM Object
In this step UC creates a simulation object.
...# Creating and Initializing the design exploration PLM ObjectmyInitService = CATIA.GetSessionService("SimInitializationService")myInitService.SetSimulationInitialization "SimDesignexplorationCreation", "SimOptimization"mySimPLMService = CATIA.GetSessionService("SIMPLMService")mySimPLMService.PLMCreate "NewDesignExplorationObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
For further information about the initialization of a simulation object, refer to the article Initializing a Simulation Object. 
7.Retrieves the Scenario Manager
In this step UC retrieves the scenario manager.
...myScenarioManager = MySimulationRoot.GetItem("SimScenarioManager")
Page 228 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 229 ---

Constraint Late Types
Constraints creation is managed by the SimDesignExplorationFeatures collection by calling theAdd method from it.
A "late type" must be given to indicate which type of constraint is to be created:
...
8.Creating the Structural Analysis Case with the FEM Rep
In this step UC retrieves the structural analysis case and associates it with the FEM rep.
For further information about the creation and management of structural analysis case, refer to the article Creating and Executing a Simulation (Python). 
9.Creating and Initializing the Static Step
In this step UC creates a static step under the structural analysis case and sets its individual attributes.
For further information about the creation and management of steps, refer to the article Creating and Executing a Simulation (Python). 
10.Retrieving the Structural Analysis Case Features Set
In this step UC retrieves the features set for the structural analysis case.
For further information about the management of structural analysis case features set, refer to the article Creating and Executing a Simulation (Python). 
11.Creating Structural Analysis Case features
In this step UC creates and initializes features for the structural anaylsis case.
For further information about the creation and management of structural analysis features, refer to the article Creating and Executing a Simulation (Python). 
12.Associates the Bead Design Improvement Study with the Structural Analysis Case
In this step UC retrieves the Bead design improvement study and associates it with the structural analysis case
...myAnalysisCases = myScenarioManager.AnalysisCasesmyBeadStudy = myAnalysisCases.AddAnalysisCase("SimBeadDesignImprovementStudy")myBeadStudy.AnalysisCase = myAnalysisCase ...
13.Retrieving the Design Improvement Study Features Set
In this step UC retrieves the features set.
...myBeadFeatures = myBeadStudy.Features...
14.Creating Design Improvement Study Features
In this step UC creates features for the Bead design improvement study.
...# Creating Design Space feature and setting its supportmyDesignSpace = myFeatures.Add("SimDesignSpace")myLinkAccess = myDesignSpace .GetItem("SimLinkAccess")myLinkAccess.AddLink "MainSupport", myLinkToDisconnectSupport...
You can find the available late types for features creation in the Creation Late Types for Design Exploration Scenario Features article.
15.Launches the Bead Design Improvement Study
In this step UC launch the Bead design improvement study and shows the results.
...myExecutionService = myEditor.GetService("SimExecutionService")myExecutionService.BasicExecuteAll (mySimulationReference)...
Creation Late Types for Design Exploration Scenario FeaturesTechnical ArticleAbstract
The following reference article documents the different late types that can be used to create Design Exploration Scenario features.
lConstraints Late Types
lDesign Variable Late Types
lManufacturing Controls Features Late Types
lObjective Late Types
lResponse Variable Late Types
lShape ControlsFeatures Late Types
Related TopicsSimDesignExplorationFeaturesCollection
Page 229 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 230 ---

Design Variable Features Late Types
Design Variable features creation is managed by theSimDesignExplorationFeatures collection by calling theAdd method from it.
A "late type" must be given to indicate which type of Setup feature is to be created:
Design Space Sub-Features Late Types
Design space sub-features creation is managed by theSimDesignExplorationFeatures collection by calling theAddSubFeature method together with the parent SimDesigSpaceor SimLocalOptimizationArea from it.
A "late type" must be given to indicate which type of Setup feature is to be created:
Manufacturing Control Features Late Types
Manufacturing Controls features creation is managed by theSimDesignExplorationFeatures collection by calling theAdd method from it.
A "late type" must be given to indicate which type of Manufacturing Controls feature is to be created:
Response Variable Features Late Types
Response variable features creation is managed by theSimDesignExplorationFeatures collection by calling theAdd method from it.
A "late type" must be given to indicate which type of load is to be created:
Objective features late types
Restraint features creation is managed by the SimDesignExplorationFeatures collection by calling the Add method from it.
A "late type" must be given to indicate which type of restraint is to be created:
Shape Control features late types
Shape Control features creation is managed by theSimDesignExplorationFeatures collection by calling theAdd method from it.
Constraints Late typeCenter Of Gravity ConstraintSimCenterOfGravityConstraintDisplacement ConstraintSimDisplacementsConstraintFastener Force ConstraintSimFastenerForceConstraintFrequency ConstraintSimFrequencyConstraintGeneral ConstraintSimGeneralConstraintMass ConstraintSimMassConstraintStress ConstraintSimStressConstraintReaction Force ConstraintSimReactionForceConstraint
Design Variable featureLate typeDesign Space SimDesignSpace
Design space sub-featureLate typeLocal Optimization AreaSimLocalOptimizationAreaIn-Plane ControlSimInPlaneControlTransition ControlSimTransitionControlPreserved RegionSimPreservedRegion
Manufacturing Control featureLate typeALM Overhang ControlSimOverhangControlCasting Control SimCastingControlExtrusion Control SimExtrusionControlMilling Control SimMillingControlRib Control SimRibControl
Response variable Late typeAbsolute Mass Response VariableSimAbsoluteMassResponseVariableCalculated Response Variable SimCalculatedResponseVariableCenter Of Gravity Response VariableSimCenterOfGravityResponseVariableDisplacement Response VariableSimDisplacementResponseVariableFastener Force Response VariableSimFastenerForceResponseVariableFrequency Response Variable SimFrequencyResponseVariableReaction Moment Response VariableSimReactionMomentResponseVariableRelative Mass Response VariableSimRelativeMassResponseVariableMoment Of Inertia Response VariableSimMomentOfInertiaResponseVariablePlastic Strain Magnitude Response VariableSimPlasticStrainResponseVariableRotation Response Variable SimRotationResponseVariableStiffness Response Variable SimStiffnessResponseVariableStress Response Variable SimStressResponseVariable
ObjectiveLate typeObjectiveSimNonParametricObjective
Page 230 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 231 ---

A "late type" must be given to indicate which type of shape control is to be created:
History
Initializing a Simulation Object
The first step in creating a new simulation is to call theSetSimulationInitialization method ofSimInitializationService.
...' Initializing the simulation PLM Object
Dim myInitService As SimInitializationServiceSet myInitService = CATIA.GetSessionService("SimInitializationService")
myInitService.SetSimulationInitialization "SimDesignExplorationCreation", "SimOptimization"...
The argument strings into theSetSimulationInitialization method maps to the App and Analysis Case of the Simulation as per the table below.
Once the SetSimulationInitialization has been called, a new simulation can be created by calling PLMCreate method of SIMPLMService.
...' Creating the simulation PLM Object
Dim mySimPLMService As SIMPLMServiceSet mySimPLMService = CATIA.GetSessionService("SIMPLMService")
Dim mySimulationReference As SimulationReferencemySimPLMService.PLMCreate "NewSimObject", "SMAFeaPLMNewSimu", myModel, mySimulationReference, myEditor...
History
Shape ControlLate typeBead Width ControlSimBeadWidthControlCyclic Symmetry ControlSimCyclicSymmetryControlPenetration CheckSimPenetrationCheckSymmetry ControlSimSymmetryControlThickness ControlSimThicknessControl
Version: 1 [Febraury 2023]Document created
Initializing a Simulation ObjectTechnical ArticleAbstract
The following reference section documents the required licensing for initializing various types of simulations.
lInitializing a Simulation Object
App AppName ArgumentAnalysis Case TypeName Argument Recommended Roles
SIMULIA Mechanical Scenario CreationSimMechanicalScenarioCreationGeneral SimGeneralSYE - Structural Analysis EngineerSSU - Structural Mechanics Engineer StructuralSimStructuralThermal SimThermalThermalStructuralSimThermalStructural
SIMULIA Structural Scenario CreationSimStructuralScenarioCreationStructuralSimStructuralSFO - Structural Performance EngineerThermal SimThermalThermalStructuralSimThermalStructural
SIMULIA Linear Structural Scenario Creation SimLinearStructuralScenarioCreationStructuralSimStructuralSLL - Structural EngineerThermal SimThermalSIMULIA Linear Structural ValidationSimLinearStructuralValidationStructuralSimStructuralSRD - Structural DesignerThermal SimThermalFrequencySimFrequencyBuckle SimBuckleDesign Exploration SimDesignExplorationCreationOptimizationSimOptimizationOPZ - Structural Generative Engineer
Version: 2 [Mar 2023]Document updated to remove deprecated method
Physics Results Explorer Object Model MapSee AlsoLegend
Page 231 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 232 ---

Use the GetItem method of the SimResultRepManager object to retrieve theSimResultsManager object.
Dim oSimResultRepManager As SimResultRepManager...Dim oSimResultsManager As SimResultsManagerSet oSimResultsManager = oSimResultRepManager.GetItem("SimResultsManager")
Opening a Simulation DocumentThis article explains how to open the .3dxml or SIM file and retrieve the results analysis case. This can be used to create and manage the results features.
Before you begin: Note that:
lOpening .3dxml file: You should first launch CATIA and then import theCAAScdFeaResults.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lOpening SIM file: You should first launch CATIA. Then open the Physics Results app. Rename the CAAScdFeaSimResults.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed to CAAScdFeaSimResults.SMASim. Then import this file.This use case can be divided in two steps:
1.Retrieving the Sim Results Manager2.Retrieving the Results Analysis Case
1.Retrieving the Sim Results Manager
As a first step, the below code retrieves editor, the simulation reference, the simulation results rep and the sim results manager. 
... 
Dim oEditor As EditorSet oEditor = CATIA.ActiveEditor
Dim oSimulationReference As SimulationReference
Dim oProdService As PLMProductServiceSet oProdService = oEditor.GetService("PLMProductService")
Dim oEntities As PLMEntities
If Not oProdService.EditedContent Is Nothing Then
Set oEntities = oProdService.EditedContent
Dim oEntity As PLMEntityDim oSimObjEntity As PLMEntity
For Each oEntity In oEntitiesIf oEntity.GetCustomType = "SIMObjSimulationObjectGenericDS" Or oEntity.GetCustomType = "DesignSight" Then Set oSimObjEntity = oEntityEnd IfNext
Set oSimulationReference = oSimObjEntity
Dim oSimResults As SimulationResultsSet oSimResults = oSimulationReference.Results
Dim oSimRepresentation As SimulationRepresentationSet oSimRepresentation = oSimResults.Item(1)
Dim oSimRepManager As SimResultRepManagerSet oSimRepManager = oSimRepresentation.Root
Page 232 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 233 ---

Dim oResultsManager As SimResultsManagerSet oResultsManager = oSimRepManager.GetItem("SimResultsManager")
End If...
2.Retrieving the Results Analysis Case
As a first step, the below code retrieves the analysis case from results manager. 
...Dim oResultsAnalysisCases As SimResultsAnalysisCasesSet oResultsAnalysisCases = oResultsManager.ResultsAnalysisCases
Dim oResultsAnalysisCase As SimResultsAnalysisCaseSet oResultsAnalysisCase = oResultsAnalysisCases.Item(1)
...
Opening a Simulation DocumentThis article explains how to open the .3dxml or SIM file and retrieve the results analysis case. This can be used to create and manage the results features.
Before you begin: Note that:
lOpening .3dxml file: You should first launch CATIA and then import theCAAScdFeaResults.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
lOpening SIM file: You should first launch CATIA. Then open the Physics Results app. Rename the CAAScdFeaSimResults.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed to CAAScdFeaSimResults.SMASim. Then import this file.This use case can be divided in two steps:
1.Retrieving the Sim Results Manager2.Retrieving the Results Analysis Case1.Retrieving the Sim Results Manager
As a first step, the below code retrieves editor, the simulation reference, the simulation results rep and the sim results manager. 
... 
import sys, osfrom com3dx import *CATIA = get3dxClient()ENUM = win32com.client.constants
oEditor = CATIA.ActiveEditor
oProdService = oEditor.GetService("PLMProductService")
oEntities = oProdService.EditedContent
oEntity = oEntities.Item(1)
oSimulationRoot = oEntity 
oResults = oSimulationRoot.Results
oSimulationRepRes = oResults.Item(1)  
oRootRepRes = oSimulationRepRes.Root    
oResultsManager = oRootRepRes.GetItem("SimResultsManager")   
...
2.Retrieving the Results Analysis Case
As a first step, the below code retrieves the analysis case from results manager. 
...
oResultsAnalysisCases = oResultsManager.ResultsAnalysisCases
oResultsAnalysisCase = oResultsAnalysisCases.Item(1)...
Retrieving the field and history variablesThis article explains how to get the field and history variable names specified in the output request. It also shows how to retrieve the region and sub regions avaialble for the history output
Where to find the macro: CAAScdFeaResultsGetOutputVariablesSource.htmThis use case can be divided in 5 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the step3.Retrieves the field variables from step4.Retrieves the history variables from step5.Retrieves the region and sub region for history variables
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can use VB_HistoryPlot.SMASimfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API 
Page 233 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 234 ---

CD-ROM is installed. 
On opening the model,Select yes option from the dialogue to activate the results. 
Retrieve the analysis case2.Retrieves the step
This step shows how to get the step from the case.
...
Dim oResultsStepsSet oResultsSteps = oResultsAnalysisCase.ResultsSteps
Dim oResultsStepSet oResultsStep = oResultsSteps.Item(1)...
3.Retrieves the field variables from step
This step shows how to get the field variables from the step. The list of avialable field names will be returned. These variable can then be used to create Plots, Sensors etc.
...
Dim  idFrame  As DoubleidFrame = 0Dim ieSource As SimResultsSourceieSource = SimFieldSourceResults
The available options for SimResultsSource are:SimFieldSourceResults,SimFieldSourceDiagnostic,SimFieldSourcePreLoad,SimFieldSourceHistory
Dim oFieldVariables()oResultsStep.GetAvailableFields idFrame, ieSource, oFieldVariables...
4.Retrieves the history variables from step
This step shows how to get the history variables from the step. The list of avialable history names will be returned. These variable can then be used to create history plots, history sensors. 
...Dim  idFrame  As DoubleodFrame = 0Dim ieSource As SimResultsSourceieSource = SimFieldSourceHistory
Dim oHistoryVariables()oResultsStep.GetAvailableFields idFrame, ieSource, oHistoryVariables...
5.Retrieves the region and sub region for history variables
This step shows how to get the history region and sub region informationfor the given variable. These can be used to specify support while creating the history plot.
...Dim  iVariableString  As StringoVariableString = "U"
Dim oRegionNames() // All the region namesDim oSubRegionIndex() // Number of sub regions per regionDim oSubRegionNames()// Global list of sub regionsoResultsStep.GetHistoryRegionsAndSubRegions 1VariableString, oRegionNames, oSubRegionIndex, oSubRegionNames...
Retrieving the field and history variablesThis article explains how to get the field and history variable names specified in the output request. It also shows how to retrieve the region and sub regions avaialble for the history output
Where to find the macro: CAAScdFeaResultsGetOutputVariablesSourcePython.htmThis use case can be divided in 5 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the step3.Retrieves the field variables from step4.Retrieves the history variables from step5.Retrieves the region and sub region for history variables
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can use VB_HistoryPlot.SMASimfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
On opening the model,Select yes option from the dialogue to activate the results. 
Retrieve the analysis case2.Retrieves the step
Page 234 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 235 ---

This step shows how to get the step from the case.
...
oResultsSteps = oResultsAnalysisCase.ResultsStepsoResultsStep = oResultsSteps.Item(1)...
3.Retrieves the field variables from step
This step shows how to get the field variables from the step. The list of avialable field names will be returned. These variable can then be used to create Plots, Sensors etc.
...
idFrame = 0ieSource = ENUM.SimFieldSourceResults
The available options for SimResultsSource are:SimFieldSourceResults,SimFieldSourceDiagnostic,SimFieldSourcePreLoad,SimFieldSourceHistory
oFieldVariables = oResultsStep.GetAvailableFields (idFrame, ieSource, ())...
4.Retrieves the history variables from step
This step shows how to get the history variables from the step. The list of avialable history names will be returned. These variable can then be used to create history plots, history sensors. 
...odFrame = 0ieSource = ENUM.SimFieldSourceHistoryoHistoryVariables = oResultsStep.GetAvailableFields (idFrame, ieSource, ())...
5.Retrieves the region and sub region for history variables
This step shows how to get the history region and sub region informationfor the given variable. These can be used to specify support while creating the history plot.
...iVariableString = "U"
oRegionNames, oSubRegionIndex, oSubRegionNames = oResultsStep.GetHistoryRegionsAndSubRegions (iVariableString, (), (), ())...
Creating a field plotThis article explains how to retrieve the results features.
This use case can be divided in 9 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the features from the results set3.Identifiers to retrieve the features1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.
Retrieve the analysis case2.Retrieves the features from the results set
In this step we retrieve the results set and then get the features from it.
Dim oResultsSet As SimResultsSetSet oResultsSet = oResultsAnalysisCase.GetSet("FieldPlotSet")
'We can get the feature either by its index or by its name from the results set
'The following step shows how to retrieve the plot by its indexDim oFieldPlot As SimFieldPlotSet oFieldPlot = oResultsSet.Item(1)
'The following step shows how to retrieve the plot by its nameDim oFieldPlot1 As SimFieldPlotSet oFieldPlot1 = oResultsSet.Item("Plot U.1")
3.Identifiers to retrieve the features
Following is the list of string by which the feature sets can be retrieved:
1. "FieldPlotSet"2. "SensorSet"3. "ResultantSensorSet"4. "FrequencySensorSet"5. "BuckleModeSensorSet"6. "HistoryPlotSet"7. "UserCsysSet"8. "EnvelopePlotSet"9. "LLCCombinationPlotSet"
Page 235 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 236 ---

10."DisplayGroupSet"
Creating a field plotThis article explains how to open the results and create a field plot.
Where to find the macro: CAAScdFeaResultsFieldPlotSource.htmThis use case can be divided in 9 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the plot from the results set3.Gets a list of creatable plot Ids from the plot definition4.Creates the field plot through template5.Sets the display group to the plot6.Sets the deformation scale factor7.Retrieves the legend from the plot8.Retrieves the plot type9.Retrieves the step and frame from the plot10.Deletes the plot1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.
Retrieve the analysis case2.Retrieves the plot from the results set
In this step we retrieve the results set and then get the first plot from the results set.
By default the Undeformed plot is the first plot.
...Dim oFieldPlots As SimResultsSetSet oFieldPlots = oResultsAnalysisCase.GetSet("FieldPlot")
Dim oFieldPlot As SimFieldPlotSet oFieldPlot = oFieldPlots.Item(1)...
3.Gets a list of creatable plot Ids from the plot definition
This step shows how to get the creatable plot ids from the plot.
If ilFields is an empty list, the list of existing fields in the model is used.
The returned list of Field Plot Ids is filtered to exclude the Ids of Field Plots referencing fields that are not in the list or fields that are not in the model.
If ibIncludeDefaults is True, include the internal Field Plot definitions in addition to definitions passed to @href #AddField PlotDefinitions.
If ibIncludeUndMesh is True, include the Field Plot Id for the undeformed mesh.
sId is the returned list of Field Plot Id strings.
...Dim ilFields() As VariantDim ibIncludeDefaults As BooleanDim ibIncludeUndMesh As BooleanDim sId() As VariantoResultsAnalysisCase.GetListOfFieldPlotIDs ilFields, ibIncludeDefaults, ibIncludeUndMesh, sId...
4.Creates the field plot through template
This step shows how to create a field plot from the results analysis case retrieved from the earlier step.
...Dim sId As StringsId = "Contour_Stress_Tresca"Dim oPlot As SimFieldPlotSet oPlot = oResultsAnalysisCase.CreateFieldPlotByID(sId, True)...
5.Sets the display group to the plot
The following code sets the already created display groups to the plot.
...'First we retrieve the display group from the results set
Dim oDisplayGroupSet As SimResultsSetSet oDisplayGroupSet = oResultsAnalysisCase.GetSet("DisplayGroupSet")Dim oDisplayGroup As SimDisplayGroupSet oDisplayGroup = oDisplayGroupSet.Item(1)
Dim MyDispatch As CATBaseDispatchSet MyDispatch = oDisplayGroupDim MySupports(0)Set MySupports(0) = MyDispatchoPlot.DisplayGroup = MyDispatch1oPlot.Refresh...
6.Sets the deformation scale factor
The following code sets the deformation scale factor to the plot.
Page 236 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 237 ---

...oPlot.SetDeformationScaleFactors 2, 2, 2...
7.Retrieves the legend from the plot
Here we retrieve the plot legend. 
...Dim oPlotLegend As SimLegendSet oPlotLegend = oPlot.Legend...
8.Retrieves the plot type
More options for setting SimFieldPlotTypes can be found at FieldPlotEnums.
...Dim oPlotType As SimFieldPlotTypesSet oPlotType = oPlot.Type...
9.Retrieves the step and frame from the plot
Following code retrieves the step and frame information from the plot.
...Dim nbFrame As LongSet nbFrame = oPlot.GetCurrentFrame True 
Dim sStep As StringoPlot.GetStepAndFrame sStep, nbframe, 0, False...
10.Deletes the plot
Deletes the plot feature.
...oResultsAnalysisCase.DeleteFeature oPlot
Managing field plot optionsThis article explains how to open the results, retrieve the field plot and modify the rendering options.
Where to find the macro: CAAScdFeaFieldPlotOptionsSource.htmThis use case can be divided in 5 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the existing field plot3.Gets the field plot options from the field plot4.Sets the field plot options5.Updates the field plot1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can useCAAScdFeaResults.3dxmlfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
On opening the model, select "Results" in the action bar to go to Physics Results Explorer. 
Retrieve the analysis case2.Retrieves the existing field plot
This step shows how to get the field plot from the results analysis case retrieved from the earlier step.
...
Dim oFieldPlotsSet oFieldPlots = oResultsAnalysisCase.GetSet("FieldPlots")
Dim oFieldPlot As SimFieldPlotSet oFieldPlot = oFieldPlots.Item(2)...
3.Gets the field plot options from the field plot
This step shows how to get the field plot options from the field plot.
...
Dim  oFieldOptions  As SimFieldPlotOptionsSet oFieldOptions = oFieldPlot.GetItem("SimFieldPlotOptions")...
4.Sets the field plot options
The following code sets the field plot options
...oFieldOptions.SetShowLabels True, True
Page 237 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 238 ---

More options for setting SimThresholdType and SimVisibleEdges can be found at  FieldPlotEnums.
Dim  eThreshold  As SimThresholdTypeeThreshold = SimThresholdUpperLimitoFieldOptions.SetThreshold eThreshold ,15, TRUE
oFieldOptions.Transparency = True
Dim  eVisibleEdges  As SimVisibleEdgeseVisibleEdges = SimOutlineoFieldOptions.SetVisibleEdges SimOutline, 25...
5.Updates the field plot
Following code updates the field plot with new attributes. 
...oFieldOptions.Update...
Retrieving and managing plot legendThis article explains how to retrieve and manage the field plot legend.
Where to find the macro: CAAScdFeaResultsPlotLegendSource.htmThis use case can be divided in 9 steps:
1.Opens the document and retrieves the results analysis case2.Creates the field plot through template3.Retrieves the legend from the plot4.Gets and sets the minimum and maximum value for the legend5.Gets and Sets the color modifiers6.Gets and Sets the legend style7.Gets and sets the number of legend colors8.Sets the number format9.Specifies the animation range
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. 
Retrieve the analysis case2.Creates the field plot through template
This step shows how to create a field plot from the results analysis case retrieved from the earlier step.
...Dim sId As StringsId = "Contour_Stress_Tresca"Dim oPlot As SimFieldPlotSet oPlot = oResultsAnalysisCase.CreateFieldPlotByID(sId, True)...
3.Retrieves the legend form the plot
Here we retrieve the plot legend. 
...Dim oPlotLegend As SimLegendSet oPlotLegend = oPlot.Legend...
4.Gets and sets the minimum and maximum value for the legend
In this step we retrieve the minimum and maximum values for the legend.
...Dim nbMinvalue As doubleDim nbMaxvalue As double
oPlotLegend.SetMinMaxValue 100, 10000, TrueoPlotLegend.GetMinMaxValue nbMinvalue, nbMaxvalue, True, False...
5.Gets and Sets the color modifiers
Following code gets and sets the smooth and inverse colors options.
...Dim bSmooth As booleanDim bInverse As boolean
oPlotLegend.GetColorModifiers bSmooth, bInverseoPlotLegend.SetColorModifiers True, True...
6.Gets and Sets the legend style
The legend styles can be either SMAMpaLegendStyle_Detailed or SMAMpaLegendStyle_Simplified.
...Dim sStyle As StringsStyle = oPlotLegend.Style oPlotLegend.Style = "SMAMpaLegendStyle_Detailed"...
Page 238 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 239 ---

7.Gets and sets the number of legend colors
In the following code we get and set the number of colors for the legend.
...Dim nbColors As LongnbColors = oPlotLegend.NbColorsoPlotLegend.NbColors = nbColors * 2...
8.Sets the number format
The below code sets the numerical format used for result values to scientific. The various options are 
Automatic = 0, Scientific = 1, Decimal = 2
...                                                                              oPlotLegend.NumberFormat = 1                                                                                               ...
9.Specifies the animation range
Sets the legend animation range.
...oPlotLegend.StartAnimationRange 200, 5000, True...
Configuring multiviews and adding plots to itThis article explains how to configure multiviews and add plots to it.
Where to find the macro: CAAScdFeaResultsMultiViewSource.htmThis use case can be divided in 6 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the multi view manager3.Retrieves the plots list from the analysis case4.Applies the given multi view configuration to current viewer5.Adds a plot in multi view configuration at given position6.Sets the synchronization mode for viewpoints
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can useVB_Composite_Analysis.SMASim file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed.
Before proceding further,create 3 plots and make undeformed plot as an active plot.
Retrieve the analysis case2.Retrieves the multi view manager
This step shows how to retrieve the multi view manager.
...Dim MultiViewManager  As SimMultiViewSet MultiViewManager = oResultsManager.MultiViewManager...
3.Retrieves the plots list from the analysis case
This step shows how to get list of plots from the analysis case. 
...Dim oFieldPlots  As SimResultsSetSet oFieldPlots = oResultsAnalysisCase.GetSet("FieldPlots")
Dim iPos   As Integer iPos = 1
Dim oFieldPlot   As SimFieldPlotSet oFieldPlot = oFieldPlots.Item(2)...
4.Applies the given multi view configuration to current viewer
In this step we apply the multi view configuration to the current viewer.
The available configurations are:
* SimVPFourSquare to apply four views (2x2).
* SimVPTriLeft to apply four views with three views on left and one main view on right. 
* SimVPTriBottom to apply four views with three views on bottom and one main view on top. 
* SimVPTwoRow to apply two views top and bottom. 
* SimVPTwoColumn to apply two views left and right. 
* SimVPSingle to apply default single view.
Page 239 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 240 ---

...
 MultiViewManager.Configuration = SimVPFourSquare...
5.Adds a plot in multi view configuration at given position
Following code shows how to add plot in multi view configuration at given position.
iPos is the position at which the plot has to be added.
Following are the iPos values to be used for various configurations.
* VPFourSquare 1-Top left, 2- Top right, 3-Bottom left, 4-Bottom right.
* VPTriLeft 1- Main view on right, 2-Top left, 3-Left middle, 4- Bottom left.
* VPTriBottom 1-Top main view, 2- Bottom left, 3-Bottom middle, 4- Bottom right.
* VPTwoRow 1- Top, 2- Bottom.
* VPTwoColumn 1- Left, 2-Right.
...
 iPos = 2Set oFieldPlot = oFieldPlots.Item(3)MultiViewManager.AddPlot oFieldPlot, iPos
iPos = 4Set oFieldPlot = oFieldPlots.Item(4)MultiViewManager.AddPlot oFieldPlot, iPos...
6.Sets the synchronization mode for viewpoints
Setting synchronization mode TRUE will propagate actions performed such as Pan, Zoom, Rotate in one viewpoint to other viewpoints.
Setting synchronization mode FALSE will allow actions performed such as Pan, Zoom, Rotate in only one viewpoint.
Following code sets the synchronization mode for viewpoints.
...MultiViewManager.Synchronize = False...
Creating a history plotThis article explains how to open the results and create a history plot.
Where to find the macro: CAAScdFeaResultsHistoryPlotSource.htmThis use case can be divided in 13 steps:
1.Opens the document and retrieves the results analysis case2.Creates the history plot3.Get the step Id ,name and step description4.Sets the attributes to the history plot5.Sets the support for the history plot6.Sets step, frame and load case information7.Sets the complex type and angle8.Sets name to history plot9.Updates the history plot10.Returns the minimum and maximum values11.Gets the list of curves present in the history plot12.Exports the curve values in the specified file format13.Returns the minimum and maximum values of the curve
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can useVB_HistoryPlot.SMASimfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
On opening the model,Select yes option from the dialogue to activate the results. 
Retrieve the analysis case2.Creates the history plot
This step shows how to create a history plot from the results analysis case retrieved from the earlier step.
...Dim oHistoryPlot1Set oHistoryPlot1 = oResultsAnalysisCase.CreateHistoryPlot...
3.Get the step Id ,name and step description
This step shows how to get the step Id,name and step description.
...dim  oSteps  As SimResultsStepsSet  oSteps = oResultsAnalysisCase.ResultsSteps
Page 240 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 241 ---

dim   oResultsStep As SimResultsStepSet oResultsStep = oSteps.Item(1)
dim  stepId As Stringdim  stepName As Stringdim  stepDescription As String
 oResultsStep.GetIdentifier stepId, stepName, stepDescription
...
4.Sets the attributes to the history plot
The following code sets the history plot attributes.In this step we set the history plot attributes.More options for history plot attributes can be found at HistoryplotEnums
...oHistoryPlot1.Variable = "UT"oHistoryPlot1.ComponentQuantity = SimVector_Component_1...
5.Sets the support for the history plot.
The following code sets support for creating the history plot such as regions and sub-regions. If user wants to select the whole model, no need to call this method. 
...
    Dim MySupports(0)    MySupports(0) = "INP2SIM_NSET_Nodal Probe2"
    Dim MySupports1(0)    MySupports1(0) = 3
    Dim MySupports2(2)    MySupports2(0) = "Node 4"    MySupports2(1) = "Node 36"    MySupports2(2) = "Node 87"
    oHistoryPlot1.SetSupport  MySupports, MySupports1,  MySupports2...
6.Sets the step, frame and load case information
Following code sets the step,frame and load case information.
stepId is the persistent ID of the step.
The Frame index starts from 1. This option is needed only in case of multiple load cases.In the following code we have used 0 as the frame index.
The load case index starts from 1. It is needed if a load case is present in the step.In the following code we have used 0 as the load case index. 
...oHistoryPlot1.SetStepAndFrame stepId, 0, 0...
Using following code we can set all available time based steps.
...oHistoryPlot1.SetAllTimeBasedSteps  ...
7.Sets the complex type and angle
Following code sets the complex type and angle.The complex options are dependent on the complex options that are set while creating the step. 
More options for setting SimComplexValues can be found at HistoryplotEnums.
...Dim ieComplexValue  As SimComplexValuesieComplexValue = SimEnvelopeMax
Dim iValueAtAngle  As doubleiValueAtAngle = 30
oHistoryPlot1.SetComplex  ieComplexValue, iValueAtAngle...
8.Sets name to history plot
Following code sets the name to history plot.
... oHistoryPlot1.Name = "Test History Plot 1"...
9.Updates the history plot
Following code creates and displays the history plot in the XY viewer.This method needs to be called at the end after setting the attributes. 
...oHistoryPlot1.Update...
10.Returns the minimum and maximum values. 
This step returns the minimum and maximum values. It considers all the curves and gives the absolute min and max value. 
Page 241 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 242 ---

...Dim dMin  As DoubleDim dMax  As Double
oHistoryPlot1.GetMinMaxValues dMin, dMax 
11.Gets the list of curves present in the history plot
Following code returns the list of curves present in the history plot. 
...Dim olsHistoryCurves  As CATSafeArrayVariantoHistoryPlot1.GetHistoryCurveList olsHistoryCurves...
12.Exports the curve values in the specified file format either to disc or in the database as a VPMDocument
(a) Saving the file on disc: 
Following code exports the curve values in the specified file format at the given location.
icsFileName is the file name. If not specified, the name of the curve will be taken by default.
icsFileLocation is the The location at which the exported file needs to be created.
More options for setting ieFileType can be found at HistoryplotEnums.
...
Dim icsFileName  As StringicsFileName = "ExportedHistCurve"
Dim icsFileLocation  As String icsFileLocation="C:\temp" 
Dim ieFileType  As SimFileTypeieFileType = SimXlsx
Dim oHistoryCurve1   As SimHistoryCurveSet oHistoryCurve1 = olsHistoryCurves.Item(1)                           
oHistoryCurve1.Export icsFileName,icsFileLocation,ieFileType...
(b) Saving the file in data base as a VPMDocument: 
Following code exports the curve values in the specified file format in the data base.
icsFileName is the file name. If not specified, the name of the curve will be taken by default.
More options for setting ieFileType can be found at HistoryplotEnums.
...Dim icsFileName  As StringicsFileName = "ExportedHistCurve"
Dim ieFileType  As SimFileTypeieFileType = SimCsv
Dim oHistoryCurve1   As SimHistoryCurveSet oHistoryCurve1 = olsHistoryCurves.Item(1)   
oHistoryCurve1.ExportToPLMDoc icsFileName,ieFileType...
Note: The user will have save the document/session to see the exported file in the database.
13.Returns the minimum and maximum values of the curve 
This step returns the minimum and maximum values of the curve. 
...Dim dMin  As DoubleDim dMax  As Double
oHistoryCurve1.GetMinMaxValues dMin, dMax 
Creating a history plotThis article explains how to open the results and create a history plot.
Where to find the macro: CAAScdFeaResultsHistoryPlotSourcePython.htm
This use case can be divided in 13 steps:
1.Opens the document and retrieves the results analysis case2.Creates the history plot3.Get the step Id ,name and step description4.Sets the attributes to the history plot5.Sets the support for the history plot6.Sets step, frame and load case information7.Sets the complex type and angle8.Sets name to history plot9.Updates the history plot10.Returns the minimum and maximum values11.Gets the list of curves present in the history plot
Page 242 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 243 ---

12.Exports the curve values in the specified file format13.Returns the minimum and maximum values of the curve
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can useVB_HistoryPlot.SMASimfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
On opening the model,Select yes option from the dialogue to activate the results. 
Retrieve the analysis case2.Creates the history plot
This step shows how to create a history plot from the results analysis case retrieved from the earlier step.
...
oHistoryPlot1 = oResultsAnalysisCase.CreateHistoryPlot()...
3.Get the step Id ,name and step description
This step shows how to get the step Id,name and step description.
...
oSteps = oResultsAnalysisCase.ResultsSteps
oResultsStep = oSteps.Item(1)
stepId, stepName, stepDescription = oResultsStep.GetIdentifier ((), (), ())
...
4.Sets the attributes to the history plot
The following code sets the history plot attributes.In this step we set the history plot attributes.More options for history plot attributes can be found at HistoryplotEnums
...oHistoryPlot1.Variable = ("UT")oHistoryPlot1.ComponentQuantity = ENUM.SimVector_Component_1...
5.Sets the support for the history plot.
The following code sets support for creating the history plot such as regions and sub-regions. If user wants to select the whole model, no need to call this method. 
...
MySupports = ["INP2SIM_NSET_Nodal Probe2"]MySupports1 = [3]MySupports2 = ["Node 4", "Node 36", "Node 87"]
oHistoryPlot1.SetSupport  (MySupports, MySupports1,  MySupports2)...
6.Sets the step, frame and load case information
Following code sets the step,frame and load case information.
stepId is the persistent ID of the step.
The Frame index starts from 1. This option is needed only in case of multiple load cases.In the following code we have used 0 as the frame index.
The load case index starts from 1. It is needed if a load case is present in the step.In the following code we have used 0 as the load case index. 
...oHistoryPlot1.SetStepAndFrame (stepId, 0, 0)...
Using following code we can set all available time based steps.
...oHistoryPlot1.SetAllTimeBasedSteps()...
7.Sets the complex type and angle
Following code sets the complex type and angle.The complex options are dependent on the complex options that are set while creating the step. 
More options for setting SimComplexValues can be found at HistoryplotEnums.
...
ieComplexValue = ENUM.SimEnvelopeMaxiValueAtAngle = 30
oHistoryPlot1.SetComplex  (ieComplexValue, iValueAtAngle)...
8.Sets name to history plot
Following code sets the name to history plot.
Page 243 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 244 ---

... oHistoryPlot1.Name = ("Test History Plot 1")...
9.Updates the history plot
Following code creates and displays the history plot in the XY viewer.This method needs to be called at the end after setting the attributes. 
...oHistoryPlot1.Update()...
10.Returns the minimum and maximum values. 
This step returns the minimum and maximum values. It considers all the curves and gives the absolute min and max value. 
...
dMin, dMax = oHistoryPlot1.GetMinMaxValues (0, 0) 
11.Gets the list of curves present in the history plot
Following code returns the list of curves present in the history plot. 
...oHistCurveList = oHistoryPlot1.GetHistoryCurveList (())oHistCurve = oHistCurveList[0]...
12.Exports the curve values in the specified file format either to disc or in the database as a VPMDocument
(a) Saving the file on disc: 
Following code exports the curve values in the specified file format at the given location.
icsFileName is the file name. If not specified, the name of the curve will be taken by default.
icsFileLocation is the The location at which the exported file needs to be created.
More options for setting ieFileType can be found at HistoryplotEnums.
...
iFileName = "History_Curve1"iFileLocation="C:\\temp"oHistCurve.Export (iFileName, iFileLocation, ENUM.SimXlsx)
...
(b) Saving the file in data base as a VPMDocument:
Following code exports the curve values in the specified file format in the data base.
icsFileName is the file name. If not specified, the name of the curve will be taken by default.
More options for setting ieFileType can be found at HistoryplotEnums.
...
oHistCurve1 = oHistCurveList[1]iFileName1 = "History_Curve_PLM"oHistCurve1.ExportToPLMDoc (iFileName1, ENUM.SimCsv)
...
Note: The user will have save the document/session to see the exported file in the database.
13.Returns the minimum and maximum values of the curve 
This step returns the minimum and maximum values of the curve. 
...
dMin, dMax = oHistoryCurve1.GetMinMaxValues (0, 0 )
Creating a sensorThis article explains how to open the results and create a sensor.
Before you begin: Note that:
lOpening .3dxml file: You should first launch CATIA and then import theCAAScdFeaResultsMultiLoadCase.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. Where to find the macro: CAAScdFeaResultsSensorSource.htm
This use case can be divided in 11 steps:
1.Opens the document and retrieves the results analysis case2.Creates the sensor3.Sets the attributes to the sensor4.Sets the axis to the sensor5.Sets support to the sensor6.Creates the frame selection7.Sets the frame selection attributes
Page 244 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 245 ---

8.Sets the frame selection in the sensor9.Sets the sensor parameters10.Updates the sensor11.Retrieves the sensor12.Show annotation on the sensor
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. 
Retrieve the analysis case2.Creates the sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...Dim oLocalSensor As SimSensorSet oLocalSensor = oResultsAnalysisCase.CreateSensor...
Creates the sensor by Id
Creates a sensor using field plot definition defined in XML description library files. It takes input as the ID of the Field Plot as specified in the XML file as sensor ID.
if this method is used no need to set the sensor attributes mentioned in Step 3. 
we can use the GetListOfFieldPlotIDs of ResultsAnalysisCase to get the list of plot ids.This plot ids can be used to create the sensor.
...Dim csSensorID As String
Dim oLocalSensor As SimSensorSet oLocalSensor = oResultsAnalysisCase.CreateSensorByID csSensorID...
3.Sets the attributes to the sensor
The following code sets the sensor attributes.
...oLocalSensor.VariableType = "S"oLocalSensor.ProcessingType = SimQuantityoLocalSensor.ComplexValue = SimValueAtAngleoLocalSensor.Location = SimCentroidsoLocalSensor.ComplexValueAtAngle = 10oLocalSensor.TransformType = SimUserModelAxisoLocalSensor.QuantityType = "Mid Principal"...
4.Sets the axis to the sensor
There are three ways in which we can set the axis as a transformation. 
a) Using the axes available in the SIM: The exact name of the coordinate system needs to be specified....oLocalSensor.TransformType = SimUserDefinedoLocalSensor.CoordinateSystem = "Orientation-Rib02--1-1"...
b) The User Csys created in Physics results:...
Dim oResultsCsysSet As SimResultsSetSet oResultsCsysSet = oResultsAnalysisCase.GetSet("UserCsysSet")Dim oUserCsys As SimUserCsysSet oUserCsys = oResultsCsysSet.Item(1)
oLocalSensor.TransformType = SimUserDefinedDim oAxisSystemAxis As SimResultsAxisSystemAccessSet oAxisSystemAxis = oLocalSensor.GetItem("SimResultsAxisSystemAccess")
oAxisSystemAxis.Axis = oUserCsys...
c) The model axes created at the product level: First the axis needs to be retrieved from the product, then set it to the sensor as below. Refer the sample script to see how to retrieve axis from the product....oLocalSensor.TransformType = SimUserModelAxis
Set AxisSystems = MyPart.AxisSystemsSet AxisSystem = AxisSystems.Item(2)
Dim oAxisSystemAxis As SimResultsAxisSystemAccessSet oAxisSystemAxis = oLocalSensor.GetItem("SimResultsAxisSystemAccess")oAxisSystemAxis.Axis = AxisSystem...
Note: For setting the axis call the "TransformType" and "QuantityType" in the same order as specified in Step 3. The TransformType must be called before the QuantityType
5.Sets support to the sensor
Here we set named display group as a support to the sensor. 
...
'First we retrieve the display group from the results setDim oDisplayGroupSet As SimResultsSetSet oDisplayGroupSet = oResultsAnalysisCase.GetSet("DisplayGroupSet")
Page 245 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 246 ---

Dim oDisplayGroup As SimDisplayGroupSet oDisplayGroup = oDisplayGroupSet.Item(1)
Dim MyDispatch As CATBaseDispatchSet MyDispatch = oDisplayGroup
Dim MySupports(0)Set MySupports(0) = MyDispatch
LocalSensor.Support = MySupports
...
6.Creates the frame selection
Here we create a frame selection object. 
...Dim oFrameSelector As SimFramesSelectionSet oFrameSelector = oResultsAnalysisCase.CreateFrameSelector...
7.Sets the frame selection attributes
In this step we set the frame selection attributes. More options for frames selection can be found at Frames Selection
...a) Setting pre defined frame selection enumns in the sensor:
    oFrameSelector.SymbolicFrameRange = SimAllFrames
b) Setting custom frame selection to the sensor:
1) Retrieving the Step ID and setting it to the frame selector Dim oResultsSteps As SimResultsStepsSet oResultsSteps = ResultsAnalysisCase.ResultsSteps
Dim oResultsStep As SimResultsStepSet oResultsStep = oResultsSteps.Item(2)
Dim sID As StringDim sStepName As StringDim sStepName As StringDim sDescription As StringoResultsStep.GetIdentifier sID, sStepName, sDescriptionDim lsStepID(0)lsStepID(0) = sID
FrameSelector.StepList = lsStepID
2) Retrieving the Load case ID and setting it to the frame selectorNote: It is mandatory to set the Load Case, if the selected step has one.
Dim oGlobalLoadCaseIDList()Dim oGlobalLoadCaseIDNames()Dim oLoadCaseIDListInStep()
The following method returns all the Load case ID avaialble in the case. The order of the list is the same as the user has created theload case. One can get the indices of the Load case available in that step using GetLoadCases() method as shown belowoResultsManager.GetLoadCaseIdentifier oGlobalLoadCaseIDList, oGlobalLoadCaseIDNamesoResultsStep.GetLoadCases oLoadCaseIDListInStepDim iLCItendifierString As StringDim iLoadCaseIDListToSet(0)
iLCItendifierString = oGlobalLoadCaseIDList(0)iLoadCaseIDListToSet(0) = iLCItendifierStringDim iLCInSteps(0)iLCInSteps(0) = 1oFrameSelector.SetLoadCases iLCInSteps, iLoadCaseIDListToSet
3) Setting the frames to the frame selectorNote: One can use the SimResultsStep::GetFramesData() method to get the frames data for the step
Dim iFramesInLC(0)iFramesInLC(0) = 2Dim oGlobalLoadCaseIDNames()Dim oLoadCaseIDListInStep()
Dim iFrameIndex(1)iFrameIndex(0) = 0iFrameIndex(1) = 1oFrameSelector.SetFrames iFramesInLC, iFrameIndex
The following method must be called at the end after setting the Step, LC and Frame information.
oLocalSensor.FrameSelector = oFrameSelector
...
8.Sets the frame selection in the sensor
Following code sets the frame selection in the sensor.
...oLocalSensor.FrameSelector = oFrameSelector...
9.Sets the sensor parameters
Here we set the sensor parameters such as Max, Min, Absolute Max, Parameter for each step and Parameter for each frame or load case.
...oLocalSensor.SetParameters True,True,True,False,False  
Page 246 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 247 ---

The following steps shows how to set the Sum and Average parameters:
Dim oSensorOption As SimSensorOptionsSet oLocalSensor.GetItem("SimSensorOptions")
oSensorOption.SetSumParameter TrueoSensorOption.SetAverageParameter True...
10.Updates the sensor
Following code updates the sensor.
...oLocalSensor.Update...
11.Retrieves the sensor
This step shows how to retrieve the sensor from the results analysis case using the results set.
...Dim oResultSet As SimResultsSetSet oResultSet = oResultsAnalysisCase.GetSet("SensorSet")
Dim oRetrievedSensor As SimSensor
The sensor can be retrieved from the results set by following two ways:a) Index:Set oRetrievedSensor = oResultSet.Item(1) 
b) Name:Set oRetrievedSensor = oResultSet.Item("Sensor S.1")...
12.Show annotation on the sensor
Following shows annotation on the sensor. The annotation contains information regarding the step, frame and parameter values
...oRetrievedSensor.Annotation = True...
Creating a sensorThis article explains how to open the results and create a sensor.
Before you begin: Note that:
lOpening .3dxml file: You should first launch CATIA and then import theCAAScdFeaResultsMultiLoadCase.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. Where to find the macro: CAAScdFeaResultsSensorSource.htmThis use case can be divided in 11 steps:
1.Opens the document and retrieves the results analysis case2.Creates the sensor3.Sets the attributes to the sensor4.Sets the axis to the sensor5.Creates the frame selection6.Sets the frame selection in the sensor7.Sets the sensor parameters8.Updates the sensor9.Show annotation on the sensor
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. 
Retrieve the analysis case2.Creates the sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...oLocalSensor = oResultsAnalysisCase.CreateSensor()...
Creates the sensor by Id
Creates a sensor using field plot definition defined in XML description library files. It takes input as the ID of the Field Plot as specified in the XML file as sensor ID.
if this method is used no need to set the sensor attributes mentioned in Step 3. 
we can use the GetListOfFieldPlotIDs of ResultsAnalysisCase to get the list of plot ids.This plot ids can be used to create the sensor.
...oLocalSensor = oResultsAnalysisCase.CreateSensorByID (csSensorID)...
3.Sets the attributes to the sensor
The following code sets the sensor attributes.
Page 247 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 248 ---

...oLocalSensor.VariableType = ("S")oLocalSensor.ProcessingType = ENUM.SimQuantityoLocalSensor.Location = ENUM.SimCentroidsoLocalSensor.TransformType = ENUM.SimUserModelAxisoLocalSensor.QuantityType = ("Tensor Component 11")...
4.Sets the axis to the sensor
There are three ways in which we can set the axis as a transformation. 
a) Using the axes available in the SIM: The exact name of the coordinate system needs to be specified....oLocalSensor.TransformType = SimUserDefinedoLocalSensor.CoordinateSystem = "Orientation-Rib02--1-1"...
b) The User Csys created in Physics results:...oResultsCsysSet = oResultsAnalysisCase.GetSet("UserCsysSet")oUserCsys = oResultsCsysSet.Item(1)
oLocalSensor.TransformType = SimUserDefinedoAxisSystemAxis = oLocalSensor.GetItem("SimResultsAxisSystemAccess")
oAxisSystemAxis.Axis = oUserCsys...
c) The model axes created at the product level: First the axis needs to be retrieved from the product, then set it to the sensor as below. Refer the sample script to see how to retrieve axis from the product....oLocalSensor.TransformType = SimUserModelAxis
AxisSystems = MyPart.AxisSystemsAxisSystem = AxisSystems.Item(2)
oAxisSystemAxis = oLocalSensor.GetItem("SimResultsAxisSystemAccess")oAxisSystemAxis.Axis = AxisSystem...
Note: For setting the axis call the "TransformType" and "QuantityType" in the same order as specified in Step 3. The TransformType must be called before the QuantityType
5.Creates the frame selection
Here we create a frame selection object. 
...oFrameSelector = oResultsAnalysisCase.CreateFrameSelector()...
6.Sets the frame selection attributes
In this step we set the frame selection attributes. More options for frames selection can be found at Frames Selection
...a) Setting pre defined frame selection enumns in the sensor:
    oFrameSelector.SymbolicFrameRange = SimAllFrames
b) Setting custom frame selection to the sensor:
1) Retrieving the Step ID and setting it to the frame selector oResultsSteps = ResultsAnalysisCase.ResultsSteps
oResultsStep = oResultsSteps.Item(2)
sID, sStepName, sDescription = oResultsStep.GetIdentifier ("", "", "")lsStepID = [sID]
FrameSelector.StepList = lsStepID
2) Retrieving the Load case ID and setting it to the frame selectorNote: It is mandatory to set the Load Case, if the selected step has one.
The following method returns all the Load case ID avaialble in the case. The order of the list is the same as the user has created theload case. One can get the indices of the Load case available in that step using GetLoadCases() method as shown belowoResultsManager.GetLoadCaseIdentifier oGlobalLoadCaseIDList, oGlobalLoadCaseIDNamesoResultsStep.GetLoadCases oLoadCaseIDListInStep
iLCItendifierString = oGlobalLoadCaseIDList[0]iLCInSteps = [1]oFrameSelector.SetLoadCases (iLCInSteps, iLCItendifierString)
3) Setting the frames to the frame selectorNote: One can use the SimResultsStep::GetFramesData() method to get the frames data for the step
iFramesInLC = [2]iFrameIndex = [0,1]oFrameSelector.SetFrames iFramesInLC, iFrameIndex
The following method must be called at the end after setting the Step, LC and Frame information.
oLocalSensor.FrameSelector = oFrameSelector
...
7.Sets the frame selection in the sensor
Following code sets the frame selection in the sensor.
...
Page 248 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 249 ---

oLocalSensor.FrameSelector = oFrameSelector...
8.Sets the sensor parameters
Here we set the sensor parameters such as Max, Min, Absolute Max, Parameter for each step and Parameter for each frame or load case.
...oLocalSensor.SetParameters (True,True,True,False,False)
The following steps shows how to set the Sum and Average parameters:
oSensorOption = GetItem("SimSensorOptions")
oSensorOption.SetSumParameter (True)oSensorOption.SetAverageParameter (True)...
9.Updates the sensor
Following code updates the sensor.
...oLocalSensor.Update()...
10.Show annotation on the sensor
Following shows annotation on the sensor. The annotation contains information regarding the step, frame and parameter values
...oLocalSensor.Annotation = True...
Creating a resultant sensorThis article explains how to open the results and create a resultant sensor.
Where to find the macro: CAAScdFeaResultsResultantSensorSource.htmThis use case can be divided in 6 steps:
1.Opens the document and retrieves the results analysis case 2.Creates the sensor3.Sets step and frame4.Sets the support for the sensor5.Updates the sensor6.Exports the sensor7.Retrieves the sensor
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. 
Retrieve the analysis case2.Creates the sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...Dim oResultantSensor As SimResultantSensorSet oResultantSensor = oResultsAnalysisCase.CreateResultantSensor...
3.Sets step and frame
The following code sets the step and frame.
...Dim oSteps  As SimResultsStepsSet oSteps = oResultsAnalysisCase.ResultsSteps
Dim oStep   As SimResultsStepSet oStep = oSteps.Item(1)
Dim osStepID    As StringDim ocsStepName    As StringDim ocsStepDescription    As String
oStep.GetIdentifier osStepID, ocsStepName, ocsStepDescriptionoResultantSensor.SetStepAndFrame osStepID, 1, 0...
4.Sets the support for the sensor
In this step the support for the sensor is specified. The API and input for orphan and native simulations is different as explained below: 
a) Orphan simulation: The SimSupport method should be used to set the support. It takes the input values as list of strings which are the names of the node sets. 
...Dim MySupports(0)MySupports(0) = "Clamp1"
oResultantSensor.SimSupport = MySupports...
Page 249 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 250 ---

b) Native simulation: The Support method is used to set the support. It takes input as list of features such as restraints, loads.
Find here CAAScdFeaResultsNativeResultantSensorSource the sample script.
...Dim oDispatch As CATBaseDispatchSet oDispatch = oPressure
Dim MySupports(0) As CATSafeArrayVariantSet MySupports(0) = oDispatch
oResultantSensor.Support = MySupports...
Important note: The above code where the CATSafeArrayVariant is used works fine in CATScript. But for VBScript and VBA, one must un-type the variable which calls the support method. Thus in the above code "oResultantSensor" variable must be un-typed. Thus in Step 2, the variable must be be declared without its class type as stated below:
Dim oResultantSensor
For further details on usage of Arrays please refer to : About Microsoft Automation Languages, Debug, and Compatibility
5.Updates the sensor
Following code updates the sensor.
...oResultantSensor.Update...
6.Exports the sensor
The sensor can be exported to csv file either on disk or as a PLM document.
...
(a) Saving the file on disk: User can specify mulitple sensors which will be exported in a single file. 
Dim olsSensors(0)  As CATSafeArrayVariantSet olsSensors(0) = oResultantSensor
Dim icsFileName  As StringicsFileName = "ExportedSensor"
Dim icsFileLocation  As String icsFileLocation="C:\temp" 
Dim ieFileType  As SimFileTypeieFileType = SimXlsx
Note: The following boolean specified if the axis direction is to be exported
Dim bActivate  As BooleanbActivate = True
oResultsAnalysisCase.ExportSensorOutputToFile olsSensors, icsFileName, icsFileLocation, ieFileType, True, SimComma
(b) Saving as a PLM document: Only 1 sensor can be exported at a time.
Dim olsSensors(0)  As CATSafeArrayVariantSet olsSensors(0) = oResultantSensor
Dim icsFileName  As StringicsFileName = "ExportedSensor"
Dim ieFileType  As SimFileTypeieFileType = SimXlsx
Note: The following boolean specified if the axis direction is to be exported
Dim bActivate  As BooleanbActivate = True
oResultsAnalysisCase.ExportSensorOutputToPLM olsSensors, icsFileName, SimCsv, False, SimSemicolan
...
7.Retrieves the sensor
This step shows how to retrieve the sensor from the results analysis case using the results set.
...Dim oResultSet As SimResultsSetSet oResultSet = oResultsAnalysisCase.GetSet("ResultantSensorSet")
Dim oRetrievedSensor As SimResultantSensor
The sensor can be retrieved from the results set by following two ways:a) Index:Set oRetrievedSensor = oResultSet.Item(1) 
b) Name:Set oRetrievedSensor = oResultSet.Item("Resultant Sensor.1")...
Creating a resultant sensor
Page 250 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 251 ---

This article explains how to open the results and create a resultant sensor.
Where to find the macro: CAAScdFeaResultsResultantSensorSourcePython.htmThis use case can be divided in 6 steps:
1.Opens the document and retrieves the results analysis case2.Creates the sensor3.Sets step and frame4.Sets the support for the sensor5.Updates the sensor1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.
Retrieve the analysis case2.Creates the sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...oResultantSensor = oResultsAnalysisCase.CreateResultantSensor()...
3.Sets step and frame
The following code sets the step and frame.
...oSteps = oResultsAnalysisCase.ResultsStepsoStep = oSteps.Item(1)
stepId, stepName, stepDescription = oStep.GetIdentifier ((), (), ())
oResultantSensor.SetStepAndFrame (stepId, 1, 0)...
4.Sets the support for the sensor
In this step the support for the sensor is specified. The API and input for orphan and native simulations is different as explained below: 
a) Orphan simulation: The SimSupport method should be used to set the support. It takes the input values as list of strings which are the names of the node sets. 
...MySupports = ["Clamp1"]
oResultantSensor.SimSupport = (MySupports)...
b) Native simulation: The Support method is used to set the support. It takes input as list of features such as restraints, loads.
Find here CAAScdFeaResultsNativeResultantSensorSourcePython the sample script.
...oDispatch = oPressure
MySupports(0) = oDispatch
oResultantSensor.Support = (MySupports)...
Important note: The above code where the CATSafeArrayVariant is used works fine in CATScript. But for VBScript and VBA, one must un-type the variable which calls the support method. Thus in the above code "oResultantSensor" variable must be un-typed. Thus in Step 2, the variable must be be declared without its class type as stated below:
For further details on usage of Arrays please refer to : About Microsoft Automation Languages, Debug, and Compatibility
5.Updates the sensor
Following code updates the sensor.
...oResultantSensor.Update...
Creating a frequency sensorThis article explains how to open the results and create a frequency sensor.
Where to find the macro: CAAScdFeaResultsFrequencySensorSource.htmThis use case can be divided in 7 steps:
1.Opens the document and retrieves the results analysis case2.Creates a frequency sensor3.Creates the frame selection4.Sets the frame selection attributes5.Sets the frame selection in the sensor6.Updates the sensor7.Retrieves the sensor
Page 251 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 252 ---

1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.
Retrieve the analysis case2.Creates a frequency sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...Dim oFrequencySensor As SimFrequencySensorSet oFrequencySensor = oResultsAnalysisCase.CreateFrequencySensor...
3.Creates the frame selection
Here we create a frame selection object. 
...Dim oFrameSelector As SimFramesSelectionSet oFrameSelector = oResultsAnalysisCase.CreateFrameSelector...
4.Sets the frame selection attributes
In this step we set the frame selection attributes. More options for frames selection can be found at Frames Selection
...oFrameSelector.SymbolicFrameRange = SimFrequencyFrames...
5.Sets the frame selection in the sensor
Following code sets the frame selection in the sensor.
...oFrequencySensor.FrameSelector = oFrameSelector...
6.Updates the sensor
Following code updates the sensor.
...oFrequencySensor.Update...
7.Retrieves the sensor
This step shows how to retrieve the sensor from the results analysis case using the results set.
...Dim oResultSet As SimResultsSetSet oResultSet = oResultsAnalysisCase.GetSet("FrequencySensorSet")
Dim oRetrievedSensor As SimFrequencySensor
The sensor can be retrieved from the results set by following two ways:a) Index:Set oRetrievedSensor = oResultSet.Item(1) 
b) Name:Set oRetrievedSensor = oResultSet.Item("Frequency Sensor.1")...
Creating a frequency sensorThis article explains how to open the results and create a frequency sensor.
Where to find the macro: CAAScdFeaResultsFrequencySensorSourcePython.htmThis use case can be divided in 7 steps:
1.Opens the document and retrieves the results analysis case2.Creates a frequency sensor3.Creates the frame selection4.Sets the frame selection attributes5.Sets the frame selection in the sensor6.Updates the sensor
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.
Retrieve the analysis case2.Creates a frequency sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...oFrequencySensor = oResultsAnalysisCase.CreateFrequencySensor...
3.Creates the frame selection
Page 252 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 253 ---

Here we create a frame selection object. 
...oFrameSelector = oResultsAnalysisCase.CreateFrameSelector()...
4.Sets the frame selection attributes
In this step we set the frame selection attributes. More options for frames selection can be found at Frames Selection
...oFrameSelector.SymbolicFrameRange = ENUM.SimFrequencyFrames...
5.Sets the frame selection in the sensor
Following code sets the frame selection in the sensor.
...oFrequencySensor.FrameSelector = oFrameSelector...
6.Updates the sensor
Following code updates the sensor.
...oFrequencySensor.Update()...
Creating a buckle mode sensorThis article explains how to open the results and create a buckle mode sensor.
Where to find the macro: CAAScdFeaResultsBuckleModeSensorSource.htmThis use case can be divided in 7 steps:
1.Opens the document and retrieves the results analysis case2.Creates a buckle mode sensor3.Creates the frame selection4.Sets the frame selection attributes5.Sets the frame selection in the sensor6.Updates the sensor7.Retrieves the sensor
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. You can use VB_Buckle_Mode_Sensor.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed.
Retrieve the analysis case2.Creates a buckle mode sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...Dim oBuckleModeSensor As SimBuckleModeSensorSet oBuckleModeSensor = oResultsAnalysisCase.CreateBuckleModeSensor...
3.Creates the frame selection
Here we create a frame selection object. 
...Dim oFrameSelector As SimFramesSelectionSet oFrameSelector = oResultsAnalysisCase.CreateFrameSelector...
4.Sets the frame selection attributes
In this step we set the frame selection attributes. More options for frames selection can be found at Frames Selection
...oFrameSelector.SymbolicFrameRange = SimAllFrames...
5.Sets the frame selection in the sensor
Following code sets the frame selection in the sensor.
...oBuckleModeSensor.FrameSelector  = oFrameSelector...
6.Updates the sensor
Following code updates the sensor.
...oBuckleModeSensor.Update...
Page 253 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 254 ---

7.Retrieves the sensor
This step shows how to retrieve the sensor from the results analysis case using the results set.
...Dim oResultSet As SimResultsSetSet oResultSet = oResultsAnalysisCase.GetSet("BuckleModeSensorSet")
Dim oRetrievedSensor As SimBuckleModeSensor
The sensor can be retrieved from the results set by following two ways:a) Index:Set oRetrievedSensor = oResultSet.Item(1) 
b) Name:Set oRetrievedSensor = oResultSet.Item("Buckle Mode Sensor.1")...
Creating a buckle mode sensorThis article explains how to open the results and create a buckle mode sensor.
Where to find the macro: CAAScdFeaResultsBuckleModeSensorSourcePython.htmThis use case can be divided in 6 steps:
1.Opens the document and retrieves the results analysis case2.Creates a buckle mode sensor3.Creates the frame selection4.Sets the frame selection attributes5.Sets the frame selection in the sensor6.Updates the sensor1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. You can use VB_Buckle_Mode_Sensor.3dxml file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed.
Retrieve the analysis case2.Creates a buckle mode sensor
This step shows how to create a sensor from the results analysis case retrieved from the earlier step.
...oBuckleModeSensor = oResultsAnalysisCase.CreateBuckleModeSensor()...
3.Creates the frame selection
Here we create a frame selection object. 
...oFrameSelector = oResultsAnalysisCase.CreateFrameSelector()...
4.Sets the frame selection attributes
In this step we set the frame selection attributes. More options for frames selection can be found at Frames Selection
...oFrameSelector.SymbolicFrameRange = ENUM.SimAllFrames...
5.Sets the frame selection in the sensor
Following code sets the frame selection in the sensor.
...oBuckleModeSensor.FrameSelector = oFrameSelector...
6.Updates the sensor
Following code updates the sensor.
...oBuckleModeSensor.Update()...
Creating a history sensorThis article explains how to open the results and create a history sensor.
Where to find the macro: CAAScdFeaResultsHistorySensorSource.htm
This use case can be divided in 9 steps:
1.Opens the document and retrieves the results analysis case2.Creates the history sensor3.Get the step Id ,name and step description4.Sets the attributes to the history sensor5.Sets the support for the history sensor6.Sets step, frame and load case information
Page 254 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 255 ---

7.Sets the sensor parameters8.Updates the history sensor9.Retrieves the sensor parameter values
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. You can useVB_HistoryPlot.SMASim file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROMinstalled. 
Import the SMASim file. Click on the link below for details about how to retrieve the analysis case. 
Retrieve the analysis case2.Creates the history sensor
This step shows how to create a history sensor factory and history sensor from the results analysis case retrieved from the earlier step.
...Dim oHistorySensorFactory As SimHistorySensorFactorySet oHistorySensorFactory = oResultsAnalysisCase.GetItem("SimHistorySensorFactory")
Dim oHistorySensor As SimHistorySensorSet oHistorySensor = oHistorySensorFactory.CreateSensor...
3.Get the step Id ,name and step description
This step shows how to get the step Id,name and step description.
...dim  oSteps  As SimResultsStepsSet  oSteps = oResultsAnalysisCase.ResultsSteps
dim   oResultsStep As SimResultsStepSet oResultsStep = oSteps.Item(1)
dim  stepId As Stringdim  stepName As Stringdim  stepDescription As String
    oResultsStep.GetIdentifier stepId, stepName, stepDescription...
4.Sets the attributes to the history sensor
The following code sets the history sensor attributes.In this step we set the history sensor attributes.More options for history sensor attributes can be found at HistoryplotEnums
...    oHistorySensor.Variable = "UT"    oHistorySensor.ComponentQuantity = SimVector_Component_1
Dim ieComplexValue  As SimComplexValues    ieComplexValue = SimEnvelopeMax
Dim iValueAtAngle  As double    iValueAtAngle = 30
    oHistorySensor.SetComplex  ieComplexValue, iValueAtAngle...
5.Sets the support for the history sensor.
The following code sets support for creating the history sensor such as regions and sub-regions. If user wants to select the whole model, no need to call this method. 
...    Dim MySupports(0)    MySupports(0) = "INP2SIM_NSET_Nodal Probe1"
    Dim MySupports1(0)    MySupports1(0) = 3
    Dim MySupports2(2)    MySupports2(0) = "Node 4"    MySupports2(1) = "Node 87"
    oHistorySensor.SetSupport  MySupports, MySupports1,  MySupports2    oHistorySensor.SetStepAndFrame stepId, 0, 0...
6.Sets the step, frame and load case information
Following code sets the step,frame and load case information.
stepId is the persistent ID of the step.
The Frame index starts from 1. This option is needed only in case of multiple load cases.In the following code we have used 0 as the frame index.
The load case index starts from 1. It is needed if a load case is present in the step.In the following code we have used 0 as the load case index. 
...    oHistorySensor.SetStepAndFrame stepId, 0, 0...
Using following code we can set all available time based steps.
...    oHistorySensor.SetAllTimeBasedSteps  
Page 255 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 256 ---

...
7.Sets the history sensor parameters
Following code sets the history sensor parameters such as max, min, absolute max.
...    oHistorySensor.SetParameters True, True, True  ...
The following line creates parameter for the last value. The last parameter be created only if a single sub-region is selected as support....    oHistorySensor.LastValue = True...
8.Updates the history sensor
Following code updates the history sensor. This method needs to be called at the end after setting the attributes. 
...    oHistorySensor.Update...
9.Retrieves the sensor parameter values. 
This step retrieves the minimum and maximum values. 
...    Dim oKnowServices As KnowledgeServices    Set oKnowServices = CATIA.GetSessionService("KnowledgeServices")
    Dim oKnowCollection    Set oKnowCollection = oKnowServices.GetKnowledgeCollection(oHistorySensor, kweParametersType )
    Dim oParamMinValue As String    oParamMinValue = oKnowCollection.Item(1).Value
    Dim oParamMaxValue As String    oParamMaxValue = oKnowCollection.Item(2).Value...
Creating a history sensorThis article explains how to open the results and create a history sensor.
Where to find the macro: CAAScdFeaResultsHistorySensorSourcePython.htmThis use case can be divided in 9 steps:
1.Opens the document and retrieves the results analysis case2.Creates the history sensor3.Get the step Id ,name and step description4.Sets the attributes to the history sensor5.Sets the support for the history sensor6.Sets step, frame and load case information7.Sets the sensor parameters8.Updates the history sensor9.Retrieves the sensor parameter values
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. You can useVB_HistoryPlot.SMASim file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROMinstalled. 
Import the SMASim file. Click on the link below for details about how to retrieve the analysis case. 
Retrieve the analysis case2.Creates the history sensor
This step shows how to create a history sensor factory and history sensor from the results analysis case retrieved from the earlier step.
...    oHistorySensorFactory = oResultsAnalysisCase.GetItem("SimHistorySensorFactory")
    oHistorySensor = oHistorySensorFactory.CreateSensor...
3.Get the step Id ,name and step description
This step shows how to get the step Id,name and step description.
...    oSteps = oResultsAnalysisCase.ResultsSteps    oStep = oSteps.Item(1)
    stepId, stepName, stepDescription = oStep.GetIdentifier ((), (), ())...
4.Sets the attributes to the history sensor
The following code sets the history sensor attributes.In this step we set the history sensor attributes.More options for history sensor attributes can be found at HistoryplotEnums
Page 256 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 257 ---

...    oHistorySensor.Variable = "UT"    oHistorySensor.ComponentQuantity = ENUM.SimVector_Component_1    ieComplexValue = ENUM.SimEnvelopeMax    iValueAtAngle = 30    oHistorySensor.SetComplex  (ieComplexValue, iValueAtAngle)...
5.Sets the support for the history sensor.
The following code sets support for creating the history sensor such as regions and sub-regions. If user wants to select the whole model, no need to call this method. 
...    MySupports = ["INP2SIM_NSET_Nodal Probe1"]
    MySupports1 = [3]
    MySupports2 = ["Node 4", "Node 87"]
    oHistorySensor.SetSupport  (MySupports, MySupports1,  MySupports2)...
6.Sets the step, frame and load case information
Following code sets the step,frame and load case information.
stepId is the persistent ID of the step.
The Frame index starts from 1. This option is needed only in case of multiple load cases.In the following code we have used 0 as the frame index.
The load case index starts from 1. It is needed if a load case is present in the step.In the following code we have used 0 as the load case index. 
...    oHistorySensor.SetStepAndFrame (stepId, 0, 0)...
Using following code we can set all available time based steps.
...    oHistorySensor.SetAllTimeBasedSteps()...
7.Sets the history sensor parameters
Following code sets the history sensor parameters such as max, min, absolute max.
...    oHistorySensor.SetParameters (True, True, True)...
The following line creates parameter for the last value. The last parameter be created only if a single sub-region is selected as support....    oHistorySensor.LastValue = True...
8.Updates the history sensor
Following code updates the history sensor. This method needs to be called at the end after setting the attributes. 
...    oHistorySensor.Update()...
9.Retrieves the sensor parameter values. 
This step retrieves all the parameters. Here it is maximum and minimum values. 
...    oKnowServices = CATIA.GetSessionService("KnowledgeServices")
    oKnowCollection = oKnowServices.GetKnowledgeCollection(oHistorySensor, ENUM.kweParametersType )
    oParamMinValue = oKnowCollection.Item(1).Value
    oParamMaxValue = oKnowCollection.Item(2).Value...
Creating a strain gauge sensorThis article explains how to open the results and create a strain gauge sensor.
Where to find the macro: CAAScdFeaResultsStrainGaugeSensorSource.htmThis use case can be divided in 9 steps:
1.Opens the document and retrieves the results analysis case2.Creates the strain gauge sensor3.Get the step Id ,name and step description4.Sets step, frame and load case information5.Sets the attributes to the sensor6.Sets the gauge attributes7.Updates the sensor8.Retrieves the sensor parameter values9.Exports the sensor gauge definition
Page 257 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 258 ---

1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case. You can use CAAScdFeaSimResults.SMASim file supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
Import the SMASim file. Click on the link below for details about how to retrieve the analysis case. 
Retrieve the analysis case2.Creates the strain gauge sensor
This step shows how to create a strain gauge sensor factory and strain gauge sensor from the results analysis case retrieved from the earlier step.
...
Dim oStrainGaugeSensorFactory As SimStrainGaugeSensorFactorySet oStrainGaugeSensorFactory = oResultsAnalysisCase.GetItem("SimStrainGaugeSensorFactory")
Dim oStrainGaugeSensor As SimStrainGaugeSensorSet oStrainGaugeSensor = oStrainGaugeSensorFactory.CreateSensor
...
3.Get the step Id ,name and step description
This step shows how to get the step Id,name and step description.
...dim oSteps  As SimResultsStepsSet  oSteps = oResultsAnalysisCase.ResultsSteps
dim oResultsStep As SimResultsStepSet oResultsStep = oSteps.Item(1)
dim stepId As Stringdim stepName As Stringdim stepDescription As String
oResultsStep.GetIdentifier stepId, stepName, stepDescription
...
4.Sets the step, frame and load case information
Following code sets the step,frame and load case information.
stepId is the persistent ID of the step.
The Frame index starts from 1. This option is needed only in case of multiple load cases.In the following code we have used 0 as the frame index.
The load case index starts from 1. It is needed if a load case is present in the step.In the following code we have used 0 as the load case index. 
...
oStrainGaugeSensor.SetStepAndFrame stepId, 2, 0
...
5.Sets the attributes to the sensor.
The following code sets the variable type. The available type are SimStress, SimStrainFromStrain and SimStrainFromDisplacement 
...
oStrainGaugeSensor.VariableType = SimStress
...
6.Sets the gauge attributes
Following code sets the size, origin and orientation of gauges. We are creating 2 gauges here.
...
Note:The length, width and tolerance must be specified in MKS.    oStrainGaugeSensor.SetSize True, 0.01, 0.008    oStrainGaugeSensor.GaugeTolerance = 0.005
Note:The origin location must be specified in mm. The axis direction is unitless.For SetOriginLocations, the first parameter is an unique index. The other parameters are the X,Y and Z values of origin.For SetAxisDirections, the first 3 parameters are the X directions(gauge) and the other 3 parameters are the Z directions(set).
    oStrainGaugeSensor.SetOriginLocations 1, 20, 70, 50    oStrainGaugeSensor.SetAxisDirections 0.12, 0.99, 0, 0, -0, 1    oStrainGaugeSensor.SetOriginLocations 2, 20, -80, 50    oStrainGaugeSensor.SetAxisDirections 0.273, -0.96, 0, 0, -0, 1    oStrainGaugeSensor.ShowGlyph = True
...
7.Updates the sensor
Following code updates the sensor. This method needs to be called at the end after setting the attributes. 
...
Page 258 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 259 ---

oStrainGaugeSensor.Update
...
8.Retrieves the sensor gauge values. 
This step retrieves the gauge values. 
...
Dim oKnowServices As KnowledgeServicesSet oKnowServices = CATIA.GetSessionService("KnowledgeServices")
Dim oKnowCollectionSet oKnowCollection = oKnowServices.GetKnowledgeCollection(oStrainGaugeSensor, kweParametersType )
Dim oValue1 As StringoValue1 = oKnowCollection.Item(1).Value
Dim oValue2 As StringoValue2 = oKnowCollection.Item(2).Value
...
9.Exports the sensor gauge definition. 
This step Exports the sensor gauge definition to csv file. 
...
oStrainGaugeSensor.Export "VSG_Export", "C:\temp", SimCsv
...
Exporting field plotsThis article explains how to export the plot to a file or a PLM document. The file is exported in .csv format
Where to find the macro: CAAScdFeaResultsExportPlotSource.htmThis use case can be divided in following steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the field plot from existing list3.Export the plot to file4.Exports the plot to a PLMDocument
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can useCAAScdFeaResults.3dxmlfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
Retrieve the analysis case2.Retrieves the field plot
This step shows how to retrieve the field plot from existing list of plots.
...
Dim oFieldPlots As SimResultsSetSet oFieldPlots =  oResultsAnalysisCase.GetSet("FieldPlots")
Dim oFieldPlot As SimFieldPlotSet oFieldPlot = oFieldPlots.Item(2)
...
3.Export the plot to file
This step shows how to export the plot to file.
...
Dim oExportPlot  As SimExportFieldSet oExportPlot = oResultsAnalysisCase.CreateExportFieldFromPlot(oFieldPlot)
Dim iFileName As StringiFileName = "Field_Plot_Export"
Dim iFileLocation As StringiFileLocation = "C:\temp"
Dim iDeformed As IntegeriDeformed = 1
Dim iExportOnExteriorValuesOnly As IntegeriExportOnExteriorValuesOnly = 0
' The ExcludeNullValues() method can be called if one wants to exclude the NULL values.It must be called before the WriteToFile() or CreateFeatureLinkedDocument() methods.
oExportPlot.ExcludeNullValues = True
oExportPlot.WriteToFile iFileName, iFileLocation, iDeformed, iExportOnExteriorValuesOnly
...
Page 259 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 260 ---

4.Exports the plot to a PLMDocument
The following code creates new Tabular Export Field feature and PLM document which will be linked to this feature 
...
iFileName = "My_Export_Document"oExportPlot.CreateFeatureLinkedDocument iFileName, iDeformed, iExportOnExteriorValuesOnly
...
Setting animation options and creating videoThis article explains how to set animation options and create a movie file.
Where to find the macro: CAAScdFeaResultsAnimationOptionsSource.htmThis use case can be divided in 8 steps:
1.Opens the document and retrieves the results analysis case2.Retrieves the animation options object3.Retrieves the available animation options4.Sets the animation options5.Retrieves the animation video object6.Retrieves the available codec options7.Sets the video options8.Creates the video1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can use VB_HistoryPlot.SMASimfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
On opening the model,Select yes option from the dialogue to activate the results. 
Retrieve the analysis case2.Retrieves the animation options object
This step retrieves the animation options object from the results analysis case. Each case can have its own animation option object
...
Dim oAnimationOptions As SimResultsAnimationOptionsoAnimationOptions = oResultsAnalysisCase.GetItem("SimResultsAnimationOptions")
...
3.Retrieves the available animation types
This step shows how to get the available animation types for the current plot. It will be a list of strings. 
...
Dim ocsAnimTypes()oAnimationOptions.GetAvailableAnimationTypes ocsAnimTypes
...
4.Sets the animation types
It is mandatory to call the SetType method at the beginning and Update method at the end after all the values are set.
...
a) Its is mandatory to set the type. User can set attributes for all the animation types
Following are the different animation types. The avaialablity of the type depends on the current plot type. The GetAvailableAnimationTypes() method can be called to get the list of avaialable animation types.  1) SimScaleFactor  2) SimTimeHistory  3) SimLoopOverModes  4) SimScanSingleFrame  5) SimTimeHistoryAndLoopover  6) SimFrameBased  7) SimStreamline  8) SimEventSeries  9) SimHarmonic
Dim oAnimType As SimAnimationTypesoAnimType = SimTimeHistoryoAnimationOptions.SetType oAnimType
b) Frame selector needs to be set only for time history and loop over mode
Dim FrameSelector As SimFramesSelectionSet FrameSelector = oResultsAnalysisCase.CreateFrameSelectorFrameSelector.SymbolicFrameRange = SimAllFramesoAnimationOptions.SetFrameSelector FrameSelector
c) Specifies whether to animate over all the frames or with specific intervals
Dim oSamplingType As SimSamplingRateTypesoSamplingType = SimAllSelectedFramesDim oSamplingFilterType As SimSamplingFilterTypesoSamplingFilterType = SimTotalFramesoAnimationOptions.SetSamplingRate oSamplingType, oSamplingFilterType, 10
d) Specifies the speed of animation
Page 260 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 261 ---

Dim eTargetSpeedType As SimTargetSpeedTypeseTargetSpeedType = SimTargetSpeedMaxoAnimationOptions.SetTargetSpeed eTargetSpeedType, 10
e) Updates the options. It has to be called at the end
oAnimationOptions.Update
...
5.Retrieves the animation video object.
The following code retrieves the animation video object from the SimResultsManager. 
...
Dim oAnimationVideo As SimResultsAnimationVideoSet oAnimationVideo = oRootRepRes.GetItem("SimResultsAnimationVideo")
...
6.Retrieves the available codec options
The codec options may be system specific. The different codecs are IntelIYUV, MicrosoftVideo1, FullFrames(compressed), "H.264 / MPEG-4 AVC"
...
Dim lsCodecs()oAnimationVideo.GetListOfCodecOptions lsCodecs
...
1.
Sets the video options
                            Following code sets the video options.
...
a) The following enums are avaialble for SimAnimPlaybackTypes in SMAIAMpaAnimationOptionsEnums:    SimPlaybackFramesPerSec,    SimPlaybackTotalTime
Dim oPlaybackType As SimAnimPlaybackTypesoPlaybackType = SimPlaybackTotalTimeoAnimationVideo.SetPlayback oPlaybackType, 10
b) The codecs can be set as below.
    i) Microsoft Video 1 codec:        Dim csCodec As String        csCodec = "Microsoft Video 1"        oAnimationVideo.SetCodec csCodec        oAnimationVideo.SetCompressionOptions 88, True, 1, 100
    ii) H.264 / MPEG-4 AVC codec:        Dim csCodec As String        csCodec = "H.264 / MPEG-4 AVC"        oAnimationVideo.SetCodec csCodec        oAnimationVideo.SetRayTraceOptions 5, True, 1, True, True, True, 20
    iii) IntelIYUV and FullFrames(compressed) codecs:Dim csCodec As StringcsCodec = "FullFrames(compressed)"
c) Setting the XY plot options. Only the activated or opened history plot will be added in the video.oAnimationVideo.SetXYPlotOptions True, 40, 40, 0, 100
...
7.Creates the video
Following code sets the path and file name to create the video.
...
Dim ofilePath As StringDim ofileName As StringofilePath = "D:\temp"ofileName = "HistoryAnimationMovie.avi"oResAnimVideo.CreateMovie ofilePath, ofileName
...
Setting animation options and creating videoThis article explains how to set animation options and create a movie file.
Where to find the macro: CAAScdFeaResultsAnimationOptionsSourcePython.htm
This use case can be divided in 8 steps:
Page 261 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 262 ---

1.Opens the document and retrieves the results analysis case2.Retrieves the animation options object3.Retrieves the available animation options4.Sets the animation options5.Retrieves the animation video object6.Retrieves the available codec options7.Sets the video options8.Creates the video
1.Opens the document and retrieves the results analysis case
As a first step, the following code will show how to open the simulation document and retrieve the results analysis case.You can use VB_HistoryPlot.SMASimfile supplied in the folderInstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\ where InstallRootFolder is the folder where the API CD-ROM is installed. 
On opening the model,Select yes option from the dialogue to activate the results. 
Retrieve the analysis case2.Retrieves the animation options object
This step retrieves the animation options object from the results analysis case. Each case can have its own animation option object
...
oAnimationOptions = oResultsAnalysisCase.GetItem("SimResultsAnimationOptions")
...
3.Retrieves the available animation types
This step shows how to get the available animation types for the current plot. It will be a list of strings. 
...
ocsAnimTypes = oAnimationOptions.GetAvailableAnimationTypes (())
...
4.Sets the animation types
It is mandatory to call the SetType method at the beginning and Update method at the end after all the values are set.
...
a) Its is mandatory to set the type. User can set attributes for all the animation types
Following are the different animation types. The avaialablity of the type depends on the current plot type. The GetAvailableAnimationTypes() method can be called to get the list of avaialable animation types.  1) SimScaleFactor  2) SimTimeHistory  3) SimLoopOverModes  4) SimScanSingleFrame  5) SimTimeHistoryAndLoopover  6) SimFrameBased  7) SimStreamline  8) SimEventSeries  9) SimHarmonic
oAnimType = ENUM.SimTimeHistoryoAnimationOptions.SetType (oAnimType)
b) Frame selector needs to be set only for time history and loop over mode
FrameSelector = oResultsAnalysisCase.CreateFrameSelector()FrameSelector.SymbolicFrameRange = ENUM.SimAllFramesoAnimationOptions.SetFrameSelector (FrameSelector)
c) Specifies whether to animate over all the frames or with specific intervals
oSamplingType = ENUM.SimAllSelectedFramesoSamplingFilterType = ENUM.SimTotalFramesoAnimationOptions.SetSamplingRate (oSamplingType, oSamplingFilterType, 10)
d) Specifies the speed of animation
eTargetSpeedType = ENUM.SimTargetSpeedMaxoAnimationOptions.SetTargetSpeed (eTargetSpeedType, 10)
e) Updates the options. It has to be called at the end
oAnimationOptions.Update()
...
5.Retrieves the animation video object.
The following code retrieves the animation video object from the SimResultsManager. 
...
oAnimationVideo = oRootRepRes.GetItem("SimResultsAnimationVideo")
...
6.Retrieves the available codec options
The codec options may be system specific. The different codecs are IntelIYUV, MicrosoftVideo1, FullFrames(compressed), "H.264 / MPEG-4 AVC"
...
Page 262 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 263 ---

What is the Simulation Interchange Model (SIM)?
The Simulation Interchange Model (SIM) is the SIMULIA data storage or exchange mechanism used by 3DEXPERIENCE SIMULIA applications. It is a database designed to handle large volumes of data efficiently. It supports both model and results data.
The database access starts with accessing a file named .SMAManifest. This is an xml file that groups other files that make up the database; binary files with extensions .SMAFocus and .SMABulk.
A SIM document can be generated by either a 3DEXPERIENCE simulation run or by a standalone Abaqus execution with resultsFormat SIM option. This SIM document can be read, accessed or modified using the SIM results API.
SIM Results Python API
A SIM document is capable of storing both model and results data. The results SIM document can be visualized in the Physics Results Explorer app. While results documents are usually generated by SIMULIA apps, they can also be generated, modified, read using SIM results API, available in both C++ and Python. This section discusses the SIM Python API.
The SIM Results API has two modules- simResultsReader and simResultsWriter that help reading and writing results.
A script generated using these modules can be run within the 3DEXPERIENCE platform using the Python button in the Tools section of any SIMULIA app as shownbelow
After clicking the Python button, you choose the Python file as shown below
lsCodecs = []lsCodecs = oAnimationVideo.GetListOfCodecOptions (lsCodecs)
...
7.Sets the video options
Following code sets the video options. 
...
a) The following enums are avaialble for SimAnimPlaybackTypes in SMAIAMpaAnimationOptionsEnums:    SimPlaybackFramesPerSec,    SimPlaybackTotalTime
oPlaybackType = ENUM.SimPlaybackTotalTimeoAnimationVideo.SetPlayback (oPlaybackType, 10)
b) The codecs can be set as below.
    i) Microsoft Video 1 codec:        csCodec = "Microsoft Video 1"        oAnimationVideo.SetCodec (csCodec)        oAnimationVideo.SetCompressionOptions (88, True, 1, 100)
    ii) H.264 / MPEG-4 AVC codec:        csCodec = "H.264 / MPEG-4 AVC"        oAnimationVideo.SetCodec (csCodec)        oAnimationVideo.SetRayTraceOptions (5, True, 1, True, True, True, 20)
    iii) IntelIYUV and FullFrames(compressed) codecs:        csCodec = "FullFrames(compressed)"
c) Setting the XY plot options. Only the activated or opened history plot will be added in the video.oAnimationVideo.SetXYPlotOptions (True, 40, 40, 0, 100)
...
8.Creates the video
Following code sets the path and file name to create the video.
...
ofilePath = "D:\\temp"ofileName = "HistoryAnimationMovie.avi"oResAnimVideo.CreateMovie (ofilePath, ofileName)
...
Simulation Interchange Model OverviewTechnical Article
Abstract
This technical article presents an overview of the Simulation Interchange Model.
lWhat is the Simulation Interchange Model (SIM)?
lSIM Results Python API
lSIM API Features
lSIM Data Model
lLimitations
lAccessing the SIM document generated within the 3DEXPERIENCE platform
Page 263 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 264 ---

By default, the Python interpreter is the 3DEXPERIENCE Python interpreter. You can also use Python downloaded from internet by following the steps below. OnlyPython 2 is supported.
1.Download and install the internet Python2.In 3DX, go to Preferences -> Simulation -> Python 
¡Change the Python preferences to Use configured Python
¡Specify the Executable path andLibrary path for the configured Python as shown below.
¡The Executable path should be the path of the internet Python executable's path and the Library path should be the path which contains the Abaqus shared libraries. 
3. Each script should have the following line at the beginning of the script:
...import syssys.path += ['E:\\Dassault Systemes\\PROD\\win_b64\\code\\python2.7\\lib']#where 'E:\\Dassault Systemes\\PROD\\win_b64\\code\\python2.7\\lib' is the Python library path...
SIM API Features
Some of the main features in the SIM API are: 
lUses Numpy arrays for efficiency.
lThrows clear exceptions during writing and reading phase.
lSupports Unicode characters. 
lUses very few classes as most of the methods are directly under reader and writer classes. 
lSupports multiple field classes per output location. 
lProvides functionality to read or write basic model data (nodes, elements, materials, sections etc.) and supports full results data. 
SIM Data Model
Page 264 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 265 ---

Limitations
Some of the limitations in the SIM API are: 
lThe API does not provide the ability to read and write many model attributes such as loads, BCs, interactions, material properties, surfaces, etc. The SIM Python reference API showcases the coverage attributes.
lThere are no methods to add part and assembly information using the SIM results writer API.
Accessing the SIM document generated within the 3DEXPERIENCE platform
The following snippet helps you access an SMAManifest file from a scenario object.
...import com3dximport simResultsReader
#Inside scenario appCATIA = com3dx.get3dxClient()myEditor = CATIA.ActiveEditormyProdService = myEditor.GetService("PLMProductService")mySimuObj = myProdService.EditedContent.Item(1)myProduct = mySimuObj.Model
#Get FEM rootmySimuService = CATIA.GetSessionService("SimSimulationService")myRootOccurrence = mySimuService.GetProductRootOccurrence(mySimuObj)myFemRoot = NonemyRef = myRootOccurrence.ReferenceRootOccurrenceOffor myRep in myRef.RepInstances:   myRepRef = myRep.ReferenceInstanceOf   if "FEM" == myRepRef.GetAttributeValue("V_discipline"):      myFemRoot = myRepRef.GetItem("SimFemRoot")      break
print '-'*40
#Get SIM access for FEMmySimManagerSIMAccess = myFemRoot.GetItem("SimManagerSIMAccess")print "root fem:", mySimManagerSIMAccess.ManifestPath
#Get first analysis casemyScenarioManager = mySimuObj.GetItem("SimScenarioManager")myScenarioAccess = myScenarioManager.AnalysisCases.Item(1).GetItem("SimManagerSIMAccess")print "analysis case:", myScenarioAccess.ManifestPath
#Get first resultmyResultManager = mySimuObj.Results.Item(1).Root.GetItem("SimResultsManager")myResultAccess = myResultManager.ResultsAnalysisCases.Item(1).GetItem("SimManagerSIMAccess")print "result case:", myResultAccess.ManifestPath
#Use SIM Reader API to read the resultsreader = simResultsReader.SIMResultsReader()reader.LoadDocument(myResultAccess.ManifestPath)print "element types:", reader.GetElementSpecs()...
Reading SIM Results Using PythonThis article explains how to read results from a SIM file using Python.This use case can be divided into the following steps:
1.Import the required modules2.Load the SIM document3.Get the unit system 4.Read and print the nodes and node set information5.Read and print the elements and element set information6.Read and print the steps and frames7.Read the field variables8.Read the field output data1.Read the orientation information2.Read the drawer9.Read the history variables10.Read the history output data11.Samples
Page 265 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 266 ---

1.Import the required modules
This step imports simResultsReader module which contains methods and classes needed for reading results. 
...from simResultsReader import *...
2.Load the SIM document
This step loads the SIM document. To automatically upgrade/downgrade the SIM document, refer to 'SIM Utilities reference (python)'
...reader = SIMResultsReader()reader.LoadDocument(simName)...
3.Get the unit system
This step reads the unit system.
...unitSys = reader.GetUnitSystem()print "Unit System name:", unitSys.nameprint "Unit System conversion factors:", unitSys.convFactors print "Length to SI conversion factor", unitSys.lengthToSIConvFactorprint "Mass to SI conversion factor", unitSys.massToSIConvFactorprint "Time to SI conversion factor", unitSys.timeToSIConvFactor...
4.Read and print the nodes and node set information
This step gets the space dimensions of the document, reads the nodes, coordinates and node set information from the SIM document.
...dims = reader.GetSpaceDimensions()print 'Number of space dimensions: %d' % dims
#Read the nodesnodes = reader.GetNodeIndices()#Read the coordinatescoords = reader.GetNodeCoordinates(nodes)
print 'Number of nodes: %d\n' % len(nodes)counter = 0
for node in nodes:#Read the user label for the node    print reader.GetNodeUserLabel(node), ': ',    for dim in range(dims):        print coords[counter], ' ',        counter += 1        print ''
#Read the node setsnodeSets = reader.GetNodeSets()print '\nNumber of node sets: ', len(nodeSets)for nodeSet in nodeSets:    print ' Node set name: ', nodeSet    nodeMembers = reader.GetNodeSetMembers(nodeSet)    print '\tMembers: '    print '\t', nodeMembers...
5.Read and print the elements and element set information
This step reads the element specs, elements, element connectivity and element set information from the SIM document. 
...#Read the element specsspecs = reader.GetElementSpecs()
print '\nNumber of element specs: %d' % len(specs)
for spec in specs:    print ' Element spec: ', spec    elements = reader.GetElementIndices(spec)#Read the element connectivity    connectivity = reader.GetElementsConnectivity(elements)    nodesPerElement = len(connectivity)/ len(elements)
    counter = 0    for element in elements:        print '\t',        print reader.GetElementUserLabel(element), ': ',        for i in range(nodesPerElement):            print connectivity[counter], ' ',            counter += 1        print ''
#Read the element setselementSets = reader.GetElementSets()print '\nNumber of element sets: ', len(elementSets)
for elementSet in elementSets:    print ' Element set name: ', elementSet#Read the element set members    elementMembers = reader.GetElementSetMembers(elementSet)    print '\tMembers: '    print '\t', elementMembers...
Page 266 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 267 ---

6.Read and print the steps and frames
This step reads the steps and frames from the SIM document.
...#Read the step namesstepNames = reader.GetStepSequence()print '\nNumber of steps: ', len(stepNames)
for stepName in stepNames:    print ' Step name: ', stepName#Read step type and description    stepInfo = reader.GetStepTypeAndDescription(stepName)    print ' Step type: %s' % stepInfo[0]    print ' Step description: %s' % stepInfo[1]
#Read the frame indices and values    frameIndices, frameValues = reader.GetFrames(stepName)
    if not frameIndices == None:        numFrames = len(frameIndices)        print ' Number of frames: ', numFrames        for counter in range(numFrames):            print '\t%d : %g' % (frameIndices[counter], frameValues[counter])...
7.Read the field variables
This step retrieves the field variables from the SIM document.
...fieldResultsInventory = reader.GetFieldResultsInventory(stepName)print ' Number of fields: ', len(fieldResultsInventory)
#Sort the list so that the output is consistentfieldResultsInventory.sort(key = lambda item: item.fieldVariableName)
for field in fieldResultsInventory:    print ' Field variable: ' , field.fieldVariableName    print '\tField type: ' , field.fieldType    print '\tField index: ', field.fieldIndex    print '\tField output position: ', field.outputPosition    print ''...
8.Read the field output data
This step retrieves the field output data from the SIM document. In this example, this step retrieves UNIQUE NODAL data.
...#Initialize a field resultfieldObj = simResultsReader.UniqueNodalFieldReader()reader.InitFieldResult(stepName, field, fieldObj)numDrawers = fieldObj.GetNumberOfDrawers()...
1.Read the orientation information
This step reads the orientation information for this field variable.
...ori = fieldObj.GetOrientationFieldInfo()if ori:   print '\tField has orientation.'   print '\t Orientation field name:' , ori.fieldVariableName   print '\t Orientation field type: ' , ori.fieldType   print '\t Orientation field index: ', ori.fieldIndex   print '\t Orientation field output position: ', ori.outputPosition...
2.Read the drawer
This step reads the drawer and prints the field data
...for nd in range(numDrawers):   print '\t Drawer number: ', nd   dims = fieldObj.GetDimensions(nd)   print '\t Frames: ', dims.frameIndices   print '\t Load cases: ', dims.loadCases   print '\t Nodes: ', dims.nodeIndices   print '\t Components: ', dims.components   print '\t Invariants: ', dims.invariants
   frames = dims.frameIndices   lcs = dims.loadCases   nodes = dims.nodeIndices   for frame in frames:      print '\n\t Processing frame: ' , frame      for lc in lcs:         print '\t Processing load case: ', lc         data, imagData = fieldObj.GetFieldResultData(nd, frame, nodes, lc)         print '\t Real data: ', data         print '\t Imag data: ', imagData...
9.Read the history variables
This step retrieves the history variables from the SIM document.
Page 267 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 268 ---

...historyResultsInventory = reader.GetHistoryResultsInventory(stepName)print ' Number of history: ', len(historyResultsInventory)
#Sort the list so that the output is consistenthistoryResultsInventory.sort(key = lambda item: item.fieldVariableName)
for history in historyResultsInventory:   print ' Processing history output: ' , history.fieldVariableName   print '\tHistory output type: ' , history.fieldType   print '\tHistory output index: ', history.fieldIndex   print '\tHistory output position: ', history.outputPosition   print ''...
10.Read the history output data
This step retrieves the history output data from the SIM document. In this example, this step retrieves UNIQUE NODAL data, reads the drawer and prints the history data.
...#Initialize a history resulthistoryObj = simResultsReader.UniqueNodalFieldReader()reader.InitHistoryResult(stepName, field, historyObj)numDrawers = historyObj.GetNumberOfDrawers()
for nd in range(numDrawers):   print '\t Processing drawer: ', nd   dims = historyObj.GetDimensions(nd)   print '\t Load cases: ', dims.loadCases   print '\t Nodes: ', dims.nodeIndices   print '\t Components: ', dims.components   print '\t Invariants: ', dims.invariants
   frames = dims.frameIndices   lcs = dims.loadCases   nodes = dims.nodeIndices   for node in nodes:      print '\n\t Processing node: ' , node      for lc in lcs:         print '\t Processing load case: ', lc         for component in dims.components:            print '\t Processing component: ', component            data, imagData = historyObj.GetHistoryResultData(nd, node, component, lc)            print '\t Real data: ', data            print '\t Imag data: ', imagData...
11.Samples
Read results from a SIM document: simResultsReaderSample1.py
Read results from a SIM document which has Unicode strings: simResultsReaderSample1-Unicode.py
Read mises stress values from a SIM document: misesFromSim.py
Read and write results to the same SIM document: resultsReadWriteSample1.py
Copyright © 1999-2018, Dassault Systèmes. All rights reserved.
Writing SIM Results Using PythonThis article explains how to write results to a SIM file using Python.This use case can be divided into the following steps:
1.Import the required modules2.Create a new SIM document3.Set the unit system4.Write the nodes and node set information5.Write the elements and element set information6.Write the material and section information7.Create a new step and frames8.Create and initialize a new nodal displacement field variable9.Create a new field type and write data10.Create a new history type and write history data11.Save and close the document12.Samples13.Adding user labels14.SIM Predefined string1.Import the required modules
This step imports the simResultsWriter module, which contains methods and classes needed for writing results.
... from simResultsWriter import * ...
2.Create a new SIM document
This step creates a new SIM document. 
...
Page 268 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 269 ---

iDocName = “new.sim”writer = SIMResultsWriter()writer.Initialize()writer.CreateDocument(iDocName)...
3.Set the unit system
This step sets the unit system for the SIM document. 
...#Set the unit systemiUnitSystemName = "FPSUnitSystem"iLengthToSIConvFactor = 0.3048iMassToSIConvFactor = 0.453592iTimeToSIConvFactor = 1.0writer.SetUnitSystem(iUnitSystemName, iLengthToSIConvFactor, iMassToSIConvFactor, iTimeToSIConvFactor)...
4.Write the nodes and node set information
This step writes the nodes, coordinates and node set information to the SIM document.  The user is in charge of the management of the memory. The user has to allocate the
...#Write nodesnodeIndices = [ 0,1,2,3,4,5,6,7, 8, 9, 10, 11, 12 ]coords = [ 0.0, 0.0 , 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 
numOfSpaceDims = 3writer.WriteNodes(numOfSpaceDims, nodeIndices, coords)
#Create node setallNodes = "ALL NODES"setIndices = [ 0,1,2,3,4,5,6,7 ]writer.CreatePermutedNodeSet(allNodes, setIndices)...
5.Write the elements and element set information
This step writes the element specs, elements, element connectivity and element set information to the SIM document.
...#Write elementselmType = "C3D4";elementIndices = [ 0,1,2,3 ]; numElements = len(elementIndices)connectivity = [ 0, 1, 2, 5, 0, 2, 3, 7, 0, 5, 7, 4, 5, 0, 7, 2 ]writer.AddElements(elmType, elementIndices, connectivity)
#Create element setsetIndices = [ 0, 1 ]aluminiumElements = “ALUMINIUM_ELEMENTS”writer.CreatePermutedElementSet(aluminiumElements, setIndices)...
6.Write the material and section information
This step writes the material and section information to the SIM document and assigns them to the elements sets created in previous step.
...#Create materialmaterialName = "ALUMINIUM"writer.CreateMaterial(materialName) 
#Create sectionwriter.CreateContinuumSection(aluminiumElements, materialName)...
7.Create a new step and frames
This step creates a new static step and frames.
...frameValues = [ 0.0, 1.0]
stepName = "Step-1"stepType = "Step_Gen_Static"stepDescription = "The description goes here"
writer.AddStep(stepName, stepType, stepDescription, frameValues)...
8.Create and initialize a new nodal displacement field variable
This step creates and initializes a nodal displacement field variable. The dimension of the field is also defined here (in this case, it is a vector with 3 components). 
...#Initialize the field variabledispUniqueNodalField = UniqueNodalField()stepName = “Step-1”displacementFieldType = “U_D”writer.InitFieldResult(stepName, displacementFieldType, dispUniqueNodalField)
#Define dimensionsvectorComponents = ["C_1", "C_2", "C_3"]magInvariants = ["MAGNITUDE"] complexData = FalsedoublePrecision = TruedispUniqueNodalField.DefineDimensions(allNodes, vectorComponents, magInvariants, complexData, doublePrecision)...
Page 269 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 270 ---

9.Create a new field type and write field data
This step creates a new displacement field type and writes the data at the first frame. 
...#Write the field datanewField = "NewDisplacementField01"writer.AddFieldType(newField, "New Displacement Field", "VECTOR", "L", "DISPLACEMENT")
dispNodalData0 = [ 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ]firstFrameIndex = 0dispUniqueNodalField.AddFrameData(firstFrameIndex, allNodes, dispNodalData0)...
10.Create a new history type and write history data
This step creates a new displacement history type and writes the data at all frames.
...#Initialize the history variabledispHistoryField = UniqueNodalField()writer.InitHistoryResult(stepName, displacementFieldType, dispHistoryField)vectorComponents = ["C_1"] invariants = NonedispHistoryField.DefineDimensions(allNodes, vectorComponents, invariants, complexData, doublePrecision)
#Write the history datadispHistoryData = [ 0,0,0,0,0,0,0,0,-1.52,-1.25,-9.43,-5.95,-2.25,1.54,5.27,8.80 ]frameIndices = [ 0,1 ]dispHistoryField.AddHistoryData(frameIndices, allNodes, dispHistoryData) ...
11.Close the document
This step saves and closes the document.
...writer.Finalize()...
12.Samples
Write results to a SIM document #1: simResultsWriterSample1.py
Write results to a SIM document #2: simResultsWriterSample2.py
Write user node and element labels to a SIM document: simResultsWriterSample3.py
Write results to a SIM document with some Unicode strings: simResultsWriterSample1-Unicode.py
Read and write results to the same SIM document: resultsReadWriteSample1.py
13.Adding user labels
This step shows how to add user node labels to the SIM document, map the user labels to the flat labels and how the user labels are used. For a sample script, please refer to simResultsWriterSample3.py in 
 AddUserNodeLabels() is used to add user node labels to the SIM document:
...#Add the user node labelsinstance1 = "Part-1-1"userNodeLabels = [1001,1002,1003,1004,1005,1006,1007,1008]flatNodeIndices = writer.AddUserNodeLabels(iInstanceName = instance1, iUserLabels = userNodeLabels)
A dictionary is constructed to store the map between the user supplied node labels and the flat labels generated by SIM: 
...nodeMap = {}for i in range(len(userNodeLabels)):    nodeMap[instance1 + "." + str(userNodeLabels[i])] = flatNodeIndices[i]...
When creating the element connectivity or node sets, the above dictionary is used: 
...elementSpec = "C3D4";elementIndices = [1,2]connectivity = [nodeMap[instance1+"."+str(1005)], nodeMap[instance1+"."+str(1006)], nodeMap[instance1+"."+str(1008)], ...]writer.AddElements(elementSpec, elementIndices, connectivity)
nset1 = "SampleNodeSet1"nset1Indices = [nodeMap[instance1+"."+str(1006)], nodeMap[instance1+"."+str(1008)]]writer.CreatePermutedNodeSet(nset1, nset1Indices)...
14.SIM predefined string
This section discusses some of the possible predefined SIM strings that can be used in the API.
lStep Type
Predefined String DescriptionStep_Gen_Anneal *ANNEAL
Step_Gen_BaseStateResolution Base state step for linear pertubation steps when there is no general step preceeding them
Page 270 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 271 ---

lComponent
Step_Gen_TemperatureDisplacement_SteadyState*COUPLED TEMPERATURE-DISPLACEMENT, STEADY STATE 
Step_Gen_TemperatureDisplacement_Transient*COUPLED TEMPERATURE-DISPLACEMENT, TRANSIENT Step_Gen_TemperatureElectricalSteadyState*COUPLED THERMAL-ELECTRICAL, STEADY STATE Step_Gen_TemperatureElectrical COUPLED THERMAL-ELECTRICALStep_Gen_DirectCyclic *DIRECT CYCLIC Step_Gen_Dynamic *DYNAMICStep_Gen_Dynamic_Explicit *DYNAMIC, EXPLICIT
Step_Gen_Dynamic_Explicit_TemperatureDisplacement*DYNAMIC TEMPERATURE-DISPLACEMENT, EXPLICIT Step_Gen_Geostatic *GEOSTATIC Step_Gen_HeatTransferSteadyState *HEAT TRANSFER, STEADY STATE Step_Gen_HeatTransfer *HEAT TRANSFERStep_Gen_Dynamic_Implicit *DYNAMIC Step_Gen_MassDiffusionSteadyState *MASS DIFFUSION, STEADY STATE Step_Gen_MassDiffusion *MASS DIFFUSIONStep_Gen_SoilsSteadyState *SOILS Step_Gen_Soils *SOILS, CONSOLIDATIONStep_Gen_StaticRiks *STATIC, RIKSStep_Gen_Static *STATIC Step_Gen_SteadyStateTransport *STEADY STATE TRANSPORTStep_Gen_Dynamic_SubspaceProjection *DYNAMIC, SUBSPACEStep_Gen_Visco *VISCO Step_Gen_Electromagnetic *ELECTROMAGNETICStep_Lin_Buckle *STEP, LINEAR and *BUCKLE Step_Lin_ComplexFrequency *STEP, LINEAR and *COMPLEX FREQUENCY Step_Lin_Frequency *STEP, LINEAR and *FREQUENCY Step_Lin_MatrixGeneration *STEP, LINEAR and *MATRIX GENERATE Step_Lin_SubstructureGeneration *STEP, LINEAR and *SUBSTRUCTURE GENERATE Step_Lin_BeamSectionGeneration *STEP, LINEAR and *BEAM SECTION GENERATE 
Step_Lin_DirectHarmonic *STEP, LINEAR and *STEADY STATE DYNAMICS, DIRECT Step_Lin_ModalHarmonic *STEP, LINEAR and *STEADY STATE DYNAMICS Step_Lin_ModalRandomResponse *STEP, LINEAR and *RANDOM RESPONSE Step_Lin_ModalTransient *STEP, LINEAR and *MODAL DYNAMIC Step_Lin_ResponseSpectrum *STEP, LINEAR and *RESPONSE SPECTRUM Step_Lin_Static *STEP, LINEAR and *STATIC Step_Lin_Electromagnetic *STEP, LINEAR and *ELECTROMAGNETIC
Predefined StringDescriptionC_SCALARIndicates scalarC_1 Indicates vector first componentC_2 Indicates vector second componentC_3 Indicates vector third componentC_11 Indicates second-order tensor 11-componentC_22 Indicates second-order tensor 22-componentC_33 Indicates second-order tensor 33-componentC_12 Indicates second-order tensor 12-componentC_13 Indicates second-order tensor 13-componentC_23 Indicates second-order tensor 23-componentC_21 Indicates second-order tensor 21-componentC_31 Indicates second-order tensor 31-componentC_32 Indicates second-order tensor 32-component
C_12PLUSIndicates second-order tensor 12-component PLUS cross-diagonal 21 component (and, when used with a symmetric tensor, therefore TWICE the 12'engineering' 12 shear component.
C_13PLUSIndicates second-order tensor 13-component PLUS cross-diagonal 31 component.C_23PLUSIndicates second-order tensor 23-component PLUS cross-diagonal component.C_SORT_PRIN1Indicates second-order tensor principal value 1, as sorted with principal values 1,2,3 ascending.C_SORT_PRIN2Indicates second-order tensor principal value 2, as sorted with principal values 1,2,3 ascending.C_SORT_PRIN3Indicates second-order tensor principal value 3, as sorted with principal values 1,2,3 ascending.C_1111 Indicates fourth-order tensor 1111-componentC_1122 Indicates fourth-order tensor 1122-componentC_1112 Indicates fourth-order tensor 1112-componentC_2211 Indicates fourth-order tensor 2211-componentC_2222 Indicates fourth-order tensor 2222-componentC_2212 Indicates fourth-order tensor 2212-componentC_1211 Indicates fourth-order tensor 1211-componentC_1222 Indicates fourth-order tensor 1222-componentC_1212 Indicates fourth-order tensor 1212-componentC_ROT1 Indicates the 1-component of a finite rotation vector, representing an orthogonal second-order tensor.C_ROT2 Indicates the 2-component of a finite rotation vector, representing an orthogonal second-order tensor.
Page 271 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 272 ---

lInvariant
lOutput Position
lElement type(please refer to Abaqus Element Guide for the complete list)
lPhysical dimensionPhysical dimension describes the dimensions of a quantity in terms of fundamental quantities. This is used for units conversion. The following are the rules to define the physical dimension string:1. Write its formula in the base physical dimensions, representing the base physical dimensions (M..L..T..E..K..A..C) through their own symbol names.2. Omit any exponents of value 1 in the formula; include no base dimensions which have an exponent 0 in the formula.3. Arrange the formula so the base physical dimensions appear in the order they appear below, that is, M..L..T..E..K..A..C.4. Write down what you see from left to right, each base symbol followed immediately by what we'll call the symbol form of its exponent:5. To put an exponent in symbol form, as a fraction it must be normalized; represent minus in the numerator with a prefix 0.)
lField typeUse GetFieldTypeFromOutputVariable() to get a field type from Abaqus output variable (refer to Abaqus Output Guide for the complete list of Abaqus output variables). For user defined field types, use eitherAddFieldType() or AddModifiedFieldType() to create new field types.
C_ROT3 Indicates the 3-component of a finite rotation vector, representing an orthogonal second-order tensor.
C_PRIN1 Indicates second-order tensor principal value 1. Differs from C_SORT_PRIN1 in that the 1 here reflects a basis vector 1, not the lowest ofin conjunction with a quaternion to represent a symmetric tensor; or with two quaternions to represent a general tensor.C_PRIN2 See C_PRIN1C_PRIN3 See C_PRIN1
C_QUAT0Indicates quaternion component of orthogonal two-tensor. Note: rotation in three dimensions has all four quaternion components possibly noninvolves nonzero components only for C_QUAT0 and C_QUAT3.
C_QUAT1Indicates quaternion component of orthogonal two-tensor; component 1 of vector q.C_QUAT2Indicates quaternion component of orthogonal two-tensor; component 2 of vector q.C_QUAT3Indicates quaternion component of orthogonal two-tensor; component 3 of vector q.
Predefined StringDescriptionINV1 The 'first invariant' of a second order tensor. Applied to a strain, this gives volumetric strainINV3 The 'third invariant' of a second order tensor.PRESSURE_LIKEThis is defined as minus one third INV1. Applied to stress tensor, it produces pressure.MISES_LIKE The function which produces the Mises stress from a second-order stress tensor.TRESCA_LIKEThe function which produces the Tresca stress from a second-order stress tensor.MAGNITUDEThe function which produces the magnitude of a vector.MAX_PRINCIPALThe function which produces the maximum principal value of a second-order tensor.MID_PRINCIPALThe function which produces the 'mid' principal value of a second-order tensor.MIN_PRINCIPALThe function which produces the minimum principal value of a second-order tensor.MAX_INPLANE_PRINCIPALThe function which produces the maximum in-plane principal value of a second-order tensor.MIN_INPLANE_PRINCIPALThe function which produces the minimum in-plane principal value of a second-order tensor.OUTOFPLANE_PRINCIPALThe function which produces the out of plane principal value of a second-order tensor.
Predefined StringDescriptionUNIQUE_NODALUNIQUE NODALELEMENT_CENTROIDELEMENT CENTROIDWHOLE_ELEMENTWHOLE ELEMENTINTEGRATION_POINTINTEGRATION POINTELEMENT_NODALELEMENT NODALSURFACE_NODALSURFACE NODALWHOLE_REGIONWHOLE REGIONWHOLE_MODELWHOLE MODELGENERIC_POSITIONGENERIC POSITION
Predefined StringDescriptionC3D8 C3D8C3D4 C3D4B31 B31S4 S4... ...
Predefined String Description
L LengthM MassT TimeE Electric CurrentK TemperatureA Amount of substanceC Luminous IntensityMLT02 Mass*Length/Time^2; physical dimension for stressML2T02K01A01 Mass*Length^2/(Time^2*Temperature*Amount of substance)M1_2L01_2T01 Mass^0.5/(Length^0.5*Time)... ...
Predefined StringDescriptionU_D Translational displacementSTRAIN_ENERGYStrain energy
Page 272 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 273 ---

SIMResultsReader
This class is intended to make it as easy as possible to read results from SIM.
Method Index
o __init__Creates a new instance of SIMResultsReader o FinalizeDelete all the objects created. 
o GetBaseStateStepGets the base state step name. 
o GetElementFaceConnectivityGets the face connectivity of the given elements at the given face. 
o GetElementIndicesGets the element indices for the specified element spec. 
o GetElementSetMembersGets the element indices in the specified element set. 
o GetElementSetUserNameGets the user element set name. 
o GetElementSetsGets the set of element sets in the model. 
o GetElementSpecGets the element spec of the given element. 
o GetElementSpecsGets the vector of element specs. 
o GetElementTopologyGets the element topology of the given element. 
o GetElementUserLabelGets the user label for an element. Returns true if user label found. 
o GetElementsConnectivityGets the element connectivity for the specified element indices. The element indices must belong to the same element spec. 
o GetElementsInSectionGets the elements in the given section.. If iElemIndices is specified, gets the elements that belong to the given section from this list of elements . 
o GetFieldResultsInventoryGets all the field info objects describing the field types and output locations for the field results in the step. 
o GetFramesGets the frame indices and the frame values for the specified step. 
o GetHistoryResultsInventoryGets all the field info objects describing the field types and output locations for the history results in the step. 
o GetLoadCasesGets the map of load cases in the model. 
o GetNodeCoordinatesGets the nodal coordinates. 
o GetNodeIndicesGets the node indices.
o GetNodeSetMembersGets the node indices in the specified node set. 
o GetNodeSetUserNameGets the user node set name. 
o GetNodeSetsGets the set of node sets in the model. 
o GetNodeUserLabelGets the user label for a node. Returns true if user label found. 
o GetSectionNamesGets the name of the sections present in the model. 
S0 Stress... ...
Page 273 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 274 ---

o GetSectionTypeGets the section type for the specified section. 
o GetShellSectionPropertiesGets the shell section properties for the given section. 
o GetSpaceDimensionsReturns the space dimensions of the main model in the SIM document. 
o GetStepSequenceGets the sequence of steps. 
o GetStepTypeAndDescriptionGets the step type and the step description for the specified step. 
o GetSurfaceElementsAtFaceGets the elements at the given face in the surface. 
o GetSurfaceFacesGets the faces in the given surface. 
o GetSurfaceNamesGets the name of surfaces in the model. 
o GetUnitSystemReturns the unit system name of the SIM document and the conversion factors. 
o GroupElementsBySectionsGroups the elements based on its section. 
o HasExternalElementSetsChecks if external element sets exists in the sim file. Returns true if external element sets are found. 
o HasExternalNodeSetsChecks if external node sets exists in the sim file. Returns true if external node sets are found.
o HasInternalElementSetsChecks if internal element sets exists in the sim file. Returns true if internal element sets are found. 
o HasInternalNodeSetsChecks if internal node sets exists in the sim file. Returns true if internal node sets are found.
o InitFieldResultInitializes a field for reading field result. 
o InitHistoryResultInitializes a field for reading history result. 
o LoadDocumentLoads an existing SIM document.
Methods
o__init__
Parameters:None
oFinalize
Delete all the objects created.Parameters:None
o GetBaseStateStep
Gets the base state step name. Parameters:[out] A string specifying the base state step name. 
oGetElementFaceConnectivity
Gets the face connectivity of the given elements at the given face. Parameters:iElementIndices [in/required] The element indices. iFaceIndex [in/required] The face index.[out] The face connectivity of the given elements at the given face. 
oGetElementIndices
Gets the element indices for the specified element spec. Parameters:iElementSpec[in/required] A string specifying the element spec. [out] A sequence of integers specifying the element indices.
oGetElementSetMembers
Page 274 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 275 ---

Gets the element indices in the specified element set. Parameters:iElementSet[in/required] A string specifying the element set name.[out] A sequence of integers specifying the elements in the element set; if the set is unsorted, the members will be unsorted.
oGetElementSetUserName
Gets the user element set name.Parameters:iElementSet[in/required] A string specifying the flat element set name.[out] A sequence of a strings specifying the occurence name and the user element set name. 
o GetElementSets
Gets the set of element sets in the model. Parameters:includeExternalSets [in/optional] A boolean specifying if external sets should be included or not.includeInternalSets [in/optional] A boolean specifying if internal sets should be included or not. [out] A sequence of strings specifying the element sets in the model.
oGetElementSpec
Gets the element spec of the given element.Parameters:iElementIndex[in/required] The element index. [out] The element spec of the given element. 
o GetElementSpecs
Gets the vector of element specs. Parameters:[out] A sequence of strings specifying the element specs in the model.
oGetElementTopology
Gets the element topology of the given element. Parameters:iElementIndex[in/required] The element index. [out] The element topology of the given element. 
o GetElementUserLabel
Gets the user label for an element. Returns true if user label found.Parameters:iElementIndice[in/required] An integer specifying the element for which user label is required. [out] A tuple of the string specifying the occurence name and the integer specifying the element user label.
oGetElementsConnectivity
Gets the element connectivity for the specified element indices. The element indices must belong to the same element spec. Parameters:iElemIndices[in/required] A sequence of integers specifying the element indices. [out] A sequence of integers specifying the element connectivity. 
o GetElementsInSection
Gets the elements in the given section.. If iElemIndices is specified, gets the elements that belong to the given section from this list of elements .Parameters:iSectionName[in/required] The name of the section. iElementIndices[in/optional] The list of element indices. [out] The elements in the section. 
oGetFieldResultsInventory
Gets all the field info objects describing the field types and output locations for the field results in the step. Parameters:iStepName[in/required] A string specifying the step name. [out] A sequence of FieldInfo objects specifying the field info sequence.
oGetFrames
Gets the frame indices and the frame values for the specified step. Parameters:iStepName[in/required] A string specifying the step name. [out] A sequence of sequence of integers specifying the frame indices and a sequence of doubles specifying the frame values.
oGetHistoryResultsInventory
Gets all the field info objects describing the field types and output locations for the history results in the step. Parameters:iStepName
Page 275 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 276 ---

[in/required] A string specifying the step name. [out] A sequence of FieldInfo objects specifying the field info sequence.
oGetLoadCases
Gets the map of load cases in the model.Parameters:[out] A dictionary with the load case index as keys and the load case name as values.
oGetNodeCoordinates
Gets the nodal coordinates.Parameters:iNodeIndices[in/required] A sequence of integers specifying the node indices.[out] A sequence of doubles specifying the nodal coordinates.
oGetNodeIndices
Gets the node indices.Parameters:[out] A sequence of integers specifying the node indices. 
o GetNodeSetMembers
Gets the node indices in the specified node set. Parameters:iNodeSet [in/required] A string specifying the node set name. [out] A sequence of integers specifying the nodes in the node set; if the set is unsorted, the members will be unsorted.
oGetNodeSetUserName
Gets the user node set name.Parameters:iNodeSet [in/required] A string specifying the flat node set name. [out] A sequence of a strings specifying the occurence name and the user node set name.
oGetNodeSets
Gets the set of node sets in the model.Parameters:includeExternalSets[in/optional] A boolean specifying if external sets should be included or not. includeInternalSets [in/optional] A boolean specifying if internal sets should be included or not.[out] A sequence of strings specifying the node sets in the model.
oGetNodeUserLabel
Gets the user label for a node. Returns true if user label found. Parameters:iNodeIndex[in/required] An integer specifying the node number for which user label is required. [out] A sequence of a string specifying the occurence name and an integer specifying the node user label
oGetSectionNames
Gets the name of the sections present in the model. Parameters:[out] The name of the sections in the model. 
o GetSectionType
Gets the section type for the specified section. Parameters:iSectionName [in/required] The name of the section. iSectionType [in/required] The type of the section. 
oGetShellSectionProperties
Gets the shell section properties for the given section. Parameters:iSectionName[in/required] The name of the section. [out] A list containing the section integration rule, number of layers in the section, angle, thickness, integration points in each layer. *
oGetSpaceDimensions
Returns the space dimensions of the main model in the SIM document. Parameters:None
oGetStepSequence
Gets the sequence of steps.Parameters:[out] A sequence of strings specifying the steps in the model. 
Page 276 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 277 ---

oGetStepTypeAndDescription
Gets the step type and the step description for the specified step. Parameters:iStepName [in/required] A string specifying the step name. [out] A sequence of a string specifying the step type and a string specifying the step description.
oGetSurfaceElementsAtFace
Gets the elements at the given face in the surface. Parameters:iSurfaceName[in/required] A string specifying the surface name.iFaceIndex [in/required] An integer specifying the face index. [out] A sequence of integers specifying the elements at the face in the surface.. 
o GetSurfaceFaces
Gets the faces in the given surface. Parameters:iSurfaceName[in/required] A string specifying the surface name. [out] A sequence of integers specifying the faces in the surface.
oGetSurfaceNames
Gets the name of surfaces in the model.Parameters:[out] A sequence of string specifying the surfaces in the model. 
o GetUnitSystem
Returns the unit system name of the SIM document and the conversion factors.Parameters:[out] An instance of the UnitSystem class object. 
oGroupElementsBySections
Groups the elements based on its section. Parameters:iElemIndices[in/required] The element indices. sectionElemIndicesMap[in/required] The elements from the input set of elements grouped based on their sections. 
oHasExternalElementSets
Checks if external element sets exists in the sim file. Returns true if external element sets are found.Parameters:[out] True if external element sets exists in the sim file. 
o HasExternalNodeSets
Checks if external node sets exists in the sim file. Returns true if external node sets are found. Parameters:[out] True if external node sets exists in the sim file. 
oHasInternalElementSets
Checks if internal element sets exists in the sim file. Returns true if internal element sets are found.Parameters:[out] True if internal element sets exists in the sim file. 
o HasInternalNodeSets
Checks if internal node sets exists in the sim file. Returns true if internal node sets are found. Parameters:[out] True if internal node sets exists in the sim file. 
o InitFieldResult
Initializes a field for reading field result. Parameters:iStepName [in/required] A string specifying the step name for the result. iFieldInfo [in/required] A FieldInfo object specifying the field info object. ioFieldReader[in/required] A FieldReader object specifying the field object which should be used to read data. 
o InitHistoryResult
Initializes a field for reading history result. Parameters:iStepName [in/required] A string specifying the step name for the result. iFieldInfo [in/required] A FieldInfo object specifying the field info object. ioFieldReader[in/required] A FieldReader object specifying the field object which should be used to read data. 
Page 277 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 278 ---

o LoadDocument
Loads an existing SIM document. Parameters:iDocument[in/required] A string specifying the document name or a SIMDocument object specifying the SIMDocument object.
ElementCentroidFieldReader
The ElementCentroidFieldReader object is derived from the FieldReader object.
Method Index
o __init__Creates a new instance of ElementCentroidFieldReader object 
o GetDimensionsReturns an instance of ElementCentroidDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, Component labels, Invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of ElementCentroidFieldReader object Parameters:[out] A new instance of ElementCentroidFieldReader object 
o GetDimensions
Returns an instance of ElementCentroidDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, Component labels, Invariants, isDoublePrecision, isComplex Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the ElementCentroidDimension object with members" frame indices, loadCases, section points, element indices, Component labels, Invariants, isDoublePrecision, isComplex.
oGetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex[in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iSectionPoint [in/required] An integer specifying the section point index for which data is required.iElementIndices [in/required] A sequence of integers specifying the element indices for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iElementIndex [in/required] An integer specifying the element index for which data is required.iComponentSymbol [in/required] A string specifying the component label for which data is required. iLoadCase[in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1.[out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
Page 278 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 279 ---

ElementFaceFieldReader
The ElementFaceFieldReader object is derived from the FieldReader object. 
Method Index
o __init__Creates a new instance of ElementFaceField object 
o GetDimensionsReturns an instance of ElementIntPointDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, face ID, component labels, Invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of ElementFaceField objectParameters:[out] A new instance of ElementFaceField object 
o GetDimensions
Returns an instance of ElementIntPointDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, face ID, component labels, Invariants, isDoublePrecision, isComplex Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the ElementIntPointDimension object with members:frame indices, loadcase indices, section points, element indices, face ID, component labels, Invariants, isDoublePrecision, isComplex. 
o GetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex [in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iFaceID [in/required] An integer specifying the face ID for which data is required. iElementIndices[in/required] A sequence of integers specifying the element indices for which data is required. iLoadCase[in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1.[out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iElementIndex [in/required] An integer specifying the element index for which data is required.iFaceID [in/required] An integer specifying the face ID for which data is required. iComponentSymbol[in/required] A string specifying the component label for which data is required. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer.
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
ElementIntegrationPointFieldReader
The ElementIntegrationPointFieldReader object is derived from the FieldReader object. 
Page 279 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 280 ---

Method Index
o __init__Creates a new instance of ElementIntegrationPointField object 
o GetDimensionsReturns an instance of ElementIntPointDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, integration point indices, component labels, Invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of ElementIntegrationPointField object Parameters:[out] A new instance of ElementIntegrationPointField object 
o GetDimensions
Returns an instance of ElementIntPointDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, integration point indices, component labels, Invariants, isDoublePrecision, isComplexParameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the ElementIntPointDimension object with members:frame indices, loadcase indices, section points, element indices, integration point indices, component labels, Invariants, isDoublePrecision, isComplex.
oGetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex[in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iSectionPoint [in/required] An integer specifying the section point index for which data is required.iElementIndices [in/required] A sequence of integers specifying the element indices for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iElementIndex [in/required] An integer specifying the element index for which data is required.iIntegrationPoint [in/required] An integer specifying the integration point index for which data is required.iComponentSymbol [in/required] A string specifying the component label for which data is required. iLoadCase[in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1.[out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
ElementNodalFieldReader
The ElementNodalFieldReader object is derived from the FieldReader object.
Method Index
o __init__Creates a new instance of ElementNodalFieldReader object 
Page 280 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 281 ---

o GetDimensionsReturns an instance of ElementNodalDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, local node indices, component labels, Invariants, isDoublePrecision, isComplex of data per element class for element output or all the nodes for node output. 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of ElementNodalFieldReader object Parameters:[out] A new instance of ElementNodalFieldReader object 
o GetDimensions
Returns an instance of ElementNodalDimension for the drawer with members: frame indices, loadcase indices, section points, element indices, local node indices, component labels, Invariants, isDoublePrecision, isComplex of data per element class for element output or all the nodes for node output. Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the ElementNodalDimension object with members: frame indices, loadcase indices, section points, elementindices, local node indices, component labels, Invariants, isDoublePrecision, isComplex. 
o GetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex [in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iElementIndices [in/required] A sequence of integers specifying the element indices for which data is required. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer.
oGetHistoryResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iElementIndex [in/required] An integer specifying the element index for which data is required.iLocalNode [in/required] An integer specifying the local node index for which data is required. iComponentSymbol[in/required] A string specifying the component label for which data is required. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer.
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
FieldReader
This abstract base class provides the interface for each field on SIM. 
Method Index
o __init__Abstract base class. 
o GetFieldMaterialReturns the material name associated with the field. This is valid in case of a multi-species field or a CEL field. 
o GetNumberOfDrawersReturns the number of drawers in the field. A drawer is a rectangular block of data per element class for element output or all the nodes for node output. 
o GetOrientationFieldInfo
Page 281 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 282 ---

Gets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Abstract base class. Parameters:None
oGetFieldMaterial
Returns the material name associated with the field. This is valid in case of a multi-species field or a CEL field.Parameters:[out] A string specifying the material name associated with the field. 
o GetNumberOfDrawers
Returns the number of drawers in the field. A drawer is a rectangular block of data per element class for element output or all the nodes for node output.Parameters:[out] The number of drawers in the field. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
GenericPositionFieldReader
The GenericPositionFieldReader object is derived from the FieldReader object.
Method Index
o __init__Creates a new instance of GenericPositionFieldReader object 
o GetDimensionsReturns the dimensions for the drawer. A bulk drawer is a rectangular drawer of data per element class for element output and all the nodes for node output. 
o GetFieldResultDataReturns a sequence of data for the drawer. A drawer is a rectangular block of data per element class for element output or all the nodes for node output. 
o GetHistoryResultDataReturns a sequence of data for the drawer. A drawer is a rectangular block of data per element class for element output or all the nodes for node output.
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of GenericPositionFieldReader object Parameters:[out] A new instance of GenericPositionFieldReader object 
o GetDimensions
Returns the dimensions for the drawer. A bulk drawer is a rectangular drawer of data per element class for element output and all the nodes for node output.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of bulk drawers. [out] An instance of the Dimension object. 
o GetFieldResultData
Returns a sequence of data for the drawer. A drawer is a rectangular block of data per element class for element output or all the nodes for node output.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers.iDimensionDetailsList; [in/required] A Dimensions object to query for the field drawer. [out] A sequence of doubles specifying the data for the drawer. 
o GetHistoryResultData
Returns a sequence of data for the drawer. A drawer is a rectangular block of data per element class for element output or all the nodes for node output.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers.iDimensionDetailsList; [in/required] A Dimensions object to query for the field drawer. [out] A sequence of doubles specifying the data for the drawer. 
Page 282 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 283 ---

oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
SurfaceNodalFieldReader
The SurfaceNodalFieldReader object is derived from the FieldReader object.
Method Index
o __init__Creates a new instance of SurfaceNodalField object 
o GetDimensionsReturns an instance of SurfaceNodalDimension for the drawer with members: frame indices loadCases, nodeIndices, components,invariants, isDoublePrecision, isComplex generalContact, masterSurface, slaveSurface, outputSurface 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of SurfaceNodalField objectParameters:[out] A new instance of SurfaceNodalField object 
o GetDimensions
Returns an instance of SurfaceNodalDimension for the drawer with members: frame indices loadCases, nodeIndices, components,invariants, isDoublePrecision, isComplex generalContact, masterSurface, slaveSurface, outputSurfaceParameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the SurfaceNodalDimension object with members: frame indices loadCases, nodeIndices, components,invariants, isDoublePrecision, isComplex. 
o GetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex [in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iNodeIndices[in/required] A sequence of integers specifying the node indices for which data is required. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer.
oGetHistoryResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iNodeIndex[in/required] An integer specifying the node index for which data is required. iComponentSymbol [in/required] A string specifying the component label for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
TempPointElementNodalFieldReader
The TempPointElementNodalFieldReader object is derived from the FieldReader object.
Page 283 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 284 ---

Method Index
o __init__Creates a new instance of TempPointElementNodalField object 
o GetDimensionsReturns an instance of TempPointElementNodalDimension for the drawer with members: frame indices, loadCases, sectionPoints, elementIndices, localNodes, temperature points, components,invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of TempPointElementNodalField object Parameters:[out] A new instance of TempPointElementNodalField object 
o GetDimensions
Returns an instance of TempPointElementNodalDimension for the drawer with members: frame indices, loadCases, sectionPoints, elementIndices, localNodes, temperature points, components,invariants, isDoublePrecision, isComplexParameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the TempPointElementNodalDimension object with members: frame indices, loadCases, sectionPoints, elementIndices, localNodes, temperaturePoints, components,invariants, isDoublePrecision, isComplex.
oGetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex[in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iSectionPoint [in/required] An integer specifying the section point for which data is required. iElementIndices[in/required] A sequence of integers specifying the node indices for which data is required. iTemperaturePoints[in/required] A sequence of integers specifying the temperature points for which data is required. iLoadCase[in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1.[out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iSectionPoint[in/required] An integer specifying the section point index for which data is required. iElementIndex [in/required] An integer specifying the element index for which data is required.iLocalNode [in/required] An integer specifying the local node index for which data is required. iTemperaturePoint[in/required] An integer specifying the temperature point for which data is required. iComponentSymbol [in/required] A string specifying the component label for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
TempPointNodalFieldReader
The TempPointNodalFieldReader object is derived from the FieldReader object.
Method Index
Page 284 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 285 ---

o __init__Creates a new instance of TempPointNodalField object 
o GetDimensionsReturns an instance of TempPointNodalDimension for the drawer with members: frame indices, loadCases, nodeIndices, temperature points, components,invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of TempPointNodalField objectParameters:[out] A new instance of TempPointNodalField object 
o GetDimensions
Returns an instance of TempPointNodalDimension for the drawer with members: frame indices, loadCases, nodeIndices, temperature points, components,invariants, isDoublePrecision, isComplex Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the TempPointNodalDimension object with members: frame indices, loadCases, nodeIndices, temperaturePoints, components,invariants, isDoublePrecision, isComplex.
oGetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex[in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iNodeIndices [in/required] A sequence of integers specifying the node indices for which data is required.iTemperaturePoints [in/required] A sequence of integers specifying the temperature points for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iNodeIndex[in/required] An integer specifying the node index for which data is required. iTemperaturePoint [in/required] An integer specifying the temperature point for which data is required.iComponentSymbol [in/required] A string specifying the component label for which data is required. iLoadCase[in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1.[out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
UniqueNodalFieldReader
The UniqueNodalFieldReader object is derived from the FieldReader object. 
Method Index
o __init__Creates a new instance of UniqueNodalField object 
o GetDimensionsReturns an instance of UniqueNodalDimension for the drawer with members: frame indices, loadCases, nodeIndices, components,invariants, isDoublePrecision, isComplex 
Page 285 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 286 ---

oGetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of UniqueNodalField objectParameters:[out] A new instance of UniqueNodalField object 
o GetDimensions
Returns an instance of UniqueNodalDimension for the drawer with members: frame indices, loadCases, nodeIndices, components,invariants, isDoublePrecision, isComplexParameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the UniqueNodalDimension object with members: frame indices, loadCases, nodeIndices, components,invariants, isDoublePrecision, isComplex. 
o GetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex [in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iNodeIndices[in/required] A sequence of integers specifying the node indices for which data is required. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer.
oGetHistoryResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iNodeIndex[in/required] An integer specifying the node index for which data is required. iComponentSymbol [in/required] A string specifying the component label for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
WholeElementFieldReader
The WholeElementFieldReader object is derived from the FieldReader object.
Method Index
o __init__Creates a new instance of WholeElementFieldReader object 
o GetDimensionsReturns an instance of WholeElementFieldReader for the drawer with members: frame indices, loadcase indices, element indices, Component labels, Invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
Page 286 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 287 ---

o__init__
Creates a new instance of WholeElementFieldReader object Parameters:[out] A new instance of WholeElementFieldReader object 
o GetDimensions
Returns an instance of WholeElementFieldReader for the drawer with members: frame indices, loadcase indices, element indices, Component labels, Invariants,isDoublePrecision, isComplex Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the WholeElementFieldReader object with members: frame indices, loadcase indices, element indices, Component labels, Invariants, isDoublePrecision, isComplex.
oGetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex[in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iElementIndices [in/required] A sequence of integers specifying the element indices for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iElementIndex[in/required] An integer specifying the element index for which data is required. iComponentSymbol [in/required] A string specifying the component label for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
WholeModelFieldReader
The WholeModelFieldReader object is derived from the FieldReader object. 
Method Index
o __init__Creates a new instance of WholeModelField object 
o GetDimensionsReturns an instance of WholeModelDimension for the drawer with members: frame indices, loadCases, components,invariants, isDoublePrecision, isComplex 
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
Methods
o__init__
Creates a new instance of WholeModelField objectParameters:[out] A new instance of WholeModelField object 
o GetDimensions
Returns an instance of WholeModelDimension for the drawer with members: frame indices, loadCases, components,invariants, isDoublePrecision, isComplexParameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the WholeModelDimension object with members: frame indices, loadCases, components,invariants, isDoublePrecision, isComplex.
Page 287 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 288 ---

oGetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex[in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iComponentSymbol[in/required] A string specifying the component label for which data is required. iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer.
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info.
WholeRegionFieldReader
The WholeRegionFieldReader object is derived from the FieldReader object. 
Method Index
o __init__Creates a new instance of WholeRegionField object 
o GetDimensionsReturns an instance of WholeRegionDimension for the drawer with members: frame indices, loadCases, regionIndices, components,invariants, isDoublePrecision, isComplex
o GetFieldResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetHistoryResultDataReturns a tuple of real and imaginary data for the drawer. 
o GetOrientationFieldInfoGets the associated orientation field info. Returns false if the field has no associated orientation. 
o GetRegionDataReturns the node or element set indices along with the set name for the given region index.
Methods
o__init__
Creates a new instance of WholeRegionField objectParameters:[out] A new instance of WholeRegionField object 
o GetDimensions
Returns an instance of WholeRegionDimension for the drawer with members: frame indices, loadCases, regionIndices, components,invariants, isDoublePrecision, isComplexParameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. [out] An instance of the WholeRegionDimension object with members: frame indices, loadCases, regionIndices, components,invariants, isDoublePrecision, isComplex. 
o GetFieldResultData
Returns a tuple of real and imaginary data for the drawer. Parameters:iDrawerNumber [in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iFrameIndex [in/required] An integer specifying the frame index for which the data is requested; Set it to -1 if the field does not have associated frames. iRegionIndices[in/required] A sequence of integers specifying the node or element indices for which data is required. iLoadCase[in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1.[out] A sequence of doubles specifying the real and imaginary data for the drawer. 
Page 288 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 289 ---

o GetHistoryResultData
Returns a tuple of real and imaginary data for the drawer.Parameters:iDrawerNumber[in/required] An integer specifying the drawer number; Must be non-negative and less than the number of drawers. iRegionIndex[in/required] An integer specifying the node index for which data is required. iComponentSymbol [in/required] A string specifying the component label for which data is required.iLoadCase [in/optional] An integer specifying the load case index, must be specified when load case exists in dimension. The default value is - 1. [out] A sequence of doubles specifying the real and imaginary data for the drawer. 
oGetOrientationFieldInfo
Gets the associated orientation field info. Returns false if the field has no associated orientation.Parameters:[out] A FieldInfo object specifying the orientation field info. 
o GetRegionData
Returns the node or element set indices along with the set name for the given region index.Parameters:iRegionIndex[in/required] Region index. [out] An instance of RegionData class with members: regionIndex, nsetName, nodeIndices, elsetName, elementIndices.
FieldInfo
This struct is intended to capture the basic field info that will help uniquely identify the field on SIM. 
Method Index
o __init__Create a new FieldInfo class.
Methods
o__init__
Parameters:None
SimResultsReaderException
The SimResultsReaderException object is derived from the Exception object.
Method Index
o __init__Creates a new instance of SimResultsReaderException 
Methods
o__init__
Parameters:None
SIMResultsWriter
This class is intended to make it as easy as possible to write results to SIM that will be compatible with HPViz. 
Method Index
o __init__Creates a new instance of SIMResultsWriter object 
o AddDisplayBodyConstraintCreates a display body constraint for the specified set of elements. 
Page 289 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 290 ---

o AddElementsAdds the element data for mesh to the document. 
o AddFieldTypeAdds a new user defined fieldType to document. 
o AddFrameAdds a frame to the step. 
oAddLoadCaseCreates a loadcase for the step. 
o AddModifiedFieldTypeCopies a existing fieldType to a new user defined fieldType, adds to the document.
o AddStepCreates a step.
o AddUserElementLabelsReturns a list of flat element labels for the given vector of user element labels.
o AddUserNodeLabelsReturns a list of flat node labels for the given vector of user node labels.. 
o CreateBeamSectionCreates beam section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error if element set contains elements of multiple element specs. 
o CreateCompositeShellSectionCreates composite shell section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an errorif element set contains elements of multiple element specs. 
o CreateContinuumSectionCreates continuum section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error ifelement set contains elements of multiple element specs. 
o CreateDocumentCreates a SIM document. If there is any existing document with same name, it will be overwritten.
o CreateHomogeneousShellSectionCreates homogeneous shell section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error if element set contains elements of multiple element specs. 
o CreateMaterialCreates material.
o CreatePermutedElementSetCreates permuted set of elements. 
o CreatePermutedNodeSetCreates permuted set of nodes. 
o FinalizeSaves and closes the SIM document; must be called only once. 
o GetDocumentReturns the underlying SIMDocument object, for advanced usage with SIM API. 
o GetFieldTypeFromOutputVariableGets a fieldType name for output variable. 
o InitFieldResultInitializes a field result. 
o InitHistoryResultInitializes a history result. 
o InitOrientationCreates Orientation.
o InitializeInitializes ResultsWriter, this method must be called before any other method.
o LoadDocumentLoads an existing SIM document. ResultsWriter expects certain state of the document, so this options should be used with caution. 
o SetGeometricNonlinearityOptionSets the geometric nonlinearity option for the step. 
o SetUnitSystemSet the unit system.
o SetUserElementLabelsMapSet the user element label to flat label mapping if it is known ahead of time.
o SetUserNodeLabelsMapSet the user node label to flat label mapping if it is known ahead of time. 
o WriteNodesWrites the node coordinate data for mesh (or part of mesh) to the document. Should give better performance if data for all nodes is written at once. 
Page 290 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 291 ---

Methods
o __init__
Creates a new instance of SIMResultsWriter object Parameters:[out] A new instance of SIMResultsWriter object 
oAddDisplayBodyConstraint
Creates a display body constraint for the specified set of elements. Parameters:iConstraintName [in/required] A string specifying the constraint name for the display body constraint; must be a unique.iConstraintDescription [in/required] A string specifying the description. iElsetName [in/required] A string specifying the element set name to be constrained as a display body.iRefNodeSetName [in/required] A string specifying the reference node set to which the display body is connected to. There can be maximum of 3 nodes in the node set and the set must be permuted.
oAddElements
Adds the element data for mesh to the document.Parameters:iElementSpec[in/required] A string specifying the elementSpec. Refer to "SIM predefined string" section of "Writing SIM Results Using Python" userdocumentation. iElementIndices [in/required] A sequence of integers specifying the element indices. iConnectivity[in/required] A sequence of integers specifying the connectivity for each element specified in iElementIndices; must be of length iNumElements 
oAddFieldType
Adds a new user defined fieldType to document.Parameters:iFieldType[in/required] A string specifying the FieldType to be added to SIM document. iFieldTypeDescription [in/required] A string specifying the description. iAlgebraicType[in/required] A string specifying the AlgebraicType.iPhysicalDimension [in/required] A string specifying the PhysicalDimension e.g. MLT02; refer to "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iDsMagnitude [in/required] A string specyfing the dsMagnitude string to help HPViz process the field types e.g FORCE.iNonNegative [in/optional] A boolean specifying if the field type can be negative or not. This can only be true for a SCALAR or TENSOR2_GENERAL. 
oAddFrame
Adds a frame to the step. Parameters:iStepName [in/required] A string specifying the step name for the frame; must be already created. iFrameIndex[in/required] An integer specifying the frame Index to be added; must not be already defined. iFrameValues [in/required] A double specifying the frame value. 
o AddLoadCase
Creates a loadcase for the step. Parameters:iStepName[in/required] A string specifying the step name for the load case; must be already created. iCaseName [in/required] A string specifying the loadcase name to be created; must be unique across all steps. 
oAddModifiedFieldType
Copies a existing fieldType to a new user defined fieldType, adds to the document. Parameters:iOriginalFieldType [in/required] A string specifying the original field type to be copied, must exist on SIM document. iFieldType [in/required] A string specifying the FieldType to be added to SIM document. iFieldTypeDescription[in/required] A string specifying the description.
oAddStep
Creates a step. Parameters:iStepName [in/required] A string specifying the step name to be created; must be unique. iStepTypeName[in/required] A string specifying the type name of the step to be created; all step type names are available in "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iStepDescription 
Page 291 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 292 ---

[in/required] A string specifying the description. iFrameValues [in/required] A sequence of doubles specifying the frame values. 
o AddUserElementLabels
Returns a list of flat element labels for the given vector of user element labels.Parameters:iInstanceName[in/required] A string specifying the instance name.iUserLabels [in/required] A sequence of integers specifying the user element labels. [out] A sequence of integers specifying the flat element labels. 
o AddUserNodeLabels
Returns a list of flat node labels for the given vector of user node labels..Parameters:iInstanceName[in/required] A string specifying the instance name.iUserLabels [in/required] A sequence of integers specifying the user node labels. [out] A sequence of integers specifying the flat node labels. 
o CreateBeamSection
Creates beam section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error if elementset contains elements of multiple element specs. Parameters:iElsetName [in/required] A string specifying the element set name; must be already created. iMaterialName[in/required] A string specifying the material name to be assigned to section; must be already created. iProfileType[in/required] A string specifying the beam Profile type.iNumDirSectionPoints [in/required] A sequence of integers specifying the number of section points in each direction.
oCreateCompositeShellSection
Creates composite shell section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error if element set contains elements of multiple element specs. Parameters:iElsetName [in/required] A string specifying the element set name; must be already created. iNumLayers[in/required] An integer specifying the number of layers.iMaterialNames [in/required] A sequence of strings specifying the name of Materials to be assigned for each layer in section; must be already created. iPlyNames [in/required] A sequence of strings specifying the ply name for each layer.iNumSectionPoints [in/required] An integer specifying the number of section points, same for all layers. iLayerThickness[in/required] A sequence of doubles specifying the thickness for each layer. 
oCreateContinuumSection
Creates continuum section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error if element set contains elements of multiple element specs. Parameters:iElsetName [in/required] A string specifying the element set name; must be already created. iMaterialName[in/required] A string specifying the material name to be assigned to section; must be already created. 
o CreateDocument
Creates a SIM document. If there is any existing document with same name, it will be overwritten. Parameters:iDocName[in/required] A string specifying the document name.
oCreateHomogeneousShellSection
Creates homogeneous shell section, element class and assigns material to the section. It is expected that an element set here defines an element class; returns an error if element set contains elements of multiple element specs. Parameters:iElsetName [in/required] A string specifying the element set name; must be already created. iMaterialName[in/required] A string specifying the material name to be assigned to section; must be already created. iNumSectionPoints[in/required] An integer specifying the number of section points.iThickness [in/optional] A double specifying the section thickness. The default value is 1.0. 
o CreateMaterial
Creates material.Parameters:iMaterialName[in/required] A string specifying the material name; must be unique. 
Page 292 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 293 ---

oCreatePermutedElementSet
Creates permuted set of elements.Parameters:iSetName [in/required] A string specifying the set name to be created; must be unique for both element and node sets. iMembers [in/required] A sequence of integers specifying the members; order is maintained, no duplicates.
oCreatePermutedNodeSet
Creates permuted set of nodes.Parameters:iSetName [in/required] A string specifying the set name to be created; must be unique for both node and element sets. iMembers [in/required] A sequence of integers specifying the members; order is maintained, no duplicates.
oFinalize
Saves and closes the SIM document; must be called only once. Parameters:None
oGetDocument
Returns the underlying SIMDocument object, for advanced usage with SIM API. Parameters:[out] A SIMDocument object specifying the SIMDocument object. 
oGetFieldTypeFromOutputVariable
Gets a fieldType name for output variable. Parameters:iOutputVariable[in/required] A string specifying output variable name for which fieldType is needed. [out] A string specifying the FieldType.
oInitFieldResult
Initializes a field result.Parameters:iStepName[in/required] A string specifying the step name for the result; must be already created. iFieldType [in/required] A string specifying the fieldType name. Refer to "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.ioField [in/required] A Field object specifying the field object which should be used to add data. 
o InitHistoryResult
Initializes a history result. Parameters:iStepName[in/required] A string specifying the step name for the result; must be already created. iFieldType [in/required] A string specifying the fieldType name; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.ioField [in/required] A Field object specifying the field object which should be used to add data. 
o InitOrientation
Creates Orientation. Parameters:iOrientationName[in/required] Orientation name to be created; must be unique.ioOrientation [in/required] Orientation object which should be used to add data. 
o Initialize
Initializes ResultsWriter, this method must be called before any other method.Parameters:iMaxChunkSizeInMB[in/optional] An integer specifying the max chunk size in MB. A chunk is the unit of I/O for bulk data. The default value is 1.
oLoadDocument
Loads an existing SIM document. ResultsWriter expects certain state of the document, so this options should be used with caution. Parameters:iDocName[in/required] A string specifying the document name.
oSetGeometricNonlinearityOption
Sets the geometric nonlinearity option for the step. Parameters:iStepName[in/required] A string specifying the step name for the option; must be already created. 
o SetUnitSystem
Page 293 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 294 ---

Set the unit system.Parameters:iUnitSystemName[in/required] A string specifying the name of the unit system.iLengthToSIConvFactor [in/optional] A double specifying the length to SI conversion factor (default = 1.0).iMassToSIConvFactor [in/optional] A double specifying the mass to SI conversion factor (default = 1.0). iTimeToSIConvFactor[in/optional] A double specifying the time to SI conversion factor (default = 1.0). iElectricCurrentToSIConvFactor[in/optional] A double specifying the electric current to SI conversion factor (default = 1.0). iTemperatureToSIConvFactor[in/optional] A double specifying the temperature to SI conversion factor (default = 1.0). iTemperatureToSIOffset[in/optional] A double specifying the temperature to SI offset (default = 0.0). iAmtOfSubToSIConvFactor [in/optional] A double specifying the amount of substance to SI conversion factor (default = 1.0). iLumIntensityToSIConvFactor [in/optional] A double specifying the Luminous intensity to SI conversion factor (default = 1.0). iAngleToSIConvFactor [in/optional] A double specifying the angle to SI conversion factor (default = 1.0).iSolidAngleToSIConvFactor [in/optional] A double specifying the solid angle to SI conversion factor (default = 1.0).
oSetUserElementLabelsMap
Set the user element label to flat label mapping if it is known ahead of time. Parameters:iInstanceName [in/required] A string specifying the instance name. iUserLabels [in/required] A sequence of integers specifying the user element labels. iFlatLabels[in/required] A sequence of integers specifying the flat element labels. 
oSetUserNodeLabelsMap
Set the user node label to flat label mapping if it is known ahead of time. Parameters:iInstanceName [in/required] A string specifying the instance name. iUserLabels [in/required] A sequence of integers specifying the user node labels. iFlatLabels[in/required] A sequence of integers specifying the flat node labels. 
oWriteNodes
Writes the node coordinate data for mesh (or part of mesh) to the document. Should give better performance if data for all nodes is written at once. Parameters:iNumSpaceDims[in/required] An integer specifying the number of space dimension for model: 2 for 2D and 3 for 3D. iNodeIndices[in/required] A sequence of integers specifying the node indices.iCoords [in/required] A sequence of doubles specifying the coordinates; must be of length iNumNodes*iNumSpaceDims.
ElemCentroidField
The ElemCentroidField object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of ElemCentroidField object 
o AddFrameDataAdds float data for a frame for a results field, dimensions must be defined before this method call.
o DefineDimensionsDefines dimensions for ElemCentroidField. 
Methods
o__init__
Creates a new instance of ElemCentroidField objectParameters:[out] A new instance of ElemCentroidField object 
o AddFrameData
Adds float data for a frame for a results field, dimensions must be defined before this method call.Parameters:iFrameIndex[in/required] An integer specifying the frame index.iSectionPoint 
Page 294 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 295 ---

[in/required] An integer specifying the section point. iElsetName [in/required] A string specifying the element set name; must be same as used in DefineDimensions or subset of it. iData [in/optional] A sequence of floats specifying the real data; must be in the order #Elements *#Components. The default is an empty sequence. iImaginaryData[in/optional] A sequence of floats specifying the imaginary data, must be in the order #Elements *#Components. The default value is an emptysequence. iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
oDefineDimensions
Defines dimensions for ElemCentroidField.Parameters:iElsetName[in/required] A string specifying the element set for element dimension; all elements must be from same element class.iSectionPoints [in/required] A sequence of integers specifying the section points for section point dimension.iComponentSymbols [in/required] A sequence of strings specifying the components for component dimension.iInvariantSymbols [in/required] A sequence of strings specifying the invariant symbols; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iComplex [in/required] A boolean specifying the complex - true if field has real and imaginary data. iDoublePrecision[in/optional] A boolean specifying the double precision data. The default value is false.
ElemFaceField
The ElemFaceField object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of ElemFaceField object 
o AddFrameDataAdds float data for a frame for a results field; dimensions must be defined before this method call.
o AddHistoryDataAdds float data for frames for a history field, dimensions must be defined before this method call. 
o DefineDimensionsDefines dimensions for ElemFaceField. 
Methods
o__init__
Creates a new instance of ElemFaceField objectParameters:[out] A new instance of ElemFaceField object 
o AddFrameData
Adds float data for a frame for a results field; dimensions must be defined before this method call.Parameters:iFrameIndex[in/required] An integer specifying the frame index.iElementSetName [in/required] A string specifying the element set name; must be same as used in DefineDimensions or subset of it. iData [in/optional] A sequence of floats specifying the real data; must be in the order #Elements *#Components. The default is an empty sequence. iImaginaryData [in/optional] A sequence of floats specifying the imaginary data, must be in the order #Elements *#Components. The default value is an empty sequence.iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
oAddHistoryData
Adds float data for frames for a history field, dimensions must be defined before this method call.Parameters:iFrameIndices[in/required] A sequence of integers specifying the frame indices. This sequence can be a subset of the 'iFrameValues' in AddStep method. iElementSetName [in/required] A string specifying the element set name; must be same as used in DefineDimensions or subset of it. iData [in/optional] A sequence of floats specifying the real data; must be in the order #Elements *#Components. The default is an empty sequence. iImaginaryData[in/optional] A sequence of floats specifying the imaginary data, must be in the order #Elements *#Components. The default value is an emptysequence. iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
Page 295 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 296 ---

oDefineDimensions
Defines dimensions for ElemFaceField.Parameters:iElementSetName[in/required] A string specifying the element set for element dimension. iFaceID [in/required] Face index.iComponentSymbols [in/required] A sequence of strings specifying the components for component dimension.iInvariantSymbols [in/required] A sequence of strings specifying the invariant symbols; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iComplex [in/required] A boolean specifying the complex - true if field has real and imaginary data. iDoublePrecision[in/optional] A boolean specifying the double precision data. The default value is false.
ElemIntegrationPointField
The ElemIntegrationPointField object is derived from the FieldWriter object.
Method Index
o __init__Creates a new instance of ElemIntegrationPointField object 
o AddFrameDataAdds float data for a frame for a results field, dimensions must be defined before this method call.
o DefineDimensionsDefines dimensions for ElemIntegrationPointField. 
Methods
o __init__
Creates a new instance of ElemIntegrationPointField object Parameters:[out] A new instance of ElemIntegrationPointField object
oAddFrameData
Adds float data for a frame for a results field, dimensions must be defined before this method call.Parameters:iFrameIndex[in/required] An integer specifying the frame index.iSectionPoint [in/required] An integer specifying the section point. iElsetName [in/required] A string specifying the element set name; must be same as used in DefineDimensions or subset of it. iData [in/optional] A sequence of floats specifying the real data; must be in the order #Elements *#IntegrationPts *#Components. The default is an empty sequence. iImaginaryData[in/optional] A sequence of floats specifying the imaginary data, must be in the order #Elements *#IntegrationPts *#Components. The default value is an empty sequence. iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
o DefineDimensions
Defines dimensions for ElemIntegrationPointField. Parameters:iElsetName [in/required] A string specifying the element set for element dimension; all elements must be from same element class. iSectionPoints [in/required] A sequence of integers specifying the section points for section point dimension.iNumIntegrationPts [in/required] An integer specifying the number of integration points; must be greater than 0.iComponentSymbols [in/required] A sequence of strings specifying the components for component dimension.iInvariantSymbols [in/required] A sequence of strings specifying the invariant symbols; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iComplex [in/required] A boolean specifying the complex - true if field has real and imaginary data. iDoublePrecision[in/optional] A boolean specifying the double precision data. The default value is false.
ElemNodalField
The ElemNodalField object is derived from the FieldWriter object. 
Page 296 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 297 ---

Method Index
o __init__Creates a new instance of ElemNodalField object 
o AddFrameDataAdds float data for a frame for a results field, dimensions must be defined before this method call.
o DefineDimensionsDefines dimensions for an element class of ElemNodalField. 
Methods
o __init__
Creates a new instance of ElemNodalField object Parameters:[out] A new instance of ElemNodalField object 
o AddFrameData
Adds float data for a frame for a results field, dimensions must be defined before this method call.Parameters:iFrameIndex[in/required] An integer specifying the frame index.iSectionPoint [in/required] An integer specifying the section point. Set it to -1 if there are no section points.iElsetName [in/required] A string specifying the element set name; must be same as used in DefineDimensions or subset of it.iData [in/optional] A sequence of floats specifying the real data; must be in the order #Elements *#Nodes *#Components. The default is an empty sequence. iImaginaryData[in/optional] A sequence of floats specifying the imaginary data, must be in the order #Elements *#Nodes *#Components. The default value is an empty sequence. iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
o DefineDimensions
Defines dimensions for an element class of ElemNodalField.Parameters:iElsetName[in/required] A string specifying the element set for element dimension; all elements must be from same element class.iNodesPerElement [in/required] An integer specifying the number of nodes for nodal dimension; must be greater than 0.iSectionPoints [in/required] A sequence of integers specifying the section points for section point dimension. Set it to empty sequence when there are no section points. iComponentSymbols[in/required] A sequence of strings specifying the components for component dimension. iInvariantSymbols [in/required] A sequence of strings specifying the invariant symbols; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation. iComplex [in/required] A boolean specifying the complex - true if field has real and imaginary data.iDoublePrecision [in/optional] A boolean specifying the double precision data. The default value is false.
UniqueNodalField
The UniqueNodalField object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of UniqueNodalField object 
o AddFrameDataAdds float data for a frame for a results field; dimensions must be defined before this method call.
o AddHistoryDataAdds float data for frames for a history field, dimensions must be defined before this method call. 
o DefineDimensionsDefines dimensions for UniqueNodalField. 
Methods
o__init__
Creates a new instance of UniqueNodalField objectParameters:
Page 297 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 298 ---

[out] A new instance of UniqueNodalField object 
o AddFrameData
Adds float data for a frame for a results field; dimensions must be defined before this method call.Parameters:iFrameIndex[in/required] An integer specifying the frame index.iNodeSetName [in/required] A string specifying the node set name; must be same as used in DefineDimensions or subset of it.iData [in/optional] A sequence of floats specifying the real data; must be in the order #Nodes *#Components. The default is an empty sequence. iImaginaryData [in/optional] A sequence of floats specifying the imaginary data, must be in the order #Nodes *#Components. The default value is an empty sequence.iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
oAddHistoryData
Adds float data for frames for a history field, dimensions must be defined before this method call.Parameters:iFrameIndices[in/required] A sequence of integers specifying the frame indices. This sequence can be a subset of the 'iFrameValues' in AddStep method. iNodeSetName [in/required] A string specifying the node set name; must be same as used in DefineDimensions or subset of it. iData [in/optional] A sequence of floats specifying the real data; must be in the order #Nodes *#Components. The default is an empty sequence. iImaginaryData [in/optional] A sequence of floats specifying the imaginary data, must be in the order #Nodes *#Components. The default value is an empty sequence.iLoadCaseName [in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
oDefineDimensions
Defines dimensions for UniqueNodalField.Parameters:iNodeSetName[in/required] A string specifying the node set for node dimension. iComponentSymbols [in/required] A sequence of strings specifying the components for component dimension.iInvariantSymbols [in/required] A sequence of strings specifying the invariant symbols; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iComplex [in/required] A boolean specifying the complex - true if field has real and imaginary data. iDoublePrecision[in/optional] A boolean specifying the double precision data. The default value is false.
WholeElemField
The WholeElemField object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of WholeElemField object 
o AddFrameDataAdds float data for a frame for a results field, dimensions must be defined before this method call.
o DefineDimensionsDefines dimensions for WholeElemField. 
Methods
o__init__
Creates a new instance of WholeElemField objectParameters:[out] A new instance of WholeElemField object 
o AddFrameData
Adds float data for a frame for a results field, dimensions must be defined before this method call.Parameters:iFrameIndex[in/required] An integer specifying the frame index.iElsetName [in/required] A string specifying the element set name; must be same as used in DefineDimensions or subset of it.iData [in/optional] A sequence of floats specifying the real data; must be in the order #Elements *#Components. The default is an empty sequence. iImaginaryData [in/optional] A sequence of floats specifying the imaginary data, must be in the order #Elements *#Components. The default value is an empty sequence.iLoadCaseName 
Page 298 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 299 ---

[in/optional] A string specifying the load case name; must be used if a step has a load case. The default value is "". 
oDefineDimensions
Defines dimensions for WholeElemField.Parameters:iElsetName[in/required] A string specifying the element set for element dimension; all elements must be from same element class.iComponentSymbols [in/required] A sequence of strings specifying the components for component dimension.iInvariantSymbols [in/required] A sequence of strings specifying the invariant symbols; must be from "SIM predefined string" section of "Writing SIM Results Using Python" user documentation.iComplex [in/required] A boolean specifying the complex - true if field has real and imaginary data. iDoublePrecision[in/optional] A boolean specifying the double precision data. The default value is false.
CartesianOrientation
The CartesianOrientation object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of CartesianOrientation object 
o DefineDefine Cartesian Orientation. 
oValidateCheck if the Orientation is defined and valid 
Methods
o__init__
Creates a new instance of CartesianOrientation objectParameters:[out] A new instance of CartesianOrientation object 
o Define
Define Cartesian Orientation.Parameters:iOrg [in/required] Origin coordinates [x,y,z] iQuaternion0 [in/required] Quaternion component r iQuaternion1 [in/required] Quaternion component u iQuaternion2 [in/required] Quaternion component v iQuaternion3 [in/required] Quaternion component w 
oValidate
Check if the Orientation is defined and validParameters:None
CylindricalOrientation
The CylindricalOrientation object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of CylindricalOrientation object 
o DefineDefine Cylindrical Orientation.
o ValidateCheck if the Orientation is defined and valid 
Methods
Page 299 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 300 ---

o __init__
Creates a new instance of CylindricalOrientation object Parameters:[out] A new instance of CylindricalOrientation object
oDefine
Define Cylindrical Orientation.Parameters:iPointA [in/required] Coordinate of First Axis Point [x,y,z] iPointB[in/required] Coordinate of Second Axis Point [x,y,z]
oValidate
Check if the Orientation is defined and validParameters:None
FieldWriter
The abstract base of all field classes. Fields in SIM are represented as multi-dimensional arrays. 
Method Index
o SetOrientationFieldSets orientation field for this field object. 
Methods
o SetOrientationField
Sets orientation field for this field object. Parameters:iOrientationField [in/required] Orientation field to be associated with this field.
SIMDocument
Method Index
o __init__Creates a new instance of SIMDocument object 
Methods
o __init__
Creates a new instance of SIMDocument object Parameters:[out] A new instance of SIMDocument object
SimResultsWriterException
The SimResultsWriterException object is derived from the Exception object.
Method Index
o __init__Creates a new instance of SimResultsWriterException object 
Methods
o __init__
Creates a new instance of SimResultsWriterException object Parameters:[out] A new instance of SimResultsWriterException object
Page 300 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 301 ---

SphericalOrientation
The SphericalOrientation object is derived from the FieldWriter object. 
Method Index
o __init__Creates a new instance of SphericalOrientation object 
o DefineDefine Spherical Orientation. 
oValidateCheck if the Orientation is defined and valid 
Methods
o__init__
Creates a new instance of SphericalOrientation objectParameters:[out] A new instance of SphericalOrientation object 
o Define
Define Spherical Orientation.Parameters:iPointA [in/required] Coordinate of First Axis Point [x,y,z] iPointB[in/required] Coordinate of Second Axis Point [x,y,z]
oValidate
Check if the Orientation is defined and validParameters:None
SIMDocUtils
This class includes all the utility methods needed for a SIM document. 
Method Index
o ConvertDocumentUpgrades or downgrades the given SIM document. o DowngradeRequiredQuery to determine if the document specified by the supplied path requires downgrade. o UpgradeRequiredQuery to determine if the document specified by the supplied path requires upgrade. 
Methods
o ConvertDocument
Upgrades or downgrades the given SIM document. Parameters:iDocName [in/required] Name of the document to upgrade/downgrade. iUpgradeDocName [in/required] Name of the upgraded/downgraded document. 
o DowngradeRequired
Query to determine if the document specified by the supplied path requires downgrade.Parameters:iDocName [in/required] Name of the document to query. True if the document requires downgrade.[out] True if the document requires downgrade.
oUpgradeRequired
Query to determine if the document specified by the supplied path requires upgrade. Parameters:iDocName [in/required] Name of the document to query. True if the document requires upgrade. [out] True if the document requires upgrade.
Page 301 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm

--- PAGE 302 ---

SimDocUtilsException
The SimDocUtilsException object is derived from the Exception object. 
Method Index
o __init__Creates a new instance of SimDocUtilsException 
Methods
o__init__
Parameters:None
Page 302 of 302Scenario and Result Representations
07/07/2025file:///C:/Users/Tarik/AppData/Local/Temp/~hh2292.htm
